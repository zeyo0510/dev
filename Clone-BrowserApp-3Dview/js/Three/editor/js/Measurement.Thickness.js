T.MeasurementThickness=function(){T.MeasurementDistance.call(this);this.createGizmo=function(c){return this.measurementGizmo=new T.MeasurementGizmoThickness(this,c)};this.getType=function(){return"Thickness"};this.getDescription=function(){return null==this.getValue()?"thickness":"thickness = "+this.getValue().toFixed(2)}};T.MeasurementThickness.prototype=Object.create(T.MeasurementDistance.prototype);
T.MeasurementGizmoThickness=function(c,n){T.MeasurementGizmoDistance.call(this,c,n);var k=this,l=new T.Raycaster;this.addControlPoint=function(b,a,c,g,m){T.MeasurementGizmoDistance.prototype.addControlPoint.call(this,b,a,c,g,m);if(1==k.controlPoints.length&&!0!==c){a.geometry&&T.GeometryUtils.computeFaceNormal.call(a.geometry,g);b=g.normal.clone();var d=(new T.Matrix3).getNormalMatrix(a.matrixWorld),d=b.clone().applyMatrix3(d).normalize().negate(),e=k.getControlPointsWorld();l.set(e[0],d);for(var d=
l.intersectObjects([a],!0),e=e[0],h=0;h<d.length;++h){var f=d[h];f.object&&f.object.geometry&&T.GeometryUtils.computeFaceNormal.call(f.object.geometry,f.face);if(0>=b.dot(f.face.normal)){e=d[h].point;break}}T.MeasurementGizmoDistance.prototype.addControlPoint.call(this,e,a,c,g,m)}};this.updateGizmosFromControlPoints=function(b){T.MeasurementGizmoDistance.prototype.updateGizmosFromControlPoints.call(this,b);if(!(2>this.controlPoints.length)){b=this.getWidth(this.getCenterPointWorld(),b);var a=this.getControlPointsWorld();
4==this.controlPoints.length?topPoints=[a[3],a[2]]:2==this.controlPoints.length&&(topPoints=[a[0],a[1]]);horisontal=(new T.V3).copy(topPoints[1]).sub(topPoints[0]);horisontalCorrection=(new T.V3).copy(horisontal).setLength(3*b);arrowCorrection=(new T.V3).copy(horisontal).setLength(2*b);0<horisontal.length()-6*b?(a=this.handleGizmos.TOPLINE[0],a.position.copy(topPoints[0]).add(horisontalCorrection),a.lookAt(topPoints[1]),a.scale.set(b,b,horisontal.length()-6*b),a.visible=!0,a=this.handleGizmos.STARTARROW[0],
a.position.copy(topPoints[0]).add(arrowCorrection),a.lookAt(topPoints[1]),a.scale.set(b,b,b),a.visible=!0,a=this.handleGizmos.ENDARROW[0],a.position.copy(topPoints[1]).sub(arrowCorrection),a.lookAt(topPoints[0]),a.scale.set(b,b,b),a.visible=!0):(this.handleGizmos.TOPLINE[0].visible=!1,this.handleGizmos.STARTARROW[0].visible=!1,this.handleGizmos.ENDARROW[0].visible=!1);a=this.pickerGizmos.TOPLINE[0];a.position.copy(topPoints[0]).add(horisontalCorrection);a.lookAt(topPoints[1]);a.scale.set(b,b,Math.max(horisontal.length()-
6*b,1E-5))}}};T.MeasurementGizmoThickness.prototype=Object.create(T.MeasurementGizmoDistance.prototype);

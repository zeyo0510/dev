Sidebar.Analysis=function(c){function q(){var a=c.selected,l=c.wallThicknessAnalysis;l&&l.enabled&&a&&(l.setMinMaxThickness(g.getValue(),h.getValue(),a),e.materialChanged.dispatch())}function r(){var a=c.selected,l=c.wallThicknessAnalysis;if(l&&l.enabled&&a){var b=0;m.getValue()&&(b+=1);n.getValue()&&(b+=2);l.setAnalysisMode(b,a);e.materialChanged.dispatch()}}function t(){f.setDisplay("none");var a=c.selected,b=c.wallThicknessAnalysis;if(b&&b.enabled&&a){var e=b.getAnalysisMode(a);if(null!==e&&void 0!==
e){f.setDisplay("block");p.setValue(void 0!==a.xrayContrast?a.xrayContrast:.5);var d=b.getMinMaxThickness(a);if(d)g.setValue(d.min),h.setValue(d.max);else{if(c.scene&&c.scene instanceof T.Platform&&c.scene.isPlatformVisible()&&(c.scene.layerThickness||c.scene.featureResolution))a=Math.min(c.scene.layerThickness,c.scene.featureResolution),d=Math.max(c.scene.layerThickness,c.scene.featureResolution),0<d&&.01>(d-a)/d&&(d*=2);else{var k=(a=T.GeometryUtils.getGlobalBoundingBox(a))?Math.abs(a.max.z-a.min.z):
Infinity,a=1,d=2;Infinity!==k&&(1E3<k?(a=k/200,d=k/100):10<k?(a=1,d=2):.1<k?(a=.039,d=.078):(a=k/20,d=k/10))}b.setMinMaxThickness(a,d);g.setValue(a);h.setValue(d)}m.setValue(1==e||3==e);n.setValue(2==e||3==e)}}}var e=c.signals,f=new UI.CollapsiblePanel;f.setBorderTop("1px solid #ccc");f.setPadding("10px");f.setDisplay("none");f.addStatic((new UI.Text).setValue("ANALYSIS").setColor("#666"));f.add(new UI.Break);var b=(new UI.Panel).setWidth("270px"),p=(new UI.Slider).setWidth("160px").setRange(0,1,
.01).setHeight("15px").onChange(function(){var a=c.selected,b=c.wallThicknessAnalysis;b&&b.enabled&&a&&(a.xrayContrast=p.getValue(),b=.5,.25>a.xrayContrast&&(b=2*a.xrayContrast),e.updateXRay.dispatch(a,Math.sqrt(b)),e.materialChanged.dispatch())});b.add((new UI.Text("X-Ray contrast")).setWidth("100px").setColor("#666"));b.add(p);f.add(b);var g=(new UI.Number).setWidth("35px").setRange(0,Infinity).setPrecision(3).onChange(function(){g.getValue()>=h.getValue()&&h.setValue(g.getValue()+.001);q()});g.setStyle("text-align",
["center"]);var h=(new UI.Number).setWidth("35px").setRange(.001,Infinity).setPrecision(3).onChange(function(){g.getValue()>=h.getValue()&&g.setValue(h.getValue()-.001);q()});h.setStyle("text-align",["center"]);var b=new UI.Panel,m=(new UI.Checkbox).onChange(r);b.add((new UI.Text("Thickness")).setWidth("77px").setColor("#f00"));b.add(m);b.add(g);b.add((new UI.Image("./assets/images/gradient_box.png")).setWidth("85px"));b.add(h);f.add(b);var b=new UI.Panel,n=(new UI.Checkbox).onChange(r),u=(new UI.Button("Update")).setWidth("75px").setHeight("18px").setFontSize("12px").setPadding("0px").setMarginLeft("46px").onClick(function(){var a=
c.wallThicknessAnalysis;a&&a.resetObject(c.selected);e.updateWallThickness.dispatch()});b.add((new UI.Text("Intersection")).setWidth("77px").setColor("#00f"));b.add(n);b.add(u);f.add(b);e.objectSelected.add(function(a){t()});e.updateWallThickness.add(function(){t()});return f};

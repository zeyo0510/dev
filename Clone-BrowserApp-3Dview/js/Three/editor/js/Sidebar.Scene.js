Sidebar.Scene=function(b){function g(){var b=c.getContentHeight(),a=parseInt(c.getHeight()),e=document.getElementById("sidebar").offsetHeight,d=document.getElementById("sidebar").scrollHeight,b=Math.min(Math.max(b,150),.4*e);if(d<=e||b<a)c.setHeight(b+"px"),d=document.getElementById("sidebar").scrollHeight,d>e&&b-(d-e)>a&&c.setHeight(b-(d-e)+"px");c.updateLayout()}var d=b.signals,f=new UI.CollapsiblePanel;f.setPadding("10px");f.setMarginBottom("0px");f.addStatic((new UI.Text("SCENE")).setColor("#666"));
f.add(new UI.Break);var c=(new UI.ObjectsTree).setId("tree").setWidth("270px").setHeight("150px").setColor("#444").setFontSize("12px");c.bindContextMenu=function(c){var a=b.getObjectById(parseInt(c.key));a||(a=b.selected?b.selected:b.scene);$(c.span.parentNode).contextMenu({selector:"span",callback:function(e,c){switch(e){case "export":a.geometry?T.FileOperations.exportObject(a,b):T.FileOperations.exportScene(b,a);sendEventStatistic("File","Export selected","Context Menu");break;case "nest":d.nest.dispatch(a);
sendEventStatistic("Edit","Nest","Context Menu");break;case "split":d.splitShells.dispatch(a);sendEventStatistic("Edit","Split Shells","Context Menu");break;case "merge":d.mergeChildren.dispatch(a);sendEventStatistic("Edit","Merge Children","Context Menu");break;case "group":d.group.dispatch();sendEventStatistic("Edit","Group","Context Menu");break;case "ungroup":d.ungroup.dispatch(a);sendEventStatistic("Edit","Ungroup","Context Menu");break;case "reduce":d.reduce.dispatch(a);sendEventStatistic("Edit",
"Reduce","Context Menu");break;case "smooth":d.smooth.dispatch(a);sendEventStatistic("Edit","Smooth","Context Menu");break;case "clone":void 0!==a&&void 0!==a.parent&&(b.signals.cloneObject.dispatch(a),sendEventStatistic("Edit","Clone","Context Menu"));break;case "delete":void 0!==a&&void 0!==a.parent&&(b.signals.deleteObject.dispatch(a),sendEventStatistic("Edit","Delete","Context Menu"))}},items:{nest:{name:"Auto Place",icon:"nest"},sep1:"---------",reduce:{name:"Reduce Faces",icon:"reduce"},smooth:{name:"Smooth",
icon:"smooth"},sep2:"---------",split:{name:"Split Shells",icon:"split"},merge:{name:"Merge Children",icon:"merge"},group:{name:"Group",icon:"group"},ungroup:{name:"Ungroup",icon:"ungroup"},clone:{name:"Clone",icon:"clone"},"delete":{name:"Delete",icon:"delete"},sep3:"---------","export":{name:"Save",icon:"save"}}})};c.onSelect(function(){b.selectById(parseInt(c.getSelectedObjectId()));g()});c.onMark(function(){b.setMarkByIds(c.getMarkedObjectIds());g()});f.add(c);d.windowResize.add(function(){g()});
d.sceneGraphChanged.add(function(){var d=b.scene;c.init();c.update(d,function(a){var e={mode:"hide",iconStyle:""},c=b.getObjectType(a),d=new T.Color(4095);if(1==a.dummy)return e;e.iconStyle=0==a.visible?e.iconStyle+"opacity: 0.3;":e.iconStyle+"opacity: 1;";switch(c){case "Platform":e.mode=a.isPlatformVisible()?"parent":"children";e.icon="./assets/icons/icon16.png";break;case "Scene":e.mode="children";break;case "Object3D":if(a instanceof T.Measurement||0<a.children.length)e.mode="show";e.icon=a instanceof
T.Measurement?"./assets/icons/measure16.png":"./assets/icons/group16.png";break;case "Mesh":if(a.geometry&&a.geometry.vertices&&0<a.geometry.vertices.length||0<a.children.length)e.mode="show";a=void 0!==a.material&&void 0!==a.material.color?a.material.color:void 0!==a.color?a.color:d;.6>a.getHSL().l?e.icon="./assets/icons/mesh-dark16.png":e.icon="./assets/icons/mesh-light16.png";e.iconStyle+="background-color:#"+a.getHexString()+";"}return e});c.markObjects(b.marked);b.selected?c.selectObjectById(b.selected.id):
g()});d.objectSelected.add(function(b){c.selectObjectById(null!==b?b.id:null)});d.objectMarked.add(function(d){c.markObjects(b.marked)});d.objectUnmarked.add(function(d){c.markObjects(b.marked)});return f};

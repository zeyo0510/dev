var Notifications=function(){this.buttonHandlerMap=[];this.clickHandlerMap=[];this.progressMap=[];this.timeoutsMap=[];var d=this;chrome.notifications.onClicked.addListener(function(a){var b=d.clickHandlerMap[a];void 0!==b&&(b(),d.closeNotification(a))});chrome.notifications.onButtonClicked.addListener(function(a,b){var c=d.buttonHandlerMap[a];void 0!==c&&(c(b),d.closeNotification(a))});this.closeNotification=function(a){try{a in this.buttonHandlerMap&&this.buttonHandlerMap.splice(a,1),a in this.clickHandlerMap&&
this.clickHandlerMap.splice(a,1),a in this.progressMap&&this.progressMap.splice(a,1),a in this.timeoutsMap&&(clearInterval(this.timeoutsMap[a]),this.timeoutsMap.splice(a,1)),chrome.notifications.clear(a,function(a){})}catch(b){console.log(b)}};this.createProgress=function(a,b,c,e,f){var h="Download_"+b.hashCode()+getUID();try{return a={type:"progress",title:a,message:b,progress:0,priority:1,buttons:[],iconUrl:"assets/icons/ext-notif64.png"},c&&(e=e?e:"Cancel",d.buttonHandlerMap[h]=c,a.buttons.push({title:e})),
chrome.notifications.create(h,a,function(a){d.progressMap[a]=0;d.timeoutsMap[a]=setInterval(function(){a in d.progressMap&&chrome.notifications.update(a,{progress:Math.round(d.progressMap[a])},function(a){})},700);f&&f()}),h}catch(l){console.log(l)}};this.updateProgress=function(a,b){try{100==Math.round(b)?chrome.notifications.update(a,{progress:100,title:"Processing",buttons:[]},function(a){}):a in this.progressMap&&(this.progressMap[a]=b)}catch(c){console.log(c)}};this.updateTitle=function(a,b){try{chrome.notifications.update(a,
{title:b},function(a){})}catch(c){console.log(c)}};this.updateMessage=function(a,b){try{chrome.notifications.update(a,{message:b},function(a){})}catch(c){console.log(c)}};this.endProgress=function(a){try{this.closeNotification(a)}catch(b){console.log(b)}};this.remind=function(a,b,c,e,f,h,l,p){var k="Reminder_"+a.hashCode()+(h?"":b.hashCode()),g=k+"_show_time";try{var r=function(e){var q={type:"basic",title:a,message:b,priority:0,buttons:[],iconUrl:"assets/icons/app-notif64.png"};l&&(d.clickHandlerMap[k]=
l);h&&(d.buttonHandlerMap[k]=function(){var a={};a[g]=0;chrome.storage.local.set(a)},q.buttons.push({title:"Never show again"}));setTimeout(function(){!e||p&&!p()||chrome.notifications.create(k,q,function(){})},c)};if(void 0!==e&&void 0!==f&&0<f){var n=(new Date).getTime(),m={};m[g]=n;chrome.storage.local.get(g,function(a){var b=!0;void 0===a[g]?(m[g]=n-f+e,chrome.storage.local.set(m),c=Math.max(c,e),b=!0):0==a[g]?b=!1:n>a[g]+f?(chrome.storage.local.set(m),b=!0):b=!1;r(b)})}else r(!0);return k}catch(t){console.log(t)}}};

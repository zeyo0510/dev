T.EffectComposer=function(a,b){this.renderer=a;void 0===b&&(b=new T.WebGLRenderTarget(window.innerWidth||1,window.innerHeight||1,{minFilter:T.LinearFilter,magFilter:T.LinearFilter,format:T.RGBFormat,stencilBuffer:!1}));this.renderTarget1=b;this.renderTarget2=b.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;this.passes=[];void 0===T.CopyShader&&console.error("T.EffectComposer relies on T.CopyShader");this.copyPass=new T.ShaderPass(T.CopyShader)};
T.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer;this.writeBuffer=a},addPass:function(a){this.passes.push(a)},insertPass:function(a,b){this.passes.splice(b,0,a)},render:function(a){this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;var b=!1,c,e,f=this.passes.length;for(e=0;e<f;e++)if(c=this.passes[e],c.enabled){var d=this.renderer.renderSelectedMode;void 0!==c.renderSelectedMode&&(this.renderer.renderSelectedMode=c.renderSelectedMode);
c.render(this.renderer,this.writeBuffer,this.readBuffer,a,b);this.renderer.renderSelectedMode=d;c.needsSwap&&(b&&(d=this.renderer.context,d.stencilFunc(d.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,a),d.stencilFunc(d.EQUAL,1,4294967295)),this.swapBuffers());c instanceof T.MaskPass?b=!0:c instanceof T.ClearMaskPass&&(b=!1)}},reset:function(a){void 0===a&&(a=this.renderTarget1.clone(),a.width=window.innerWidth,a.height=window.innerHeight);this.renderTarget1=
a;this.renderTarget2=a.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2},setSize:function(a,b){var c=this.renderTarget1.clone();c.width=a;c.height=b;this.reset(c)}};T.EffectComposer.camera=new T.OrthographicCamera(-1,1,1,-1,0,1);T.EffectComposer.quad=new T.Mesh(new T.PlaneGeometry(2,2),null);T.EffectComposer.scene=new T.Scene;T.EffectComposer.scene.add(T.EffectComposer.quad);

T.FileOperations.thingiverseWindow=null;T.FileOperations.thingiverseLastUrl="http://www.thingiverse.com/explore";T.FileOperations.closeThingiverse=function(){T.FileOperations.thingiverseWindow&&null!==T.FileOperations.thingiverseWindow&&T.FileOperations.thingiverseWindow.close()};
T.FileOperations.setThingiverseUrl=function(a){T.FileOperations.thingiverseWindow&&null!=T.FileOperations.thingiverseWindow&&T.FileOperations.thingiverseWindow.contentWindow&&T.FileOperations.thingiverseWindow.contentWindow.postMessage({navigateToUrl:a?a:"http://www.thingiverse.com"},"*")};T.FileOperations.extractFilenameFromThingiverseUrl=function(a){a=a.split(/\//g);return 1<a.length?a[a.length-1]:""};
T.FileOperations.handleThingiverseEvents=function(a){a=a.data;if(a.loaded)T.FileOperations.setThingiverseUrl("http://www.thingiverse.com/explore");else if(a.commit)a.webview&&""!=a.webview&&"about:blank"!=a.webview&&(T.FileOperations.thingiverseLastUrl=a.webview);else if(a.redirect){var b=T.FileOperations.extractFilenameFromThingiverseUrl(a.redirect);if(0<=a.redirect.toLowerCase().indexOf("thingiverse")&&0>a.redirect.toLowerCase().indexOf("#files")&&""!=b){T.FileOperations.setThingiverseUrl(T.FileOperations.thingiverseLastUrl);
var c=T.FileOperations.extractExtension(b).toLowerCase();T.FileOperations.supportedImportExtension(c)?editor.loader.loadUrl(a.redirect,b,!1,function(){editor.signals.unzoomCamera.dispatch();chrome.app.window.current().drawAttention()}):editor.notifications.remind("Thingiverse","The file you are trying to open is not supported by 3DView.",50)}}};
T.FileOperations.thingiverse=function(){chrome.app.window.create("thingDialog/thing.html",{id:"Thingiverse - 3DView",minWidth:640,minHeight:480,width:Math.min(1024,window.screen.width),height:Math.min(800,window.screen.height)},function(a){a&&(a.focus(),T.FileOperations.thingiverseWindow=a,T.FileOperations.thingiverseWindow.contentWindow.addEventListener("message",T.FileOperations.handleThingiverseEvents),notifications.remind("Meet Thingiverse","You can open compatible 3D files by clicking on them in the Thingiverse window",
1E3,1E3,864E5,!0,function(){}))})};

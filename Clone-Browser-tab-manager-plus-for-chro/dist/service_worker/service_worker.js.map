{
  "version": 3,
  "sources": ["../../node_modules/webextension-polyfill/dist/browser-polyfill.js", "../../src/helpers/storage.ts", "../../src/service_worker/context.ts", "../../src/strings/strings.ts", "../../src/helpers/utils.ts", "../../src/service_worker/background/tracking.ts", "../../src/service_worker/background/windows.ts", "../../src/service_worker/background/tabs.ts", "../../src/service_worker/ui/open.ts", "../../src/service_worker/background/actions.ts", "../../src/service_worker/ui/context_menus.ts", "../../src/service_worker/service_worker.ts"],
  "sourcesContent": ["/* webextension-polyfill - v0.12.0 - Tue May 14 2024 18:01:29 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (!(globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.id)) {\n  throw new Error(\"This script should only be loaded in a browser extension.\");\n}\n\nif (!(globalThis.browser && globalThis.browser.runtime && globalThis.browser.runtime.id)) {\n  const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = extensionAPIs => {\n    // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n    // at build time by replacing the following \"include\" with the content of the\n    // JSON file.\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"disable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"enable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"openPopup\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"browsingData\": {\n        \"remove\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"removeCache\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCookies\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeDownloads\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFormData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeHistory\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeLocalStorage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePasswords\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePluginData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"settings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"devtools\": {\n        \"inspectedWindow\": {\n          \"eval\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2,\n            \"singleCallbackArg\": false\n          }\n        },\n        \"panels\": {\n          \"create\": {\n            \"minArgs\": 3,\n            \"maxArgs\": 3,\n            \"singleCallbackArg\": true\n          },\n          \"elements\": {\n            \"createSidebarPane\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        }\n      },\n      \"downloads\": {\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"identity\": {\n        \"launchWebAuthFlow\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setEnabled\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"permissions\": {\n        \"contains\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"request\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getDevices\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"discard\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goBack\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goForward\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"topSites\": {\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    if (Object.keys(apiMetadata).length === 0) {\n      throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n    }\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.reject\n     *        The promise's rejection function.\n     * @param {object} metadata\n     *        Metadata about the wrapped method which has created the callback.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = (promise, metadata) => {\n      return (...callbackArgs) => {\n        if (extensionAPIs.runtime.lastError) {\n          promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n        } else if (metadata.singleCallbackArg ||\n                   (callbackArgs.length <= 1 && metadata.singleCallbackArg !== false)) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          if (metadata.fallbackToNoCallback) {\n            // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n            // and so the polyfill will try to call it with a callback first, and it will fallback\n            // to not passing the callback if the first call fails.\n            try {\n              target[name](...args, makeCallback({resolve, reject}, metadata));\n            } catch (cbError) {\n              console.warn(`${name} API method doesn't seem to support the callback parameter, ` +\n                           \"falling back to call it without a callback: \", cbError);\n\n              target[name](...args);\n\n              // Update the API method metadata, so that the next API calls will not try to\n              // use the unsupported callback anymore.\n              metadata.fallbackToNoCallback = false;\n              metadata.noCallback = true;\n\n              resolve();\n            }\n          } else if (metadata.noCallback) {\n            target[name](...args);\n            resolve();\n          } else {\n            target[name](...args, makeCallback({resolve, reject}, metadata));\n          }\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the original method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n      let handlers = {\n        has(proxyTarget, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(proxyTarget, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else if (hasOwnProperty(metadata, \"*\")) {\n            // Wrap all properties in * namespace.\n            value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(proxyTarget, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(proxyTarget, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(proxyTarget, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      // Per contract of the Proxy API, the \"get\" proxy handler must return the\n      // original value of the target if that value is declared read-only and\n      // non-configurable. For this reason, we create an object with the\n      // prototype set to `target` instead of using `target` directly.\n      // Otherwise we cannot return a custom object for APIs that\n      // are declared read-only and non-configurable, such as `chrome.devtools`.\n      //\n      // The proxy handlers themselves will still use the original `target`\n      // instead of the `proxyTarget`, so that the methods and properties are\n      // dereferenced via the original targets.\n      let proxyTarget = Object.create(target);\n      return new Proxy(proxyTarget, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps an onRequestFinished listener function so that it will return a\n       * `getContent()` property which returns a `Promise` rather than using a\n       * callback API.\n       *\n       * @param {object} req\n       *        The HAR entry object representing the network request.\n       */\n      return function onRequestFinished(req) {\n        const wrappedReq = wrapObject(req, {} /* wrappers */, {\n          getContent: {\n            minArgs: 0,\n            maxArgs: 0,\n          },\n        });\n        listener(wrappedReq);\n      };\n    });\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let didCallSendResponse = false;\n\n        let wrappedSendResponse;\n        let sendResponsePromise = new Promise(resolve => {\n          wrappedSendResponse = function(response) {\n            didCallSendResponse = true;\n            resolve(response);\n          };\n        });\n\n        let result;\n        try {\n          result = listener(message, sender, wrappedSendResponse);\n        } catch (err) {\n          result = Promise.reject(err);\n        }\n\n        const isResultThenable = result !== true && isThenable(result);\n\n        // If the listener didn't returned true or a Promise, or called\n        // wrappedSendResponse synchronously, we can exit earlier\n        // because there will be no response sent from this listener.\n        if (result !== true && !isResultThenable && !didCallSendResponse) {\n          return false;\n        }\n\n        // A small helper to send the message if the promise resolves\n        // and an error if the promise rejects (a wrapped sendMessage has\n        // to translate the message into a resolved promise or a rejected\n        // promise).\n        const sendPromisedResult = (promise) => {\n          promise.then(msg => {\n            // send the message value.\n            sendResponse(msg);\n          }, error => {\n            // Send a JSON representation of the error if the rejected value\n            // is an instance of error, or the object itself otherwise.\n            let message;\n            if (error && (error instanceof Error ||\n                typeof error.message === \"string\")) {\n              message = error.message;\n            } else {\n              message = \"An unexpected error occurred\";\n            }\n\n            sendResponse({\n              __mozWebExtensionPolyfillReject__: true,\n              message,\n            });\n          }).catch(err => {\n            // Print an error on the console if unable to send the response.\n            console.error(\"Failed to send onMessage rejected reply\", err);\n          });\n        };\n\n        // If the listener returned a Promise, send the resolved value as a\n        // result, otherwise wait the promise related to the wrappedSendResponse\n        // callback to resolve and send it as a response.\n        if (isResultThenable) {\n          sendPromisedResult(result);\n        } else {\n          sendPromisedResult(sendResponsePromise);\n        }\n\n        // Let Chrome know that the listener is replying.\n        return true;\n      };\n    });\n\n    const wrappedSendMessageCallback = ({reject, resolve}, reply) => {\n      if (extensionAPIs.runtime.lastError) {\n        // Detect when none of the listeners replied to the sendMessage call and resolve\n        // the promise to undefined as in Firefox.\n        // See https://github.com/mozilla/webextension-polyfill/issues/130\n        if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n          resolve();\n        } else {\n          reject(new Error(extensionAPIs.runtime.lastError.message));\n        }\n      } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n        // Convert back the JSON representation of the error into\n        // an Error instance.\n        reject(new Error(reply.message));\n      } else {\n        resolve(reply);\n      }\n    };\n\n    const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n      if (args.length < metadata.minArgs) {\n        throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      if (args.length > metadata.maxArgs) {\n        throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      return new Promise((resolve, reject) => {\n        const wrappedCb = wrappedSendMessageCallback.bind(null, {resolve, reject});\n        args.push(wrappedCb);\n        apiNamespaceObj.sendMessage(...args);\n      });\n    };\n\n    const staticWrappers = {\n      devtools: {\n        network: {\n          onRequestFinished: wrapEvent(onRequestFinishedWrappers),\n        },\n      },\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n        onMessageExternal: wrapEvent(onMessageWrappers),\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 1, maxArgs: 3}),\n      },\n      tabs: {\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 2, maxArgs: 3}),\n      },\n    };\n    const settingMetadata = {\n      clear: {minArgs: 1, maxArgs: 1},\n      get: {minArgs: 1, maxArgs: 1},\n      set: {minArgs: 1, maxArgs: 1},\n    };\n    apiMetadata.privacy = {\n      network: {\"*\": settingMetadata},\n      services: {\"*\": settingMetadata},\n      websites: {\"*\": settingMetadata},\n    };\n\n    return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n  };\n\n  // The build process adds a UMD wrapper around this file, which makes the\n  // `module` variable available.\n  module.exports = wrapAPIs(chrome);\n} else {\n  module.exports = globalThis.browser;\n}\n", "\uFEFFimport * as browser from 'webextension-polyfill';\n\nexport async function getLocalStorage(key, default_value = null){\n\tconst result = await browser.storage.local.get([key]);\n\treturn result[key] === undefined ? default_value : result[key];\n}\n\nexport async function getLocalStorageMap<T extends number, V>(key: string): Promise<Map<T, V>>{\n\tconst result = await browser.storage.local.get([key]);\n\tif (result[key] === undefined) {\n\t\treturn new Map<T, V>();\n\t}\n\tlet newMap = new Map<T, V>();\n\tlet obj: Object = result[key];\n\tfor (const [k, v] of Object.entries(obj)) {\n\t\tlet key = parseInt(k);\n\t\tnewMap.set(key as T, v as V);\n\t}\n\treturn newMap;\n}\n\nexport async function getLocalStorageStringMap<T, V>(key : string) : Promise<Map<T, V>> {\n\tconst result = await browser.storage.local.get([key]);\n\tif (result[key] === undefined) {\n\t\treturn new Map<T, V>();\n\t}\n\tlet newMap = new Map<T, V>();\n\tlet obj : Object = result[key];\n\tfor (const [k, v] of Object.entries(obj)) {\n\t\tnewMap.set(k as T, v as V);\n\t}\n\treturn newMap;\n}\n\nexport async function setLocalStorage(key : string, value){\n\tconst obj = {};\n\tobj[key] = value;\n\treturn browser.storage.local.set(obj);\n}\n\nexport async function setLocalStorageMap<T, V>(key : string, value : Map<T,V>) {\n\tconst obj = {};\n\tobj[key] = Object.fromEntries(value);\n\treturn browser.storage.local.set(obj);\n}\n\nexport async function removeLocalStorage(key){\n\treturn browser.storage.local.remove(key);\n}", "\uFEFF\"use strict\";\nimport * as browser from 'webextension-polyfill';\n\nexport let globalTabsActive : browser.Tabs.OnActivatedActiveInfoType[] = [];", "\uFEFF\"use strict\";\n\n// commands\nexport const reload_popup_controls = \"reload_popup_controls\";\nexport const update_tab_count = \"update_tab_count\";\nexport const discard_tabs = \"discard_tabs\";\nexport const move_tabs_to_window = \"move_tabs_to_window\";\nexport const focus_on_tab_and_window = \"focus_on_tab_and_window\";\nexport const focus_on_tab_and_window_delayed = \"focus_on_tab_and_window_delayed\";\nexport const focus_on_window = \"focus_on_window\";\nexport const focus_on_window_delayed = \"focus_on_window_delayed\";\nexport const set_window_color = \"set_window_color\";\nexport const set_window_name = \"set_window_name\";\nexport const create_window_with_tabs = \"create_window_with_tabs\";\nexport const create_window_with_session_tabs = \"create_window_with_session_tabs\";\nexport const close_tabs = \"close_tabs\";\nexport const switch_to_previous_active_tab = \"switch_to_previous_active_tab\";\nexport const refresh_windows = \"refresh_windows\";\n\n// context menues\nexport const open_in_own_tab = \"open_in_own_tab\";\nexport const open_popup = \"open_popup\";\nexport const open_sidebar = \"open_sidebar\";\nexport const sep1 = \"sep1\";\nexport const support_menu = \"support_menu\";\nexport const review = \"review\";\nexport const donate = \"donate\";\nexport const patron = \"patron\";\nexport const twitter = \"twitter\";\nexport const code_menu = \"code_menu\";\nexport const changelog = \"changelog\";\nexport const options = \"options\";\nexport const source = \"source\";\nexport const report = \"report\";\nexport const send = \"send\";\n\n// storage keys\nexport const windowHashes = \"windowHashes\";\nexport const windowColors = \"windowColors\";\nexport const windowNames = \"windowNames\";", "\uFEFF// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nexport function debounce(func, wait, immediate = false) {\n\tvar timeout;\n\treturn function () {\n\t\tvar context = this, args = arguments;\n\t\tvar later = function later() {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\t\tvar callNow = immediate && !timeout;\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\t\tif (callNow) func.apply(context, args);\n\t}\n}\n\nexport function is_in_bounds(object, bounds) {\n\tvar C = object, B = bounds;\n\tif (C.left >= B.left && C.left <= B.left + B.width) {\n\t\tif (C.top >= B.top && C.top <= B.top + B.height) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport function isInViewport(element, ofElement) {\n\tvar rect = element.getBoundingClientRect();\n\treturn rect.top >= 0 && rect.left >= 0 && rect.bottom <= ofElement.height && rect.right <= ofElement.width;\n}\n\nexport function stringHashcode(string) : number {\n\tvar hash = 0;\n\tfor (var i = 0; i < string.length; i++) {\n\t\tvar code = string.charCodeAt(i);\n\t\thash = ((hash << 5) - hash) + code;\n\t\thash = hash & hash; // Convert to 32bit integer\n\t}\n\treturn hash;\n}\n\nexport function maybePluralize(count, noun, suffix = 's') {\n\treturn `${count} ${noun}${count !== 1 ? suffix : ''}`;\n}\n\nexport function toBoolean(str) {\n\tif (typeof str === \"undefined\" || str === null) {\n\t\treturn false;\n\t} else if (typeof str === \"string\") {\n\t\tswitch (str.toLowerCase()) {\n\t\t\tcase \"false\":\n\t\t\tcase \"no\":\n\t\t\tcase \"0\":\n\t\t\tcase \"\":\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t} else if (typeof str === \"number\") {\n\t\treturn str !== 0;\n\t} else {\n\t\treturn true;\n\t}\n}", "\uFEFF\"use strict\";\n\nimport {hashcode} from \"@background/windows\"\nimport {debounce} from \"@helpers/utils\";\nimport {getLocalStorageMap, setLocalStorageMap, getLocalStorage, setLocalStorage} from \"@helpers/storage\";\nimport * as S from \"@strings\";\nimport * as browser from 'webextension-polyfill';\nimport {ICommand} from \"@types\";\n\nexport const cleanupDebounce = debounce(cleanUp, 500);\n\nexport async function cleanUp(remove_old = false) {\n\tlet activewindows = await browser.windows.getAll({populate: true});\n\tlet windowids: number[] = [];\n\tfor (let _w of activewindows) {\n\t\twindowids.push(_w.id);\n\t}\n\t// console.log(\"window ids...\", windowids);\n\n\tlet windows = await getLocalStorage(\"windowAge\", []);\n\tif (!(windows instanceof Array)) windows = [];\n\n\t// console.log(\"before\", JSON.parse(JSON.stringify(windows)));\n\tfor (let i = windows.length - 1; i >= 0; i--) {\n\t\tif (windowids.indexOf(windows[i]) < 0) {\n\t\t\t// console.log(\"did not find\", windows[i], i);\n\t\t\twindows.splice(i, 1);\n\t\t}\n\t}\n\n\t// console.log(\"after\", JSON.parse(JSON.stringify(windows)));\n\tawait setLocalStorage(\"windowAge\", windows);\n\n\tlet names : Map<number, string> = await getLocalStorageMap<number, string>(S.windowNames);\n\tlet colors : Map<number, string> = await getLocalStorageMap<number, string>(S.windowColors);\n\tlet to_check = new Set<number>();\n\tlet exists = new Set<number>();\n\tlet to_refresh : number[] = [];\n\n\t// console.log(\"before\", JSON.parse(JSON.stringify(names)));\n\tfor (const [id, _name] of names) {\n\t\tif (windowids.indexOf(id) < 0) {\n\t\t\t// console.log(\"did not find\", id);\n\t\t\tto_check.add(id);\n\t\t} else {\n\t\t\texists.add(id);\n\t\t}\n\t}\n\n\tfor (const [id, _color] of colors) {\n\t\tif (windowids.indexOf(id) < 0) {\n\t\t\t// console.log(\"did not find\", id);\n\t\t\tto_check.add(id);\n\t\t} else {\n\t\t\texists.add(id);\n\t\t}\n\t}\n\n\tif (to_check.size > 0) {\n\t\tlet hashes : Map<number, number> = await getLocalStorageMap<number, number>(S.windowHashes);\n\t\tlet found = false;\n\n\t\tfor (let w of activewindows) {\n\t\t\tconst windowhash = hashcode(w);\n\t\t\tfor (const [id, _hash] of hashes) {\n\t\t\t\tif (!to_check.has(id)) continue;\n\t\t\t\tif (exists.has(id)) continue;\n\t\t\t\tif (w.id === id) break;\n\t\t\t\tif (_hash === windowhash) {\n\t\t\t\t\tconsole.log(\"found by hash, old id \" + id + \" new id \" + w.id);\n\t\t\t\t\tto_refresh.push(w.id);\n\t\t\t\t\tif (!!names.get(id)) {\n\t\t\t\t\t\tnames.set(w.id, names.get(id));\n\t\t\t\t\t\tnames.delete(id);\n\t\t\t\t\t}\n\t\t\t\t\tif (!!colors.get(id)) {\n\t\t\t\t\t\tcolors.set(w.id, colors.get(id));\n\t\t\t\t\t\tcolors.delete(id);\n\t\t\t\t\t}\n\t\t\t\t\thashes.set(w.id, _hash);\n\t\t\t\t\thashes.delete(id);\n\t\t\t\t\tfound = true;\n\t\t\t\t\tto_check.delete(id);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet save = false;\n\t\tif (remove_old) {\n\t\t\tfor (const _id of to_check) {\n\t\t\t\tconsole.log(\"should delete from to check \" + _id);\n\t\t\t\tcolors.delete(_id);\n\t\t\t\tnames.delete(_id);\n\t\t\t\thashes.delete(_id);\n\t\t\t\tsave = true;\n\t\t\t}\n\t\t}\n\n\t\tif (found || save) {\n\t\t\tawait setLocalStorageMap<number, string>(S.windowNames, names);\n\t\t\tawait setLocalStorageMap<number, string>(S.windowColors, colors);\n\t\t\tawait setLocalStorageMap<number, number>(S.windowHashes, hashes);\n\t\t\tif (found) {\n\t\t\t\tbrowser.runtime.sendMessage<ICommand>({\n\t\t\t\t\tcommand: S.refresh_windows,\n\t\t\t\t\twindow_ids: to_refresh\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}", "\uFEFF\"use strict\";\n\nimport {cleanupDebounce} from \"@background/tracking\";\nimport {getLocalStorage, getLocalStorageMap, setLocalStorage, setLocalStorageMap} from \"@helpers/storage\";\nimport {is_in_bounds, stringHashcode} from \"@helpers/utils\";\nimport {setWindowColor, setWindowName} from \"@background/actions\";\nimport * as S from \"@strings\";\nimport * as browser from 'webextension-polyfill';\nimport {ISavedSession} from \"@types\";\n\nexport async function setupWindowListeners() {\n\tbrowser.windows.onFocusChanged.removeListener(windowFocus);\n\tbrowser.windows.onCreated.removeListener(windowCreated);\n\tbrowser.windows.onRemoved.removeListener(windowRemoved);\n\n\tbrowser.windows.onFocusChanged.addListener(windowFocus);\n\tbrowser.windows.onCreated.addListener(windowCreated);\n\tbrowser.windows.onRemoved.addListener(windowRemoved);\n}\n\nexport async function createWindowWithTabs(tabs : browser.Tabs.Tab[], isIncognito : boolean = false) {\n\tvar pinnedIndex = 0;\n\tvar firstTab = tabs.shift();\n\tvar t = [];\n\tfor (const _tab of tabs) {\n\t\tt.push(_tab.id);\n\t}\n\n\tvar firstPinned = firstTab.pinned;\n\tvar w = await browser.windows.create({tabId: firstTab.id, incognito: !!isIncognito});\n\tif (firstPinned) {\n\t\tawait browser.tabs.update(w.tabs[0].id, {pinned: firstPinned});\n\t\tpinnedIndex++;\n\t}\n\n\tif (t.length > 0) {\n\t\tvar i = 0;\n\t\tfor (let oldTabId of t) {\n\t\t\ti++;\n\t\t\tvar oldTab = await browser.tabs.get(oldTabId);\n\t\t\tvar tabPinned = oldTab.pinned;\n\t\t\tvar movedTabs : browser.Tabs.Tab | browser.Tabs.Tab[] = [];\n\t\t\tif (!tabPinned) {\n\t\t\t\tmovedTabs = await browser.tabs.move(oldTabId, {windowId: w.id, index: -1});\n\t\t\t} else {\n\t\t\t\tmovedTabs = await browser.tabs.move(oldTabId, {windowId: w.id, index: pinnedIndex++});\n\t\t\t}\n\n\t\t\tlet firstTab : browser.Tabs.Tab;\n\t\t\tif (Array.isArray(movedTabs)) {\n\t\t\t\tfirstTab = movedTabs[0];\n\t\t\t} else {\n\t\t\t\tfirstTab = movedTabs;\n\t\t\t}\n\n\t\t\tif (!!firstTab) {\n\t\t\t\tif (tabPinned) {\n\t\t\t\t\tawait browser.tabs.update(firstTab.id, {pinned: tabPinned});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tawait browser.windows.update(w.id, {focused: true});\n}\n\nexport async function createWindowWithSessionTabs(session: ISavedSession, tabId: number) {\n\n\tvar customName : string;\n\tif (session && session.name && session.customName) {\n\t\tcustomName = session.name;\n\t}\n\tvar color = \"default\";\n\tif (session && session.color) {\n\t\tcolor = session.color;\n\t}\n\n\tvar whitelistWindow = [\"left\", \"top\", \"width\", \"height\", \"incognito\", \"type\"];\n\n\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\twhitelistWindow = [\"left\", \"top\", \"width\", \"height\", \"incognito\", \"type\"];\n\t}\n\n\tvar whitelistTab = [\"url\", \"active\", \"selected\", \"pinned\", \"index\"];\n\n\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\twhitelistTab = [\"url\", \"active\", \"pinned\", \"index\"];\n\t}\n\n\tvar filteredWindow : browser.Windows.CreateCreateDataType = Object.keys(session.windowsInfo)\n\t\t.filter(function (key) {\n\t\t\treturn whitelistWindow.includes(key);\n\t\t})\n\t\t.reduce(function (obj, key) {\n\t\t\tobj[key] = session.windowsInfo[key];\n\t\t\treturn obj;\n\t\t}, {});\n\n\tif (filteredWindow.left < 0 || filteredWindow.left > 800) filteredWindow.left = 0;\n\tif (filteredWindow.top < 0 || filteredWindow.top > 600) filteredWindow.top = 0;\n\tif (filteredWindow.width > 800) filteredWindow.width = 800;\n\tif (filteredWindow.height > 600) filteredWindow.height = 600;\n\n\tfilteredWindow.type = \"normal\";\n\n\t// console.log(\"filtered window\", filteredWindow);\n\n\tconst newWindow = await browser.windows.create(filteredWindow).catch(function (error) {\n\t\tconsole.error(error);\n\t\tconsole.log(error);\n\t\tconsole.log(error.message);\n\t});\n\n\tif (!newWindow) return;\n\n\tlet emptyTab = newWindow.tabs[0].id;\n\n\tfor (let i = 0; i < session.tabs.length; i++) {\n\t\tlet newTab = Object.keys(session.tabs[i])\n\t\t\t.filter(function (key) {\n\t\t\t\treturn whitelistTab.includes(key);\n\t\t\t})\n\t\t\t.reduce(function (obj, key) {\n\t\t\t\tobj[key] = session.tabs[i][key];\n\t\t\t\treturn obj;\n\t\t\t}, {});\n\n\t\tvar fTab : browser.Tabs.Tab = newTab as browser.Tabs.Tab;\n\n\t\tif (tabId != null && tabId !== fTab.index) {\n\t\t\tcontinue;\n\t\t}\n\t\tfTab.windowId = newWindow.id;\n\n\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t\tif (!!fTab.url && fTab.url.search(\"about:\") > -1) {\n\t\t\t\tconsole.log(\"filtered by about: url\", fTab.url);\n\t\t\t\tfTab.url = \"\";\n\t\t\t}\n\t\t}\n\t\ttry {\n\t\t\tawait browser.tabs.create(fTab).catch(function (error) {\n\t\t\t\tconsole.error(error);\n\t\t\t\tconsole.log(error);\n\t\t\t\tconsole.log(error.message);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.log(\"couldn't restore tab\");\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\tawait browser.tabs.remove(emptyTab).catch(function (error) {\n\t\tconsole.error(error);\n\t\tconsole.log(error);\n\t\tconsole.log(error.message);\n\t});\n\n\tif (customName) {\n\t\tconsole.log(\"setting name\");\n\t\tawait setWindowName(newWindow.id, customName);\n\t}\n\n\tif (color !== \"default\") {\n\t\tconsole.log(\"setting color\");\n\t\tawait setWindowColor(newWindow.id, color);\n\t}\n\n\tawait browser.windows.update(newWindow.id, {focused: true});\n}\n\nexport function focusOnWindowDelayed(windowId: number) {\n\tsetTimeout(focusOnWindow.bind(this, windowId), 125);\n}\n\nexport async function focusOnWindow(windowId : number) {\n\tawait browser.windows.update(windowId, {focused: true});\n}\n\nasync function hideWindows(windowId : number) {\n\tif (navigator.userAgent.search(\"Firefox\") > -1) return;\n\tif (!windowId || windowId < 0) return;\n\n\tlet hide_windows = await getLocalStorage(\"hideWindows\", false);\n\tif (!hide_windows) return;\n\n\tlet has_permission = await browser.permissions.contains({permissions: ['system.display']});\n\tif (!has_permission) return;\n\n\tlet displaylayouts = await chrome.system.display.getInfo();\n\tlet monitor_bounds = [];\n\n\ttry {\n\t\tfor (let displaylayout of displaylayouts) {\n\t\t\tmonitor_bounds.push(displaylayout.bounds);\n\t\t}\n\t} catch (err) {\n\t\tconsole.error(err);\n\t\treturn;\n\t}\n\n\tlet windows = await browser.windows.getAll({populate: true});\n\tlet monitor = null;\n\n\tfor (let window of windows) {\n\t\tif (window.id === windowId) {\n\t\t\tfor (let bounds_index in monitor_bounds) {\n\t\t\t\tlet _monitor = monitor_bounds[bounds_index];\n\t\t\t\tlet _is_in_bounds = is_in_bounds(window, _monitor);\n\t\t\t\tif (_is_in_bounds) {\n\t\t\t\t\tmonitor = _monitor;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (monitor == null) return;\n\n\tfor (let window of windows) {\n\t\tif (window.id !== windowId) {\n\t\t\tif (is_in_bounds(window, monitor)) {\n\t\t\t\tawait browser.windows.update(window.id, {\"state\": \"minimized\"});\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport async function windowActive(windowId : number) {\n\tif (windowId < 0) return;\n\n\tvar windows = [];\n\tvar windowAge = await getLocalStorage(\"windowAge\", []);\n\tif (windowAge instanceof Array) windows = windowAge;\n\n\tif (windows.indexOf(windowId) > -1) windows.splice(windows.indexOf(windowId), 1);\n\twindows.unshift(windowId);\n\tawait setLocalStorage(\"windowAge\", windows);\n\n\t// browser.windows.getLastFocused({ populate: true }, function (w) {\n\t// \tfor (let i = 0; i < w.tabs.length; i++) {\n\t// \t\tvar tab = w.tabs[i];\n\t// \t\tif (tab.active === true) {\n\t// \t\t\t// console.log(\"get last focused\", tab.id);\n\t// \t\t\t// tabActiveChanged({\n\t// \t\t\t// \ttabId: tab.id,\n\t// \t\t\t// \twindowId: tab.windowId\n\t// \t\t\t// });\n\t// \t\t}\n\t// \t};\n\t// });\n\t// console.log(windows);\n}\n\nasync function windowFocus(windowId : number) {\n\ttry {\n\t\tif (!!windowId) {\n\t\t\tawait windowActive(windowId);\n\t\t\t// console.log(\"onFocused\", windowId);\n\t\t\tawait hideWindows(windowId);\n\t\t}\n\t} catch (e) {\n\n\t}\n}\n\nasync function windowCreated(window : browser.Windows.Window) {\n\ttry {\n\t\tif (!!window && !!window.id) {\n\t\t\tawait windowActive(window.id);\n\t\t}\n\t} catch (e) {\n\n\t}\n\t// console.log(\"onCreated \" + window.id, window);\n\tsetTimeout(cleanupDebounce, 250);\n}\n\nasync function windowRemoved(windowId : number) {\n\ttry {\n\t\tif (!!windowId) {\n\t\t\tawait windowActive(windowId);\n\t\t}\n\t} catch (e) {\n\n\t}\n\t// console.log(\"onRemoved\", windowId);\n}\n\nexport async function checkWindow(windowId : number) {\n\tif (!windowId) return;\n\n\tconst colors: Map<number, string> = await getLocalStorageMap<number, string>(S.windowColors);\n\tconst names: Map<number, string> = await getLocalStorageMap<number, string>(S.windowNames);\n\n\tif (!names[windowId] && !colors[windowId]) return;\n\n\tconst hashes: Map<number, number> = await getLocalStorageMap<number, number>(S.windowHashes);\n\n\ttry {\n\t\tconst window = await browser.windows.get(windowId, {populate: true});\n\n\t\tlet newHash = hashcode(window);\n\t\thashes.set(windowId, newHash);\n\t\tawait setLocalStorageMap(S.windowHashes, hashes);\n\t} catch (e) {\n\t\tconsole.log(e);\n\t}\n}\n\nexport function hashcode(window : browser.Windows.Window) : number {\n\tlet urls = [];\n\tfor (let i = 0; i < window.tabs.length; i++) {\n\t\tif (!window.tabs[i].url) continue;\n\t\turls.push(window.tabs[i].url);\n\t}\n\turls.sort();\n\n\tlet hash = 0;\n\tfor (let i = 0; i < urls.length; i++) {\n\t\tconst code = stringHashcode(urls[i]);\n\t\thash = ((hash << 5) - hash) + code;\n\t\thash = hash & hash; // Convert to 32bit integer\n\t}\n\treturn hash;\n}", "\uFEFF\"use strict\";\n\nimport {getLocalStorage} from \"@helpers/storage\";\nimport {trackLastTab} from \"@background/actions\"\nimport {globalTabsActive} from '@context';\nimport {debounce} from \"@helpers/utils\";\nimport {checkWindow, createWindowWithTabs} from '@background/windows';\nimport * as browser from 'webextension-polyfill';\n\nexport async function setupTabListeners() {\n\tbrowser.tabs.onCreated.removeListener(tabAdded);\n\tbrowser.tabs.onUpdated.removeListener(tabCountChanged);\n\tbrowser.tabs.onRemoved.removeListener(tabCountChanged);\n\tbrowser.tabs.onReplaced.removeListener(tabCountChanged);\n\tbrowser.tabs.onDetached.removeListener(tabCountChanged);\n\tbrowser.tabs.onAttached.removeListener(tabCountChanged);\n\tbrowser.tabs.onActivated.removeListener(tabActiveChanged);\n\tbrowser.tabs.onMoved.removeListener(tabCountChanged);\n\n\tbrowser.tabs.onCreated.removeListener(checkTabCreate);\n\tbrowser.tabs.onUpdated.removeListener(checkTabUpdate);\n\tbrowser.tabs.onRemoved.removeListener(checkTabRemove);\n\tbrowser.tabs.onDetached.removeListener(checkTabDetached);\n\tbrowser.tabs.onAttached.removeListener(checkTabAttached);\n\tbrowser.tabs.onMoved.removeListener(checkTabMoved);\n\n\tbrowser.tabs.onCreated.addListener(tabAdded);\n\tbrowser.tabs.onUpdated.addListener(tabCountChanged);\n\tbrowser.tabs.onRemoved.addListener(tabCountChanged);\n\tbrowser.tabs.onReplaced.addListener(tabCountChanged);\n\tbrowser.tabs.onDetached.addListener(tabCountChanged);\n\tbrowser.tabs.onAttached.addListener(tabCountChanged);\n\tbrowser.tabs.onActivated.addListener(tabActiveChanged);\n\tbrowser.tabs.onMoved.addListener(tabCountChanged);\n\n\tbrowser.tabs.onCreated.addListener(checkTabCreate); // 1, tab\n\tbrowser.tabs.onUpdated.addListener(checkTabUpdate); // 3, tabid, changeinfo, tab\n\tbrowser.tabs.onRemoved.addListener(checkTabRemove); // 2, tabid, removeinfo\n\tbrowser.tabs.onDetached.addListener(checkTabDetached); // 2, tabid, detachinfo\n\tbrowser.tabs.onAttached.addListener(checkTabAttached); // 2, tabid, attachinfo\n\tbrowser.tabs.onMoved.addListener(checkTabMoved); // 2, tabid, moveinfo\n}\n\nexport async function discardTabs(tabs) {\n\tfor (const tab of tabs) {\n\t\tif (!tab.discarded) {\n\t\t\tbrowser.tabs.discard(tab.id).catch(function (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t\tconsole.log(e.message);\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport async function closeTabs(tabs) {\n\tfor (const tab of tabs) {\n\t\tawait browser.tabs.remove(tab.id);\n\t}\n}\n\nexport async function moveTabsToWindow(windowId, tabs) {\n\tfor (const tab of tabs) {\n\t\tawait browser.tabs.move(tab.id, {windowId: windowId, index: -1});\n\t\tawait browser.tabs.update(tab.id, {pinned: tab.pinned});\n\t}\n}\n\nexport function focusOnTabAndWindowDelayed(tabId: number, windowId: number) {\n\tsetTimeout(focusOnTabAndWindow.bind(this, tabId, windowId), 125);\n}\n\nexport async function focusOnTabAndWindow(tabId : number, windowId : number) {\n\tawait browser.windows.update(windowId, {focused: true});\n\tawait browser.tabs.update(tabId, {active: true});\n\tawait tabActiveChanged({tabId: tabId, windowId: windowId});\n}\n\nexport async function updateTabCount() {\n\tlet run = true;\n\n\tconst badge = await getLocalStorage(\"badge\", true);\n\tif (!badge) run = false;\n\n\tif (run) {\n\t\tlet result = await browser.tabs.query({});\n\t\tlet count = 0;\n\t\tif (!!result && !!result.length) {\n\t\t\tcount = result.length;\n\t\t}\n\t\tawait browser.action.setBadgeText({text: count + \"\"});\n\t\tawait browser.action.setBadgeBackgroundColor({color: \"purple\"});\n\t\tconst _to_remove : number[] = [];\n\n\t\tif (!!globalTabsActive) {\n\t\t\tfor (let i = 0; i < globalTabsActive.length; i++) {\n\t\t\t\tconst t = globalTabsActive[i];\n\t\t\t\tlet found = false;\n\t\t\t\tif (!!result && !!result.length) {\n\t\t\t\t\tfor (let j = 0; j < result.length; j++) {\n\t\t\t\t\t\tif (result[j].id === t.tabId) found = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!found) _to_remove.push(i);\n\t\t\t}\n\t\t}\n\n\t\twhile (_to_remove.length > 0) {\n\t\t\tlet index = _to_remove.pop();\n\t\t\tif (!!globalTabsActive && globalTabsActive.length > 0) {\n\t\t\t\tif (!!globalTabsActive[index]) globalTabsActive.splice(index, 1);\n\t\t\t}\n\t\t}\n\n\t} else {\n\t\tawait browser.action.setBadgeText({text: \"\"});\n\t}\n}\n\nfunction tabCountChanged() {\n\tupdateTabCountDebounce();\n}\n\nexport const updateTabCountDebounce = debounce(updateTabCount, 250);\n\nasync function tabAdded(tab) {\n\tconst tabLimit = await getLocalStorage(\"tabLimit\", 0);\n\tif (tabLimit > 0) {\n\t\tif (tab.id !== browser.tabs.TAB_ID_NONE) {\n\t\t\tconst tabCount = await browser.tabs.query({currentWindow: true});\n\t\t\tif (tabCount.length > tabLimit) {\n\t\t\t\tawait createWindowWithTabs([tab], tab.incognito);\n\t\t\t}\n\t\t}\n\t}\n\tupdateTabCountDebounce();\n}\n\nfunction tabActiveChanged(tab : browser.Tabs.OnActivatedActiveInfoType) {\n\ttrackLastTab(tab);\n\tupdateTabCountDebounce();\n}\n\nasync function checkTabCreate(tab) {\n\tawait checkWindow(tab.windowId);\n}\n\nasync function checkTabUpdate(tabid, changeinfo, tab) {\n\tawait checkWindow(tab.windowId);\n}\n\nasync function checkTabRemove(tabid, removeinfo) {\n\tif (removeinfo.isWindowClosing) return;\n\tawait checkWindow(removeinfo.windowId);\n}\n\nasync function checkTabDetached(tabid, detachinfo) {\n\tawait checkWindow(detachinfo.oldWindowId);\n}\n\nasync function checkTabAttached(tabid, attachinfo) {\n\tawait checkWindow(attachinfo.newWindowId);\n}\n\nasync function checkTabMoved(tabid, moveinfo) {\n\tawait checkWindow(moveinfo.windowId);\n}", "\uFEFF\"use strict\";\n\nimport {getLocalStorage} from \"@helpers/storage\";\nimport {globalTabsActive} from '@context';\nimport {focusOnTabAndWindow} from \"@background/tabs\";\nimport * as browser from 'webextension-polyfill';\n\nexport async function openSidebar() {\n\tawait browser.sidebarAction.open();\n}\n\nexport async function openPopup() {\n\tconst openInOwnTab : boolean = await getLocalStorage(\"openInOwnTab\", false);\n\tif (openInOwnTab) {\n\t\tawait browser.action.setPopup({popup: \"popup.html?popup=true\"});\n\t\tawait browser.action.openPopup();\n\t\tawait browser.action.setPopup({popup: \"\"});\n\t} else {\n\t\tawait browser.action.openPopup();\n\t}\n}\n\nexport async function openAsOwnTab() {\n\tconst popup_page = await browser.runtime.getURL(\"popup.html\");\n\tconst tabs = await browser.tabs.query({});\n\n\tlet currentTab : browser.Tabs.OnActivatedActiveInfoType;\n\tlet previousTab : browser.Tabs.OnActivatedActiveInfoType;\n\n\tif (!!globalTabsActive && globalTabsActive.length > 1) {\n\t\tcurrentTab = globalTabsActive[globalTabsActive.length - 1];\n\t\tpreviousTab = globalTabsActive[globalTabsActive.length - 2];\n\t}\n\n\tfor (var i = 0; i < tabs.length; i++) {\n\t\tconst tab = tabs[i];\n\t\tif (tab.url.indexOf(\"popup.html\") > -1 && tab.url.indexOf(popup_page) > -1) {\n\t\t\tif (currentTab && currentTab.tabId && tab.id === currentTab.tabId && previousTab && previousTab.tabId) {\n\t\t\t\tawait focusOnTabAndWindow(previousTab.tabId, previousTab.windowId);\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tawait browser.windows.update(tab.windowId, {focused: true});\n\t\t\t\tawait browser.tabs.highlight({windowId: tab.windowId, tabs: tab.index});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\tawait browser.tabs.create({url: \"popup.html\"});\n}\n\nexport async function setupPopup() {\n\n\tconst openInOwnTab = await getLocalStorage(\"openInOwnTab\", false);\n\n\tbrowser.action.onClicked.removeListener(openAsOwnTab);\n\tif (openInOwnTab) {\n\t\tawait browser.action.setPopup({popup: \"\"});\n\t\tbrowser.action.onClicked.addListener(openAsOwnTab);\n\t} else {\n\t\tawait browser.action.setPopup({popup: \"popup.html?popup=true\"});\n\t}\n\tif (browser.sidebarAction) {\n\t\tawait browser.sidebarAction.setPanel({panel: \"popup.html?panel=true\"});\n\t}\n}", "\uFEFF\"use strict\";\n\nimport { globalTabsActive } from '@context'\nimport * as S from \"@strings\";\nimport { focusOnWindow, focusOnWindowDelayed, createWindowWithTabs, createWindowWithSessionTabs, hashcode } from '@background/windows';\nimport { getLocalStorageMap, setLocalStorageMap } from \"@helpers/storage\";\nimport { setupPopup } from \"@ui/open\";\nimport { updateTabCount, discardTabs, moveTabsToWindow, closeTabs, focusOnTabAndWindow, focusOnTabAndWindowDelayed } from \"@background/tabs\";\nimport * as browser from 'webextension-polyfill';\nimport { ICommand } from '@types';\n\nexport async function handleMessages(message, sender, sendResponse) {\n\tconst request = message as ICommand;\n\n\tswitch (request.command) {\n\t\tcase S.reload_popup_controls:\n\t\t\tsetupPopup();\n\t\t\tbreak;\n\t\tcase S.update_tab_count:\n\t\t\tupdateTabCount();\n\t\t\tbreak;\n\t\tcase S.discard_tabs:\n\t\t\tdiscardTabs(request.tabs);\n\t\t\tbreak;\n\t\tcase S.move_tabs_to_window:\n\t\t\tmoveTabsToWindow(request.window_id, request.tabs);\n\t\t\tbreak;\n\t\tcase S.focus_on_tab_and_window:\n\t\t\tif (!!request.tab) {\n\t\t\t\tfocusOnTabAndWindow(request.tab.id, request.tab.windowId);\n\t\t\t} else {\n\t\t\t\tfocusOnTabAndWindow(request.saved_tab.tabId, request.saved_tab.windowId);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase S.focus_on_tab_and_window_delayed:\n\t\t\tif (!!request.tab) {\n\t\t\t\tfocusOnTabAndWindowDelayed(request.tab.id, request.tab.windowId);\n\t\t\t} else {\n\t\t\t\tfocusOnTabAndWindowDelayed(request.saved_tab.tabId, request.saved_tab.windowId);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase S.focus_on_window:\n\t\t\tfocusOnWindow(request.window_id);\n\t\t\tbreak;\n\t\tcase S.focus_on_window_delayed:\n\t\t\tfocusOnWindowDelayed(request.window_id);\n\t\t\tbreak;\n\t\tcase S.set_window_color:\n\t\t\tsetWindowColor(request.window_id, request.color);\n\t\t\tbreak;\n\t\tcase S.set_window_name:\n\t\t\tsetWindowName(request.window_id, request.name);\n\t\t\tbreak;\n\t\tcase S.create_window_with_tabs:\n\t\t\tcreateWindowWithTabs(request.tabs, request.incognito);\n\t\t\tbreak;\n\t\tcase S.create_window_with_session_tabs:\n\t\t\tcreateWindowWithSessionTabs(request.session, request.tab_id);\n\t\t\tbreak;\n\t\tcase S.close_tabs:\n\t\t\tcloseTabs(request.tabs);\n\t\t\tbreak;\n\t}\n}\n\nexport function handleCommands(command : string) {\n\tif (command === S.switch_to_previous_active_tab) {\n\t\tif (!!globalTabsActive && globalTabsActive.length > 1) {\n\t\t\tvar _tab = globalTabsActive[globalTabsActive.length - 2];\n\t\t\tfocusOnTabAndWindow(_tab.tabId, _tab.windowId);\n\t\t}\n\t}\n}\n\nexport function trackLastTab(tab : browser.Tabs.OnActivatedActiveInfoType) {\n\tif (!!tab && !!tab.tabId) {\n\t\tif (!!globalTabsActive && globalTabsActive.length > 0) {\n\t\t\tvar lastActive = globalTabsActive[globalTabsActive.length - 1];\n\t\t\tif (!!lastActive && lastActive.tabId === tab.tabId && lastActive.windowId === tab.windowId) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\twhile (globalTabsActive.length > 20) {\n\t\t\tglobalTabsActive.shift();\n\t\t}\n\t\tfor (let i = globalTabsActive.length - 1; i >= 0; i--) {\n\t\t\tif (globalTabsActive[i].tabId === tab.tabId) {\n\t\t\t\tglobalTabsActive.splice(i, 1);\n\t\t\t}\n\t\t}\n\t\tglobalTabsActive.push(tab);\n\t}\n}\n\nexport async function setWindowColor(windowId : number, color : string) {\n\tvar colors : Map<number, string> = await getLocalStorageMap<number, string>(S.windowColors);\n\tif (!!color) {\n\t\tcolors.set(windowId, color);\n\t} else {\n\t\tcolors.delete(windowId);\n\t}\n\tawait setLocalStorageMap(S.windowColors, colors);\n\tawait updateWindowHash(windowId);\n\tbrowser.runtime.sendMessage<ICommand>({\n\t\tcommand: S.refresh_windows,\n\t\twindow_ids: [windowId]\n\t});\n}\n\nexport async function setWindowName(windowId: number, name : string) {\n\tvar names : Map<number, string> = await getLocalStorageMap<number, string>(S.windowNames);\n\tif (!!name) {\n\t\tnames.set(windowId, name);\n\t} else {\n\t\tnames.delete(windowId);\n\t}\n\tawait setLocalStorageMap(S.windowNames, names);\n\tawait updateWindowHash(windowId);\n\tbrowser.runtime.sendMessage<ICommand>({\n\t\tcommand: S.refresh_windows,\n\t\twindow_ids: [windowId]\n\t});\n}\n\nasync function updateWindowHash(windowId : number) {\n\tconst window = await browser.windows.get(windowId, {populate: true});\n\tconst hash = hashcode(window);\n\tconst hashes : Map<number, number> = await getLocalStorageMap<number, number>(S.windowHashes);\n\thashes.set(windowId, hash);\n\tawait setLocalStorageMap(S.windowHashes, hashes);\n}", "\uFEFF\"use strict\";\n\nimport {openPopup, openAsOwnTab, openSidebar} from \"@ui/open\";\nimport * as S from \"@strings\";\nimport * as browser from 'webextension-polyfill';\n\nexport async function setupContextMenus() {\n\tawait browser.contextMenus.removeAll();\n\n\tbrowser.contextMenus.create({\n\t\tid: S.open_in_own_tab,\n\t\ttitle: \"\uD83D\uDCD4 Open in own tab\",\n\t\tcontexts: [\"action\"]\n\t});\n\n\tif (!!browser.action.openPopup) {\n\t\tbrowser.contextMenus.create({\n\t\t\tid: S.open_popup,\n\t\t\ttitle: \"\uD83D\uDCD1 Open popup\",\n\t\t\tcontexts: [\"action\"]\n\t\t});\n\t}\n\n\tif (!!browser.sidebarAction) {\n\t\tbrowser.contextMenus.create({\n\t\t\tid: S.open_sidebar,\n\t\t\ttitle: \"\uD83D\uDDC2 Open sidebar\",\n\t\t\tcontexts: [\"action\"]\n\t\t});\n\t}\n\n\tbrowser.contextMenus.create({\n\t\tid: S.sep1,\n\t\ttype: \"separator\",\n\t\tcontexts: [\"action\"]\n\t});\n\n\tbrowser.contextMenus.create({\n\t\ttitle: \"\uD83D\uDE0D Support this extension\",\n\t\tid: S.support_menu,\n\t\t\"contexts\": [\"action\"]\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.review,\n\t\ttitle: \"\u2B50 Leave a review\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"support_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.donate,\n\t\ttitle: \"\u2615 Donate to keep Extensions Alive\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"support_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.patron,\n\t\ttitle: \"\uD83D\uDCB0 Become a Patron\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"support_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.twitter,\n\t\ttitle: \"\uD83D\uDC26 Follow on Twitter\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"support_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\ttitle: \"\uD83E\uDD14 Issues and Suggestions\",\n\t\tid: S.code_menu,\n\t\t\"contexts\": [\"action\"]\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.changelog,\n\t\ttitle: \"\uD83C\uDD95 View recent changes\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"code_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.options,\n\t\ttitle: \"\u2699 Edit Options\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"code_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.source,\n\t\ttitle: \"\uD83D\uDCBB View source code\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"code_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.report,\n\t\ttitle: \"\uD83E\uDD14 Report an issue\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"code_menu\"\n\t});\n\n\tbrowser.contextMenus.create({\n\t\tid: S.send,\n\t\ttitle: \"\uD83D\uDCA1 Send a suggestion\",\n\t\t\"contexts\": [\"action\"],\n\t\tparentId: \"code_menu\"\n\t});\n\n\tbrowser.contextMenus.onClicked.removeListener(contextListeners);\n\tbrowser.contextMenus.onClicked.addListener(contextListeners);\n}\n\nasync function contextListeners(info: browser.Menus.OnClickData, tab?: browser.Tabs.Tab)\n{\n\tswitch (info.menuItemId) {\n\t\tcase S.open_in_own_tab:\n\t\t\tawait openAsOwnTab();\n\t\t\tbreak;\n\t\tcase S.open_popup:\n\t\t\tawait openPopup();\n\t\t\tbreak;\n\t\tcase S.open_sidebar:\n\t\t\tawait openSidebar();\n\t\t\tbreak;\n\t\tcase S.donate:\n\t\t\tawait browser.tabs.create({url: 'https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=67TZLSEGYQFFW'});\n\t\t\tbreak;\n\t\tcase S.patron:\n\t\t\tawait browser.tabs.create({url: 'https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=67TZLSEGYQFFW'});\n\t\t\tbreak;\n\t\tcase S.changelog:\n\t\t\tawait browser.tabs.create({url: 'changelog.html'});\n\t\t\tbreak;\n\t\tcase S.options:\n\t\t\tawait browser.tabs.create({url: 'options.html'});\n\t\t\tbreak;\n\t\tcase S.report:\n\t\t\tawait browser.tabs.create({url: 'https://github.com/stefanXO/Tab-Manager-Plus/issues'});\n\t\t\tbreak;\n\t\tcase S.source:\n\t\t\tawait browser.tabs.create({url: 'https://github.com/stefanXO/Tab-Manager-Plus'});\n\t\t\tbreak;\n\t\tcase S.twitter:\n\t\t\tawait browser.tabs.create({url: 'https://www.twitter.com/mastef'});\n\t\t\tbreak;\n\t\tcase S.send:\n\t\t\tawait browser.tabs.create({url: 'https://github.com/stefanXO/Tab-Manager-Plus/issues'});\n\t\t\tawait browser.tabs.create({url: 'mailto:markus+tmp@stefanxo.com'});\n\t\t\tbreak;\n\t\tcase S.review:\n\t\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t\t\tawait browser.tabs.create({url: 'https://addons.mozilla.org/en-US/firefox/addon/tab-manager-plus-for-firefox/'});\n\t\t\t} else {\n\t\t\t\tawait browser.tabs.create({url: 'https://chrome.google.com/webstore/detail/tab-manager-plus-for-chro/cnkdjjdmfiffagllbiiilooaoofcoeff'});\n\t\t\t}\n\t\t\tbreak;\n\n\t}\n}", "\"use strict\";\n\nimport { setLocalStorage } from \"@helpers/storage\";\nimport * as _a from \"@background/actions\";\nimport * as _w from '@background/windows';\nimport * as _t from '@background/tabs';\nimport { cleanupDebounce, cleanUp } from '@background/tracking';\n\nimport * as _c from '@ui/context_menus';\nimport * as _o from '@ui/open';\nimport {debounce} from \"@helpers/utils\";\nimport * as browser from 'webextension-polyfill';\n\nbrowser.runtime.onStartup.addListener(\n\tasync function () {\n\t\tconsole.log(\" ON STARTUP\");\n\t}\n);\n\nbrowser.runtime.onSuspend.addListener(\n\tasync function () {\n\t\tconsole.log(\" ON SUSPEND\");\n\t}\n);\n\nbrowser.commands.onCommand.addListener(_a.handleCommands);\nbrowser.runtime.onMessage.addListener(_a.handleMessages);\n\n(async function () {\n\tlet windows = await browser.windows.getAll({ populate: true });\n\tawait setLocalStorage(\"windowAge\", []);\n\tif (!!windows && windows.length > 0) {\n\t\twindows.sort(function (a, b) {\n\t\t\tif (a.id < b.id) return 1;\n\t\t\tif (a.id > b.id) return -1;\n\t\t\treturn 0;\n\t\t});\n\t\tfor (let i = 0; i < windows.length; i++) {\n\t\t\tif (!!windows[i].id) await _w.windowActive(windows[i].id);\n\t\t}\n\t}\n})();\n\nexport const setupDebounced = debounce(setup, 2000);\n\nasync function setup() {\n\tawait _c.setupContextMenus();\n\tawait _o.setupPopup();\n\tawait _t.setupTabListeners();\n\tawait _w.setupWindowListeners();\n\n\t_t.updateTabCountDebounce();\n\n\tsetTimeout(cleanupDebounce, 2500);\n}\n\nsetInterval(setupDebounced, 300000);\nsetTimeout(cleanUp.bind(this, true), 2000000);\n\nsetup();"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA;AAEA,YAAI,EAAEA,WAAWC,UAAUD,WAAWC,OAAOC,WAAWF,WAAWC,OAAOC,QAAQC,KAAK;AACrF,gBAAM,IAAIC,MAAM,2DAA2D;QAC7E;AAEA,YAAI,EAAEJ,WAAWK,WAAWL,WAAWK,QAAQH,WAAWF,WAAWK,QAAQH,QAAQC,KAAK;AACxF,gBAAMG,mDAAmD;AAOzD,gBAAMC,WAAWC,mBAAiB;AAIhC,kBAAMC,cAAc;cAClB,UAAU;gBACR,SAAS;kBACP,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,OAAO;kBACL,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;cACF;cACA,aAAa;gBACX,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,OAAO;kBACL,WAAW;kBACX,WAAW;gBACb;gBACA,eAAe;kBACb,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;gBACA,QAAQ;kBACN,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;cACF;cACA,iBAAiB;gBACf,WAAW;kBACT,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,2BAA2B;kBACzB,WAAW;kBACX,WAAW;gBACb;gBACA,gBAAgB;kBACd,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,2BAA2B;kBACzB,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,gBAAgB;kBACd,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;cACF;cACA,gBAAgB;gBACd,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,eAAe;kBACb,WAAW;kBACX,WAAW;gBACb;gBACA,iBAAiB;kBACf,WAAW;kBACX,WAAW;gBACb;gBACA,mBAAmB;kBACjB,WAAW;kBACX,WAAW;gBACb;gBACA,kBAAkB;kBAChB,WAAW;kBACX,WAAW;gBACb;gBACA,iBAAiB;kBACf,WAAW;kBACX,WAAW;gBACb;gBACA,sBAAsB;kBACpB,WAAW;kBACX,WAAW;gBACb;gBACA,mBAAmB;kBACjB,WAAW;kBACX,WAAW;gBACb;gBACA,oBAAoB;kBAClB,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;cACF;cACA,YAAY;gBACV,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;cACF;cACA,gBAAgB;gBACd,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;cACF;cACA,WAAW;gBACT,OAAO;kBACL,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,sBAAsB;kBACpB,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,OAAO;kBACL,WAAW;kBACX,WAAW;gBACb;cACF;cACA,YAAY;gBACV,mBAAmB;kBACjB,QAAQ;oBACN,WAAW;oBACX,WAAW;oBACX,qBAAqB;kBACvB;gBACF;gBACA,UAAU;kBACR,UAAU;oBACR,WAAW;oBACX,WAAW;oBACX,qBAAqB;kBACvB;kBACA,YAAY;oBACV,qBAAqB;sBACnB,WAAW;sBACX,WAAW;oBACb;kBACF;gBACF;cACF;cACA,aAAa;gBACX,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,SAAS;kBACP,WAAW;kBACX,WAAW;gBACb;gBACA,eAAe;kBACb,WAAW;kBACX,WAAW;gBACb;gBACA,QAAQ;kBACN,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,SAAS;kBACP,WAAW;kBACX,WAAW;gBACb;gBACA,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,QAAQ;kBACN,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;cACF;cACA,aAAa;gBACX,6BAA6B;kBAC3B,WAAW;kBACX,WAAW;gBACb;gBACA,4BAA4B;kBAC1B,WAAW;kBACX,WAAW;gBACb;cACF;cACA,WAAW;gBACT,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,eAAe;kBACb,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;cACF;cACA,QAAQ;gBACN,kBAAkB;kBAChB,WAAW;kBACX,WAAW;gBACb;gBACA,sBAAsB;kBACpB,WAAW;kBACX,WAAW;gBACb;cACF;cACA,YAAY;gBACV,qBAAqB;kBACnB,WAAW;kBACX,WAAW;gBACb;cACF;cACA,QAAQ;gBACN,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;cACF;cACA,cAAc;gBACZ,OAAO;kBACL,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;gBACA,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;gBACA,iBAAiB;kBACf,WAAW;kBACX,WAAW;gBACb;cACF;cACA,iBAAiB;gBACf,SAAS;kBACP,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,sBAAsB;kBACpB,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;cACF;cACA,cAAc;gBACZ,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,QAAQ;kBACN,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,YAAY;kBACV,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;gBACA,QAAQ;kBACN,WAAW;kBACX,WAAW;kBACX,wBAAwB;gBAC1B;cACF;cACA,eAAe;gBACb,YAAY;kBACV,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;cACF;cACA,WAAW;gBACT,qBAAqB;kBACnB,WAAW;kBACX,WAAW;gBACb;gBACA,mBAAmB;kBACjB,WAAW;kBACX,WAAW;gBACb;gBACA,mBAAmB;kBACjB,WAAW;kBACX,WAAW;gBACb;gBACA,sBAAsB;kBACpB,WAAW;kBACX,WAAW;gBACb;gBACA,eAAe;kBACb,WAAW;kBACX,WAAW;gBACb;gBACA,qBAAqB;kBACnB,WAAW;kBACX,WAAW;gBACb;gBACA,mBAAmB;kBACjB,WAAW;kBACX,WAAW;gBACb;cACF;cACA,YAAY;gBACV,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;gBACA,qBAAqB;kBACnB,WAAW;kBACX,WAAW;gBACb;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;cACF;cACA,WAAW;gBACT,SAAS;kBACP,SAAS;oBACP,WAAW;oBACX,WAAW;kBACb;kBACA,OAAO;oBACL,WAAW;oBACX,WAAW;kBACb;kBACA,iBAAiB;oBACf,WAAW;oBACX,WAAW;kBACb;kBACA,UAAU;oBACR,WAAW;oBACX,WAAW;kBACb;kBACA,OAAO;oBACL,WAAW;oBACX,WAAW;kBACb;gBACF;gBACA,WAAW;kBACT,OAAO;oBACL,WAAW;oBACX,WAAW;kBACb;kBACA,iBAAiB;oBACf,WAAW;oBACX,WAAW;kBACb;gBACF;gBACA,QAAQ;kBACN,SAAS;oBACP,WAAW;oBACX,WAAW;kBACb;kBACA,OAAO;oBACL,WAAW;oBACX,WAAW;kBACb;kBACA,iBAAiB;oBACf,WAAW;oBACX,WAAW;kBACb;kBACA,UAAU;oBACR,WAAW;oBACX,WAAW;kBACb;kBACA,OAAO;oBACL,WAAW;oBACX,WAAW;kBACb;gBACF;cACF;cACA,QAAQ;gBACN,qBAAqB;kBACnB,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,kBAAkB;kBAChB,WAAW;kBACX,WAAW;gBACb;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,iBAAiB;kBACf,WAAW;kBACX,WAAW;gBACb;gBACA,OAAO;kBACL,WAAW;kBACX,WAAW;gBACb;gBACA,cAAc;kBACZ,WAAW;kBACX,WAAW;gBACb;gBACA,WAAW;kBACT,WAAW;kBACX,WAAW;gBACb;gBACA,mBAAmB;kBACjB,WAAW;kBACX,WAAW;gBACb;gBACA,UAAU;kBACR,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW;gBACb;gBACA,aAAa;kBACX,WAAW;kBACX,WAAW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",
  "names": ["globalThis", "chrome", "runtime", "id", "Error", "browser", "CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE", "wrapAPIs", "extensionAPIs", "apiMetadata", "Object", "keys", "length", "DefaultWeakMap", "WeakMap", "constructor", "createItem", "items", "undefined", "get", "key", "has", "set", "isThenable", "value", "then", "makeCallback", "promise", "metadata", "callbackArgs", "lastError", "reject", "message", "singleCallbackArg", "resolve", "pluralizeArguments", "numArgs", "wrapAsyncFunction", "name", "asyncFunctionWrapper", "target", "args", "minArgs", "maxArgs", "Promise", "fallbackToNoCallback", "cbError", "console", "warn", "noCallback", "wrapMethod", "method", "wrapper", "Proxy", "apply", "targetMethod", "thisObj", "call", "hasOwnProperty", "Function", "bind", "prototype", "wrapObject", "wrappers", "cache", "create", "handlers", "proxyTarget", "prop", "receiver", "defineProperty", "configurable", "enumerable", "desc", "Reflect", "deleteProperty", "wrapEvent", "wrapperMap", "addListener", "listener", "hasListener", "removeListener", "onRequestFinishedWrappers", "onRequestFinished", "req", "wrappedReq", "getContent", "onMessageWrappers", "onMessage", "sender", "sendResponse", "didCallSendResponse", "wrappedSendResponse", "sendResponsePromise", "response", "result", "err", "isResultThenable", "sendPromisedResult", "msg", "error", "__mozWebExtensionPolyfillReject__", "catch", "wrappedSendMessageCallback", "reply", "wrappedSendMessage", "apiNamespaceObj", "wrappedCb", "push", "sendMessage", "staticWrappers", "devtools", "network", "onMessageExternal", "tabs", "settingMetadata", "clear", "privacy", "services", "websites", "module", "exports", "key", "later", "browser", "windows", "browser", "tabs", "firstTab", "windows", "browser", "tabs", "browser", "tabs", "browser", "browser", "browser", "windows"]
}

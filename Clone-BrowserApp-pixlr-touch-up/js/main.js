/*
 RequireJS 2.1.8 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/*! jQuery v2.0.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-2.0.2.min.map
*/

/**
 * @license RequireJS text 2.0.7 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*----------------------------------------------------------------------------\
|                                Range Class                                  |
|-----------------------------------------------------------------------------|
|                         Created by Erik Arvidsson                           |
|                  (http://webfx.eae.net/contact.html#erik)                   |
|                      For WebFX (http://webfx.eae.net/)                      |
|-----------------------------------------------------------------------------|
| Used to  model the data  used  when working  with  sliders,  scrollbars and |
| progress bars.  Based  on  the  ideas of  the javax.swing.BoundedRangeModel |
| interface  defined  by  Sun  for  Java;   http://java.sun.com/products/jfc/ |
| swingdoc-api-1.0.3/com/sun/java/swing/BoundedRangeModel.html                |
|-----------------------------------------------------------------------------|
|                Copyright (c) 2002, 2005, 2006 Erik Arvidsson                |
|-----------------------------------------------------------------------------|
| Licensed under the Apache License, Version 2.0 (the "License"); you may not |
| use this file except in compliance with the License.  You may obtain a copy |
| of the License at http://www.apache.org/licenses/LICENSE-2.0                |
| - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - |
| Unless  required  by  applicable law or  agreed  to  in  writing,  software |
| distributed under the License is distributed on an  "AS IS" BASIS,  WITHOUT |
| WARRANTIES OR  CONDITIONS OF ANY KIND,  either express or implied.  See the |
| License  for the  specific language  governing permissions  and limitations |
| under the License.                                                          |
|-----------------------------------------------------------------------------|
| 2002-10-14 | Original version released                                      |
| 2005-10-27 | Use Math.round instead of Math.floor                           |
| 2006-05-28 | Changed license to Apache Software License 2.0.                |
|-----------------------------------------------------------------------------|
| Created 2002-10-14 | All changes are in the log above. | Updated 2006-05-28 |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|                                 Timer Class                                 |
|-----------------------------------------------------------------------------|
|                         Created by Erik Arvidsson                           |
|                  (http://webfx.eae.net/contact.html#erik)                   |
|                      For WebFX (http://webfx.eae.net/)                      |
|-----------------------------------------------------------------------------|
| Object Oriented Encapsulation  of setTimeout  fires ontimer when the  timer |
| is triggered. Does not work in IE 5.00                                      |
|-----------------------------------------------------------------------------|
|                   Copyright (c) 2002, 2006 Erik Arvidsson                   |
|-----------------------------------------------------------------------------|
| Licensed under the Apache License, Version 2.0 (the "License"); you may not |
| use this file except in compliance with the License.  You may obtain a copy |
| of the License at http://www.apache.org/licenses/LICENSE-2.0                |
| - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - |
| Unless  required  by  applicable law or  agreed  to  in  writing,  software |
| distributed under the License is distributed on an  "AS IS" BASIS,  WITHOUT |
| WARRANTIES OR  CONDITIONS OF ANY KIND,  either express or implied.  See the |
| License  for the  specific language  governing permissions  and limitations |
| under the License.                                                          |
|-----------------------------------------------------------------------------|
| 2002-10-14 | Original version released                                      |
| 2006-05-28 | Changed license to Apache Software License 2.0.                |
|-----------------------------------------------------------------------------|
| Created 2002-10-14 | All changes are in the log above. | Updated 2006-05-28 |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|                                Slider 1.02                                  |
|-----------------------------------------------------------------------------|
|                         Created by Erik Arvidsson                           |
|                  (http://webfx.eae.net/contact.html#erik)                   |
|                      For WebFX (http://webfx.eae.net/)                      |
|-----------------------------------------------------------------------------|
| A  slider  control that  degrades  to an  input control  for non  supported |
| browsers.                                                                   |
|-----------------------------------------------------------------------------|
|                Copyright (c) 2002, 2003, 2006 Erik Arvidsson                |
|-----------------------------------------------------------------------------|
| Licensed under the Apache License, Version 2.0 (the "License"); you may not |
| use this file except in compliance with the License.  You may obtain a copy |
| of the License at http://www.apache.org/licenses/LICENSE-2.0                |
| - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - |
| Unless  required  by  applicable law or  agreed  to  in  writing,  software |
| distributed under the License is distributed on an  "AS IS" BASIS,  WITHOUT |
| WARRANTIES OR  CONDITIONS OF ANY KIND,  either express or implied.  See the |
| License  for the  specific language  governing permissions  and limitations |
| under the License.                                                          |
|-----------------------------------------------------------------------------|
| Dependencies: timer.js - an OO abstraction of timers                        |
|               range.js - provides the data model for the slider             |
|               winclassic.css or any other css file describing the look      |
|-----------------------------------------------------------------------------|
| 2002-10-14 | Original version released                                      |
| 2003-03-27 | Added a test in the constructor for missing oElement arg       |
| 2003-11-27 | Only use mousewheel when focused                               |
| 2006-05-28 | Changed license to Apache Software License 2.0.                |
|-----------------------------------------------------------------------------|
| Created 2002-10-14 | All changes are in the log above. | Updated 2006-05-28 |
\----------------------------------------------------------------------------*/

/**
 *
 * Color picker
 * Author: Stefan Petre www.eyecon.ro
 * 
 * Dual licensed under the MIT and GPL licenses
 * 
 */

/*
 * Copyright 2014 Small Batch, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */

/*
 * JavaScript Canvas to Blob 2.0.5
 * https://github.com/blueimp/JavaScript-Canvas-to-Blob
 *
 * Copyright 2012, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 *
 * Based on stackoverflow user Stoive's code snippet:
 * http://stackoverflow.com/q/4998908
 */

/*
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/*
Copyright 2012 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Author: Eric Bidelman (ericbidelman@chromium.org)
*/

/** @license psd.js 2012 - imaya [ https://github.com/imaya/psd.js ] The MIT License */

/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/

function base64ArrayBuffer(e){var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),i=r.byteLength,s=i%3,o=i-s,u,a,f,l,c;for(var h=0;h<o;h+=3)c=r[h]<<16|r[h+1]<<8|r[h+2],u=(c&16515072)>>18,a=(c&258048)>>12,f=(c&4032)>>6,l=c&63,t+=n[u]+n[a]+n[f]+n[l];return s==1?(c=r[o],u=(c&252)>>2,a=(c&3)<<4,t+=n[u]+n[a]+"=="):s==2&&(c=r[o]<<8|r[o+1],u=(c&64512)>>10,a=(c&1008)>>4,f=(c&15)<<2,t+=n[u]+n[a]+n[f]+"="),t}var requirejs,require,define;(function(Z){function H(e){return"[object Function]"===L.call(e)}function I(e){return"[object Array]"===L.call(e)}function y(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function M(e,t){if(e){var n;for(n=e.length-1;-1<n&&(!e[n]||!t(e[n],n,e));n-=1);}}function s(e,t){return ga.call(e,t)}function l(e,t){return s(e,t)&&e[t]}function F(e,t){for(var n in e)if(s(e,n)&&t(e[n],n))break}function Q(e,t,n,r){return t&&F(t,function(t,i){if(n||!s(e,i))r&&"string"!=typeof t?(e[i]||(e[i]={}),Q(e[i],t,n,r)):e[i]=t}),e}function u(e,t){return function(){return t.apply(e,arguments)}}function aa(e){throw e}function ba(e){if(!e)return e;var t=Z;return y(e.split("."),function(e){t=t[e]}),t}function A(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ha(e){function t(e,t,n){var r,i,s,o,u,a,f,c=t&&t.split("/");r=c;var h=N.map,p=h&&h["*"];if(e&&"."===e.charAt(0))if(t){r=l(N.pkgs,t)?c=[t]:c.slice(0,c.length-1),t=e=r.concat(e.split("/"));for(r=0;t[r];r+=1)if(i=t[r],"."===i)t.splice(r,1),r-=1;else if(".."===i){if(1===r&&(".."===t[2]||".."===t[0]))break;0<r&&(t.splice(r-1,2),r-=2)}r=l(N.pkgs,t=e[0]),e=e.join("/"),r&&e===t+"/"+r.main&&(e=t)}else 0===e.indexOf("./")&&(e=e.substring(2));if(n&&h&&(c||p)){t=e.split("/");for(r=t.length;0<r;r-=1){s=t.slice(0,r).join("/");if(c)for(i=c.length;0<i;i-=1)if(n=l(h,c.slice(0,i).join("/")))if(n=l(n,s)){o=n,u=r;break}if(o)break;!a&&p&&l(p,s)&&(a=l(p,s),f=r)}!o&&a&&(o=a,u=f),o&&(t.splice(0,u,o),e=t.join("/"))}return e}function n(e){z&&y(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===S.contextName)return t.parentNode.removeChild(t),!0})}function r(e){var t=l(N.paths,e);if(t&&I(t)&&1<t.length)return n(e),t.shift(),S.require.undef(e),S.require([e]),!0}function i(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function o(e,n,r,s){var o,u,a=null,f=n?n.name:null,c=e,h=!0,p="";return e||(h=!1,e="_@r"+(B+=1)),e=i(e),a=e[0],e=e[1],a&&(a=t(a,f,s),u=l(_,a)),e&&(a?p=u&&u.normalize?u.normalize(e,function(e){return t(e,f,s)}):t(e,f,s):(p=t(e,f,s),e=i(p),a=e[0],p=e[1],r=!0,o=S.nameToUrl(p))),r=a&&!u&&!r?"_unnormalized"+(q+=1):"",{prefix:a,name:p,parentMap:n,unnormalized:!!r,url:o,originalName:c,isDefine:h,id:(a?a+"!"+p:p)+r}}function a(e){var t=e.id,n=l(C,t);return n||(n=C[t]=new S.Module(e)),n}function f(e,t,n){var r=e.id,i=l(C,r);s(_,r)&&(!i||i.defineEmitComplete)?"defined"===t&&n(_[r]):(i=a(e),i.error&&"error"===t)?n(i.error):i.on(t,n)}function c(e,t){var n=e.requireModules,r=!1;t?t(e):(y(n,function(t){if(t=l(C,t))t.error=e,t.events.error&&(r=!0,t.emit("error",e))}),!r)&&j.onError(e)}function h(){R.length&&(ia.apply(M,[M.length-1,0].concat(R)),R=[])}function p(e){delete C[e],delete k[e]}function d(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,y(e.depMaps,function(r,i){var s=r.id,o=l(C,s);o&&!e.depMatched[i]&&!n[s]&&(l(t,s)?(e.defineDep(i,_[s]),e.check()):d(o,t,n))}),n[r]=!0)}function v(){var e,t,i,s,o=(i=1e3*N.waitSeconds)&&S.startTime+i<(new Date).getTime(),u=[],a=[],f=!1,l=!0;if(!w){w=!0,F(k,function(i){e=i.map,t=e.id;if(i.enabled&&(e.isDefine||a.push(i),!i.error))if(!i.inited&&o)r(t)?f=s=!0:(u.push(t),n(t));else if(!i.inited&&i.fetched&&e.isDefine&&(f=!0,!e.prefix))return l=!1});if(o&&u.length)return i=A("timeout","Load timeout for modules: "+u,null,u),i.contextName=S.contextName,c(i);l&&y(a,function(e){d(e,{},{})}),(!o||s)&&f&&(z||da)&&!T&&(T=setTimeout(function(){T=0,v()},50)),w=!1}}function m(e){s(_,e[0])||a(o(e[0],null,!0)).init(e[1],e[2])}function g(e){var e=e.currentTarget||e.srcElement,t=S.onScriptLoad;return e.detachEvent&&!W?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=S.onScriptError,(!e.detachEvent||W)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function b(){var e;for(h();M.length;){e=M.shift();if(null===e[0])return c(A("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));m(e)}}var w,E,S,x,T,N={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},C={},k={},L={},M=[],_={},D={},B=1,q=1;return x={require:function(e){return e.require?e.require:e.require=S.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?e.exports:e.exports=_[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t=l(N.pkgs,e.map.id);return(t?l(N.config,e.map.id+"/"+t.main):l(N.config,e.map.id))||{}},exports:_[e.map.id]}}},E=function(e){this.events=l(L,e.id)||{},this.map=e,this.shim=l(N.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},E.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=u(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,S.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();S.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;D[e]||(D[e]=!0,S.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id;t=this.depExports;var r=this.exports,i=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(H(i)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{r=S.execCb(n,i,t,r)}catch(s){e=s}else r=S.execCb(n,i,t,r);this.map.isDefine&&((t=this.module)&&void 0!==t.exports&&t.exports!==this.exports?r=t.exports:void 0===r&&this.usingExports&&(r=this.exports));if(e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else r=i;this.exports=r,this.map.isDefine&&!this.ignore&&(_[n]=r,j.onResourceLoad)&&j.onResourceLoad(S,this.map,this.depMaps),p(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,n=e.id,r=o(e.prefix);this.depMaps.push(r),f(r,"defined",u(this,function(r){var i,h;h=this.map.name;var d=this.map.parentMap?this.map.parentMap.name:null,v=S.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(r.normalize&&(h=r.normalize(h,function(e){return t(e,d,!0)})||""),r=o(e.prefix+"!"+h,this.map.parentMap),f(r,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=l(C,r.id))this.depMaps.push(r),this.events.error&&h.on("error",u(this,function(e){this.emit("error",e)})),h.enable()}else i=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=u(this,function(e){this.inited=!0,this.error=e,e.requireModules=[n],F(C,function(e){0===e.map.id.indexOf(n+"_unnormalized")&&p(e.map.id)}),c(e)}),i.fromText=u(this,function(t,r){var u=e.name,f=o(u),l=O;r&&(t=r),l&&(O=!1),a(f),s(N.config,n)&&(N.config[u]=N.config[n]);try{j.exec(t)}catch(h){return c(A("fromtexteval","fromText eval for "+n+" failed: "+h,h,[n]))}l&&(O=!0),this.depMaps.push(f),S.completeLoad(u),v([u],i)}),r.load(e.name,v,i,N)})),S.enable(r,this),this.pluginMaps[r.id]=r},enable:function(){k[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(e,t){var n,r;if("string"==typeof e){e=o(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e;if(n=l(x,e.id)){this.depExports[t]=n(this);return}this.depCount+=1,f(e,"defined",u(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&f(e,"error",u(this,this.errback))}n=e.id,r=C[n],!s(x,n)&&r&&!r.enabled&&S.enable(e,this)})),F(this.pluginMaps,u(this,function(e){var t=l(C,e.id);t&&!t.enabled&&S.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){y(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},S={config:N,contextName:e,registry:C,defined:_,urlFetched:D,defQueue:M,Module:E,makeModuleMap:o,nextTick:j.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=N.pkgs,n=N.shim,r={paths:!0,config:!0,map:!0};F(e,function(e,t){r[t]?"map"===t?(N.map||(N.map={}),Q(N[t],e,!0,!0)):Q(N[t],e,!0):N[t]=e}),e.shim&&(F(e.shim,function(e,t){I(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=S.makeShimExports(e)),n[t]=e}),N.shim=n),e.packages&&(y(e.packages,function(e){e="string"==typeof e?{name:e}:e,t[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ja,"").replace(ea,"")}}),N.pkgs=t),F(C,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=o(t))}),(e.deps||e.callback)&&S.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(Z,arguments)),t||e.exports&&ba(e.exports)}},makeRequire:function(n,r){function i(t,u,f){var l,h;return r.enableBuildCallback&&u&&H(u)&&(u.__requireJsBuild=!0),"string"==typeof t?H(u)?c(A("requireargs","Invalid require call"),f):n&&s(x,t)?x[t](C[n.id]):j.get?j.get(S,t,n,i):(l=o(t,n,!1,!0),l=l.id,s(_,l)?_[l]:c(A("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(n?"":". Use require([])")))):(b(),S.nextTick(function(){b(),h=a(o(null,n)),h.skipMap=r.skipMap,h.init(t,u,f,{enabled:!0}),v()}),i)}return r=r||{},Q(i,{isBrowser:z,toUrl:function(e){var r,i=e.lastIndexOf("."),s=e.split("/")[0];return-1!==i&&("."!==s&&".."!==s||1<i)&&(r=e.substring(i,e.length),e=e.substring(0,i)),S.nameToUrl(t(e,n&&n.id,!0),r,!0)},defined:function(e){return s(_,o(e,n,!1,!0).id)},specified:function(e){return e=o(e,n,!1,!0).id,s(_,e)||s(C,e)}}),n||(i.undef=function(e){h();var t=o(e,n,!0),r=l(C,e);delete _[e],delete D[t.url],delete L[e],r&&(r.events.defined&&(L[e]=r.events),p(e))}),i},enable:function(e){l(C,e.id)&&a(e).enable()},completeLoad:function(e){var t,n,i=l(N.shim,e)||{},o=i.exports;for(h();M.length;){n=M.shift();if(null===n[0]){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);m(n)}n=l(C,e);if(!t&&!s(_,e)&&n&&!n.inited){if(N.enforceDefine&&(!o||!ba(o)))return r(e)?void 0:c(A("nodefine","No define call for "+e,null,[e]));m([e,i.deps||[],i.exportsFn])}v()},nameToUrl:function(e,t,n){var r,i,s,o,u,a;if(j.jsExtRegExp.test(e))o=e+(t||"");else{r=N.paths,i=N.pkgs,o=e.split("/");for(u=o.length;0<u;u-=1){if(a=o.slice(0,u).join("/"),s=l(i,a),a=l(r,a)){I(a)&&(a=a[0]),o.splice(0,u,a);break}if(s){e=e===s.name?s.location+"/"+s.main:s.location,o.splice(0,u,e);break}}o=o.join("/"),o+=t||(/\?/.test(o)||n?"":".js"),o=("/"===o.charAt(0)||o.match(/^[\w\+\.\-]+:/)?"":N.baseUrl)+o}return N.urlArgs?o+((-1===o.indexOf("?")?"?":"&")+N.urlArgs):o},load:function(e,t){j.load(S,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||ka.test((e.currentTarget||e.srcElement).readyState))P=null,e=g(e),S.completeLoad(e.id)},onScriptError:function(e){var t=g(e);if(!r(t.id))return c(A("scripterror","Script error for: "+t.id,e,[t.id]))}},S.require=S.makeRequire(),S}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z="undefined"!=typeof window&&!!navigator&&!!window.document,da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},t={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;t=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(t=require,require=void 0),j=requirejs=function(e,t,n,r){var i,s="_";return!I(e)&&"string"!=typeof e&&(i=e,I(t)?(e=t,t=n,n=r):e=[]),i&&i.context&&(s=i.context),(r=l(E,s))||(r=E[s]=j.s.newContext(s)),i&&r.configure(i),r.require(e,t,n)},j.config=function(e){return j(e)},j.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=j),j.version="2.1.8",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(e){j[e]=function(){var t=E._;return t.require[e].apply(t,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},j.load=function(e,t,n){var r=e&&e.config||{};if(z)return r=j.createNode(r,t,n),r.setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),r.attachEvent&&!(r.attachEvent.toString&&0>r.attachEvent.toString().indexOf("[native code"))&&!W?(O=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)):(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)),r.src=n,K=r,C?x.insertBefore(r,C):x.appendChild(r),K=null,r;if(da)try{importScripts(n),e.completeLoad(t)}catch(i){e.onError(A("importscripts","importScripts failed for "+t+" at "+n,i,[t]))}},z&&M(document.getElementsByTagName("script"),function(e){x||(x=e.parentNode);if(J=e.getAttribute("data-main"))return q=J,t.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",t.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),t.deps=t.deps?t.deps.concat(q):[q],!0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),I(t)||(n=t,t=null),!t&&H(n)&&(t=[],n.length&&(n.toString().replace(la,"").replace(ma,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),O&&((r=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return P=e}),r=P),r&&(e||(e=r.getAttribute("data-requiremodule")),i=E[r.getAttribute("data-requirecontext")])),(i?i.defQueue:R).push([e,t,n])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(t)}})(this),define("requireLib",function(){}),function(e,undefined){function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:q.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)H.set(e[r],"globalEval",!t||H.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(H.hasData(e)&&(s=H.access(e),o=H.set(t,s),f=s.events)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)x.event.add(t,i,f[i][n])}L.hasData(e)&&(u=L.access(e),a=x.extend({},u),L.set(t,a))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function Ht(t){return e.getComputedStyle(t,null)}function qt(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=H.get(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(s[o]=H.access(r,"olddisplay",Rt(r.nodeName)))):s[o]||(i=Lt(r),(n&&"none"!==n||!i)&&H.set(r,"olddisplay",i?n:x.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=x.css(e,n+jt[s],!0,i)),r?("content"===n&&(o-=x.css(e,"padding"+jt[s],!0,i)),"margin"!==n&&(o-=x.css(e,"border"+jt[s]+"Width",!0,i))):(o+=x.css(e,"padding"+jt[s],!0,i),"padding"!==n&&(o+=x.css(e,"border"+jt[s]+"Width",!0,i)));return o}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=Ht(e),o=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=vt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=o&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(o?"border":"content"),r,s)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){function o(u){var a;return i[u]=!0,x.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):undefined:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===on;return o(t.dataTypes[0])||!i["*"]&&o("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}function pn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):undefined}function fn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function jn(e,t,n){var r,i,s=0,o=kn.length,u=x.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(Dn(l,f.opts.specialEasing);o>s;s++)if(r=kn[s].call(f,e,l,f.opts))return r;return x.map(l,Sn,f),x.isFunction(f.opts.start)&&f.opts.start.call(e,f),x.fx.timer(x.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Dn(e,t){var n,r,i,s,o;for(n in e)if(r=x.camelCase(n),i=t[r],s=e[n],x.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=x.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function An(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&Lt(e),p=H.get(e,"fxshow");n.queue||(u=x._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,x.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(c.display="inline-block")),n.overflow&&(c.overflow="hidden",f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!p||p[r]===undefined)continue;h=!0}l[r]=p&&p[r]||x.style(e,r)}if(!x.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=H.access(e,"fxshow",{}),s&&(p.hidden=!h),h?x(e).show():f.done(function(){x(e).hide()}),f.done(function(){var t;H.remove(e,"fxshow");for(t in l)x.style(e,t,l[t])});for(r in l)o=Sn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}function Hn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function qn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.2",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||x.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,s=n&&x.isArray(n)?n:[]):s=n&&x.isPlainObject(n)?n:{},o[t]=x.extend(f,s,r)):r!==undefined&&(o[t]=r));return o},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=j(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=j(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return f.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===x.type(n)){i=!0;for(u in n)x.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(x(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),t=x(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,E;if((t?t.ownerDocument||t:w)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,E=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=bt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+wt(l[f]);g=$.test(e)&&t.parentNode||t,E=l.join(",")}if(E)try{return H.apply(n,g.querySelectorAll(E)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Lt(e.replace(W,"$1"),t,n,i)}function ut(e){return Y.test(e+"")}function at(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function ft(e){return e[b]=!0,e}function lt(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ct(e,t,n){e=e.split("|");var r,i=e.length,o=n?null:t;while(i--)(r=s.attrHandle[e[i]])&&r!==t||(s.attrHandle[e[i]]=o)}function ht(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:e[t]===!0?t.toLowerCase():null}function pt(e,t){return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}function dt(e){return"input"===e.nodeName.toLowerCase()?e.defaultValue:t}function vt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function mt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function gt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function yt(e){return ft(function(t){return t=+t,ft(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function bt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function wt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function Et(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=S++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function St(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Tt(e,t,n,r,i,s){return r&&!r[b]&&(r=Tt(r)),i&&!i[b]&&(i=Tt(i,s)),ft(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||kt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:xt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=xt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=xt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function Nt(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=Et(function(e){return e===t},u,!0),c=Et(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[Et(St(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Tt(a>1&&St(h),a>1&&wt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&Nt(e.slice(a,r)),i>r&&Nt(e=e.slice(r)),i>r&&wt(e))}h.push(n)}return St(h)}function Ct(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=E+=null==x?1:Math.random()||.1;for(S&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}S&&(E=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=xt(g)}H.apply(c,g),S&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return S&&(E=N,f=x),w};return r?ft(u):u}function kt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Lt(e,t,n,i){var o,u,f,l,c,h=bt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&wt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}function At(){}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),w=e.document,E=0,S=0,T=at(),N=at(),C=at(),k=!1,L=function(){return 0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(w.childNodes),w.childNodes),_[w.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.parentWindow;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.frameElement&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=lt(function(e){return e.innerHTML="<a href='#'></a>",ct("type|href|height|width",pt,"#"===e.firstChild.getAttribute("href")),ct(F,ht,null==e.getAttribute("disabled")),e.className="i",!e.getAttribute("className")}),r.input=lt(function(e){return e.innerHTML="<input>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}),ct("value",dt,r.attributes&&r.input),r.getElementsByTagName=lt(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=lt(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=lt(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=ut(n.querySelectorAll))&&(lt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),lt(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=ut(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&lt(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=ut(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},r.sortDetached=lt(function(e){return 1&e.compareDocumentPosition(n.createElement("div"))}),L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(w,e)?-1:t===n||y(w,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return vt(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?vt(u[i],a[i]):u[i]===w?-1:a[i]===w?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:ft,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=bt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[E,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[E,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?ft(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ft(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?ft(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ft(function(e){return function(t){return ot(e,t).length>0}}),contains:ft(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ft(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:yt(function(){return[0]}),last:yt(function(e,t){return[t-1]}),eq:yt(function(e,t,n){return[0>n?n+t:n]}),even:yt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:yt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:yt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:yt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=mt(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=gt(n);a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=bt(e)),n=t.length;while(n--)s=Nt(t[n]),s[b]?r.push(s):i.push(s);s=C(e,Ct(i,r))}return s},s.pseudos.nth=s.pseudos.eq,At.prototype=s.filters=s.pseudos,s.setFilters=new At,r.sortStable=b.split("").sort(L).join("")===b,c(),[0,0].sort(L),r.detectDuplicates=k,x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(h){for(t=e.memory&&h,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(h[0],h[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,u,n))>-1)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?x.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||n&&!a||(r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,s){var o=s[0],u=x.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,s=1===i?e:x.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),u=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=u.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(u,null!=u.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),u.removeChild(n))}),t):t}({});var L,H,q=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(x.isEmptyObject(s))x.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){return t===undefined||t&&"string"==typeof t&&n===undefined?this.get(e,t):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(w)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,H=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||H.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return H.access(e,t,n)},_removeData:function(e,t){H.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length&&(o=L.get(i),1===i.nodeType&&!H.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>s;s++)r=n[s].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,o[r]));H.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}}),x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=H.get(e,t),n&&(!r||x.isArray(n)?r=H.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),s=x._queueHooks(e,t),o=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return H.get(e,n)||H.access(e,n,{empty:x.Callbacks("once memory").add(function(){H.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(o--)n=H.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,i="boolean"==typeof t;return x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var s,o=0,u=x(this),a=t,f=e.match(w)||[];while(s=f[o++])a=i?a:!u.hasClass(s),u[a?"addClass":"removeClass"](s)}else(n===r||"boolean"===n)&&(this.className&&H.set(this,"__className__",this.className),this.className=this.className||e===!1?"":H.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=x.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=x.inArray(x(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===r?x.prop(e,t,n):(1===o&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=x.find.attr(e,t),null==s?undefined:s):null!==n?i&&"set"in i&&(s=i.set(e,n,t))!==undefined?s:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(w);if(s&&1===e.nodeType)while(n=s[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!x.isXMLDoc(e),s&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],s=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,s}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=H.get(e);if(g){n.handler&&(o=n,n=o.handler,s=o.selector),n.guid||(n.guid=x.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(w)||[""],l=t.length;while(l--)a=X.exec(t[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),d&&(h=x.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=x.event.special[d]||{},c=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||e.addEventListener&&e.addEventListener(d,u,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=H.hasData(e)&&H.get(e);if(m&&(a=m.events)){t=(t||"").match(w)||[""],f=t.length;while(f--)if(u=X.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=x.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)x.event.remove(e,p+t[f],n,r,!0);x.isEmptyObject(a)&&(delete m.handle,H.remove(e,"events"))}},trigger:function(t,n,r,i){var s,u,a,f,l,c,h,p=[r||o],d=y.call(t,"type")?t.type:t,v=y.call(t,"namespace")?t.namespace.split("."):[];if(u=a=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[d]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!x.isWindow(r)){for(f=h.delegateType||d,_.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(r.ownerDocument||o)&&p.push(a.defaultView||a.parentWindow||e)}s=0;while((u=p[s++])&&!t.isPropagationStopped())t.type=s>1?f:h.bindType||d,c=(H.get(u,"events")||{})[t.type]&&H.get(u,"handle"),c&&c.apply(u,n),c=l&&u[l],c&&x.acceptData(u)&&c.apply&&c.apply(u,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!x.acceptData(r)||l&&x.isFunction(r[d])&&!x.isWindow(r)&&(a=r[l],a&&(r[l]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,a&&(r[l]=a)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,s,o=[],u=d.call(arguments),a=(H.get(this,"events")||{})[e.type]||[],f=x.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){o=x.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((x.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?x(i,this).index(a)>=0:x.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return t.length>u&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),u.filter?u.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(s=r,r=function(e){return x().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?x.unique(s):s)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,s,o,u,a,l=0,c=this.length,h=this,p=c-1,d=e[0],v=x.isFunction(d);if(v||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=h.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(s=x.map(mt(r,"script"),ft),o=s.length;c>l;l++)u=r,l!==p&&(u=x.clone(u,!0,!0),o&&x.merge(s,mt(u,"script"))),t.call(this[l],u,l);if(o)for(a=s[s.length-1].ownerDocument,x.map(s,ht),l=0;o>l;l++)u=s[l],at.test(u.type||"")&&!H.access(u,"globalEval")&&x.contains(a,u)&&(u.src?x._evalUrl(u.src):x.globalEval(u.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),s=i.length-1,o=0;for(;s>=o;o++)n=o===s?this:this.clone(!0),x(i[o])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=mt(u),s=mt(e),r=0,i=s.length;i>r;r++)yt(s[r],o[r]);if(t)if(n)for(s=s||mt(e),o=o||mt(u),r=0,i=s.length;i>r;r++)gt(s[r],o[r]);else gt(e,u);return o=mt(u,"script"),o.length>0&&dt(o,!a&&mt(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;c>l;l++)if(i=e[l],i||0===i)if("object"===x.type(i))x.merge(p,i.nodeType?[i]:i);else if(rt.test(i)){s=s||h.appendChild(t.createElement("div")),o=(nt.exec(i)||["",""])[1].toLowerCase(),u=ct[o]||ct._default,s.innerHTML=u[1]+i.replace(tt,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.firstChild;x.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(t.createTextNode(i));h.textContent="",l=0;while(i=p[l++])if((!r||-1===x.inArray(i,r))&&(a=x.contains(i.ownerDocument,i),s=mt(h.appendChild(i),"script"),a&&dt(s),n)){f=0;while(i=s[f++])at.test(i.type||"")&&n.push(i)}return h},cleanData:function(e){var t,n,r,i,s,o,u=x.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(F.accepts(n)&&(s=n[H.expando],s&&(t=H.cache[s]))){if(r=Object.keys(t.events||{}),r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);H.cache[s]&&delete H.cache[s]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,s={},o=0;if(x.isArray(t)){for(r=Ht(e),i=t.length;i>o;o++)s[t[o]]=x.css(e,t[o],!1,r);return s}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return qt(this,!0)},hide:function(){return qt(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:Lt(this))?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=x.camelCase(t),a=e.style;return t=x.cssProps[u]||(x.cssProps[u]=At(a,u)),o=x.cssHooks[t]||x.cssHooks[u],n===undefined?o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t]:(s=typeof n,"string"===s&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||x.cssNumber[u]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),o&&"set"in o&&(n=o.set(e,n,r))===undefined||(a[t]=n)),undefined)}},css:function(e,t,n,r){var i,s,o,u=x.camelCase(t);return t=x.cssProps[u]||(x.cssProps[u]=At(e.style,u)),o=x.cssHooks[t]||x.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(s=parseFloat(i),n===!0||x.isNumeric(s)?s||0:i):i}}),vt=function(e,t,n){var r,i,s,o=n||Ht(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(""!==u||x.contains(e.ownerDocument,e)||(u=x.style(e,t)),Ct.test(u)&&wt.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&Ht(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=s[r]||s[r-2]||s[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[],x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),o.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){function T(e,t,s,u){var f,m,g,b,w,S=t;2!==y&&(y=2,o&&clearTimeout(o),n=undefined,i=u||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,s&&(b=pn(l,E,s)),b=fn(l,b,E,f),f?(l.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=E.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===l.type?S="nocontent":304===e?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g)):(g=S,(e||!S)&&(S="error",0>e&&(e=0))),E.status=e,E.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,E]):p.rejectWith(c,[E,S,g]),E.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?m:g]),d.fireWith(c,[E,S]),a&&(h.trigger("ajaxComplete",[E,l]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=x.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?x(c):x.event,p=x.Deferred(),d=x.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s){s={};while(t=Qt.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),T(0,t),this}};if(p.promise(E).complete=d.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=x.trim(l.dataType||"*").toLowerCase().match(w)||[""],null==l.crossDomain&&(u=tn.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===Xt[1]&&u[2]===Xt[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=x.param(l.data,l.traditional)),ln(rn,l,t,E),2===y)return E;a=l.global,a&&0===x.active++&&x.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Zt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Vt.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),l.ifModified&&(x.lastModified[r]&&E.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&E.setRequestHeader("If-None-Match",x.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+sn+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)E.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==y){b="abort";for(f in{success:1,error:1,complete:1})E[f](l[f]);if(n=ln(on,l,t,E)){E.readyState=1,a&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{y=1,n.send(m,T)}catch(S){if(!(2>y))throw S;T(-1,S)}}else T(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||x.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),o&&x.isFunction(s)&&s(o[0]),o=s=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(mn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=vn[s=yn++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),s=i&&i[3]||(x.cssNumber[e]?"":"px"),o=(x.cssNumber[e]||"px"!==s&&+r)&&Tn.exec(x.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,x.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}}),x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(Hn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),s=x.speed(t,n,r),o=function(){var t=jn(this,x.extend({},e),s);(i||H.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=x.timers,o=H.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Cn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=H.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=x.timers,o=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:Hn("show"),slideUp:Hn("hide"),slideToggle:Hn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(s=i.getBoundingClientRect()),n=qn(o),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s},x.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=x.css(e,"position"),c=x(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=x.css(e,"top"),a=x.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),x.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,s){var o=qn(t);return s===undefined?o?o[n]:t[i]:(o?o.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):t[i]=s,undefined)},t,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,o):x.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)}(window),define("app/Canvas",["jquery"],function(e){function f(){return s}function l(e){s=e,TopMenu.setScaleEnabled(e)}function c(e,t){if(!s)return;t=typeof t!="undefined"?t:!0,WebGL.setScale(e),t&&TopMenu.setScale(e),WebGL.drawScene(!1),PaintCanvas.repaint();for(var n=0;n<a.eventListeners.onScaleChanged.length;n++){var r=a.eventListeners.onScaleChanged[n];r()}}function h(t,r){var i=window.devicePixelRatio||1;e(n).css("width",t),e(n).css("height",r),n.width=t*i,n.height=r*i}function p(){console.log("window resize: "+e(window).innerWidth()+"x"+e(window).innerHeight()),h(e(window).innerWidth(),e(window).innerHeight()),PaintCanvas.setSize(e(window).innerWidth(),e(window).innerHeight()),WebGL.setViewportSize(n.width,n.height),v()&&(WebGL.scaleToFit(!1,!1,!0),WebGL.drawScene(!1),PaintCanvas.repaint())}function d(){n=document.getElementById("webgl-canvas"),WebGL.init(),e(window).resize(function(){p()}),p()}function v(){return WebGL.isImageLoaded()}function m(){TopMenu.setPreview(WebGL.getPreviewWidth(),WebGL.getPreviewHeight(),WebGL.getPreviewPixelArray())}function g(e){u=e}function y(){var e=WebGL.getPixelArray();e&&(u=e,u.width=WebGL.getImageWidth(),u.height=WebGL.getImageHeight())}function b(){WebGL.loadImageToTexture(u,!1)}function w(){return u}function E(e){console.log("large image loaded: "+e.width+" x "+e.height);var t=1024,r=document.createElement("canvas");e.width>e.height?(r.width=MAX_IMAGE_DIMENSION,r.height=Math.ceil(MAX_IMAGE_DIMENSION*e.height/e.width)):(r.height=MAX_IMAGE_DIMENSION,r.width=Math.ceil(MAX_IMAGE_DIMENSION*e.width/e.height));var i=Math.ceil(e.width/t),s=Math.ceil(e.height/t),o=e.width/i,u=e.height/s,a=r.width/i,f=r.height/s;console.log("resizing "+o+"x"+u+" tiles to "+a+"x"+f);var l=n.getContext("2d"),c=r.getContext("2d"),h=0,p=0;while(Math.round(h+u)<=Math.round(e.height)){var d=0;while(Math.round(d+o)<=Math.round(e.width)){console.log("i, j = "+d+", "+h);var v=d/o,m=h/u;c.drawImage(e,d,h,o,u,v*a,m*f,a,f),console.log("tile "+v+","+m+" last pixel"),console.log(c.getImageData((v+1)*a-1,(m+1)*f-1,1,1).data),p++,d+=o}h+=u}return r}function S(e,t,n){var r=new Image;r.onload=function(){var e=r.width,i=r.height;if(r.width>MAX_IMAGE_DIMENSION||r.height>MAX_IMAGE_DIMENSION)console.log("image "+r.width+"x"+r.height+" greater than MAX_IMAGE_DIMENSION, resizing..."),r=E(r);WebGL.setImageWidth(r.width),WebGL.setImageHeight(r.height),WebGL.clearDisplayTexture();try{WebGL.loadImageToTexture(r,!0)}catch(s){console.log(s.message),App.alert("The image could not be loaded. Please restart the application and try again.",!0),AnalyticsTracker.sendEvent("quality_webgl_texture_not_loaded"),AnalyticsTracker.sendEvent("info_webgl_texture_not_loaded",e+"x"+i+"_"+r.width+"x"+r.height),n();return}t(),AnalyticsTracker.sendAppView("ImageView"),WebGL.reset(),WebGL.drawScene(),o=!1,y(!1)},r.src=e}var t="",n,r=.3,i=8,s=!0,o=!1,u=null;this.eventListeners={onScaleChanged:[]};var a=this;return{DEFAULT_MAX_SCALE:i,DEFAULT_MIN_SCALE:r,saveCurrentImage:y,loadCurrentImage:b,getCurrentImage:w,setCurrentImage:g,isImageLoaded:v,setRotation:function(e){WebGL.setRotation(e)},getImageWidth:function(){return WebGL.getImageWidth()},setImageWidth:function(e){WebGL.setImageWidth(e)},getImageHeight:function(){return WebGL.getImageHeight()},setImageHeight:function(e){WebGL.setImageHeight(e)},setScale:c,setScaleEnabled:l,isScaleEnabled:f,getOffset:function(){return WebGL.getOffset()},setOffset:function(e,t){return WebGL.setOffset(e,t)},getScale:function(){return WebGL.getScale()},getWidth:function(){return e(n).width()},getHeight:function(){return e(n).height()},setSize:h,init:d,loadImage:S,setVisible:function(t){e(n).css("display",t?"block":"none")},setFilename:function(e){t=e},getFilename:function(){return t},updatePreview:m,hasUnsavedChanges:function(){return o},setHasUnsavedChanges:function(e){o=e},addEventListener:function(e,t){a.eventListeners[e].push(t)},removeEventListener:function(e,t){var n=a.eventListeners[e].indexOf(t);n>=0&&a.eventListeners[e].splice(n,1)}}}),define("app/WebGL",["jquery"],function(e){function O(r){r=typeof r!="undefined"?r:!0,f=document.getElementById("webgl-canvas"),r&&M();try{gl=f.getContext("experimental-webgl"),gl.viewportWidth=f.width,gl.viewportHeight=f.height,console.log("setting gl viewport "+gl.viewportWidth+"x"+gl.viewportHeight),t=gl.getParameter(gl.MAX_TEXTURE_SIZE),n=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE),AnalyticsTracker.sendEvent("info_webgl_max_texture_size",t),AnalyticsTracker.sendEvent("info_webgl_max_renderbuffer_size",n),MAX_IMAGE_DIMENSION=Math.min(MAX_IMAGE_DIMENSION,n,t),console.log("setting MAX_IMAGE_DIMENSION = "+MAX_IMAGE_DIMENSION),WebGLShaders.init(),gl.clearColor(.37647058823529,.37647058823529,.37647058823529,1),gl.enable(gl.DEPTH_TEST)}catch(i){}gl?(console.log("max texture size: "+t),console.log("initGL viewport "+e(f).width()+"x"+e(f).height()),console.log("renderbuffer max: "+n)):(App.alert("There was a problem initializing WebGL. Please restart the application and Google Chrome and try again."),AnalyticsTracker.sendEvent("quality_webgl_not_initialized"))}function M(){f.addEventListener("webglcontextlost",function(e){console.log("webglcontextlost: preventing default behavior"),e.preventDefault(),T||(T=setTimeout(function(){App.alert("There was a problem restoring WebGL. Please restart the application and try again.",!0),AnalyticsTracker.sendEvent("quality_webgl_context_lost")},4e3))},!1),f.addEventListener("webglcontextrestored",function(e){console.log("webglcontextrestored"),T&&(clearTimeout(T),T=null),O(!1),MainMenu.getPanel()&&MainMenu.getPanel().exitPanel(!1),z()&&(l=gl.createTexture(),B(l,Canvas.getCurrentImage(),!1),v=null,m=null,g=null,y=null,st(),I())},!1)}function _(t,n,r){t=typeof t!="undefined"?t:!0,n=typeof n!="undefined"?n:!0,r=typeof r!="undefined"?r:!1;var i=100,a=e(f).width()-i*2,l=e(f).height()-i*2;if(p<=a&&d<=l)r&&(o=p/e(f).width(),u=d/e(f).height()),n&&(s=1);else if(p/a<d/l){var c=e(f).height()/d,h=p*c;r&&(o=h/e(f).width()/c,u=1/c),n&&(s=c,s*=l/e(f).height())}else{var c=e(f).width()/p,v=d*c;r&&(u=v/e(f).height()/c,o=1/c),n&&(s=c,s*=a/e(f).width())}t&&Canvas.setScale(s)}function D(){E=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,E),console.log("initBuffers canvas = "+e(f).width()+"x"+e(f).height()),r=0,i=0,_(!1,!0,!0),console.log("xs = "+o+", ys = "+u),s<Canvas.DEFAULT_MIN_SCALE?TopMenu.setMinimumScale(s):TopMenu.setMinimumScale(Canvas.DEFAULT_MIN_SCALE),TopMenu.setScale(s),vertices=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],console.log("new vertices: "+vertices),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(vertices),gl.STATIC_DRAW),E.itemSize=3,E.numItems=4,S=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,S);var t=[0,0,1,0,1,1,0,1];gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(t),gl.STATIC_DRAW),S.itemSize=2,S.numItems=4,x=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,x);var n=[0,1,2,0,2,3];gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),gl.STATIC_DRAW),x.itemSize=1,x.numItems=6}function P(e,t){e=typeof e!="undefined"?e:p,t=typeof t!="undefined"?t:d,v&&gl.deleteFramebuffer(v),v=gl.createFramebuffer(),gl.bindFramebuffer(gl.FRAMEBUFFER,v),v.width=e,v.height=t,m&&gl.deleteTexture(m),m=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,m),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,v.width,v.height,0,gl.RGBA,gl.UNSIGNED_BYTE,null),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,m,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}function H(){w=70*window.devicePixelRatio,b=parseInt(w*p/d),b>t||b>MAX_IMAGE_DIMENSION?b=w*3:b==0&&(b=1),TopMenu.setPreviewWidth(b/window.devicePixelRatio),g&&gl.deleteFramebuffer(g),g=gl.createFramebuffer(),gl.bindFramebuffer(gl.FRAMEBUFFER,g),g.width=b,g.height=w,y&&gl.deleteTexture(y),y=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,y),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,g.width,g.height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var e=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,e),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,g.width,g.height),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,y,0),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,e),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindRenderbuffer(gl.RENDERBUFFER,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}function B(e,t,n,r,i,s){n=typeof n!="undefined"?n:!0,r=typeof r!="undefined"?r:p,i=typeof i!="undefined"?i:d,s=typeof s!="undefined"?s:!1,gl.bindTexture(gl.TEXTURE_2D,e),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,n),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,s?gl.LINEAR:window.devicePixelRatio>1?gl.LINEAR:gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),t instanceof HTMLImageElement||t instanceof HTMLCanvasElement?(console.log("loading image or canvas into texture ("+r+"x"+i+")"),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t)):(console.log("loading pixel array into texture ("+r+"x"+i+")"),console.log("first pixel: "+t[0]+" "+t[1]+" "+t[2]+" "+t[3]),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,r,i,0,gl.RGBA,gl.UNSIGNED_BYTE,t)),e.width=r,e.height=i;if(gl.getError()!=gl.NO_ERROR)throw new Error("Texture too large")}function j(){var e=WebGLShaders.getProgram();gl.viewport(0,0,g.width,g.height),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.bindBuffer(gl.ARRAY_BUFFER,E),gl.vertexAttribPointer(e.aVertexPosition,E.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,S),gl.vertexAttribPointer(e.aTextureCoord,S.itemSize,gl.FLOAT,!1,0,0),e.name=="multipleActionsEffect"?(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,h),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,c)):C?(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,C),gl.uniform1i(e.uSampler,0)):(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,l),gl.uniform1i(e.uSampler,0)),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,x),gl.uniform2f(e.uResolution,p,d),gl.uniform1f(e.uXoffset,0),gl.uniform1f(e.uYoffset,0),gl.uniform1f(e.uScaleX,1),gl.uniform1f(e.uScaleY,1),gl.uniform1f(e.uFlip,-1),gl.uniform2fv(e.uRotation,a),gl.drawElements(gl.TRIANGLES,x.numItems,gl.UNSIGNED_SHORT,0),gl.bindTexture(gl.TEXTURE_2D,null)}function F(e,t,n){e=typeof e!="undefined"?e:!0,t=typeof t!="undefined"?t:1,n=typeof n!="undefined"?n:1;var r=WebGLShaders.getProgram();gl.viewport(0,0,v.width,v.height),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),console.log("drawRenderToTexture"),gl.bindBuffer(gl.ARRAY_BUFFER,E),gl.vertexAttribPointer(r.aVertexPosition,E.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,S),gl.vertexAttribPointer(r.aTextureCoord,S.itemSize,gl.FLOAT,!1,0,0),r.name=="multipleActionsEffect"?(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,h),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,c)):C?(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,C),gl.uniform1i(r.uSampler,0)):(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,l),gl.uniform1i(r.uSampler,0)),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,x),gl.uniform2f(r.uResolution,p,d),gl.uniform1f(r.uXoffset,0),gl.uniform1f(r.uYoffset,0),gl.uniform1f(r.uScaleX,t),gl.uniform1f(r.uScaleY,n),gl.uniform1f(r.uFlip,e?-1:1),gl.uniform2fv(r.uRotation,a),gl.drawElements(gl.TRIANGLES,x.numItems,gl.UNSIGNED_SHORT,0),gl.bindTexture(gl.TEXTURE_2D,null),k&&(k.setShaderProgram(r),k.updateOffset(L,A),k.setCanvas(p,d),k.draw(e?-1:1))}function I(t,n,v){t=typeof t!="undefined"?t:!0,n=typeof n!="undefined"?n:!1,v=typeof v!="undefined"?v:!1;var m=WebGLShaders.getProgram();gl.viewport(0,0,gl.viewportWidth,gl.viewportHeight),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.getError()!=gl.NO_ERROR&&(N||(N=App.alert('There was a problem with WebGL. Click "OK" to return to your image or "Restart" to restart the application.',!0),AnalyticsTracker.sendEvent("quality_webgl_error"))),gl.bindBuffer(gl.ARRAY_BUFFER,E),gl.vertexAttribPointer(m.aVertexPosition,E.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,S),gl.vertexAttribPointer(m.aTextureCoord,S.itemSize,gl.FLOAT,!1,0,0),m.name=="multipleActionsEffect"?(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,h),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,c)):C?(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,C),gl.uniform1i(m.uSampler,0)):(gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,l),gl.uniform1i(m.uSampler,0)),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,x),console.log("scaled image width: "+s*p),console.log("scaled image height: "+s*d);var g=s,y=s;Math.round(s*p*1e5)/1e5%1>0&&(g=Math.round(s*p)/p),Math.round(s*d*1e5)/1e5%1>0&&(y=Math.round(s*d)/d);var b=Math.round((e(f).width()/2-p*g/2)*1e5)/1e5%1,w=Math.round((e(f).height()/2-d*y/2)*1e5)/1e5%1;b>0&&(console.log("round up image_x_offset = "+b),r+=b/e(f).width()*2),w>0&&(console.log("round up image_y_offset = "+w),i-=w/e(f).height()*2),console.log("drawScene with scale = "+s),gl.uniform2f(m.uResolution,e(f).width(),e(f).height()),gl.uniform1f(m.uXoffset,r),gl.uniform1f(m.uYoffset,i),gl.uniform1f(m.uScaleX,(v?-1:1)*o*g),gl.uniform1f(m.uScaleY,(n?-1:1)*u*y),gl.uniform1f(m.uFlip,1),gl.uniform2fv(m.uRotation,a),console.log("drawScene offset "+r+" "+i),console.log("uScaleX"+o*g),console.log("uScaleY"+u*y),gl.drawElements(gl.TRIANGLES,x.numItems,gl.UNSIGNED_SHORT,0),b>0&&(r-=b/e(f).width()*2),w>0&&(i+=w/e(f).height()*2),t&&Canvas.updatePreview()}function q(){console.log("canvas clear"),gl.viewport(0,0,gl.viewportWidth,gl.viewportHeight),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.clearColor(.37647058823529,.37647058823529,.37647058823529,1),l&&(gl.deleteTexture(l),l=null),m&&(gl.deleteTexture(m),m=null),v&&(gl.deleteFramebuffer(v),v=null),h&&(gl.deleteTexture(h),h=null),c&&(gl.deleteTexture(c),c=null)}function R(){return{x:r,y:i}}function U(e,t){r=e,i=t,console.log("xOffset: "+e+" yOffset: "+t),I()}function z(){return l!=null}function W(){gl.bindFramebuffer(gl.FRAMEBUFFER,g),j(),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,y,0);var e=new Uint8Array(b*w*4);if(gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");return gl.readPixels(0,0,b,w,gl.RGBA,gl.UNSIGNED_BYTE,e),gl.bindFramebuffer(gl.FRAMEBUFFER,null),e}function X(e,t,n,r,i){t=typeof t!="undefined"?t:0,n=typeof n!="undefined"?n:0,r=typeof r!="undefined"?r:p,i=typeof i!="undefined"?i:d,e=typeof e!="undefined"?e:!1,gl.bindFramebuffer(gl.FRAMEBUFFER,v);var s=e?m:l;gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,s,0),e&&F(!0);if(gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE){var o=gl.checkFramebufferStatus(gl.FRAMEBUFFER);switch(o){case gl.FRAMEBUFFER_COMPLETE:break;case gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case gl.FRAMEBUFFER_UNSUPPORTED:throw"Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED";default:throw"Incomplete framebuffer: "+o}throw new Error("incomplete framebuffer")}try{console.log("creating array: "+r*i*4+" bytes");var u=new Uint8Array(r*i*4)}catch(a){return App.alert("The application is out of memory. Please save your image and restart the application before continuing."),console.log("out of memory, returning null"),null}return console.log("done creating array"),gl.readPixels(t,n,r,i,gl.RGBA,gl.UNSIGNED_BYTE,u),console.log("getPixelArray first pixel: "+u[0]+" "+u[1]+" "+u[2]+" "+u[3]),gl.bindFramebuffer(gl.FRAMEBUFFER,null),u}function V(e,t){e=typeof e!="undefined"?e:1,t=typeof t!="undefined"?t:1,console.log("renderToFramebuffer"),gl.bindFramebuffer(gl.FRAMEBUFFER,v),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,m,0),F(!1,e,t);if(gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");gl.bindFramebuffer(gl.FRAMEBUFFER,null)}function $(e){e?h=null:l=c}function J(e){C=e}function K(){h=l}function Q(){h&&(l=h,h=null)}function G(){var e;e=l,l=m,m=e}function Y(){gl.bindFramebuffer(gl.FRAMEBUFFER,v),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,m,0);if(gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");gl.bindTexture(gl.TEXTURE_2D,l),gl.copyTexImage2D(gl.TEXTURE_2D,0,gl.RGBA,0,0,p,d,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}function Z(e,t){console.log("resizing to "+e+" x "+t);var n=p,r=d,i=e/n,s=t/r;gl.bindTexture(gl.TEXTURE_2D,l),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.bindTexture(gl.TEXTURE_2D,null),p=e,d=t,P(),H(),p=n,d=r,gl.bindFramebuffer(gl.FRAMEBUFFER,v);if(i<1&&s<1){var o=WebGLShaders.setProgram("bicubic");gl.uniform1f(o.textureSizeWidth,n*i),gl.uniform1f(o.texelSizeX,.5*(1-i)/(n*i)),gl.uniform1f(o.textureSizeHeight,r*s),gl.uniform1f(o.texelSizeY,.5*(1-s)/(r*s))}console.log("scaleX "+i+" scaleY "+s),i=1,s=1,gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,m,0),F(!1,i,s);if(gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");G(),gl.bindTexture(gl.TEXTURE_2D,l),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,window.devicePixelRatio>1?gl.LINEAR:gl.NEAREST),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null),p=e,d=t,D(),P(),WebGLShaders.setProgram("passthru")}function et(e,t,n,r){console.log("crop: "+e+" "+t+" "+n+" "+r),gl.bindFramebuffer(gl.FRAMEBUFFER,v),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,l,0);if(gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");gl.bindTexture(gl.TEXTURE_2D,m),gl.copyTexImage2D(gl.TEXTURE_2D,0,gl.RGBA,e,Canvas.getImageHeight()-r-t,n,r,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null),G(),p=n,d=r,D(),P(),H(),I()}function tt(){var e=new Uint8Array(d*p*4);return gl.readPixels(0,0,p,d,gl.RGBA,gl.UNSIGNED_BYTE,e),lt(null,f.width,f.height),e}function nt(e,t,n,r,i,s){s=typeof s!="undefined"?s:!0,gl.bindTexture(gl.TEXTURE_2D,l),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,s),gl.texSubImage2D(gl.TEXTURE_2D,0,t,Canvas.getImageHeight()-i-n,r,i,gl.RGBA,gl.UNSIGNED_BYTE,e),gl.bindTexture(gl.TEXTURE_2D,null),I()}function rt(e,t){p=e,d=t,P()}function it(){l&&gl.deleteTexture(l),l=gl.createTexture()}function st(){D(),P(),H()}function ot(e,t){WebGL.handleLoadedTexture(l,e,t,e.width,e.height)}function ut(e){s=e}function at(){V(),G()}function ft(e,t,n,r,i,s){var o=WebGLShaders.getProgram();gl.bindBuffer(gl.ARRAY_BUFFER,E),gl.vertexAttribPointer(o.aVertexPosition,E.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,S),gl.vertexAttribPointer(o.aTextureCoord,S.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,x),gl.uniform2f(o.uResolution,i!=undefined?i:p,s!=undefined?s:d),gl.uniform1f(o.uXoffset,0),gl.uniform1f(o.uYoffset,0),gl.uniform1f(o.uScaleX,n!=undefined?n:1),gl.uniform1f(o.uScaleY,r!=undefined?r:1),gl.uniform1f(o.uFlip,1),gl.uniform2fv(o.uRotation,t!=undefined?t:a);for(var u=0;u<e.length;u++)gl.activeTexture(gl.TEXTURE0+u),gl.bindTexture(gl.TEXTURE_2D,e[u]);gl.drawElements(gl.TRIANGLES,x.numItems,gl.UNSIGNED_SHORT,0)}function lt(e,t,n){gl.bindFramebuffer(gl.FRAMEBUFFER,e),gl.viewport(0,0,t,n)}function ct(e){var t=new Uint8Array(p*d*4);gl.readPixels(0,0,p,d,gl.RGBA,gl.UNSIGNED_BYTE,t);var n=WebGLShaders.setProgram(e);if(e=="multipleActionsEffect"){var r=gl.getUniformLocation(n,"uSampler"),i=gl.getUniformLocation(n,"blendTexture");gl.uniform1i(r,0),gl.uniform1i(i,1)}lt(null,f.width,f.height),c=gl.createTexture(),WebGL.handleLoadedTexture(c,t,!1,p,d),K(),$(!1),WebGLEffects.isTextureResized()&&WebGL.scaleToFit(!1,!0,!0)}function ht(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t}var t,n,r=0,i=0,s=1,o=1,u=1,a=[0,1],f,l=null,c=null,h=null,p,d,v=null,m=null,g=null,y=null,b,w,E,S,x,T=null,N=null,C=null,k=null,L=0,A=0;return{reset:st,clearDisplayTexture:it,render:at,isImageLoaded:z,loadImageToTexture:ot,setScale:ut,setRotation:function(e){e+=90,a=[Math.cos(e/180*Math.PI),Math.sin(e/180*Math.PI)]},getImageWidth:function(){return p},setImageWidth:function(e){p=e},getImageHeight:function(){return d},setImageHeight:function(e){d=e},setViewportSize:function(e,t){gl.viewportWidth=e,gl.viewportHeight=t},init:O,initBuffers:D,initTextureFramebuffer:P,initPreviewFramebuffer:H,drawScene:I,clear:q,scaleToFit:_,getScale:function(){return s},getWidth:function(){return e(f).width()},getHeight:function(){return e(f).height()},getOffset:R,setOffset:U,getPixelArray:X,renderToFramebuffer:V,swapTextures:G,loadFromFramebuffer:Y,crop:et,resize:Z,loadImageData:function(e,t){t=typeof t!="undefined"?t:!0,B(l,e,t)},loadImageDataRect:nt,setVisible:function(t){e(f).css("display",t?"block":"none")},setTextTexture:function(e){k=e},setTextOffset:function(e,t){L=e,A=t},setFramebufferSize:rt,getPreviewPixelArray:W,getPreviewWidth:function(){return b},getPreviewHeight:function(){return w},handleLoadedTexture:B,setEffectTexture:$,backUpDisplayTexture:K,setBlurTexture:J,getDisplayTexture:function(){return l},drawTexture:ft,getPixelsForMultiActsEffect:tt,loadEffectTexture:ct,setFramebuffer:lt,restoreDisplayTexture:Q,createAndSetupTexture:ht}}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h={},p=e.config&&e.config()||{};t={version:"2.0.7",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,e))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!shaders/vertex.shader",[],function(){return"attribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform float uXoffset;\nuniform float uYoffset;\nuniform float uScaleX;\nuniform float uScaleY;\nuniform float uFlip;\nuniform vec2 uRotation;\n\nuniform vec2 uResolution;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n\n	vec3 vertex_pos = aVertexPosition;// / vec3(uResolution.x, uResolution.y, 1.0);\n\n	vertex_pos = vertex_pos + vec3(uXoffset, uYoffset, 0.0);\n\n	vertex_pos.x = vertex_pos.x * uScaleX * uResolution.x / uResolution.y;\n	vertex_pos.y = vertex_pos.y * uScaleY;\n\n	//vertex_pos = vertex_pos + vec3(uXoffset, uYoffset, 0.0);\n\n	vec3 pos = vec3(\n	 	vertex_pos.x * uRotation.y + vertex_pos.y * uRotation.x,\n	 	vertex_pos.y * uRotation.y - vertex_pos.x * uRotation.x, 0.0);\n\n	pos = pos / vec3(uResolution.x / uResolution.y, 1.0, 1.0);\n\n	pos.y = pos.y * uFlip;\n\n	//pos = pos + vec3(uXoffset, uYoffset, 0.0);\n\n	gl_Position = vec4(pos, 1.0);\n\n	vTextureCoord = aTextureCoord;\n\n}"}),define("text!shaders/passthru_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nvoid main(void) {\n\n	gl_FragColor = texture2D(uSampler, vTextureCoord);\n  \n}"}),define("text!shaders/contrast_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uContrast;\nuniform float uBrightness;\n\nvoid main(void) {\n    vec4 texel = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    vec3 rgbcolor = texel.rgb;\n\n    \n    rgbcolor += uBrightness;\n    if (uContrast > 0.0) {\n        rgbcolor = (rgbcolor - 0.5) / (1.0 - uContrast) + 0.5;\n    } else {\n        rgbcolor = (rgbcolor - 0.5) * (1.0 + uContrast) + 0.5;\n    }\n\n\n    gl_FragColor = vec4(rgbcolor, texel.a);//1.0);\n}"}),define("text!shaders/color_fragment.shader",[],function(){return'# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uHue;\nuniform float uSaturation;\nuniform float uVibrance;\nuniform float uWarmth;\n\n// sRGB working space, D50 reference white\n// See http://www.brucelindbloom.com/Eqn_RGB_XYZ_Matrix.html\n\nmat3 mRGBtoXYZ = mat3(\n    0.4360747, 0.2225045, 0.0139322,\n    0.3850649, 0.7168786, 0.0971045,\n    0.1430804, 0.0606169, 0.7141733\n);\n\nmat3 mXYZtoRGB = mat3(\n    3.1338561, -0.9787684, 0.0719453,\n    -1.6168667, 1.9161415, -0.2289914,\n    -0.4906146, 0.0334540, 1.4052427\n);\n\n\n// Bradford method for Chromatic Adaptation\n// See http://www.brucelindbloom.com/Eqn_ChromAdapt.html\n\nmat3 mBradford = mat3(\n    0.8951000, -0.7502000, 0.0389000,\n    0.2664000, 1.7135000, -0.0685000,\n    -0.1614000, 0.0367000, 1.0296000\n);\n\nmat3 mBradfordInv = mat3(\n    0.9869929, 0.4323053, -0.0085287,\n    -0.1470543, 0.5183603, 0.0400428,\n    0.1599627, 0.0492912, 0.9684867\n);\n\nfloat Luminance(vec3 c) {\n    return dot(c, vec3(0.299, 0.587, 0.114));\n}\n\n/*\n\nThe following function is adapted from GPUImage\n\nhttps://github.com/BradLarson/GPUImage\n\nCopyright (c) 2012, Brad Larson, Ben Cochran, Hugues Lismonde, Keitaroh Kobayashi, Alaric Cole, Matthew Clark, Jacob Gundersen, Chris Williams.\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\nRedistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\nRedistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\nNeither the name of the GPUImage framework nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n*/\n\nvec3 ClipColor(vec3 c) {\n    float l = Luminance(c);\n    float n = min(min(c.r, c.g), c.b);\n    float x = max(max(c.r, c.g), c.b);\n    \n    if (n < 0.0) {\n        c.r = l + ((c.r - l) * l) / (l - n);\n        c.g = l + ((c.g - l) * l) / (l - n);\n        c.b = l + ((c.b - l) * l) / (l - n);\n    }\n    if (x > 1.0) {\n        c.r = l + ((c.r - l) * (1.0 - l)) / (x - l);\n        c.g = l + ((c.g - l) * (1.0 - l)) / (x - l);\n        c.b = l + ((c.b - l) * (1.0 - l)) / (x - l);\n    }\n \n    return c;\n }\n\n\nvoid main(void) {\n\n    vec4 color = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    float angle = uHue * 3.14159265;\n    float s = sin(angle), c = cos(angle);\n    vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\n    float len = length(color.rgb);\n    color.rgb = vec3(\n        dot(color.rgb, weights.xyz),\n        dot(color.rgb, weights.zxy),\n        dot(color.rgb, weights.yzx));\n\n    float average = (color.r + color.g + color.b) / 3.0;\n\n    float luminance = Luminance(color.rgb);\n    \n    float saturation = uSaturation;\n\n    if (saturation > 0.0) {\n        saturation = saturation * 0.5;\n        color.rgb += (luminance - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\n    } else {\n        color.rgb += (luminance - color.rgb) * (-saturation);\n    }\n    \n    luminance = Luminance(color.rgb);\n\n    \n    float mn = min(min(color.r, color.g), color.b);\n    float mx = max(max(color.r, color.g), color.b);\n    float invsat = pow(1.0 - (mx - mn), 2.0);\n\n    color.rgb = mix(vec3(luminance), color.rgb, uVibrance * invsat + 1.0);\n    \n\n    vec3 refWhiteTo;\n    vec3 refWhiteFrom = vec3(1.0, 1.0, 1.0);\n\n    if (uWarmth > 0.0) {\n        refWhiteTo = mix(vec3(1.0, 1.0, 1.0), vec3(0.8, 0.8, 0.2), uWarmth * 0.75);\n    } else {\n        refWhiteTo = mix(vec3(1.0, 1.0, 1.0), vec3(0.1, 0.2, 0.8), -uWarmth * 0.75);\n    }\n\n    vec3 crSrc = mBradford * refWhiteFrom;\n    vec3 crDst = mBradford * refWhiteTo;\n\n    mat3 mcr = mat3(\n        crDst.x / crSrc.x, 0.0, 0.0,\n        0.0, crDst.y / crSrc.y, 0.0,\n        0.0, 0.0, crDst.z / crSrc.z\n    );\n\n    mat3 mChromatic = mBradfordInv * mcr * mBradford;\n\n    vec3 xyz = mChromatic * (mRGBtoXYZ * color.rgb);\n    vec3 rgb = mXYZtoRGB * xyz;\n\n    float oldLuminance = Luminance(color.rgb);\n    float newLuminance = Luminance(rgb);\n\n    rgb += vec3(oldLuminance) - vec3(newLuminance);\n    rgb = ClipColor(rgb);\n\n    gl_FragColor = vec4(rgb, 1.0);\n\n}'}),define("text!shaders/test_fragment.shader",[],function(){return"\nprecision highp float;\n\nuniform float textureSizeWidth;\nuniform float textureSizeHeight;\nuniform float texelSizeX;\nuniform float texelSizeY;\nvarying highp vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float uParam1;\nuniform float uParam2;\n\n\nvec4 tex2DBiLinear( sampler2D textureSampler_i, vec2 texCoord_i )\n{\n    vec4 p0q0 = texture2D(textureSampler_i, texCoord_i);\n    vec4 p1q0 = texture2D(textureSampler_i, texCoord_i + vec2(4.0*texelSizeX, 0));\n\n    vec4 p0q1 = texture2D(textureSampler_i, texCoord_i + vec2(0, 4.0*texelSizeY));\n    vec4 p1q1 = texture2D(textureSampler_i, texCoord_i + vec2(4.0*texelSizeX , 4.0*texelSizeY));\n\n    float a = fract( texCoord_i.x * textureSizeWidth );\n\n    vec4 pInterp_q0 = mix( p0q0, p1q0, a );\n    vec4 pInterp_q1 = mix( p0q1, p1q1, a );\n\n    //pInterp_q1.x = pInterp_q1.x + 0.5;\n\n    float b = fract( texCoord_i.y * textureSizeHeight );\n    return mix( pInterp_q0, pInterp_q1, b );\n}\n\nfloat Triangular( float f )\n{\n    f = f / 2.0;\n    if( f < 0.0 )\n    {\n        return ( f + 1.0 );\n    }\n    else\n    {\n        return ( 1.0 - f );\n    }\n    return 0.0;\n}\n/*\nfloat BellFunc( float x )\n{\n    float f = ( x / 2.0 ) * 1.5; // Converting -2 to +2 to -1.5 to +1.5\n    if( f > -1.5 && f < -0.5 )\n    {\n        return( 0.5 * pow(f + 1.5, 2.0));\n    }\n    else if( f > -0.5 && f < 0.5 )\n    {\n        return 3.0 / 4.0 - ( f * f );\n    }\n    else if( ( f > 0.5 && f < 1.5 ) )\n    {\n        return( 0.5 * pow(f - 1.5, 2.0));\n    }\n    return 0.0;\n}\n*/\nfloat BSpline( float x )\n{\n    float f = x;\n    if( f < 0.0 )\n    {\n        f = -f;\n    }\n\n    if( f >= 0.0 && f <= 1.0 )\n    {\n        return ( 2.0 / 3.0 ) + ( 0.5 ) * ( f* f * f ) - (f*f);\n    }\n    else if( f > 1.0 && f <= 2.0 )\n    {\n        return 1.0 / 6.0 * pow( ( 2.0 - f  ), 3.0 );\n    }\n    return 1.0;\n}  \n/*\nfloat CatMullRom( float x )\n{\n    const float B = 0.0;\n    const float C = 0.5;\n    float f = x;\n    if( f < 0.0 )\n    {\n        f = -f;\n    }\n    if( f < 1.0 )\n    {\n        return ( ( 12.0 - 9.0 * B - 6.0 * C ) * ( f * f * f ) +\n            ( -18.0 + 12.0 * B + 6.0 *C ) * ( f * f ) +\n            ( 6.0 - 2.0 * B ) ) / 6.0;\n    }\n    else if( f >= 1.0 && f < 2.0 )\n    {\n        return ( ( -B - 6.0 * C ) * ( f * f * f )\n            + ( 6.0 * B + 30.0 * C ) * ( f *f ) +\n            ( - ( 12.0 * B ) - 48.0 * C  ) * f +\n            8.0 * B + 24.0 * C)/ 6.0;\n    }\n    else\n    {\n        return 0.0;\n    }\n} \n*/\nvec4 BiCubic( sampler2D textureSampler, vec2 TexCoord )\n{\n    //float texelSizeX = 1.0 / fWidth; //size of one texel \n    //float texelSizeY = 1.0 / fHeight; //size of one texel \n    vec4 nSum = vec4( 0.0, 0.0, 0.0, 0.0 );\n    vec4 nDenom = vec4( 0.0, 0.0, 0.0, 0.0 );\n    float a = fract( TexCoord.x * textureSizeWidth ); // get the decimal part\n    float b = fract( TexCoord.y * textureSizeHeight ); // get the decimal part\n    for( int m = -1; m <=2; m++ )\n    {\n        for( int n =-1; n<= 2; n++)\n        {\n            vec4 vecData = texture2D(textureSampler, \n                               TexCoord + vec2(texelSizeX * float( m ), \n                    texelSizeY * float( n )));\n            float f  = BSpline( float( m ) - a );\n            vec4 vecCooef1 = vec4( f,f,f,f );\n            float f1 = BSpline ( -( float( n ) - b ) );\n            vec4 vecCoeef2 = vec4( f1, f1, f1, f1 );\n            nSum = nSum + ( vecData * vecCoeef2 * vecCooef1  );\n            nDenom = nDenom + (( vecCoeef2 * vecCooef1 ));\n        }\n    }\n    return nSum / nDenom;\n}\n\n\n\nvoid main() { \n\n    //gl_FragColor = \n    //vec4 texel = BiCubic(uSampler, vTextureCoord);\n    vec4 texel = tex2DBiLinear(uSampler,vTextureCoord);\n\n    vec3 rgbcolor = texel.rgb;\n\n      \n    rgbcolor += uParam2;\n    if (uParam1 > 0.0) {\n        rgbcolor = (rgbcolor - 0.5) / (1.0 - uParam1) + 0.5;\n    } else {\n        rgbcolor = (rgbcolor - 0.5) * (1.0 + uParam1) + 0.5;\n    }\n    \n\n    gl_FragColor = vec4(rgbcolor, texel.a);\n}\n\n\n/*\nfloat BSpline( float x )\n{\n    float f = abs(x);\n\n    if(f <= 1.0 )\n        return (( 2.0 / 3.0 ) + ( 0.5 ) * ( f * f * f ) - (f * f));\n    else\n    {\n        f = 2.0 - f;\n        return (1.0 / 6.0 * f * f * f);\n    }\n}\nconst vec4 offset = vec4(-1.0, 1.0, 1.0 ,-1.0);\n\nvec4 filter(sampler2D tex, vec2 texcoord)\n{\n    float fx = fract(texcoord.x);\n    float fy = fract(texcoord.y);\n    texcoord.x -= fx;\n    texcoord.y -= fy;\n\n    vec4 xcubic = vec4(BSpline(- 1.0 - fx), BSpline(-fx), BSpline(1.0 - fx), BSpline(2.0 - fx));\n    vec4 ycubic = vec4(BSpline(- 1.0 - fy), BSpline(-fy), BSpline(1.0 - fy), BSpline(2.0 - fy));\n\n    vec4 c = vec4(texcoord.x - 0.5, texcoord.x + 1.5, texcoord.y - 0.5, texcoord.y + 1.5);\n    vec4 s = vec4(xcubic.x + xcubic.y, xcubic.z + xcubic.w, ycubic.x + ycubic.y, ycubic.z + ycubic.w);\n    vec4 offset = c + vec4(xcubic.y, xcubic.w, ycubic.y, ycubic.w) / s;\n\n    vec4 sample0 = texture2D(tex, vec2(offset.x, offset.z) / 1.0);\n    vec4 sample1 = texture2D(tex, vec2(offset.y, offset.z) / 1.0);\n    vec4 sample2 = texture2D(tex, vec2(offset.x, offset.w) / 1.0);\n    vec4 sample3 = texture2D(tex, vec2(offset.y, offset.w) / 1.0);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx), sy);\n}\n\nvoid main() {\n   gl_FragColor = filter(uSampler, vTextureCoord);\n}\n*/\n\n\n\n/*\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uParam1;\nuniform float uParam2;\n\n\nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepLeftTextureCoordinate;\nvarying vec2 twoStepsLeftTextureCoordinate;\nvarying vec2 threeStepsLeftTextureCoordinate;\nvarying vec2 fourStepsLeftTextureCoordinate;\nvarying vec2 oneStepRightTextureCoordinate;\nvarying vec2 twoStepsRightTextureCoordinate;\nvarying vec2 threeStepsRightTextureCoordinate;\nvarying vec2 fourStepsRightTextureCoordinate;\n\n// sinc(x) * sinc(x/a) = (a * sin(pi * x) * sin(pi * x / a)) / (pi^2 * x^2)\n// Assuming a Lanczos constant of 2.0, and scaling values to max out at x = +/- 1.5\n\nvoid main()\n{\n     lowp vec4 fragmentColor = texture2D(uSampler, centerTextureCoordinate) * 0.38026;\n\n     fragmentColor += texture2D(uSampler, oneStepLeftTextureCoordinate) * 0.27667;\n     fragmentColor += texture2D(uSampler, oneStepRightTextureCoordinate) * 0.27667;\n\n     fragmentColor += texture2D(uSampler, twoStepsLeftTextureCoordinate) * 0.08074;\n     fragmentColor += texture2D(uSampler, twoStepsRightTextureCoordinate) * 0.08074;\n\n     fragmentColor += texture2D(uSampler, threeStepsLeftTextureCoordinate) * -0.02612;\n     fragmentColor += texture2D(uSampler, threeStepsRightTextureCoordinate) * -0.02612;\n\n     fragmentColor += texture2D(uSampler, fourStepsLeftTextureCoordinate) * -0.02143;\n     fragmentColor += texture2D(uSampler, fourStepsRightTextureCoordinate) * -0.02143;\n\n     vec4 texel = fragmentColor;\n     vec3 rgbcolor = texel.rgb;\n\n    \n    rgbcolor += uParam2;\n    if (uParam1 > 0.0) {\n        rgbcolor = (rgbcolor - 0.5) / (1.0 - uParam1) + 0.5;\n    } else {\n        rgbcolor = (rgbcolor - 0.5) * (1.0 + uParam1) + 0.5;\n    }\n\n\n    gl_FragColor = vec4(rgbcolor, texel.a);\n}\n*/\n/*\nvoid main(void) {\n    vec4 texel = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    vec3 rgbcolor = texel.rgb;\n\n    \n    rgbcolor += uParam2;\n    if (uContrast > 0.0) {\n        rgbcolor = (rgbcolor - 0.5) / (1.0 - uParam1) + 0.5;\n    } else {\n        rgbcolor = (rgbcolor - 0.5) * (1.0 + uParam1) + 0.5;\n    }\n\n\n    gl_FragColor = vec4(rgbcolor, texel.a);\n}\n*/"}),define("text!shaders/bicubic_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nuniform float textureSizeWidth;\nuniform float textureSizeHeight;\nuniform float texelSizeX;\nuniform float texelSizeY;\nvarying highp vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float uParam1;\nuniform float uParam2;\n\nfloat BSpline( float x )\n{\n    float f = x;\n    if( f < 0.0 )\n    {\n        f = -f;\n    }\n\n    if( f >= 0.0 && f <= 1.0 )\n    {\n        return ( 2.0 / 3.0 ) + ( 0.5 ) * ( f* f * f ) - (f*f);\n    }\n    else if( f > 1.0 && f <= 2.0 )\n    {\n        return 1.0 / 6.0 * pow( ( 2.0 - f  ), 3.0 );\n    }\n    return 1.0;\n}  \n\nvec4 BiCubic( sampler2D textureSampler, vec2 TexCoord )\n{\n    //float texelSizeX = 1.0 / fWidth; //size of one texel \n    //float texelSizeY = 1.0 / fHeight; //size of one texel \n    vec4 nSum = vec4( 0.0, 0.0, 0.0, 0.0 );\n    vec4 nDenom = vec4( 0.0, 0.0, 0.0, 0.0 );\n    float a = fract( TexCoord.x * textureSizeWidth ); // get the decimal part\n    float b = fract( TexCoord.y * textureSizeHeight ); // get the decimal part\n    for( int m = -1; m <=2; m++ )\n    {\n        for( int n =-1; n<= 2; n++)\n        {\n            vec4 vecData = texture2D(textureSampler, \n                               TexCoord + vec2(texelSizeX * float( m ), \n                    texelSizeY * float( n )));\n            float f  = BSpline( float( m ) - a );\n            vec4 vecCooef1 = vec4( f,f,f,f );\n            float f1 = BSpline ( -( float( n ) - b ) );\n            vec4 vecCoeef2 = vec4( f1, f1, f1, f1 );\n            nSum = nSum + ( vecData * vecCoeef2 * vecCooef1  );\n            nDenom = nDenom + (( vecCoeef2 * vecCooef1 ));\n        }\n    }\n    return nSum / nDenom;\n}\n\n\n\nvoid main() { \n\n    gl_FragColor = BiCubic(uSampler, vTextureCoord);\n\n}\n"}),define("text!shaders/overlay_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nuniform float textureSizeWidth;\nuniform float textureSizeHeight;\nuniform float uOverlayWidth;\nuniform float uOverlayHeight;\nuniform float uOverlayOffsetX;\nuniform float uOverlayOffsetY;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D uSamplerCopy;\n\nvoid main(void) {\n	//float offset_x = 33.0;\n	//float offset_y = 105.0;\n	//float texture_width = 76.0;\n	//float texture_height = 177.0;\n\n	vec4 test = texture2D( uSamplerCopy, vec2(vTextureCoord.x * (textureSizeWidth / uOverlayWidth) - uOverlayOffsetX / uOverlayWidth,\n		vTextureCoord.y * (textureSizeHeight / uOverlayHeight) - (textureSizeHeight - uOverlayHeight - uOverlayOffsetY) / uOverlayHeight) );\n	\n\n\n	float min_x = uOverlayOffsetX / textureSizeWidth;\n	float max_x = (uOverlayOffsetX + uOverlayWidth) / textureSizeWidth;\n	//float max_y = (uOverlayOffsetY) / textureSizeHeight;\n	//float min_y = (uOverlayOffsetY + uOverlayHeight) / textureSizeHeight;\n	\n	float max_y = (textureSizeHeight - uOverlayOffsetY) / textureSizeHeight;\n	float min_y = (textureSizeHeight - uOverlayOffsetY - uOverlayHeight) / textureSizeHeight;\n\n	//gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));\n	\n	\n    gl_FragColor = mix(\n    	texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)),\n    	test, step(\n    		1.0 - step(\n    		step(vTextureCoord.x, min_x) + 1.0 - step(vTextureCoord.x, max_x), 0.5) +\n    		1.0 - step(\n    		1.0 - step(vTextureCoord.y, max_y) + step(vTextureCoord.y, min_y), 0.5), 0.5) ); \n  \n}"}),define("text!shaders/mapping_fragment.shader",[],function(){return"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\n\r\nuniform sampler2D uSampler;	\r\nuniform sampler2D red;	\r\nuniform sampler2D green;	\r\nuniform sampler2D blue;\r\nuniform float uAmount;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main() {\r\n	vec4 color = texture2D(uSampler, vTextureCoord);\r\n	\r\n	vec2 indexRed = vec2(color.r, 0.0);\r\n    vec4 redColor = texture2D(red, indexRed);\r\n    \r\n    vec2 indexGreen = vec2(color.g, 0.0);\r\n    vec4 greenColor = texture2D(green, indexGreen);\r\n    \r\n    vec2 indexBlue = vec2(color.b, 0.0);\r\n    vec4 blueColor = texture2D(blue, indexBlue);\r\n    \r\n	gl_FragColor = mix(\r\n		color,\r\n		vec4(redColor.r, greenColor.g, blueColor.b, color.a),\r\n		uAmount);\r\n}"}),define("text!shaders/lookup_fragment.shader",[],function(){return"#ifdef GL_ES\r\nprecision highp float;\r\n#endif\r\n\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uData;\r\nvarying vec2 vTextureCoord;\r\nuniform float uAmount;\r\n\r\nvoid main() {\r\n	vec4 color = texture2D(uSampler, vTextureCoord);\r\n	vec2 pos = vec2((color.r + color.g + color.b)/ 3.0, 0.0);\r\n	vec4 dstColor = texture2D(uData, pos);\r\n	\r\n	gl_FragColor = mix(\r\n		color,\r\n		dstColor,\r\n		uAmount);\r\n}"}),define("text!shaders/waterdown_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D texture;\nvarying vec2 vTextureCoord;\nuniform float uAmount;\n\nvoid main() {\n	vec4 color = texture2D(texture, vTextureCoord);\n	\n	float r = color.r * 255.0;\n	float g = color.g * 255.0;\n	float b = color.b * 255.0;\n	\n	r = (r*0.393) + (g*0.769) + (b*0.189);\n	g = (r*0.349) + (g*0.686) + (b*0.168);\n	b = (r*0.272) + (g*0.534) + (b*0.131);\n				\n	if(r > 255.0) r = 255.0;\n	else if(r < 0.0) r = 0.0;\n	if(g > 255.0) g = 255.0;\n	else if(g < 0.0) g = 0.0;\n	if(b > 255.0) b = 255.0;\n	else if(b < 0.0) b = 0.0;\n	\n	gl_FragColor = mix(\n		color,\n		vec4(r/255.0, g/255.0, b/255.0, color.a),\n		uAmount);\n}"}),define("text!shaders/vignette_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D texture;\nuniform float size;\nvarying vec2 vTextureCoord;\nuniform int colormode;\n\nvoid main()\n{\n   vec4 color = texture2D(texture, vTextureCoord);\n   \n   float amount = 0.5;\n   float vSize = size * 2.0; // Multiply by 2.0 to make the effect match the express flash version.\n   \n   float dist = distance(vTextureCoord, vec2(0.5, 0.5));\n   if(colormode == 0)\n   {\n	   color.rgb *= smoothstep(0.8, vSize * 0.799, dist * (amount + vSize));\n   }\n   else\n   {\n	   float percent = smoothstep(0.5, 0.8, dist);\n	   color = vec4(mix(color.rgb, vec3(1.0, 1.0, 1.0), percent), color.a);\n   }\n\n   gl_FragColor = color;\n}"}),define("text!shaders/noise_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float amount;\n\nfloat rand(vec2 co) {\n   return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main() {\n   vec4 color = texture2D(texture, vTextureCoord);\n   float diff = (rand(vTextureCoord) - 0.5) * amount * 0.5; // here multiply 0.5 in order to match the express flash version\n   color.r += diff;\n   color.g += diff;\n   color.b += diff;\n   \n   gl_FragColor = color;\n}"}),define("text!shaders/desaturate_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D Sample0;\nvarying vec2 vTextureCoord;\nuniform float uAmount;\n\nvec4 Desaturate(vec3 color)\n{\n	vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n	vec3 gray = vec3(dot(grayXfer, color));\n	return vec4(gray, 1.0);\n}\n\nvoid main() {\n	vec4 color = texture2D(Sample0, vTextureCoord);\n	gl_FragColor = mix(\n		color,\n		Desaturate(color.rgb),\n		uAmount);\n}"}),define("text!shaders/sharpen_fragment.shader",[],function(){return"#ifdef GL_ES\n	precision highp float;\n#endif\n\nvarying vec2 vTextureCoord;\n \nuniform sampler2D u_image;\nuniform vec2 u_textureSize;\nuniform float u_kernel[9];\n\nvoid main() {\n   vec2 onePixel = vec2(1.0, 1.0) / u_textureSize;\n   vec4 colorSum =\n       texture2D(u_image, vTextureCoord + onePixel * vec2(-1, -1)) * u_kernel[0] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2( 0, -1)) * u_kernel[1] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2( 1, -1)) * u_kernel[2] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2(-1,  0)) * u_kernel[3] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2( 0,  0)) * u_kernel[4] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2( 1,  0)) * u_kernel[5] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2(-1,  1)) * u_kernel[6] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2( 0,  1)) * u_kernel[7] +\n       texture2D(u_image, vTextureCoord + onePixel * vec2( 1,  1)) * u_kernel[8] ;\n   \n   float kernelWeight =\n       u_kernel[0] +\n       u_kernel[1] +\n       u_kernel[2] +\n       u_kernel[3] +\n       u_kernel[4] +\n       u_kernel[5] +\n       u_kernel[6] +\n       u_kernel[7] +\n       u_kernel[8] ;\n\n   if (kernelWeight <= 0.0) {\n     kernelWeight = 1.0;\n   }\n\n   gl_FragColor = vec4((colorSum / kernelWeight).rgb, 1);\n}"}),define("text!shaders/pixelate_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\n\nuniform sampler2D texture;\nvarying vec2 vTextureCoord;\n\nfloat discretize(float f, float d)\n{\n    return floor(f*d + 0.5)/d;\n}\n\nvec2 discretize(vec2 v, float d)\n{\n    return vec2(discretize(v.x, d), discretize(v.y, d));\n}\n\nvoid main()\n{\n    vec2 texCoord = discretize(vTextureCoord, 128.0);\n    gl_FragColor = texture2D(texture, texCoord);\n}"}),define("text!shaders/blend_fragment.shader",[],function(){return'/// <summary>\n/// Fragment shader for blending 2 images.\n/// </summary>\n\n\n#ifdef GL_ES\n	precision highp float;\n#endif\n\n/// <summary>\n/// Uniform variables.\n/// <summary>\nuniform sampler2D Sample0;	// Background layer (AKA: Destination)\nuniform sampler2D Sample1;	// Foreground layer (AKA: Source)\nuniform sampler2D maskTexture;\n\nuniform int blendmode;  // use to identify the blend mode\nuniform float alpha;\n\nuniform float amount;\n\n\n/// <summary>\n/// Varying variables.\n/// <summary>\nvarying vec2 vTextureCoord;\n\n\n/// <summary>\n/// Blend the source and destination pixels.\n/// This function does not precompute alpha channels. To learn more about the equations that\n/// factor in alpha blending, see http://www.w3.org/TR/2009/WD-SVGCompositing-20090430/.\n/// <summary>\n/// <param name="src">Source (foreground) pixel.</param>\n/// <param name="dst">Destination (background) pixel.</param>\n/// <returns>The blended pixel.</returns>\nvec4 blend (vec4 src, vec4 dst, int blendmode)\n{	\n	if(blendmode == 0) // Dst over\n	{\n		return vec4(dst.rgb, alpha) * alpha + src * (1.0 - alpha);\n	}\n	else if(blendmode == 1) //Add\n	{\n		return vec4((src + dst).rgb, alpha) * alpha + dst * (1.0 - alpha);\n	}\n	else if(blendmode == 2) //Multiply\n	{\n		return src * dst * alpha + dst * (1.0 - alpha);\n	}\n	else if(blendmode == 3) //Screen\n	{\n		return ((src + dst) - (src * dst)) * alpha + dst * (1.0 - alpha); \n	}\n	else if(blendmode == 4) //Darken\n	{\n		return min(src + (1.0 - src.a) * dst, dst + (1.0 - dst.a) * src); \n	}\n	else if(blendmode == 5) //Lighten\n	{\n		 return vec4(max(dst, src).rgb, alpha) * alpha + dst * (1.0 - alpha);\n	}\n	else if(blendmode == 6) //Overlay\n	{\n		vec3 value = vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n				(dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n				(dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n		\n	    return vec4(value, alpha) * alpha + dst * (1.0 - alpha);\n	}\n	else if(blendmode == 7) //Softlight\n	{	\n		vec3 value = vec3((src.x <= 0.5) ? (dst.x - (1.0 - 2.0 * src.x) * dst.x * (1.0 - dst.x)) : (((src.x > 0.5) && (dst.x <= 0.25)) ? (dst.x + (2.0 * src.x - 1.0) * (4.0 * dst.x * (4.0 * dst.x + 1.0) * (dst.x - 1.0) + 7.0 * dst.x)) : (dst.x + (2.0 * src.x - 1.0) * (sqrt(dst.x) - dst.x))),\n				(src.y <= 0.5) ? (dst.y - (1.0 - 2.0 * src.y) * dst.y * (1.0 - dst.y)) : (((src.y > 0.5) && (dst.y <= 0.25)) ? (dst.y + (2.0 * src.y - 1.0) * (4.0 * dst.y * (4.0 * dst.y + 1.0) * (dst.y - 1.0) + 7.0 * dst.y)) : (dst.y + (2.0 * src.y - 1.0) * (sqrt(dst.y) - dst.y))),\n				(src.z <= 0.5) ? (dst.z - (1.0 - 2.0 * src.z) * dst.z * (1.0 - dst.z)) : (((src.z > 0.5) && (dst.z <= 0.25)) ? (dst.z + (2.0 * src.z - 1.0) * (4.0 * dst.z * (4.0 * dst.z + 1.0) * (dst.z - 1.0) + 7.0 * dst.z)) : (dst.z + (2.0 * src.z - 1.0) * (sqrt(dst.z) - dst.z))));\n				\n		return vec4(value, alpha) * alpha + dst * (1.0 - alpha);\n	}\n	\n	else if(blendmode == 8) //Hardlight\n	{\n\n		vec3 value = vec3((src.x <= 0.50) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - src.x) * (1.0 - dst.x)),\n			(src.y <= 0.50) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - src.y) * (1.0 - dst.y)),\n			(src.z <= 0.50) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - src.z) * (1.0 - dst.z)));\n		\n		return vec4(value, alpha);\n	}\n	else if(blendmode == 11) //Substract\n    {\n        return vec4((src - dst).rgb, alpha) * alpha + dst * (1.0 - alpha);\n    }\n    else if(blendmode == 12){ //special hardlight for liquify\n\n    		if (abs(src.x) + abs(src.y - 0.50) + abs(src.z - 0.50) < 0.01) return vec4(dst.xyz, alpha);\n\n            if(src.rgb == dst.rgb){\n                return dst;\n            }\n            else{\n                vec3 value = vec3((src.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - src.x) * (1.0 - dst.x)),\n                            (src.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - src.y) * (1.0 - dst.y)),\n                            (src.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - src.z) * (1.0 - dst.z)));\n                return vec4(value, alpha);\n            }\n\n    }\n	\n	return src;\n}\n\n/// <summary>\n/// Fragment shader entry.\n/// <summary>\nvoid main ()\n{\n	// Get samples from both layers\n	vec4 dst = texture2D(Sample0, vTextureCoord);\n	vec4 src = texture2D(Sample1, vTextureCoord);\n	\n	if(blendmode == 0) //Normal or Layer\n	{\n		gl_FragColor = mix(dst, src, src.a);\n	}\n	else if(blendmode == 9)\n	{\n		src.a = alpha;\n		\n		gl_FragColor = mix(dst, src, src.a); //opacity\n	}\n	else if(blendmode == 10){\n		vec4 colorMask = texture2D(maskTexture, vTextureCoord);\n		gl_FragColor = dst * colorMask + src * (1.0 - colorMask);\n	}\n	else\n	{\n		src.a = alpha;\n		// Apply blend operation\n\n		vec4 colour = clamp(blend(src, dst, blendmode), 0.0, 1.0);\n		\n		// Set fragment\n		gl_FragColor.xyz = mix(dst, colour, amount).rgb;\n		gl_FragColor.w = 1.0;\n	}\n}'}),define("text!shaders/saturation_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\n\nuniform sampler2D texture;\nuniform float saturation;\n\nvarying vec2 vTextureCoord;\n\nvoid main() {\n	vec4 color = texture2D(texture, vTextureCoord);\n	\n	/* saturation adjustment */\n	float amount = saturation * 0.5; // Multiply by 0.5 in order to match express flash version\n	float average = (color.r + color.g + color.b) / 3.0;\n	if (amount > 0.0) {\n		color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - amount));\n	} else {\n		color.rgb += (average - color.rgb) * (-amount);\n	}\n	\n	gl_FragColor = color;\n}"}),define("text!shaders/verticalBlur_fragment.shader",[],function(){return"#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform sampler2D uSampler; // this should hold the texture rendered by the horizontal blur pass\nvarying vec2 vTextureCoord;\n \nuniform float blurSize;\n \nvoid main(void)\n{\n   vec4 sum = vec4(0.0);\n \n   // blur in y (vertical)\n   // take nine samples, with the distance blurSize between them\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blurSize)) * 0.05;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blurSize)) * 0.09;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blurSize)) * 0.12;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blurSize)) * 0.15;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blurSize)) * 0.15;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blurSize)) * 0.12;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blurSize)) * 0.09;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blurSize)) * 0.05;\n \n   gl_FragColor = sum;\n}"}),define("text!shaders/horizontalBlur_fragment.shader",[],function(){return"#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float blurSize; \n\nvoid main(void)\n{\n   vec4 sum = vec4(0.0, 0.0, 0.0, 0.0);\n\n   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blurSize, vTextureCoord.y)) * 0.05;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blurSize, vTextureCoord.y)) * 0.09;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blurSize, vTextureCoord.y)) * 0.12;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x - blurSize, vTextureCoord.y)) * 0.15;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x + blurSize, vTextureCoord.y)) * 0.15;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blurSize, vTextureCoord.y)) * 0.12;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blurSize, vTextureCoord.y)) * 0.09;\n   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blurSize, vTextureCoord.y)) * 0.05;\n \n   gl_FragColor = sum;\n}"}),define("text!shaders/colormatrix_fragment.shader",[],function(){return"#ifdef GL_ES\nprecision highp float;\n#endif\n\n\nuniform sampler2D texture;\nuniform mat4 colormatrix;\nvarying vec2 vTextureCoord;\n\nvoid main() {\n	vec4 color = texture2D(texture, vTextureCoord);\n	gl_FragColor = color * colormatrix;\n}"}),define("text!shaders/multiple_actions_effect_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D blendTexture;\nuniform float uAmount;\n\nvoid main(void) {\n\n	vec4 color = texture2D(uSampler, vTextureCoord);\n	\n	vec4 texel = texture2D(blendTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n	vec4 blendColor = vec4(texel.rgb, 1.0);\n	gl_FragColor = mix(color, blendColor, uAmount); \n}"}),define("text!shaders/focalblur_fragment.shader",[],function(){return"#ifdef GL_ES\r\n	precision highp float;\r\n#endif\r\n\r\nuniform sampler2D uSampler;\r\nuniform sampler2D blurTexture;\r\nuniform vec2 center;\r\nuniform float innerRadius;\r\nuniform float outterRadius;\r\nuniform float resolutionRate;\r\nuniform int type;\r\nuniform float rotation;\nuniform float rotateAngle;\r\nvarying vec2 vTextureCoord;\r\n\r\nbool InsideInnerCircle(float x, float y){\r\n\r\n	float centerX = center.x;\r\n	float centerY = center.y / resolutionRate;\r\n	\r\n	if(((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY)) <= (innerRadius * innerRadius)){\r\n		return true;\r\n	}\r\n	else{\r\n		return false;\r\n	}\r\n}\r\n\r\nbool InsideOutterCircle(float x, float y){\r\n\r\n	float centerX = center.x;\r\n	float centerY = center.y / resolutionRate;\r\n	\r\n	if(((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY)) > (innerRadius * innerRadius) && \r\n		((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY)) < (outterRadius * outterRadius)){\r\n		return true;\r\n	}\r\n	else{\r\n		return false;\r\n	}\r\n}\r\n\r\nbool InsideInnerRectancle(float x, float y){\r\n\r\n	float centerX = center.x;\r\n	float centerY = center.y / resolutionRate;\r\n	\r\n	if(rotateAngle == 0.0 || rotateAngle == -180.0 || rotateAngle == -360.0){\n		if(y >= (centerY - innerRadius) && y <= (centerY + innerRadius)){\n	      		return true;\n		}\n		else{\n			return false;\n		}\n	}\r\n	\r\n	if(rotateAngle == -90.0 || rotateAngle == -270.0 ){\n		if(x >= (centerX - innerRadius) && x <= (centerX + innerRadius)){\n      			return true;\n		}\n		else{\n			return false;\n		}\n	}\r\n		\r\n	float rotate = 1.5707963 + rotation;\r\n		\r\n	float point1X = centerX - innerRadius * cos(rotate);\r\n	float point1Y = centerY - innerRadius * sin(rotate);\r\n	\r\n	float point2X = centerX + innerRadius * cos(rotate);\r\n	float point2Y = centerY + innerRadius * sin(rotate);\r\n	\r\n	//y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X = 0; \r\n	//A = -tan(-rotation) B = 1, C = tan(-rotation) * pointX\r\n	//Ax + By + C = 0;\r\n	//y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X = 0;\r\n	//the distance of one point to the line: abs(Ax0 + By0 + C) /sqrt(A*A + B*B)\r\n	\r\n	float A = -tan(-rotation);\r\n	float distance1 = abs(y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X) / sqrt(1.0 + A * A);\r\n	float distance2 = abs(y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X) / sqrt(1.0 + A * A);\r\n	\r\n	if((distance1 + distance2) <= (innerRadius * 2.0))\r\n		return true;\r\n	else \r\n		return false;\r\n}\r\n\r\nbool InsideOutterRectancle(float x, float y){\r\n\r\n	float centerX = center.x;\r\n	float centerY = center.y / resolutionRate;\n	\n	if(rotateAngle == 0.0 || rotateAngle == -180.0 || rotateAngle == -360.0){\n		if(y >= (centerY - outterRadius) && y <= (centerY + outterRadius)){\n	      		return true;\n		}\n		else{\n			return false;\n		}\n	}\n	\n	if(rotateAngle == -90.0 || rotateAngle == -270.0 ){\n		if(x >= (centerX - outterRadius) && x <= (centerX + outterRadius)){\n      			return true;\n		}\n		else{\n			return false;\n		}\n	}\n\r\n	float rotate = 1.5707963 + rotation;\r\n	\r\n	float point1X = centerX - outterRadius * cos(rotate);\r\n	float point1Y = centerY - outterRadius * sin(rotate);\r\n	\r\n	float point2X = centerX + outterRadius * cos(rotate);\r\n	float point2Y = centerY + outterRadius * sin(rotate);\r\n	\r\n	//y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X = 0; \r\n	//A = -tan(-rotation) B = 1, C = tan(-rotation) * pointX\r\n	//Ax + By + C = 0;\r\n	//y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X = 0;\r\n	//the distance of one point to the line: abs(Ax0 + By0 + C) /sqrt(A*A + B*B)\r\n	\r\n	float A = -tan(-rotation);\r\n	float distance1 = abs(y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X) / sqrt(1.0 + A * A);\r\n	float distance2 = abs(y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X) / sqrt(1.0 + A * A);\r\n	\r\n	if((distance1 + distance2) <= (outterRadius * 2.0))\r\n		return true;\r\n	else \r\n		return false;\r\n}\r\n\r\nvec4 getRadialGradientColor(){\r\n\r\n	float centerX = center.x;\r\n	float centerY = center.y / resolutionRate;\r\n	\r\n	float x = vTextureCoord.x;\r\n	float y = vTextureCoord.y / resolutionRate;\r\n	\r\n	float distance = sqrt((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY));\r\n	\r\n	vec4 color;\r\n	\r\n	if(distance < innerRadius){\r\n		color = vec4(0.0, 0.0, 0.0, 1.0);\r\n	}\r\n	else if(distance <= outterRadius && distance >= innerRadius){\r\n		float intensity = (distance - innerRadius) / (outterRadius - innerRadius);\r\n		color = vec4(intensity, intensity, intensity, 1.0);\r\n	}\r\n	else\r\n		color = vec4(1.0, 1.0, 1.0, 1.0);\r\n	\r\n	return color;\r\n}\r\n\r\nvec4 getLinearGradientColor(){\r\n\r\n	float x = vTextureCoord.x;\r\n	float y = vTextureCoord.y / resolutionRate;\r\n	\r\n	vec4 color;\r\n			\r\n	if(InsideInnerRectancle(x, y)){\r\n		color = vec4(0.0, 0.0, 0.0, 1.0);\r\n	}\r\n	else if(InsideOutterRectancle(x, y) && !InsideInnerRectancle(x, y)){\r\n		float centerX = center.x;\r\n		float centerY = center.y / resolutionRate;\r\n		\r\n		float rotate = 1.5707963 - rotation;\r\n	\r\n		float point1X = centerX - innerRadius * cos(rotate);\r\n		float point1Y = centerY - innerRadius * sin(rotate);\r\n		\r\n		float point2X = centerX + innerRadius * cos(rotate);\r\n		float point2Y = centerY + innerRadius * sin(rotate);\r\n		\r\n		//y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X = 0; \r\n		//A = -tan(-rotation) B = 1, C = tan(-rotation) * point1X - point1Y\r\n		//Ax + By + C = 0;\r\n		//y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X = 0;\r\n		//the distance of one point to the line: abs(Ax0 + By0 + C) /sqrt(A*A + B*B)\r\n		\r\n		float A = -tan(-rotation);\r\n		float distance1 = abs(y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X) / sqrt(1.0 + A * A);\r\n		float distance2 = abs(y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X) / sqrt(1.0 + A * A);\r\n		\r\n		if(distance1 >= distance2){\r\n			float intensity = distance2 / (outterRadius - innerRadius);\r\n			color = vec4(intensity, intensity, intensity, 1.0);\r\n		}\r\n		else if(distance2 >= distance1){\r\n			float intensity = distance1 / (outterRadius - innerRadius);\r\n			color = vec4(intensity, intensity, intensity, 1.0);\r\n		}\r\n		else\r\n		{\r\n			// this is for handling vertical for Mac\r\n			float intensity = 0.0;\r\n			if(centerX > x)\r\n			  intensity = (centerX - x - innerRadius) / (outterRadius - innerRadius);\r\n			else\r\n			  intensity = (x - centerX - innerRadius) / (outterRadius - innerRadius);\r\n			  \r\n			color = vec4(intensity, intensity, intensity, 1.0);\r\n		}\r\n	}\r\n	else\r\n		color = vec4(1.0, 1.0, 1.0, 1.0);\r\n		\r\n	return color;\r\n}\r\n\r\nvoid main(){\r\n\r\n	float x = vTextureCoord.x;\r\n	float y = vTextureCoord.y / resolutionRate;\r\n	\r\n	if(type == 0){\r\n		if(InsideInnerCircle(x, y) || InsideOutterCircle(x, y)){\r\n			vec4 color = texture2D(uSampler, vTextureCoord);\r\n			vec4 colorBlur = texture2D(blurTexture, vTextureCoord);\r\n			vec4 colorMask = getRadialGradientColor();\r\n			gl_FragColor = colorBlur * colorMask + color * (1.0 - colorMask);\r\n		}\r\n		else\r\n		{\r\n			gl_FragColor = texture2D(blurTexture, vTextureCoord);\r\n		}\r\n	}\r\n	else{\n		if(rotateAngle == 0.0 || rotateAngle == -90.0 || rotateAngle == -270.0 || rotateAngle == -180.0 || rotateAngle == -360.0)\n		{\n			float centerX = center.x;\r\n			float centerY = center.y / resolutionRate;\n		\n			if(rotateAngle == 0.0 || rotateAngle == -180.0 || rotateAngle == -360.0){\n				if(y >= (centerY - outterRadius) && y <= (centerY + outterRadius)){\n			      		vec4 color = texture2D(uSampler, vTextureCoord);\r\n			      		vec4 colorBlur = texture2D(blurTexture, vTextureCoord);\r\n			      		vec4 colorMask = getLinearGradientColor();\r\n			      		gl_FragColor = colorBlur * colorMask + color * (1.0 - colorMask);\n				}\n				else{\n					gl_FragColor = texture2D(blurTexture, vTextureCoord);\n				}\n			}\n			if(rotateAngle == -90.0 || rotateAngle == -270.0 ){\n				if(x >= (centerX - outterRadius) && x <= (centerX + outterRadius)){\n			      		vec4 color = texture2D(uSampler, vTextureCoord);\r\n			      		vec4 colorBlur = texture2D(blurTexture, vTextureCoord);\r\n			      		vec4 colorMask = getLinearGradientColor();\r\n			      		gl_FragColor = colorBlur * colorMask + color * (1.0 - colorMask);\n				}\n				else{\n					gl_FragColor = texture2D(blurTexture, vTextureCoord);\n				}\n			}\n		}\n		else\n		{\r\n			if(InsideInnerRectancle(x, y) || InsideOutterRectancle(x, y)){\r\n				vec4 color = texture2D(uSampler, vTextureCoord);\r\n				vec4 colorBlur = texture2D(blurTexture, vTextureCoord);\r\n				vec4 colorMask = getLinearGradientColor();\r\n				gl_FragColor = colorBlur * colorMask + color * (1.0 - colorMask);\r\n			}\r\n			else\r\n			{\r\n				gl_FragColor = texture2D(blurTexture, vTextureCoord);\r\n			}\n		}\r\n	}\r\n}"}),define("text!shaders/blur_fragment.shader",[],function(){return"#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform sampler2D texture;\nuniform vec2 delta;\nvarying vec2 vTextureCoord;\n\n\nfloat random(vec3 scale, float seed){\n	return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvec4 getBlurColor(){\n	vec4 color = vec4(0.0);\n	float total = 0.0;\n	\n	float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n	\n	for (float t = -20.0; t <= 20.0; t++) {\n		float percent = (t + offset - 0.5) / 20.0;\n		float weight = 1.0 - abs(percent);\n		vec4 sample = texture2D(texture, vTextureCoord + delta * percent);\n		\n		color += sample * weight;\n		total += weight;\n	}\n	\n	color = color / total;\n	\n	return color;\n}\n\nvoid main(){\n\n	float x = vTextureCoord.x;\n	float y = vTextureCoord.y;\n	\n	gl_FragColor = getBlurColor();\n}"}),define("text!shaders/autofix_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;	\n\nuniform sampler2D red;	\nuniform sampler2D green;	\nuniform sampler2D blue;\n\nvoid main() {\n	vec4 color = texture2D(uSampler, vTextureCoord);\n	\n	vec2 indexRed = vec2(color.r, 0.0);\n    vec4 redColor = texture2D(red, indexRed);\n    \n    vec2 indexGreen = vec2(color.g, 0.0);\n    vec4 greenColor = texture2D(green, indexGreen);\n    \n    vec2 indexBlue = vec2(color.b, 0.0);\n    vec4 blueColor = texture2D(blue, indexBlue);\n	\n	gl_FragColor = vec4(redColor.r, greenColor.g, blueColor.b, 1.0);\n}"}),define("text!shaders/invert_fragment.shader",[],function(){return"#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform sampler2D texture;\nvarying vec2 vTextureCoord;\n\nvoid main()\n{\n	vec4 color = texture2D(texture, vTextureCoord);\n	gl_FragColor = vec4((1.0 - color.rgb), color.w);\n}"}),define("text!shaders/levels_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\n/*\n** Gamma correction\n** Details: http://blog.mouaif.org/2009/01/22/photoshop-gamma-correction-shader/\n*/\n\n#define GammaCorrection(color, gamma)								pow(color, vec3(1.0 / gamma))\n\n/*\n** Levels control (input (+gamma), output)\n** Details: http://blog.mouaif.org/2009/01/28/levels-control-shader/\n*/\n\n#define LevelsControlInputRange(color, minInput, maxInput)				min(max(color - vec3(minInput), vec3(0.0)) / (vec3(maxInput) - vec3(minInput)), vec3(1.0))\n#define LevelsControlInput(color, minInput, gamma, maxInput)				GammaCorrection(LevelsControlInputRange(color, minInput, maxInput), gamma)\n#define LevelsControlOutputRange(color, minOutput, maxOutput) 			mix(vec3(minOutput), vec3(maxOutput), color)\n#define LevelsControl(color, minInput, gamma, maxInput, minOutput, maxOutput) 	LevelsControlOutputRange(LevelsControlInput(color, minInput, gamma, maxInput), minOutput, maxOutput)\n\nuniform float levelsMin;\nuniform float levelsMax;\n\nuniform sampler2D Sample0;\nvarying vec2 vTextureCoord;\n\nvoid main(){\n\n	vec4 color = texture2D(Sample0, vTextureCoord);\n	gl_FragColor = vec4(LevelsControl(color.rgb, levelsMin, 0.58, levelsMax, 0.2, 1.0), 1.0);\n}"}),define("text!shaders/threshold_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float amount;\n\nvoid main(void) {\n\n	vec4 color = texture2D(uSampler, vTextureCoord);\n	color.r = (color.r >= amount ? amount : 0.0);\n	color.g = (color.g >= amount ? amount : 0.0);\n	color.b = (color.b >= amount ? amount : 0.0);\n	color.a = (color.a >= amount ? amount : 0.0);\n	\n	gl_FragColor = color;\n  \n}"}),define("text!shaders/gradient_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float resolutionRate;\nuniform int type;\n\nvec4 getRadialGradientColor(){\n	\n	float centerX = 0.5;\n	float centerY = 0.5 / resolutionRate;\n	\n	float x = vTextureCoord.x;\n	float y = vTextureCoord.y / resolutionRate;\n	\n	float distance = sqrt((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY));\n	\n	vec4 color;\n	\n	float innerRadius = 0.0;\n	float outterRadius = 0.5;\n	\n	if(type == 0){\n		innerRadius = 60.0 / 255.0;\n		color = vec4(0.0, 0.0, 0.0, 1.0);\n	}\n	else if(type == 1){\n		innerRadius = 50.0 / 255.0;\n		color = vec4(0.0, 1.0, 0.0, 1.0);\n	}\n	\n	if(distance < innerRadius){\n		color = vec4(1.0, 1.0, 1.0, 1.0);\n	}\n	else if(distance <= outterRadius && distance >= innerRadius){\n		float intensity = (distance - innerRadius) / (outterRadius - innerRadius);\n		color = vec4(mix(color.rgb, vec3((1.0 - intensity), (1.0 - intensity), (1.0 - intensity)), (1.0 - intensity)), 1.0);\n	}\n		\n	return color;\n}\n\nbool InsideInnerRectancle(float x, float y){\n\n	float innerRadius = 85.0 / (255.0 * 2.0);\n	float rotation = -40.0 * 3.1415926 / 180.0;\n	\n	float centerX = 0.5;\n	float centerY = 0.5 / resolutionRate;\n\n	float rotate = 1.5707963 + rotation;\n		\n	float point1X = centerX - innerRadius * cos(rotate);\n	float point1Y = centerY - innerRadius * sin(rotate);\n	\n	float point2X = centerX + innerRadius * cos(rotate);\n	float point2Y = centerY + innerRadius * sin(rotate);\n	\n	//y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X = 0; \n	//A = -tan(-rotation) B = 1, C = tan(-rotation) * pointX\n	//Ax + By + C = 0;\n	//y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X = 0;\n	//the distance of one point to the line: abs(Ax0 + By0 + C) /sqrt(A*A + B*B)\n	\n	float A = -tan(-rotation);\n	float distance1 = abs(y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X) / sqrt(1.0 + A * A);\n	float distance2 = abs(y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X) / sqrt(1.0 + A * A);\n	\n	if((distance1 + distance2) <= (innerRadius * 2.0))\n		return true;\n	else \n		return false;\n}\n\nbool InsideOutterRectancle(float x, float y){\n\n	float outterRadius = 80.0 / 255.0 + 85.0 / (255.0 * 2.0);\n	float rotation = -40.0 * 3.1415926 / 180.0;\n	\n	float centerX = 0.5;\n	float centerY = 0.5 / resolutionRate;\n	\n	float rotate = 1.5707963 + rotation;\n	\n	float point1X = centerX - outterRadius * cos(rotate);\n	float point1Y = centerY - outterRadius * sin(rotate);\n	\n	float point2X = centerX + outterRadius * cos(rotate);\n	float point2Y = centerY + outterRadius * sin(rotate);\n	\n	//y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X = 0; \n	//A = -tan(-rotation) B = 1, C = tan(-rotation) * pointX\n	//Ax + By + C = 0;\n	//y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X = 0;\n	//the distance of one point to the line: abs(Ax0 + By0 + C) /sqrt(A*A + B*B)\n	\n	float A = -tan(-rotation);\n	float distance1 = abs(y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X) / sqrt(1.0 + A * A);\n	float distance2 = abs(y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X) / sqrt(1.0 + A * A);\n	\n	if((distance1 + distance2) <= (outterRadius * 2.0))\n		return true;\n	else \n		return false;\n}\n\n\nvec4 getLinearGradientColor(){\n\n	float x = vTextureCoord.x;\n	float y = vTextureCoord.y / resolutionRate;\n	float rotation = -40.0 * 3.1415926 / 180.0;\n	\n	vec4 color;\n			\n	if(InsideInnerRectancle(x, y)){\n		color = vec4(1.0, 1.0, 1.0, 1.0);\n	}\n	else if(InsideOutterRectancle(x, y) && !InsideInnerRectancle(x, y)){\n	\n		float innerRadius = 85.0 / (255.0 * 2.0);\n		float outterRadius = 80.0 / 255.0 + 85.0 / (255.0 * 2.0);\n		float centerX = 0.5;\n		float centerY = 0.5 / resolutionRate;\n		\n		float rotate = 1.5707963 - rotation;\n	\n		float point1X = centerX - innerRadius * cos(rotate);\n		float point1Y = centerY - innerRadius * sin(rotate);\n		\n		float point2X = centerX + innerRadius * cos(rotate);\n		float point2Y = centerY + innerRadius * sin(rotate);\n		\n		//y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X = 0; \n		//A = -tan(-rotation) B = 1, C = tan(-rotation) * point1X - point1Y\n		//Ax + By + C = 0;\n		//y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X = 0;\n		//the distance of one point to the line: abs(Ax0 + By0 + C) /sqrt(A*A + B*B)\n		\n		float A = -tan(-rotation);\n		float distance1 = abs(y - tan(-rotation) * x - point1Y + tan(-rotation) * point1X) / sqrt(1.0 + A * A);\n		float distance2 = abs(y - tan(-rotation) * x - point2Y + tan(-rotation) * point2X) / sqrt(1.0 + A * A);\n		\n		if(distance1 >= distance2){\n			float intensity = distance2 / (outterRadius - innerRadius);\n			color = vec4((1.0 - intensity), (1.0 - intensity), (1.0 - intensity), 1.0);\n		}\n		else if(distance2 >= distance1){\n			float intensity = distance1 / (outterRadius - innerRadius);\n			color = vec4((1.0 - intensity), (1.0 - intensity), (1.0 - intensity), 1.0);\n		}\n	}\n	else\n		color = vec4(0.0, 0.0, 0.0, 0.0);\n		\n	return color;\n}\n\nvoid main(void) {\n\n	gl_FragColor = (type == 2) ? getLinearGradientColor() : getRadialGradientColor();\n  \n}"}),define("text!shaders/unsharpmask_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D blurredTexture;\n\nuniform float amount;\n\nvoid main(void) {\n\n	vec4 color = texture2D(uSampler, vTextureCoord);\n    vec4 blurColor = texture2D(blurredTexture, vTextureCoord);\n    gl_FragColor = mix(blurColor, color, 1.0 + amount);\n  \n}"}),define("text!shaders/copychanel_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nvoid main() {\n	vec4 color = texture2D(uSampler, vTextureCoord);\n    color.a = color.b;\n	gl_FragColor = color;\n}"}),define("text!shaders/copypixel_fragment.shader",[],function(){return"# ifdef GL_ES\nprecision highp float;\n# endif\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D sourceTexture;\nuniform sampler2D alphaTexture;\n\nvoid main() {\n	vec4 color = texture2D(uSampler, vTextureCoord);\n    vec4 sourceColor = texture2D(sourceTexture, vTextureCoord);\n    vec4 alphaColor = texture2D(alphaTexture, vTextureCoord);\n\n	gl_FragColor = sourceColor * alphaColor.a + color * (1.0 - alphaColor.a);\n}"}),define("text!shaders/liquify_fragment.shader",[],function(){return"#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform sampler2D texture;\nuniform sampler2D dis_tex;\nuniform vec2 texSize;\nvarying vec2 vTextureCoord;\n\nuniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform int liquify_mode; \n\nvoid main(){\n\n	//this is for enlarge and shrink\n	if(liquify_mode == 1 || liquify_mode == 2){\n		vec2 coord = vTextureCoord * texSize;\n		coord -= center;\n		\n		float dist = length(coord);\n		if(dist < radius){\n			float percent = 1.0 - ((radius - dist) / radius) * strength;\n			percent = pow(percent, 5.0);\n			coord = coord * percent;\n			coord += center;\n			gl_FragColor = texture2D(texture, coord / texSize);\n		}\n		else\n		{\n			gl_FragColor = texture2D(texture, vTextureCoord);\n		}\n	}// this is for thin and tall\n	else if(liquify_mode == 3 || liquify_mode == 4 || liquify_mode == 5){\n		 vec4 displacement = texture2D(dis_tex, vTextureCoord);\n		 float x = vTextureCoord.x + (displacement.g * 256.0 - 128.0) * strength / 256.0;\n		 float y = vTextureCoord.y + (displacement.b * 256.0 - 128.0) * strength / 256.0;\n		 gl_FragColor = texture2D(texture, vec2(x, y));\n	}\n	else if(liquify_mode == 0){\n		gl_FragColor = texture2D(texture, vTextureCoord);\n	}\n	\n	//gl_FragColor = texture2D(dis_tex, vTextureCoord);\n}"}),define("app/WebGLShaders",["jquery","text!shaders/vertex.shader","text!shaders/passthru_fragment.shader","text!shaders/contrast_fragment.shader","text!shaders/color_fragment.shader","text!shaders/test_fragment.shader","text!shaders/bicubic_fragment.shader","text!shaders/overlay_fragment.shader","text!shaders/mapping_fragment.shader","text!shaders/lookup_fragment.shader","text!shaders/waterdown_fragment.shader","text!shaders/vignette_fragment.shader","text!shaders/noise_fragment.shader","text!shaders/desaturate_fragment.shader","text!shaders/sharpen_fragment.shader","text!shaders/pixelate_fragment.shader","text!shaders/blend_fragment.shader","text!shaders/saturation_fragment.shader","text!shaders/verticalBlur_fragment.shader","text!shaders/horizontalBlur_fragment.shader","text!shaders/colormatrix_fragment.shader","text!shaders/multiple_actions_effect_fragment.shader","text!shaders/focalblur_fragment.shader","text!shaders/blur_fragment.shader","text!shaders/autofix_fragment.shader","text!shaders/invert_fragment.shader","text!shaders/levels_fragment.shader","text!shaders/threshold_fragment.shader","text!shaders/gradient_fragment.shader","text!shaders/unsharpmask_fragment.shader","text!shaders/copychanel_fragment.shader","text!shaders/copypixel_fragment.shader","text!shaders/liquify_fragment.shader"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_){function H(e,t){var n=gl.createShader(t);return gl.shaderSource(n,e),gl.compileShader(n),gl.getShaderParameter(n,gl.COMPILE_STATUS)?n:(console.log(gl.getShaderInfoLog(n)),null)}function B(e,t,n){var r=H(n,gl.VERTEX_SHADER),i=H(t,gl.FRAGMENT_SHADER),s=gl.createProgram();gl.attachShader(s,r),gl.attachShader(s,i),gl.linkProgram(s),gl.getProgramParameter(s,gl.LINK_STATUS)||console.log("Could not initialize shaders"),s.aVertexPosition=gl.getAttribLocation(s,"aVertexPosition"),gl.enableVertexAttribArray(s.aVertexPosition),s.aTextureCoord=gl.getAttribLocation(s,"aTextureCoord"),gl.enableVertexAttribArray(s.aTextureCoord),s.uXoffset=gl.getUniformLocation(s,"uXoffset"),s.uYoffset=gl.getUniformLocation(s,"uYoffset"),s.uScaleX=gl.getUniformLocation(s,"uScaleX"),s.uScaleY=gl.getUniformLocation(s,"uScaleY"),s.uFlip=gl.getUniformLocation(s,"uFlip"),s.uRotation=gl.getUniformLocation(s,"uRotation"),s.uResolution=gl.getUniformLocation(s,"uResolution"),s.uSampler=gl.getUniformLocation(s,"uSampler");switch(e){case"passthru":break;case"overlay":s.uSamplerCopy=gl.getUniformLocation(s,"uSamplerCopy"),s.uOverlayWidth=gl.getUniformLocation(s,"uOverlayWidth"),s.uOverlayHeight=gl.getUniformLocation(s,"uOverlayHeight"),s.uOverlayOffsetX=gl.getUniformLocation(s,"uOverlayOffsetX"),s.uOverlayOffsetY=gl.getUniformLocation(s,"uOverlayOffsetY"),s.textureSizeWidth=gl.getUniformLocation(s,"textureSizeWidth"),s.textureSizeHeight=gl.getUniformLocation(s,"textureSizeHeight");break;case"contrast":s.uContrast=gl.getUniformLocation(s,"uContrast"),s.uBrightness=gl.getUniformLocation(s,"uBrightness");break;case"color":s.uHue=gl.getUniformLocation(s,"uHue"),s.uSaturation=gl.getUniformLocation(s,"uSaturation"),s.uVibrance=gl.getUniformLocation(s,"uVibrance"),s.uWarmth=gl.getUniformLocation(s,"uWarmth");break;case"test":s.uParam1=gl.getUniformLocation(s,"uParam1"),s.uParam2=gl.getUniformLocation(s,"uParam2");break;case"bicubic":s.textureSizeWidth=gl.getUniformLocation(s,"textureSizeWidth"),s.textureSizeHeight=gl.getUniformLocation(s,"textureSizeHeight"),s.texelSizeX=gl.getUniformLocation(s,"texelSizeX"),s.texelSizeY=gl.getUniformLocation(s,"texelSizeY");break;case"mapping":s.uAmount=gl.getUniformLocation(s,"uAmount"),s.uRed=gl.getUniformLocation(s,"red"),s.uGreen=gl.getUniformLocation(s,"green"),s.uBlue=gl.getUniformLocation(s,"blue");break;case"lookup":s.uAmount=gl.getUniformLocation(s,"uAmount"),s.uData=gl.getUniformLocation(s,"uData");break;case"blend":s.blendmode=gl.getUniformLocation(s,"blendmode"),s.alpha=gl.getUniformLocation(s,"alpha"),s.amount=gl.getUniformLocation(s,"amount");break;case"vignette":s.size=gl.getUniformLocation(s,"size"),s.colormode=gl.getUniformLocation(s,"colormode");break;case"noise":s.amount=gl.getUniformLocation(s,"amount");break;case"saturation":s.saturation=gl.getUniformLocation(s,"saturation");break;case"horizontalBlur":case"verticalBlur":s.blurSize=gl.getUniformLocation(s,"blurSize");break;case"multipleActionsEffect":s.name="multipleActionsEffect";case"waterdown":case"desaturate":s.uAmount=gl.getUniformLocation(s,"uAmount");break;case"colormatrix":s.colormatrix=gl.getUniformLocation(s,"colormatrix");break;case"focalblur":s.center=gl.getUniformLocation(s,"center"),s.innerRadius=gl.getUniformLocation(s,"innerRadius"),s.outterRadius=gl.getUniformLocation(s,"outterRadius"),s.resolutionRate=gl.getUniformLocation(s,"resolutionRate"),s.blurTexture=gl.getUniformLocation(s,"blurTexture"),s.type=gl.getUniformLocation(s,"type"),s.rotation=gl.getUniformLocation(s,"rotation"),s.rotateAngle=gl.getUniformLocation(s,"rotateAngle");break;case"blur":s.delta=gl.getUniformLocation(s,"delta");break;case"autofix":s.uRed=gl.getUniformLocation(s,"red"),s.uGreen=gl.getUniformLocation(s,"green"),s.uBlue=gl.getUniformLocation(s,"blue");break;case"levels":s.levelsMin=gl.getUniformLocation(s,"levelsMin"),s.levelsMax=gl.getUniformLocation(s,"levelsMax");break;case"threshold":s.amount=gl.getUniformLocation(s,"amount");break;case"gradient":s.resolutionRate=gl.getUniformLocation(s,"resolutionRate"),s.type=gl.getUniformLocation(s,"type");break;case"unsharpmask":s.amount=gl.getUniformLocation(s,"amount"),s.blurredTexture=gl.getUniformLocation(s,"blurredTexture");break;case"copypixel":s.sourceTexture=gl.getUniformLocation(s,"sourceTexture"),s.alphaTexture=gl.getUniformLocation(s,"alphaTexture");break;case"liquify":s.center=gl.getUniformLocation(s,"center"),s.radius=gl.getUniformLocation(s,"radius"),s.strength=gl.getUniformLocation(s,"strength"),s.texSize=gl.getUniformLocation(s,"texSize"),s.dis_tex=gl.getUniformLocation(s,"dis_tex"),s.liquify_mode=gl.getUniformLocation(s,"liquify_mode")}P[e]=s}function j(e,t){return D=P[e],gl.useProgram(D),e=="blend"?(gl.uniform1i(D.blendmode,t),gl.uniform1f(D.alpha,1),gl.uniform1f(D.amount,1)):e=="contrast"?(gl.uniform1f(D.uContrast,0),gl.uniform1f(D.uBrightness,0)):e=="color"&&(gl.uniform1f(D.uHue,0),gl.uniform1f(D.uSaturation,0),gl.uniform1f(D.uVibrance,0),gl.uniform1f(D.uWarmth,0)),D}function F(){B("passthru",n,t),B("contrast",r,t),B("color",i,t),B("test",s,t),B("bicubic",o,t),B("overlay",u,t),B("mapping",a,t),B("lookup",f,t),B("waterdown",l,t),B("vignette",c,t),B("noise",h,t),B("desaturate",p,t),B("sharpen",d,t),B("pixelate",v,t),B("saturation",g,t),B("blend",m,t),B("verticalBlur",y,t),B("horizontalBlur",b,t),B("colormatrix",w,t),B("multipleActionsEffect",E,t),B("focalblur",S,t),B("blur",x,t),B("autofix",T,t),B("invert",N,t),B("levels",C,t),B("threshold",k,t),B("gradient",L,t),B("unsharpmask",A,t),B("copychanel",O,t),B("copypixel",M,t),B("liquify",_,t),j("passthru")}var D=null,P={};return{init:F,setProgram:j,getProgram:function(){return D}}}),define("app/image/ChannelMap",[],function(){function e(){return this.knLog127Over255=Math.log(127/255),this.minin=0,this.midin=1,this.maxin=255,this.minout=0,this.maxout=255,this.mid=.5,this.Reset=function(){this.minout=0,this.maxout=255,this.midin=1,this.minin=0,this.maxin=255,this.mid=.5},this.flat=function(){return Boolean(minout==0&&maxout==255&&mid==.5&&minin==0&&maxin==255)},this.SetMid=function(e){mid=(e-minin)/(maxin-minin),midin=MidToIn(mid)},this.MidToIn=function(e){return Math.min(Math.max(Math.pow(9.99,2*e-1),.1),9.99)},this.map=function(e){return e=(e-this.minin)/(this.maxin-this.minin),e=Math.pow(e,this.midin),e=this.minout+e*(this.maxout-this.minout),e>this.maxout?e=this.maxout:e<this.minout&&(e=this.minout),Math.round(e)},this.ComputeArray=function(e){var t,n=new Array,r=0;while(r++<256)t=this.map(r),t<0?t=0:t>255&&(t=255),n.push(t<<e);return n},this}return e}),define("app/image/ColorMatrix",[],function(){function e(){return this.LUMA_R=.212671,this.LUMA_G=.71516,this.LUMA_B=.072169,this.LUMA_R2=.3086,this.LUMA_G2=.6094,this.LUMA_B2=.082,this.ONETHIRD=1/3,this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.transformMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0],this.Colorize=function(e){var t,n,r,i=1,s=1,o=e/60,u=Math.floor(e/60),a=o-u,f=s*(1-i),l=s*(1-i*a),c=s*(1-i*(1-a));switch(u){case 0:t=1,n=c,r=f;break;case 1:t=l,n=1,r=f;break;case 2:t=f,n=1,r=c;break;case 3:t=f,n=l,r=1;break;case 4:t=c,n=f,r=1;break;case 5:t=1,n=f,r=l;break;case 6:t=1,n=c,r=f}return this.concat([t*this.LUMA_R2,t*this.LUMA_G2,t*this.LUMA_B2,0,0,n*this.LUMA_R2,n*this.LUMA_G2,n*this.LUMA_B2,0,0,r*this.LUMA_R2,r*this.LUMA_G2,r*this.LUMA_B2,0,0,0,0,0,1,0])},this.concat=function(e){var t=[],n=0,r,i;for(i=0;i<4;i++){for(r=0;r<5;r++)t[n+r]=e[n]*this.matrix[r]+e[n+1]*this.matrix[r+5]+e[n+2]*this.matrix[r+10]+e[n+3]*this.matrix[r+15]+(r==4?e[n+4]:0);n+=5}var s=[],o=0;for(var n=0;n<4;n++){for(var u=0;u<4;u++)s[o+u]=t[o+n]*this.transformMatrix[u]+t[o+n+1]*this.transformMatrix[u+4]+t[o+n+2]*this.transformMatrix[u+8]+t[o+n+3]*this.transformMatrix[u+12]+t[o+n+4]*this.transformMatrix[u+16];o+=4}return s},this.AdjustSaturation=function(e){var t,n,r,i;return t=1-e,n=t*this.LUMA_R,r=t*this.LUMA_G,i=t*this.LUMA_B,this.concat([n+e,r,i,0,0,n,r+e,i,0,0,n,r,i+e,0,0,0,0,0,1,0])},this.AdjustBrightness=function(e){return this.concat([1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0])},this.AdjustContrast=function(e){return e+=1,this.concat([e,0,0,0,128*(1-e),0,e,0,0,128*(1-e),0,0,e,0,128*(1-e),0,0,0,1,0])},this.Desaturate=function(){return this.concat([this.LUMA_R,this.LUMA_G,this.LUMA_B,0,0,this.LUMA_R,this.LUMA_G,this.LUMA_B,0,0,this.LUMA_R,this.LUMA_G,this.LUMA_B,0,0,0,0,0,1,0])},this.Invert=function(){return this.concat([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},this.Threshold=function(e){var t=256;return this.concat([this.LUMA_R*t,this.LUMA_G*t,this.LUMA_B*t,0,-t*e,this.LUMA_R*t,this.LUMA_G*t,this.LUMA_B*t,0,-t*e,this.LUMA_R*t,this.LUMA_G*t,this.LUMA_B*t,0,-t*e,0,0,0,1,0])},this.BlackAndWhite=function(e,t,n){return this.concat([e,t,n,0,0,e,t,n,0,0,e,t,n,0,0,0,0,0,1,0])},this}return e}),define("app/WebGLEffects",["app/image/ChannelMap","app/image/ColorMatrix"],function(e,t){function o(){return s}function u(){for(var e=0;e<r.length;e++)gl.deleteFramebuffer(r[e]);r=[];for(var e=0;e<i.length;e++)gl.deleteTexture(i[e]);i=[]}function a(e){function m(e,n){t==null&&(t=document.createElement("canvas")),t.width=e,t.height=n;var r=t.getContext("2d");return r.clearRect(0,0,t.width,t.height),r}var t=null;e&&f(e,!0);var n=WebGLShaders.getProgram();gl.uniform1f(n.uAmount,1);var r=null,i=m(170,100),s=i.createImageData(Canvas.getImageWidth(),Canvas.getImageHeight()),o=Canvas.getImageWidth()*Canvas.getImageHeight()*4;if(!e||e.actions.length==1){r=WebGL.getPixelArray(!0);for(var u=0;u<o;u++)s.data[u]=r[u]}else{r=WebGL.getPixelsForMultiActsEffect();var a=Canvas.getImageWidth(),l=Canvas.getImageHeight();for(var c=0;c<l;c++)for(var u=0;u<a;u++){var h=(c*a+u)*4,p=((l-1-c)*a+u)*4;for(var d=0;d<4;d++)s.data[p+d]=r[h+d]}}Canvas.getImageWidth()>170?i.putImageData(s,-1*(Canvas.getImageWidth()-170)/2,0):i.putImageData(s,0,-1*(Canvas.getImageHeight()-100)/2);var v=new Image;return v.src=t.toDataURL(),v}function f(e,t){if(e.actions.length==1)if(e.actions[0].type=="mapping"){console.log("setEffect = mapping");var r=WebGLShaders.setProgram("mapping");gl.uniform1i(r.uRed,1),gl.uniform1i(r.uGreen,2),gl.uniform1i(r.uBlue,3);for(var i=0;i<n.length;i++)gl.deleteTexture(n[i]);n=[];var s=p(e.actions[0].param.red,"red");n.push(s);var o=p(e.actions[0].param.green,"green");n.push(o);var u=p(e.actions[0].param.blue,"blue");n.push(u),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,s),gl.activeTexture(gl.TEXTURE0+2),gl.bindTexture(gl.TEXTURE_2D,o),gl.activeTexture(gl.TEXTURE0+3),gl.bindTexture(gl.TEXTURE_2D,u)}else if(e.actions[0].type=="lookup"){console.log("setEffect = lookup");var r=WebGLShaders.setProgram("lookup");gl.uniform1i(r.uData,1);for(var i=0;i<n.length;i++)gl.deleteTexture(n[i]);n=[];var a=p(e.actions[0].param.data,"lookup");n.push(a),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,a)}else e.actions[0].type=="waterdown"?WebGLShaders.setProgram("waterdown"):e.actions[0].type=="desaturate"&&WebGLShaders.setProgram("desaturate");else h(e,WebGL.getDisplayTexture()),t==0&&WebGL.loadEffectTexture("multipleActionsEffect")}function l(e){var t=e>>>16&255,n=e>>>8&255,r=e&255,i=255,s=new Uint8Array([t,n,r,i]),o=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,o),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,s),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),o}function c(e){var t=new Uint8Array(Canvas.getImageWidth()*Canvas.getImageHeight()*4);gl.readPixels(0,0,Canvas.getImageWidth(),Canvas.getImageHeight(),gl.RGBA,gl.UNSIGNED_BYTE,t),WebGL.handleLoadedTexture(e,t,!1,Canvas.getImageWidth(),Canvas.getImageHeight())}function h(e,n){if(Canvas.getImageHeight()>2048||Canvas.getImageWidth()>2048){var o=Math.round(Canvas.getImageWidth()/2),a=Math.round(Canvas.getImageHeight()/2);WebGL.setFramebufferSize(o,a),s=!0}var f=[],h=e;u();for(var d=0;d<2;d++){var v=WebGL.createAndSetupTexture(gl);i.push(v),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,Canvas.getImageWidth(),Canvas.getImageHeight(),0,gl.RGBA,gl.UNSIGNED_BYTE,null);var m=gl.createFramebuffer();m.width=Canvas.getImageWidth(),m.height=Canvas.getImageHeight(),r.push(m),gl.bindFramebuffer(gl.FRAMEBUFFER,m),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,v,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,n),f[0]=n;var g=0,y=[];n.name="original_render",y.push(n);var b=0;for(var w=0;w<h.actions.length;w++){if(h.actions[w].target!=null){if(h.actions[w].type!="merge"&&y[g].name!="original_render"){var v=gl.createTexture();v.name=y[g].name,c(v),y[g]=v}g=h.actions[w].target}else if(g==0&&h.actions[w].type=="duplicate"&&y[g].name!="original_render"||h.actions[w].type=="gradient"){var v=gl.createTexture();v.name=y[g].name,c(v),y[g]=v}gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,y[g]),f[0]=y[g],WebGL.setFramebuffer(r[b%2],Canvas.getImageWidth(),Canvas.getImageHeight());switch(h.actions[w].type){case"duplicate":g+=1,y.splice(g,0,y[g-1]);continue;case"contrast":var E=WebGLShaders.setProgram("contrast"),S=h.actions[w].param.amount;gl.uniform1f(E.uContrast,S/100),h.name=="Logan"?gl.uniform1f(E.uContrast,.35):h.name=="Sun"&&gl.uniform1f(E.uContrast,.15);break;case"brightness":var E=WebGLShaders.setProgram("contrast"),S=h.actions[w].param.amount;gl.uniform1f(E.uBrightness,S/100);switch(h.name){case"Hans":case"Per":case"Jones":case"Robert":case"Thomas":gl.uniform1f(E.uBrightness,S/100);break;case"Camille":case"Sarah":case"Rose":case"Jessica":case"Laila":case"Mary":gl.uniform1f(E.uBrightness,S/1e3)}break;case"saturation":var E=WebGLShaders.setProgram("color"),S=h.actions[w].param.amount;console.log("saturation is "+S),gl.uniform1f(E.uSaturation,S/100);break;case"sharpen":var E=WebGLShaders.setProgram("sharpen"),x=gl.getUniformLocation(E,"u_textureSize"),T=gl.getUniformLocation(E,"u_kernel[0]");gl.uniform2f(x,Canvas.getImageWidth(),Canvas.getImageHeight());var N=[-1,-1,-1,-1,16,-1,-1,-1,-1];gl.uniform1fv(T,N);break;case"boxblur":case"blur":var C=WebGLShaders.setProgram("blur"),k=h.actions[w].param.amount;h.name=="Agatha"&&(k+=1.5),gl.uniform2fv(C.delta,[k/Canvas.getImageWidth(),0]),WebGL.drawTexture(f),gl.bindTexture(gl.TEXTURE_2D,i[b%2]),f=[],f[0]=i[b%2],b++,WebGL.setFramebuffer(r[b%2],Canvas.getImageWidth(),Canvas.getImageHeight()),gl.uniform2fv(C.delta,[0,k/Canvas.getImageHeight()]);break;case"vignette":var E=WebGLShaders.setProgram("vignette"),L=h.actions[w].param.size,A=h.actions[w].param.color=="0xffffff"?1:0;gl.uniform1f(E.size,L/100),gl.uniform1i(E.colormode,A),h.name=="Carl"?gl.uniform1f(E.size,L/30):h.name=="Sun"&&gl.uniform1f(E.size,L/500);break;case"noise":var E=WebGLShaders.setProgram("noise");h.actions[w].param.amount>100?gl.uniform1f(E.amount,h.actions[w].param.amount/5e3):gl.uniform1f(E.amount,h.actions[w].param.amount/200),h.name=="Agatha"&&gl.uniform1f(E.amount,h.actions[w].param.amount/300);break;case"desaturate":var E=WebGLShaders.setProgram("desaturate");gl.uniform1f(E.uAmount,1);break;case"levels":var E=WebGLShaders.setProgram("levels");gl.uniform1f(E.levelsMin,h.actions[w].param.min/255),gl.uniform1f(E.levelsMax,h.actions[w].param.max/255);break;case"mapping":for(var O=1;O<f.length;O++)gl.deleteTexture(f[O]);var M=f[0];f=[],f.push(M);var _=p(h.actions[w].param.red,"red");f.push(_);var D=p(h.actions[w].param.green,"green");f.push(D);var P=p(h.actions[w].param.blue,"blue");f.push(P);var E=WebGLShaders.setProgram("mapping");gl.uniform1f(E.uAmount,1);var H=gl.getUniformLocation(E,"uSampler"),B=gl.getUniformLocation(E,"red"),j=gl.getUniformLocation(E,"green"),F=gl.getUniformLocation(E,"blue");gl.uniform1i(H,0),gl.uniform1i(B,1),gl.uniform1i(j,2),gl.uniform1i(F,3);break;case"waterdown":var E=WebGLShaders.setProgram("waterdown");gl.uniform1f(E.uAmount,1);break;case"pixelate":WebGLShaders.setProgram("pixelate");break;case"lookup":var E=WebGLShaders.setProgram("lookup");gl.uniform1f(E.uAmount,1);for(var O=1;O<f.length;O++)gl.deleteTexture(f[O]);var M=f[0];f=[],f.push(M);var I=p(h.actions[w].param.data,"lookup");f.push(I);var H=gl.getUniformLocation(E,"uSampler"),q=gl.getUniformLocation(E,"uData");gl.uniform1i(H,0),gl.uniform1i(q,1);break;case"colorize":var E=WebGLShaders.setProgram("colormatrix"),R=new t,U=R.Colorize(h.actions[w].param.hue);gl.uniformMatrix4fv(E.colormatrix,!1,U);break;case"fill":var v=l(h.actions[w].param.color);v.name="fill_"+h.actions[w].param.color,g+=1,y[g]=v;continue;case"invert":WebGLShaders.setProgram("invert");break;case"threshold":var E=WebGLShaders.setProgram("threshold");gl.uniform1f(E.amount,h.actions[w].param.value/256);break;case"gradient":var C=WebGLShaders.setProgram("gradient");switch(h.name){case"Polak":gl.uniform1i(C.type,0);break;case"Tony":gl.uniform1i(C.type,1);break;case"Melissa":gl.uniform1i(C.type,2)}gl.uniform1f(C.resolutionRate,Canvas.getImageWidth()/Canvas.getImageHeight()),g+=1;break;case"merge":if(h.actions[w].param.blend==null)h.actions[w].param.mask!=null?WebGLShaders.setProgram("blend",10):WebGLShaders.setProgram("blend",9);else switch(h.actions[w].param.blend){case"normal":case"layer":WebGLShaders.setProgram("blend",0);break;case"add":WebGLShaders.setProgram("blend",1);break;case"multiply":WebGLShaders.setProgram("blend",2);break;case"screen":WebGLShaders.setProgram("blend",3);break;case"darken":WebGLShaders.setProgram("blend",4);break;case"lighten":WebGLShaders.setProgram("blend",5);break;case"overlay":WebGLShaders.setProgram("blend",6);break;case"softlight":WebGLShaders.setProgram("blend",7);break;case"hardlight":WebGLShaders.setProgram("blend",8)}var E=WebGLShaders.getProgram(),H=gl.getUniformLocation(E,"Sample0"),q=gl.getUniformLocation(E,"Sample1");gl.uniform1i(H,0),gl.uniform1i(q,1);if(h.actions[w].param.mask!=null){var z=gl.getUniformLocation(E,"maskTexture");gl.uniform1i(z,2)}if(h.actions[w].param.opacity!=undefined){var W=h.actions[w].param.opacity;gl.uniform1f(E.alpha,W/100)}f=[];var X=g-1;f.push(y[X]),f.push(y[X+1]),h.actions[w].param.mask!=null&&(f.push(y[X+2]),y.splice(X+2,1)),y.splice(X+1,1),g-=1}WebGL.drawTexture(f);var V=i[b%2];V.name=h.actions[w].type+"_"+b,gl.bindTexture(gl.TEXTURE_2D,V),f=[],f[0]=V,y[g]=f[0],b++}gl.bindTexture(gl.TEXTURE_2D,null)}function p(e,t,n){var r=new Uint8Array(1024),i=0;switch(t){case"lookup":for(var s=0;s<256;s++)r[i]=e[s]>>>16&255,r[i+1]=e[s]>>>8&255,r[i+2]=e[s]&255,r[i+3]=255,i+=4;break;case"red":for(var s=0;s<256;s++)r[i]=n?e[s]>>>16&255:e[s],r[i+1]=0,r[i+2]=0,r[i+3]=255,i+=4;break;case"green":for(var s=0;s<256;s++)r[i]=0,r[i+1]=n?e[s]>>>8&255:e[s],r[i+2]=0,r[i+3]=255,i+=4;break;case"blue":for(var s=0;s<256;s++)r[i]=0,r[i+1]=0,r[i+2]=n?e[s]&255:e[s],r[i+3]=255,i+=4}var o=256,u=1,a=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,a),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,o,u,0,gl.RGBA,gl.UNSIGNED_BYTE,r),gl.bindTexture(gl.TEXTURE_2D,null),a}var n=[],r=[],i=[],s=!1;return{setEffect:f,generateThumbnailForEffect:a,createTextureFromRawRGB:p,isTextureResized:o}}),define("app/image/ColorTransform",[],function(){function e(){this.redMultiplier=0,this.greenMultiplier=0,this.blueMultiplier=0,this.alphaMultipler=0,this.redOffset=0,this.greenOffset=0,this.blueOffset=0,this.alphaOffset=0,this.oldRed=0,this.oldGreen=0,this.oldBlue=0,this.oldAlpha=0,this.setParameters=function(e,t,n,r,i,s,o,u){this.redMultiplier=e,this.greenMultiplier=t,this.blueMultiplier=n,this.alphaMultipler=r,this.redOffset=i,this.greenOffset=s,this.blueOffset=o,this.alphaOffset=u;var a=Math.round(this.oldRed*this.redMultiplier+this.redOffset),f=Math.round(this.oldGreen*this.greenMultiplier+this.greenOffset),l=Math.round(this.oldBlue*this.blueMultiplier+this.blueOffset);this.oldRed=a>255?255:a,this.oldGreen=f>255?255:f,this.oldBlue=l>255?255:l,this.oldAlpha=this.oldAlpha*this.alphaMultipler+this.alphaOffset},this.color=function(){return 65536*this.oldRed+256*this.oldGreen+this.oldBlue},this.red=function(){return this.oldRed},this.blue=function(){return this.oldBlue},this.green=function(){return this.oldGreen}}return e}),define("app/PaintCanvas",["jquery","app/image/ColorTransform"],function(e,t){function A(){function A(e,t){var n=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,r=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,i=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),s=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();n+=i,r+=s,d={x:parseInt(p.x*Canvas.getScale()+n+e-o.x),y:parseInt(p.y*Canvas.getScale()+r+t-o.y)}}function D(){if(n.length==0)return;console.log("clone! "+n.length+" points");var t=n[0],i=n[0],s=r[0],u=r[0];for(var f=1;f<n.length;f++)n[f]<t?t=n[f]:n[f]>i&&(i=n[f]),r[f]<s?s=r[f]:r[f]>u&&(u=r[f]);t-=a*Canvas.getScale()/2,s-=a*Canvas.getScale()/2,i+=a*Canvas.getScale()/2,u+=a*Canvas.getScale()/2;var c=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,h=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,d=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),v=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();c+=d,h+=v,console.log("image origin: "+c+","+h),console.log("bounds: "+t+","+s+" "+(i-t)+"x"+(u-s)),M(!1);var m=l.getImageData(t,s,i-t,u-s),g=e("<canvas>").attr("width",m.width).attr("height",m.height)[0],y=g.getContext("2d");y.putImageData(m,0,0);var b=e("<canvas>").attr("width",Math.ceil(m.width/Canvas.getScale())).attr("height",Math.ceil(m.height/Canvas.getScale()))[0],w=b.getContext("2d");w.scale(1/Canvas.getScale(),1/Canvas.getScale()),w.drawImage(y.canvas,0,0),scaled_paint_data=w.getImageData(0,0,w.canvas.width,w.canvas.height);var E=parseInt((t-c)/Canvas.getScale()),S=parseInt((s-h)/Canvas.getScale()),x=scaled_paint_data.width,T=scaled_paint_data.height,N=0,C=0,k=scaled_paint_data.width,L=scaled_paint_data.height,A=E,O=S;E<0&&(x+=E,N=-E,A=0);if(E+scaled_paint_data.width>=Canvas.getImageWidth()){var _=E+scaled_paint_data.width-Canvas.getImageWidth();x-=_,k-=_}S<0&&(T+=S,C=-S,O=0);if(S+scaled_paint_data.height>=Canvas.getImageHeight()){var _=S+scaled_paint_data.height-Canvas.getImageHeight();T-=_,L-=_}var D=0,P=new Uint8Array(x*T),H=new Uint8Array(x*T*4);for(var B=C;B<L;B++)for(var f=N;f<k;f++)P[D]=scaled_paint_data.data[(B*scaled_paint_data.width+f)*4]==0?0:1,H[D*4]=scaled_paint_data.data[(B*scaled_paint_data.width+f)*4]==0?0:255,H[D*4+1]=scaled_paint_data.data[(B*scaled_paint_data.width+f)*4]==0?0:255,H[D*4+2]=scaled_paint_data.data[(B*scaled_paint_data.width+f)*4]==0?0:255,H[D*4+3]=255,D++;var j=(t-o.x)/Canvas.getScale(),F=(s-o.y)/Canvas.getScale(),I=[];for(var f=0;f<n.length;f++)I.push((n[f]-c)/Canvas.getScale()),I.push((r[f]-h)/Canvas.getScale());console.log("doSeamless: "+(p.x+j)+" "+(p.y+F)+" "+A+", "+O+" "+x+"x"+T+"b = "+a),NaClTouchUp.doSeamless(p.x+j,p.y+F,A,O,x,T,P,I,a),n=[],r=[],M()}function P(){console.log("clone!");var t=n[0],i=n[0],s=r[0],u=r[0];for(var f=1;f<n.length;f++)n[f]<t?t=n[f]:n[f]>i&&(i=n[f]),r[f]<s?s=r[f]:r[f]>u&&(u=r[f]);t-=a*Canvas.getScale()/2,s-=a*Canvas.getScale()/2,i+=a*Canvas.getScale()/2,u+=a*Canvas.getScale()/2;var c=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,h=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,v=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),m=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();c+=v,h+=m,console.log("image origin: "+c+","+h),console.log("bounds: "+t+","+s+" "+(i-t)+"x"+(u-s)),M(!1);var g=l.getImageData(t,s,i-t,u-s),y=e("<canvas>").attr("width",g.width).attr("height",g.height)[0],b=y.getContext("2d");b.putImageData(g,0,0);var w=e("<canvas>").attr("width",Math.ceil(g.width/Canvas.getScale())).attr("height",Math.ceil(g.height/Canvas.getScale()))[0],E=w.getContext("2d");E.scale(1/Canvas.getScale(),1/Canvas.getScale()),E.drawImage(b.canvas,0,0),scaled_paint_data=E.getImageData(0,0,E.canvas.width,E.canvas.height);var S=parseInt((t-c)/Canvas.getScale()),x=parseInt((s-h)/Canvas.getScale()),T=scaled_paint_data.width,N=scaled_paint_data.height,C=0,k=0,L=scaled_paint_data.width,A=scaled_paint_data.height,O=S,_=x;S<0&&(T+=S,C=-S,O=0);if(S+scaled_paint_data.width>=Canvas.getImageWidth()){var D=S+scaled_paint_data.width-Canvas.getImageWidth();T-=D,L-=D}x<0&&(N+=x,k=-x,_=0);if(x+scaled_paint_data.height>=Canvas.getImageHeight()){var D=x+scaled_paint_data.height-Canvas.getImageHeight();N-=D,A-=D}console.log("target_width"+T),console.log("target_height"+N),d={x:parseInt(p.x*Canvas.getScale()+c+n[0]-o.x),y:parseInt(p.y*Canvas.getScale()+h+r[0]-o.y)};if(T>0&&N>0){var P=(n[0]-o.x)/Canvas.getScale(),H=(r[0]-o.y)/Canvas.getScale();NaClTouchUp.doClone(p.x+P,p.y+H,(n[0]-c)/Canvas.getScale(),(r[0]-h)/Canvas.getScale(),a)}n=[],r=[],M()}function H(){console.log("inpaint!");var t=n[0],i=n[0],s=r[0],o=r[0];for(var f=1;f<n.length;f++)n[f]<t?t=n[f]:n[f]>i&&(i=n[f]),r[f]<s?s=r[f]:r[f]>o&&(o=r[f]);t-=a*Canvas.getScale()/2,s-=a*Canvas.getScale()/2,i+=a*Canvas.getScale()/2,o+=a*Canvas.getScale()/2;var c=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,h=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,p=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),d=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();c+=p,h+=d,console.log("image origin: "+c+","+h),console.log("bounds: "+t+","+s+" "+(i-t)+"x"+(o-s)),M(!1);var v=l.getImageData(t,s,i-t,o-s),m=e("<canvas>").attr("width",v.width).attr("height",v.height)[0],g=m.getContext("2d");g.putImageData(v,0,0);var y=e("<canvas>").attr("width",Math.ceil(v.width/Canvas.getScale())).attr("height",Math.ceil(v.height/Canvas.getScale()))[0],b=y.getContext("2d");b.scale(1/Canvas.getScale(),1/Canvas.getScale()),b.drawImage(g.canvas,0,0),scaled_paint_data=b.getImageData(0,0,b.canvas.width,b.canvas.height);var w=parseInt((t-c)/Canvas.getScale()),E=parseInt((s-h)/Canvas.getScale()),S=scaled_paint_data.width,x=scaled_paint_data.height,T=0,N=0,C=scaled_paint_data.width,k=scaled_paint_data.height,L=w,A=E;w<0&&(S+=w,T=-w,L=0);if(w+scaled_paint_data.width>=Canvas.getImageWidth()){var O=w+scaled_paint_data.width-Canvas.getImageWidth();S-=O,C-=O}E<0&&(x+=E,N=-E,A=0);if(E+scaled_paint_data.height>=Canvas.getImageHeight()){var O=E+scaled_paint_data.height-Canvas.getImageHeight();x-=O,k-=O}var _=0,D=new Uint8Array(S*x);for(var P=N;P<k;P++)for(var f=T;f<C;f++)D[_]=scaled_paint_data.data[(P*scaled_paint_data.width+f)*4]==0?0:1,_++;var H=[];for(var f=0;f<n.length;f++)H.push((n[f]-c)/Canvas.getScale()),H.push((r[f]-h)/Canvas.getScale());NaClTouchUp.doTouchUp(L,A,S,x,D,H,a),n=[],r=[],M(),u=!1}f=document.getElementById("paint-canvas"),m=new Image,m.src="/images/cursor_clone_source.png",e(window).keydown(function(e){switch(e.which){case 18:h=!0,M()}}),e(window).keyup(function(e){switch(e.which){case 18:h=!1,M()}});var v=function(e){var t=1.1;e.shiftKey&&(t=1.01);var n=Canvas.getScale()*((e.detail||e.wheelDelta)<0?t:1/t);n<TopMenu.getMinimumScale()?n=TopMenu.getMinimumScale():n>TopMenu.getMaximumScale()&&(n=TopMenu.getMaximumScale()),Canvas.setScale(n),console.log("scale: "+Canvas.getScale()),e.preventDefault()};f.addEventListener("DOMMouseScroll",v,!1),f.addEventListener("mousewheel",v,!1),e("#paint-canvas").mousedown(function(e){if(!c)return;if(NaClTouchUp.isProcessing())return;if(MainMenu.getPanel().type=="clone"&&h){console.log("option key pressed!"),_(e.pageX-this.offsetLeft,e.pageY-this.offsetTop);return}if(MainMenu.getPanel().type=="clone"&&!p){M(!1);var t="Alt";navigator.appVersion.indexOf("Mac")!=-1&&(t="Option"),App.alert("Could not use the clone brush because the area to clone has not been defined ("+t+"-click to define a source point)");return}console.log("paint mousedown"),s.x=e.pageX-this.offsetLeft,s.y=e.pageY-this.offsetTop,n=[e.pageX-this.offsetLeft],r=[e.pageY-this.offsetTop],MainMenu.getPanel().type=="liquify"&&e.which==1&&(F(e.pageX-this.offsetLeft,e.pageY-this.offsetTop),MainMenu.getPanel().getLiquifyMode()=="push"?(T==null&&(T=document.createElement("canvas")),T.width=Canvas.getImageWidth(),T.height=Canvas.getImageHeight(),N=T.getContext("2d"),N.clearRect(0,0,N.canvas.width,N.canvas.height),N.fillStyle="#008080",N.fillRect(0,0,N.canvas.width,N.canvas.height),C!=null&&(gl.deleteTexture(C),C=null)):MainMenu.getPanel().render()),MainMenu.getPanel().type=="airbrush"&&e.which==1&&(F(e.pageX-this.offsetLeft,e.pageY-this.offsetTop),y==null&&(y=document.createElement("canvas"),y.width=0,y.height=0),y.width==0&&y.height==0&&(y.width=Canvas.getImageWidth(),y.height=Canvas.getImageHeight(),b=y.getContext("2d"),b.globalAlpha=E,b.clearRect(0,0,b.canvas.width,b.canvas.height))),u=MainMenu.getPanel().type=="airbrush"&&e.which==3||MainMenu.getPanel().type=="liquify"&&MainMenu.getPanel().getLiquifyMode()!="push"||e.which==3?!1:!0;if(MainMenu.getPanel().type=="clone"){o={x:s.x,y:s.y};if(!MainMenu.getPanel().isSeamless()){P();return}A(e.pageX-this.offsetLeft,e.pageY-this.offsetTop),console.log("clone: x "+d.x),console.log("clone: y "+d.y),g=window.setInterval(function(){console.log("time reached"),D()},NaClTouchUp.CLONE_WAIT_DURATION)}M()}),e("#paint-canvas").mousemove(function(e){if(!c)return;s.x=e.pageX-this.offsetLeft,s.y=e.pageY-this.offsetTop;if(u){n.push(e.pageX-this.offsetLeft),r.push(e.pageY-this.offsetTop);if(n.length==2){var o=j(n[0],r[0]);S=o.centerX,x=o.centerY}MainMenu.getPanel().type=="clone"&&(MainMenu.getPanel().isSeamless()?A(e.pageX-this.offsetLeft,e.pageY-this.offsetTop):P())}M();if(MainMenu.getPanel()&&MainMenu.getPanel().type=="liquify"&&MainMenu.getPanel().getLiquifyMode()=="push"&&N&&u&&n.length>1){N.clearRect(0,0,N.canvas.width,N.canvas.height),N.fillStyle="rgba(0,128,128,1.0)",N.fillRect(0,0,N.canvas.width,N.canvas.height);var f=0,l=0,h=0,p=j(s.x,s.y);console.log("clickX: "+n.length);var d=n.length-2;d<0&&(d=0),k=s.x-n[d],L=s.y-r[d];var v=new t;v.setParameters(0,0,0,1,128,128+Math.min(121,Math.max(-128,-k*8)),128+Math.min(121,Math.max(-128,L*8)),0),f=v.red(),l=v.green(),h=v.blue();var m=a/2;O(N,p.centerX,p.centerY,m,f,l,h,1),console.log("liquify brush color: "+f+" "+l+" "+h),C!=null&&(gl.deleteTexture(C),C=null),C=gl.createTexture(),WebGL.handleLoadedTexture(C,T,!0,T.width,T.height),MainMenu.getPanel().generatePushDisplacementMap(C),MainMenu.getPanel().render()}if(MainMenu.getPanel()&&MainMenu.getPanel().type=="airbrush"&&b&&u&&n.length>1){b.globalAlpha=E;var f=0,l=0,h=0,p=j(s.x,s.y),g=Math.sqrt(Math.pow(S-p.centerX,2)+Math.pow(x-p.centerY,2)),m=a/2;for(i=0;i<g;i+=10){var _=i/g;O(b,S*_+p.centerX*(1-_),x*_+p.centerY*(1-_),m,f,l,h,.5)}S=p.centerX,x=p.centerY,w!=null&&(gl.deleteTexture(w),w=null),w=gl.createTexture(),WebGL.handleLoadedTexture(w,y,!0,y.width,y.height,!0),MainMenu.getPanel().generateMaskingTexture(w),MainMenu.getPanel().render()}}),e("#paint-canvas").mouseup(function(e){if(!c)return;if(MainMenu.getPanel().type=="clone"&&!p)return;if(MainMenu.getPanel().type=="clone"&&h)return;MainMenu.getPanel().type=="touchup"?H():MainMenu.getPanel().type=="clone"?(console.log("clone brush up"),g&&(console.log("clear clone timer"),window.clearInterval(g),g=null),MainMenu.getPanel().isSeamless()?(D(),NaClTouchUp.doSeamlessSaveCurrent()):NaClTouchUp.doCloneSaveCurrent(),u=!1,o=null,n=[],r=[]):MainMenu.getPanel().type=="airbrush"?(u=!1,n=[],r=[]):MainMenu.getPanel().type=="liquify"&&(MainMenu.getPanel().saveCurrentImage(),z(),MainMenu.getPanel().reset())}),e("#paint-canvas").mouseleave(function(e){if(!c)return;MainMenu.getPanel()&&MainMenu.getPanel().type=="airbrush"&&b&&u&&n.length>1,s.x=-1,s.y=-1,u=!1,M(!1)}),l=document.getElementById("paint-canvas").getContext("2d")}function O(e,t,n,r,i,s,o,u){var a=e.createRadialGradient(t,n,1,t,n,r);a.addColorStop(0,"rgba("+i+", "+s+", "+o+", "+u+")"),a.addColorStop(.8,"rgba("+i+", "+s+", "+o+", 0.03)"),a.addColorStop(1,"rgba("+i+", "+s+", "+o+", 0)"),e.beginPath(),e.arc(t,n,r,0,2*Math.PI,!0),e.fillStyle=a,e.fill(),e.closePath()}function M(e){e=typeof e!="undefined"?e:c,l.clearRect(0,0,l.canvas.width,l.canvas.height);if(e&&s.x>=0&&s.y>=0)if(MainMenu.getPanel()&&MainMenu.getPanel().type=="clone"&&h)l.drawImage(m,s.x-parseInt(m.width/2),s.y-parseInt(m.height/2));else{l.strokeStyle="#eeeeee",l.lineCap="round",l.lineWidth=1,l.beginPath(),l.arc(s.x,s.y,a*Canvas.getScale()/2,0,Math.PI*2,!0),l.stroke(),l.closePath();if(MainMenu.getPanel()&&MainMenu.getPanel().type=="clone"&&u){var t=n[0]-o.x,i=r[0]-o.y;l.drawImage(m,d.x-parseInt(m.width/2),d.y-parseInt(m.height/2))}}if(MainMenu.getPanel()&&MainMenu.getPanel().type=="clone"&&MainMenu.getPanel().isSeamless())return;if(n.length==1)l.fillStyle=!MainMenu.getPanel()||MainMenu.getPanel().type!="airbrush"&&MainMenu.getPanel().type!="liquify"?"rgba(255,255,255,0.5)":"rgba(255,255,255,0.0)",l.beginPath(),l.arc(n[0],r[0],a*Canvas.getScale()/2,0,Math.PI*2,!0),l.closePath(),l.fill();else if(n.length>1){l.strokeStyle=!MainMenu.getPanel()||MainMenu.getPanel().type!="airbrush"&&MainMenu.getPanel().type!="liquify"?"rgba(255,255,255,0.5)":"rgba(255,255,255,0.0)",l.lineJoin="round",l.lineCap="round",l.lineWidth=a*Canvas.getScale(),l.beginPath(),l.moveTo(n[0],r[0]);for(var f=0;f<n.length;f++)l.lineTo(n[f],r[f]);l.stroke()}}function _(e,t){var n=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,r=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,i=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),s=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();n+=i,r+=s,console.log("image origin: "+n+","+r),p={x:(e-n)/Canvas.getScale(),y:(t-r)/Canvas.getScale()},console.log("clone source point: "+p.x+", "+p.y)}function D(t){c=t,c?e("#paint-canvas").css("cursor","none"):(e("#paint-canvas").css("cursor","default"),p=null),M(c)}function P(e){a=e}function H(){return a}function B(e){E=e/100}function j(e,t){var n=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,r=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,i=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),s=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();n+=i,r+=s;var o=(e-n)/Canvas.getScale(),u=(t-r)/Canvas.getScale(),a={centerX:o,centerY:u};return a}function F(e,t){var n=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,r=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,i=Canvas.getOffset().x/2*Canvas.getImageWidth()*Canvas.getScale(),s=Canvas.getOffset().y/-2*Canvas.getImageHeight()*Canvas.getScale();n+=i,r+=s,console.log("image origin: "+n+","+r);var o=(e-n)/Canvas.getScale(),u=(t-r)/Canvas.getScale();console.log("image ok: "+o+","+u),v={centerX:o,centerY:u}}function I(){return v}function q(e,t){f.width=e,f.height=t}function R(t){e(f).css("display",t?"block":"none")}function U(){n=[],r=[],b!=null&&(b.clearRect(0,0,b.canvas.width,b.canvas.height),b.globalAlpha=E),w!=null&&(gl.deleteTexture(w),w=null),y!=null&&(y.width=0,y.height=0),S=0,x=0,u=!1}function z(){n=[],r=[],N!=null&&(N.clearRect(0,0,N.canvas.width,N.canvas.height),N.fillStyle="#008080",N.fillRect(0,0,N.canvas.width,N.canvas.height)),C!=null&&(gl.deleteTexture(C),C=null),S=0,x=0,k=0,L=0,u=!1}var n=[],r=[],s={x:-1,y:-1},o=null,u=!1,a=50,f,l,c=!1,h=!1,p=null,d=null,v=null,m,g=null,y=null,b=null,w=null,E=.25,S=0,x=0,T=null,N=null,C=null,k=0,L=0;return{setSize:q,setVisible:R,setEnabled:D,setBrushSize:P,getBrushSize:H,setBrushCenter:F,getBrushCenter:I,clearAirbrushCanvas:U,clearLiquifyPushCanvas:z,setBrushIntensity:B,init:A,repaint:M}}),define("app/AnimatedMenu",["jquery"],function(e){function n(n,r,i,s,o){this._isAnimating=!1,this._isMenuOpen=!1,this._buttons=i,this._buttonWidth=i[0].getWidth(),this._buttonHeight=i[0].getHeight(),this._parentSelector=r,this._bottomMargin=o,this._initialX=s,this._el=e("<div id='"+n+"' style='position:absolute;display:none;bottom:"+this._bottomMargin+"px;z-index:9'></div>");var u=this;this.layoutButtons=function(n){var r=(e(window).innerWidth()-e(u._parentSelector).width())/2,i=e(window).innerWidth()/2-u._width/2-r,s=0,o=0;for(var a=0;a<u._buttons.length;a++){var f=u._buttons[a];console.log("animating to final pos = "+(i+o*(u._buttonWidth+t))),n?f.setTargetPos(i+o*(u._buttonWidth+t),s*(u._buttonHeight+t)):f.setPos(i+o*(u._buttonWidth+t),s*(u._buttonHeight+t)),n&&f.animate(function(){u._isAnimating=!1,u._isMenuOpen=!0}),o++,s==0&&o==u._buttons.length%u._maxButtonsPerRow?(s++,o=0):o==u._maxButtonsPerRow&&(o=0)}},this.onResize();for(var a=0;a<this._buttons.length;a++){var f=this._buttons[a];this._el.append(f.getElement())}}var t=5;return n.prototype.onResize=function(){this._maxButtonsPerRow=Math.floor(e(window).innerWidth()/(this._buttonWidth+t)),this._maxButtonsPerRow>=this._buttons.length?(this._numRows=1,this._width=this._buttons.length*(this._buttonWidth+t)-t):(this._numRows=Math.ceil(this._buttons.length/this._maxButtonsPerRow),this._width=this._maxButtonsPerRow*(this._buttonWidth+t)-t),this._height=this._buttonHeight*this._numRows,this._el.css("width",this._width+"px"),this._el.css("height",this._height+"px"),this._el.css("display")!="none"&&this.layoutButtons(!1)},n.prototype.setInitialX=function(e){this._initialX=e},n.prototype.isOpen=function(){return this._isMenuOpen},n.prototype.animateOpen=function(){if(this._isAnimating)return;this._isAnimating=!0,e(this._parentSelector).append(this._el);var n=(e(window).innerWidth()-e(this._parentSelector).width())/2,r=e(window).innerWidth()/2-this._width/2-n;console.log("menu width: "+this._width);var i=this;this._el.show(),console.log("buttons: "+this._buttons.length);for(var s=0;s<this._buttons.length;s++){var o=this._buttons[s];o.show(),o.setPos(this._initialX-this._buttonWidth/2,this._height),o.setTargetPos(this._initialX-this._buttonWidth/2,(this._numRows-1)*(this._buttonHeight+t)),console.log("i = "+s),s==this._buttons.length-1?o.animate(function(){console.log("final animation"),i.layoutButtons(!0)}):o.animate()}},n.prototype.animateClosed=function(){if(this._isAnimating)return;this._isAnimating=!0;var e=this;for(var n=0;n<this._buttons.length;n++){var r=this._buttons[n];r.setTargetPos(this._initialX-this._buttonWidth/2,(this._numRows-1)*(this._buttonHeight+t)),n==this._buttons.length-1?r.animate(function(){for(var t=0;t<e._buttons.length;t++){var n=e._buttons[t];n.setTargetPos(e._initialX-e._buttonWidth/2,e._bottomMargin),t==e._buttons.length-1?n.animate(function(){e._el.hide(),e._isAnimating=!1,e._isMenuOpen=!1}):n.animate()}}):r.animate()}},n.prototype.close=function(){for(var e=0;e<this._buttons.length;e++){var t=this._buttons[e];t.setPos(this._initialX-this._buttonWidth/2,this._bottomMargin)}this._el.hide(),this._isMenuOpen=!1},n}),define("text!ui/main_menu.html",[],function(){return'<div>\n<div id="menu" style="\n	position:absolute;\n	height:85px;\n	bottom:5px;\n	z-index:10;\n"></div>\n<div id="main_menu" style="\n	position:absolute;\n	height:85px;\n	bottom:5px;\n	z-index:10;\n">\n\n<div id="button_adjustments"></div>\n<div id="button_effects"></div>\n<div id="button_overlays"></div>\n<div id="button_borders"></div>\n<div id="button_text"></div>\n<div id="button_stickers"></div>\n\n</div>\n</div>'}),define("text!ui/icon_button.html",[],function(){return'<div>\n\n<div class="large" style="\n	position:absolute;\n	background: rgba(67, 67, 67, 0.9);\n	border-radius: 5px;\n	width:100px;\n	height:100px;\n	cursor:pointer;\n">\n	<img id="button_image" src="/images/button_open_computer.png" width="60" height="60" style="position:relative;left:20px;top:10px;"/>\n	<div id="button_title" style="font-size:13px;color:white;position:relative;top:7px;text-align:center;width:100px;"></div>\n</div>\n\n<div class="medium" style="\n	position:absolute;\n	background: rgba(67, 67, 67, 0.9);\n	border-radius: 5px;\n	width:85px;\n	height:85px;\n	cursor:pointer;\n">\n	<img id="button_image" src="/images/button_open_computer.png" width="50" height="50" style="position:relative;left:17px;top:7px;"/>\n	<div id="button_title" style="font-size:13px;color:white;position:relative;top:5px;text-align:center;width:85px;"></div>\n</div>\n\n<div class="small" style="\n	position:absolute;\n	background: rgba(43, 43, 43, 0.9);\n	border-radius: 5px;\n	width:75px;\n	height:75px;\n	cursor:pointer;\n">\n	<img id="button_image" src="/images/button_open_computer.png" width="42" height="42" style="position:relative;left:16px;top:6px;"/>\n	<div id="button_title" style="font-size:13px;color:white;position:relative;top:5px;text-align:center;width:75px;"></div>\n</div>\n\n</div>'}),define("app/controls/IconButton",["jquery","text!ui/icon_button.html"],function(e,t){function n(n,s,o,u,a){this.el=n,this.title=s,this.img=o,this.clickCallback=null,this.is_enabled=!0,this.targetX=0,this.targetY=0,this.opacity=typeof a!="undefined"?a?.9:1:.9,u=typeof u!="undefined"?u:"large",this.size=u,this.highlight=!1;var f=e(t).find("."+u);f.attr("id",e(this.el).attr("id")),f.find("#button_image").attr("src",this.img),f.find("#button_title").html(this.title),this.el.replaceWith(f),this.el=f,this.el.data("opacity",this.opacity),this.el.mouseover(r),this.el.mouseout(i)}function r(){e(this).css("background","#3ea2ec")}function i(){e(this).css("background",e(this).hasClass("small")?"rgba(43, 43, 43, "+e(this).data("opacity")+")":"rgba(67, 67, 67, "+e(this).data("opacity")+")")}return n.prototype.animate=function(e){e=typeof e!="undefined"?e:function(){};var t=this.targetX-parseInt(this.el.css("left")),n=this.targetY-parseInt(this.el.css("top"));this.el.animate({left:"+="+t+"px",top:"+="+n+"px"},100,"swing",e)},n.prototype.setSize=function(n){var s=e(t).find("."+n);s.attr("id",e(this.el).attr("id")),s.find("#button_image").attr("src",this.img),s.find("#button_title").html(this.title),this.el.replaceWith(s),this.el=s,this.el.mouseover(r),this.el.mouseout(i)},n.prototype.setTargetPos=function(e,t){this.targetX=e,this.targetY=t},n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.getPos=function(){return{x:parseInt(this.el.css("left")),y:parseInt(this.el.css("top"))}},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.setHighlight=function(e,t){t=typeof t!="undefined"?t:!0,this.highlight=e,e?(this.el.css("background","rgba(43, 43, 43, "+this.opacity+")"),this.el.off("mouseover"),this.el.off("mouseout")):(this.el.css("background",t?"#3ea2ec":this.size=="small"?"rgba(43, 43, 43, "+this.opacity+")":"rgba(67, 67, 67, "+this.opacity+")"),this.el.mouseover(r),this.el.mouseout(i))},n.prototype.click=function(e){this.clickCallback=e,this.el.click(this.clickCallback)},n.prototype.setTitle=function(e){this.title=e,this.el.find("#button_title").html(this.title)},n.prototype.isEnabled=function(){return this.is_enabled},n.prototype.setEnabled=function(e){this.is_enabled=e,e?(this.el.mouseover(r),this.el.mouseout(i),this.el.click(this.clickCallback),this.el.css("cursor","pointer")):(this.el.css("background",this.size=="small"?"rgba(43, 43, 43, "+this.opacity+")":"rgba(67, 67, 67, "+this.opacity+")"),this.el.off("mouseover"),this.el.off("mouseout"),this.el.off("click"),this.el.css("cursor","default"))},n.prototype.setSelected=function(e){console.log("setSelected: "+e),console.log(this.el.mouseover),e?(this.el.css("background","#3ea2ec"),this.el.off("mouseover"),this.el.off("mouseout")):(this.el.css("background",this.size=="small"?"rgba(43, 43, 43, "+this.opacity+")":"rgba(67, 67, 67, "+this.opacity+")"),this.el.mouseover(r),this.el.mouseout(i))},n.prototype.getWidth=function(){return parseInt(this.el.css("width"))},n.prototype.getHeight=function(){return parseInt(this.el.css("height"))},n.prototype.getElement=function(){return this.el},n}),define("range",[],function(){function e(){this._value=0,this._minimum=0,this._maximum=100,this._extent=0,this._isChanging=!1}return e.prototype.setValue=function(e){e=Math.round(parseFloat(e));if(isNaN(e))return;this._value!=e&&(e+this._extent>this._maximum?this._value=this._maximum-this._extent:e<this._minimum?this._value=this._minimum:this._value=e,!this._isChanging&&typeof this.onchange=="function"&&this.onchange())},e.prototype.getValue=function(){return this._value},e.prototype.setExtent=function(e){this._extent!=e&&(e<0?this._extent=0:this._value+e>this._maximum?this._extent=this._maximum-this._value:this._extent=e,!this._isChanging&&typeof this.onchange=="function"&&this.onchange())},e.prototype.getExtent=function(){return this._extent},e.prototype.setMinimum=function(e){if(this._minimum!=e){var t=this._isChanging;this._isChanging=!0,this._minimum=e,e>this._value&&this.setValue(e),e>this._maximum&&(this._extent=0,this.setMaximum(e),this.setValue(e)),e+this._extent>this._maximum&&(this._extent=this._maximum-this._minimum),this._isChanging=t,!this._isChanging&&typeof this.onchange=="function"&&this.onchange()}},e.prototype.getMinimum=function(){return this._minimum},e.prototype.setMaximum=function(e){if(this._maximum!=e){var t=this._isChanging;this._isChanging=!0,this._maximum=e,e<this._value&&this.setValue(e-this._extent),e<this._minimum&&(this._extent=0,this.setMinimum(e),this.setValue(this._maximum)),e<this._minimum+this._extent&&(this._extent=this._maximum-this._minimum),e<this._value+this._extent&&(this._extent=this._maximum-this._value),this._isChanging=t,!this._isChanging&&typeof this.onchange=="function"&&this.onchange()}},e.prototype.getMaximum=function(){return this._maximum},e}),define("timer",[],function(){function e(e){this._pauseTime=typeof e=="undefined"?1e3:e,this._timer=null,this._isStarted=!1}return e.prototype.start=function(){this.isStarted()&&this.stop();var e=this;this._timer=window.setTimeout(function(){typeof e.ontimer=="function"&&e.ontimer()},this._pauseTime),this._isStarted=!1},e.prototype.stop=function(){this._timer!=null&&window.clearTimeout(this._timer),this._isStarted=!1},e.prototype.isStarted=function(){return this._isStarted},e.prototype.getPauseTime=function(){return this._pauseTime},e.prototype.setPauseTime=function(e){this._pauseTime=e},e}),define("slider",["range","timer"],function(e,t){function n(r,i,s){if(!r)return;this._orientation=s||"horizontal",this._range=new e,this._range.setExtent(0),this._blockIncrement=10,this._unitIncrement=1,this._timer=new t(100),this._mousedown=null,this._mouseup=null,this._precision=1,this._display_filter=function(e){return e},n.isSupported&&r&&(this.document=r.ownerDocument||r.document,this.element=r,this.element.slider=this,this.element.unselectable="on",this.element.className=this._orientation+" "+this.classNameTag+" "+this.element.className,this.line=this.document.createElement("DIV"),this.line.className="line",this.line.unselectable="on",this.line.appendChild(this.document.createElement("DIV")),this.element.appendChild(this.line),this.handle=this.document.createElement("DIV"),this.handle.className="handle",this.handle.unselectable="on",this.handle.appendChild(this.document.createElement("DIV")),this.handle.firstChild.appendChild(this.document.createTextNode(String.fromCharCode(160))),this.element.appendChild(this.handle)),this.input=i;var o=this;this._range.onchange=function(){o.recalculate(),console.log("slider range onchange"),typeof o.onchange=="function"&&o.onchange()},n.isSupported&&r?(this.element.onfocus=n.eventHandlers.onfocus,this.element.onblur=n.eventHandlers.onblur,this.element.onmousedown=n.eventHandlers.onmousedown,this.element.onmouseover=n.eventHandlers.onmouseover,this.element.onmouseout=n.eventHandlers.onmouseout,this.element.onkeydown=n.eventHandlers.onkeydown,this.element.onkeypress=n.eventHandlers.onkeypress,this.element.onmousewheel=n.eventHandlers.onmousewheel,this.handle.onselectstart=this.element.onselectstart=function(){return!1},this._timer.ontimer=function(){o.ontimer()},window.setTimeout(function(){o.recalculate()},1)):this.input.onchange=function(e){o.setValue(o.input.value)}}return n.isSupported=typeof document.createElement!="undefined"&&typeof document.documentElement!="undefined"&&typeof document.documentElement.offsetWidth=="number",n.eventHandlers={getEvent:function(e,t){e||(t?e=t.document.parentWindow.event:e=window.event);if(!e.srcElement){var t=e.target;while(t!=null&&t.nodeType!=1)t=t.parentNode;e.srcElement=t}return typeof e.offsetX=="undefined"&&(e.offsetX=e.layerX,e.offsetY=e.layerY),e},getDocument:function(e){return e.target?e.target.ownerDocument:e.srcElement.document},getSlider:function(e){var t=e.target||e.srcElement;while(t!=null&&t.slider==null)t=t.parentNode;return t?t.slider:null},getLine:function(e){var t=e.target||e.srcElement;while(t!=null&&t.className!="line")t=t.parentNode;return t},getHandle:function(e){var t=e.target||e.srcElement,n=/handle/;while(t!=null&&!n.test(t.className))t=t.parentNode;return t},onfocus:function(e){var t=this.slider;t._focused=!0,t.handle.className="handle hover"},onblur:function(e){var t=this.slider;t._focused=!1,t.handle.className="handle"},onmouseover:function(e){e=n.eventHandlers.getEvent(e,this);var t=this.slider;e.srcElement==t.handle&&(t.handle.className="handle hover")},onmouseout:function(e){e=n.eventHandlers.getEvent(e,this);var t=this.slider;e.srcElement==t.handle&&!t._focused&&(t.handle.className="handle")},onmousedown:function(e){e=n.eventHandlers.getEvent(e,this);var t=this.slider;t.element.focus&&t.element.focus(),n._currentInstance=t;var r=t.document;r.addEventListener?(r.addEventListener("mousemove",n.eventHandlers.onmousemove,!0),r.addEventListener("mouseup",n.eventHandlers.onmouseup,!0)):r.attachEvent&&(r.attachEvent("onmousemove",n.eventHandlers.onmousemove),r.attachEvent("onmouseup",n.eventHandlers.onmouseup),r.attachEvent("onlosecapture",n.eventHandlers.onmouseup),t.element.setCapture());if(n.eventHandlers.getHandle(e))n._sliderDragData={screenX:e.screenX,screenY:e.screenY,dx:e.screenX-t.handle.offsetLeft,dy:e.screenY-t.handle.offsetTop,startValue:t.getValue(),slider:t};else{var i=n.eventHandlers.getLine(e);t._mouseX=e.offsetX+(i?t.line.offsetLeft:0),t._mouseY=e.offsetY+(i?t.line.offsetTop:0),t._increasing=null,t.ontimer()}t._mousedown&&t._mousedown()},onmousemove:function(e){e=n.eventHandlers.getEvent(e,this);if(n._sliderDragData){var t=n._sliderDragData.slider,r=t.getMaximum()-t.getMinimum(),i,s,o;t._orientation=="horizontal"?(i=t.element.offsetWidth-t.handle.offsetWidth,s=e.screenX-n._sliderDragData.dx,o=Math.abs(e.screenY-n._sliderDragData.screenY)>100):(i=t.element.offsetHeight-t.handle.offsetHeight,s=t.element.offsetHeight-t.handle.offsetHeight-(e.screenY-n._sliderDragData.dy),o=Math.abs(e.screenX-n._sliderDragData.screenX)>100);var u=t.getMinimum()+r*s/i,a=t.getMinimum()+r*(s+1)/i,f=t.getMinimum()+r*(s-1)/i;return Math.abs(u-t.getInitValue())<=Math.abs(a-t.getInitValue())&&Math.abs(u-t.getInitValue())<=Math.abs(f-t.getInitValue())&&(u=t.getInitValue()),t.setValue(o?n._sliderDragData.startValue:u),!1}var t=n._currentInstance;if(t!=null){var l=n.eventHandlers.getLine(e);t._mouseX=e.offsetX+(l?t.line.offsetLeft:0),t._mouseY=e.offsetY+(l?t.line.offsetTop:0)}},onmouseup:function(e){e=n.eventHandlers.getEvent(e,this);var t=n._currentInstance,r=t.document;r.removeEventListener?(r.removeEventListener("mousemove",n.eventHandlers.onmousemove,!0),r.removeEventListener("mouseup",n.eventHandlers.onmouseup,!0)):r.detachEvent&&(r.detachEvent("onmousemove",n.eventHandlers.onmousemove),r.detachEvent("onmouseup",n.eventHandlers.onmouseup),r.detachEvent("onlosecapture",n.eventHandlers.onmouseup),t.element.releaseCapture()),n._sliderDragData?n._sliderDragData=null:(t._timer.stop(),t._increasing=null),t._mouseup&&t._mouseup(),n._currentInstance=null},onkeydown:function(e){e=n.eventHandlers.getEvent(e,this);var t=this.slider,r=e.keyCode;switch(r){case 33:t.setValue(t.getValue()+t.getBlockIncrement());break;case 34:t.setValue(t.getValue()-t.getBlockIncrement());break;case 35:t.setValue(t.getOrientation()=="horizontal"?t.getMaximum():t.getMinimum());break;case 36:t.setValue(t.getOrientation()=="horizontal"?t.getMinimum():t.getMaximum());break;case 38:case 39:t.setValue(t.getValue()+t.getUnitIncrement());break;case 37:case 40:t.setValue(t.getValue()-t.getUnitIncrement())}if(r>=33&&r<=40)return!1},onkeypress:function(e){e=n.eventHandlers.getEvent(e,this);var t=e.keyCode;if(t>=33&&t<=40)return!1},onmousewheel:function(e){e=n.eventHandlers.getEvent(e,this);var t=this.slider;if(t._focused)return t.setValue(t.getValue()+e.wheelDelta/120*t.getUnitIncrement()),!1}},n.prototype.classNameTag="dynamic-slider-control",n.prototype.mousedown=function(e){this._mousedown=e},n.prototype.mouseup=function(e){this._mouseup=e},n.prototype.displayFilter=function(e){this._display_filter=e},n.prototype.setInitValue=function(e){this._initvalue=e,this.setValue(e)},n.prototype.setValue=function(e){this._range.setValue(e),this._precision==.1?this.input.value=this._display_filter((this.getValue()*this._precision).toFixed(1)):this.input.value=this._display_filter(this.getValue()*this._precision)},n.prototype.getValue=function(){return this._range.getValue()},n.prototype.setMinimum=function(e){this._range.setMinimum(e),this.input.value=this.getValue()},n.prototype.setPrecision=function(e){this._precision=e},n.prototype.getInitValue=function(){return this._initvalue},n.prototype.getMinimum=function(){return this._range.getMinimum()},n.prototype.setMaximum=function(e){this._range.setMaximum(e),this.input.value=this.getValue()},n.prototype.getMaximum=function(){return this._range.getMaximum()},n.prototype.setUnitIncrement=function(e){this._unitIncrement=e},n.prototype.getUnitIncrement=function(){return this._unitIncrement},n.prototype.setBlockIncrement=function(e){this._blockIncrement=e},n.prototype.getBlockIncrement=function(){return this._blockIncrement},n.prototype.getOrientation=function(){return this._orientation},n.prototype.setOrientation=function(e){e!=this._orientation&&(n.isSupported&&this.element&&(this.element.className=this.element.className.replace(this._orientation,e)),this._orientation=e,this.recalculate())},n.prototype.recalculate=function(){if(!n.isSupported||!this.element)return;var e=this.element.offsetWidth,t=this.element.offsetHeight,r=this.handle.offsetWidth,i=this.handle.offsetHeight,s=this.line.offsetWidth,o=this.line.offsetHeight;this._orientation=="horizontal"?(this.handle.style.left=(e-r)*(this.getValue()-this.getMinimum())/(this.getMaximum()-this.getMinimum())+"px",this.handle.style.top=(t-i)/2+"px",this.line.style.top=(t-o)/2+"px",this.line.style.left=r/2+"px",this.line.style.width=Math.max(0,e-r-2)+"px",this.line.firstChild.style.width=Math.max(0,e-r-4)+"px"):(this.handle.style.left=(e-r)/2+"px",this.handle.style.top=t-i-(t-i)*(this.getValue()-this.getMinimum())/(this.getMaximum()-this.getMinimum())+"px",this.line.style.left=(e-s)/2+"px",this.line.style.top=i/2+"px",this.line.style.height=Math.max(0,t-i-2)+"px",this.line.firstChild.style.height=Math.max(0,t-i-4)+"px")},n.prototype.ontimer=function(){var e=this.handle.offsetWidth,t=this.handle.offsetHeight,n=this.handle.offsetLeft,r=this.handle.offsetTop;this._orientation=="horizontal"?this._mouseX>n+e&&(this._increasing==null||this._increasing)?(this.setValue(this.getValue()+this.getBlockIncrement()),this._increasing=!0):this._mouseX<n&&(this._increasing==null||!this._increasing)&&(this.setValue(this.getValue()-this.getBlockIncrement()),this._increasing=!1):this._mouseY>r+t&&(this._increasing==null||!this._increasing)?(this.setValue(this.getValue()-this.getBlockIncrement()),this._increasing=!1):this._mouseY<r&&(this._increasing==null||this._increasing)&&(this.setValue(this.getValue()+this.getBlockIncrement()),this._increasing=!0),this._timer.start()},n}),define("text!ui/slider_box.html",[],function(){return'<div style="\n	position:absolute;\n	border-radius:5px;\n	color:#ffffff;\n	background-color:#404040;\n	width:220px;\n	height:85px;\n">\n\n<div id="title" style="\n	position:absolute;\n	top:17px;\n	left:25px;\n	font-size:14px;\n"></div>\n\n<input type="text" id="input" size="4" maxlength="4" style="\n	position:absolute;\n	top:15px;\n	right:25px;\n	background-color:#222222;\n	font-size:14px;\n	color:white;\n	border:solid 1px #bbbbbb;\n	padding:0px 3px;\n	pointer-events:none;\n"/>\n\n<div id="slider" style="\n	position:absolute;\n	top:45px;\n	left:10px;\n	width:200px;\n"></div>\n\n\n\n</div>'}),define("app/controls/SliderBox",["jquery","text!ui/slider_box.html","slider"],function(e,t,n){function r(r,i,s,o,u,a){this.el=r,this.title=i,this.min=s,this.max=o,this.initVal=u,this.precision=typeof a!="undefined"?a:1;var f=e(t);f.attr("id",e(this.el).attr("id")),f.find("#title").html(this.title),console.log("slider: "+f.find("#slider")),console.log("input: "+f.find("#input")),this.slider=new n(f.find("#slider")[0],f.find("#input")[0],"horizontal"),this.slider.setMinimum(s/this.precision),this.slider.setMaximum(o/this.precision),this.slider.setPrecision(this.precision),this.slider.setInitValue(u/this.precision),this.el.replaceWith(f),this.el=f}return r.prototype.mousedown=function(e){this.slider.mousedown(e)},r.prototype.mouseup=function(e){this.slider.mouseup(e)},r.prototype.displayFilter=function(e){this.slider.displayFilter(e)},r.prototype.onchange=function(e){this.slider.onchange=e},r.prototype.reset=function(){this.slider.setValue(this.initVal)},r.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},r.prototype.getValue=function(){return this.slider.getValue()*this.precision},r.prototype.hide=function(){this.el.css("visibility","hidden")},r.prototype.show=function(){this.el.css("visibility","visible")},r}),define("text!ui/button.html",[],function(){return'<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	height:40px;\n	cursor:pointer;\n">\n	<img id="button_image" width="15" height="15" style="position:absolute;left:11px;top:12px;"/>\n	<div id="button_title" style="font-size:14px;color:white;position:absolute;left:35px;top:10px;"></div>\n</div>'}),define("app/controls/Button",["jquery","text!ui/button.html"],function(e,t){function n(n,r,i,s,o,u,a,f){this.el=n,this.title=r,this.img=i,this.clickCallback=null,this.bgcolor=typeof o!="undefined"?o:"#3ea2ec",this.button_width=typeof u!="undefined"?u:15,this.button_height=typeof a!="undefined"?a:15,this.short_height=typeof f!="undefined"?f:!1,this._isSelected=!1,this.onMouseOver=function(){p.el.css("background",p.bgcolor)},this.onMouseOut=function(){p.el.css("background","#434343")};var l=e(t),c=this.short_height?35:40,h=this.short_height?8:10;l.attr("id",e(this.el).attr("id")),l.find("#button_image").attr("src",this.img),this.title?(l.find("#button_title").html(this.title),i?(l.find("#button_title").css("top",Math.floor((c-this.button_height)/2)-2),l.find("#button_image").css("top",Math.floor((c-this.button_height)/2)),l.find("#button_image").attr("width",this.button_width),l.find("#button_image").attr("height",this.button_height)):(l.find("#button_image").remove(),l.find("#button_title").css("position","static"),l.find("#button_title").css("margin-top",h+"px"),l.find("#button_title").css("text-align","center"))):(l.find("#button_image").attr("width",this.button_width),l.find("#button_image").attr("height",this.button_height),l.find("#button_image").css("left",Math.ceil((s-this.button_width)/2)),l.find("#button_image").css("top",Math.ceil((c-this.button_height)/2))),l.css("width",s),l.css("height",c),this.el.replaceWith(l),this.el=l;var p=this;this.el.mouseover(function(){p.onMouseOver()}),this.el.mouseout(function(){p.onMouseOut()})}return n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.getWidth=function(){return parseInt(this.el.css("width"))},n.prototype.getHeight=function(){return parseInt(this.el.css("height"))},n.prototype.getElement=function(){return this.el},n.prototype.getId=function(){return this.el.attr("id")},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,this.el.click(e)},n.prototype.off=function(e){this.el.off(e)},n.prototype.setEnabled=function(e){if(!e)this.el.css("background","#434343"),this.el.off("mouseover"),this.el.off("mouseout"),this.el.off("click"),this.el.css("cursor","default"),this.el.find("#button_title").css("color","#acacac"),this.el.find("#button_image").css("opacity",.5);else{var t=this;this.el.off("mouseover").mouseover(function(){t.onMouseOver()}),this.el.off("mouseout").mouseout(function(){t.onMouseOut()}),this.el.off("click").click(this.clickCallback),this.el.css("cursor","pointer"),this.el.find("#button_title").css("color","#ffffff"),this.el.find("#button_image").css("opacity",1)}},n.prototype.isSelected=function(){return this._isSelected},n.prototype.setSelected=function(e){console.log("setSelected: "+e),this._isSelected=e,console.log(this.el.mouseover);if(e)this.el.css("background",this.bgcolor),this.el.off("mouseover"),this.el.off("mouseout");else{this.el.css("background","#434343");var t=this;this.el.mouseover(function(){t.onMouseOver()}),this.el.mouseout(function(){t.onMouseOut()})}},n}),define("text!ui/panels/contrast_panel.html",[],function(){return'<div class="panel" id="contrast_panel" style="\n	position:absolute;\n	width:640px;\n">\n\n<div id="panel_label"></div>\n\n<div id="contrast_slider"></div>\n<div id="brightness_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/ContrastPanel",["jquery","app/controls/IconButton","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/contrast_panel.html"],function(e,t,n,r,i,s){function o(){function o(){var e=WebGLShaders.getProgram();gl.uniform1f(e.uContrast,n.contrast_slider.getValue()/100),gl.uniform1f(e.uBrightness,n.brightness_slider.getValue()/100),WebGL.drawScene()}this.__defineGetter__("type",function(){return"contrast"}),this.el=e(s),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Contrast","/images/contrast_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.contrast_slider=new r(e("#contrast_slider"),"Contrast",-100,100,0),this.contrast_slider.setPos(90,0),this.brightness_slider=new r(e("#brightness_slider"),"Brightness",-100,100,0),this.brightness_slider.setPos(315,0),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(540,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(540,0);var n=this;setTimeout(function(){n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),WebGLShaders.setProgram("contrast"),n.contrast_slider.onchange(o),n.brightness_slider.onchange(o),n.cancel_button.click(function(){n.exitPanel(),AnalyticsTracker.sendEvent("adjustment_contrast_cancel")}),n.accept_button.click(function(){n.accept(),AnalyticsTracker.sendEvent("adjustment_contrast_apply")}),AnalyticsTracker.sendEvent("adjustment_contrast_select")},10)}return o.prototype.accept=function(){History.commit("contrast",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.exitPanel(),Canvas.saveCurrentImage(!1)},o.prototype.exitPanel=function(){WebGLShaders.setProgram("passthru"),this.el.remove(),WebGL.drawScene(),MainMenu.show()},o.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},o.prototype.getWidth=function(){return this.el.width()},o.prototype.hide=function(){this.el.hide()},o.prototype.show=function(){this.el.show()},o}),define("app/controls/ButtonGroupSelect",["jquery"],function(e,t){function n(t,n,r){this.buttons=t,this.buttonDict={},this.selectedButtonId=n.getId(),n.setSelected(!0);var i=this;for(var s=0;s<t.length;s++){var o=this.buttons[s];this.buttonDict[o.getId()]=o,o.click(function(){i.selectedButtonId!=e(this).attr("id")&&(i.selectedButtonId&&i.buttonDict[i.selectedButtonId].setSelected(!1),i.buttonDict[e(this).attr("id")].setSelected(!0),r(e(this).attr("id"))),i.selectedButtonId=e(this).attr("id")})}}return n}),define("text!ui/panels/color_panel.html",[],function(){return'<div class="panel" id="color_panel" style="\n	position:absolute;\n	width:625px;\n">\n\n<div id="panel_label"></div>\n\n<div id="adjust_vibrance_button"></div>\n<div id="adjust_warmth_button"></div>\n<div id="adjust_hue_button"></div>\n<div id="adjust_saturation_button"></div>\n\n<div id="hue_slider"></div>\n<div id="saturation_slider"></div>\n<div id="vibrance_slider"></div>\n<div id="warmth_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/ColorPanel",["jquery","app/controls/IconButton","app/controls/ButtonGroupSelect","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/color_panel.html"],function(e,t,n,r,i,s,o){function u(){function u(e){console.log("got: "+e);switch(e){case"adjust_vibrance_button":r.vibrance_slider.show(),r.hue_slider.hide(),r.saturation_slider.hide(),r.warmth_slider.hide();break;case"adjust_warmth_button":r.vibrance_slider.hide(),r.hue_slider.hide(),r.saturation_slider.hide(),r.warmth_slider.show();break;case"adjust_hue_button":r.vibrance_slider.hide(),r.hue_slider.show(),r.saturation_slider.hide(),r.warmth_slider.hide();break;case"adjust_saturation_button":r.vibrance_slider.hide(),r.hue_slider.hide(),r.saturation_slider.show(),r.warmth_slider.hide()}}function a(){console.log("updateHueSaturation");var e=WebGLShaders.getProgram();gl.uniform1f(e.uHue,r.hue_slider.getValue()/180),gl.uniform1f(e.uSaturation,r.saturation_slider.getValue()/100),gl.uniform1f(e.uVibrance,r.vibrance_slider.getValue()/100),gl.uniform1f(e.uWarmth,r.warmth_slider.getValue()/100),WebGL.drawScene()}this.__defineGetter__("type",function(){return"color"}),this.el=e(o),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Color","/images/color_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.adjust_vibrance_button=new s(e("#adjust_vibrance_button"),"Vibrance",null,100,undefined,25,25,!1),this.adjust_vibrance_button.setPos(90,0),this.adjust_warmth_button=new s(e("#adjust_warmth_button"),"Warmth",null,100,undefined,25,25,!1),this.adjust_warmth_button.setPos(195,0),this.adjust_hue_button=new s(e("#adjust_hue_button"),"Hue",null,100,undefined,25,25,!1),this.adjust_hue_button.setPos(90,45),this.adjust_saturation_button=new s(e("#adjust_saturation_button"),"Saturation",null,100,undefined,25,25,!1),this.adjust_saturation_button.setPos(195,45),this.selectGroup=new n([this.adjust_vibrance_button,this.adjust_warmth_button,this.adjust_hue_button,this.adjust_saturation_button],this.adjust_vibrance_button,u),this.hue_slider=new i(e("#hue_slider"),"Hue",-180,180,0),this.hue_slider.setPos(300,0),this.hue_slider.hide(),this.saturation_slider=new i(e("#saturation_slider"),"Saturation",-100,100,0),this.saturation_slider.setPos(300,0),this.saturation_slider.hide(),this.vibrance_slider=new i(e("#vibrance_slider"),"Vibrance",-100,100,0),this.vibrance_slider.setPos(300,0),this.warmth_slider=new i(e("#warmth_slider"),"Warmth",-100,100,0),this.warmth_slider.setPos(300,0),this.warmth_slider.hide(),this.cancel_button=new s(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(525,45),this.accept_button=new s(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(525,0);var r=this;setTimeout(function(){console.log("setTimeout called"),r.lastWidth=Canvas.getImageWidth(),r.lastHeight=Canvas.getImageHeight(),WebGLShaders.setProgram("color"),r.hue_slider.onchange(a),r.saturation_slider.onchange(a),r.vibrance_slider.onchange(a),r.warmth_slider.onchange(a),r.cancel_button.click(function(){r.exitPanel(),AnalyticsTracker.sendEvent("adjustment_color_cancel")}),r.accept_button.click(function(){r.accept(),AnalyticsTracker.sendEvent("adjustment_color_apply")}),AnalyticsTracker.sendEvent("adjustment_color_select")},10)}return u.prototype.accept=function(){History.commit("color",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.exitPanel(),Canvas.saveCurrentImage(!1)},u.prototype.exitPanel=function(){WebGLShaders.setProgram("passthru"),this.el.remove(),WebGL.drawScene(),MainMenu.show()},u.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},u.prototype.getWidth=function(){return this.el.width()},u.prototype.hide=function(){this.el.hide()},u.prototype.show=function(){this.el.show()},u}),define("text!ui/panels/auto_fix_panel.html",[],function(){return'<div class="panel" id="auto_fix_panel" style="\n	position:absolute;\n	width:190px;\n">\n\n<div id="panel_label"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/AutoFixPanel",["jquery","app/controls/IconButton","app/controls/Button","text!ui/panels/auto_fix_panel.html","app/image/ChannelMap"],function(e,t,n,r,i){function s(){this.__defineGetter__("type",function(){return"auto_fix"}),this.el=e(r),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Auto Fix","/images/auto_fix_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.cancel_button=new n(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(90,45),this.accept_button=new n(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(90,0),this.redArr=new Array,this.greenArr=new Array,this.blueArr=new Array;var i=this;setTimeout(function(){i.lastWidth=Canvas.getImageWidth(),i.lastHeight=Canvas.getImageHeight(),i.cancel_button.click(function(){i.exitPanel(),AnalyticsTracker.sendEvent("adjustment_auto_fix_cancel")}),i.accept_button.click(function(){i.accept(),AnalyticsTracker.sendEvent("adjustment_auto_fix_apply")}),AnalyticsTracker.sendEvent("adjustment_auto_fix_select");for(var e=0;e<256;e++)i.redArr.push(1),i.greenArr.push(1),i.blueArr.push(1);i.autofix()},10)}function o(e,t,n){for(var r=0;r<256;++r)if(e[r]>n){t.minin=r;break}for(var i=255;i>=0;--i)if(e[i]>n){t.maxin=i;break}}return s.prototype.autofix=function(){var e=WebGL.getPixelArray(!0),t=Canvas.getImageWidth(),n=Canvas.getImageHeight(),r,s,u;for(var a=0;a<n;a++)for(var f=0;f<t;f++){var l=(f+a*t)*4;r=e[l],s=e[l+1],u=e[l+2],this.redArr[r]+=1,this.greenArr[s]+=1,this.blueArr[u]+=1}var c=Math.round(t*n/1e3),h=new i,p=new i,d=new i;o(this.redArr,h,c),o(this.greenArr,p,c),o(this.blueArr,d,c);var v=WebGLEffects.createTextureFromRawRGB(h.ComputeArray(16),"red",!0),m=WebGLEffects.createTextureFromRawRGB(p.ComputeArray(8),"green",!0),g=WebGLEffects.createTextureFromRawRGB(d.ComputeArray(0),"blue",!0),y=WebGLShaders.setProgram("autofix");gl.uniform1i(y.uRed,1),gl.uniform1i(y.uGreen,2),gl.uniform1i(y.uBlue,3),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,v),gl.activeTexture(gl.TEXTURE0+2),gl.bindTexture(gl.TEXTURE_2D,m),gl.activeTexture(gl.TEXTURE0+3),gl.bindTexture(gl.TEXTURE_2D,g),WebGL.drawScene()},s.prototype.accept=function(){History.commit("auto_fix",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.exitPanel(),Canvas.saveCurrentImage(!1)},s.prototype.exitPanel=function(){WebGLShaders.setProgram("passthru"),this.el.remove(),WebGL.drawScene(),MainMenu.show()},s.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},s.prototype.getWidth=function(){return this.el.width()},s.prototype.hide=function(){this.el.hide()},s.prototype.show=function(){this.el.show()},s}),define("text!ui/manipulators/focal_blur_handle.html",[],function(){return'<canvas class="focal_blur_handle" width="20" height="20" style="\n	position:absolute;\n	width:20px;\n	height:20px;\n	cursor:pointer;\n">\n\n\n</canvas>'}),define("app/manipulators/FocalBlurHandle",["jquery","text!ui/manipulators/focal_blur_handle.html"],function(e,t){function n(n){this.el=e(t),this.focal_blur_manipulator=n,this.dragging=!1,this.OFFSET=10,this.drawOffState=function(){var e=this.el[0].getContext("2d");e.clearRect(0,0,20,20),e.fillStyle="#FFFFFF",e.beginPath(),e.arc(this.OFFSET,this.OFFSET,7,0,Math.PI*2,!0),e.strokeStyle="rgba(0, 0, 0, 0.5)",e.lineWidth=2,e.closePath(),e.fill(),e.stroke()},this.drawOnState=function(){var e=this.el[0].getContext("2d");e.clearRect(0,0,20,20),e.fillStyle="#3ea2ec",e.beginPath(),e.arc(this.OFFSET,this.OFFSET,7,0,Math.PI*2,!0),e.strokeStyle="rgba(255, 255, 255, 1.0)",e.lineWidth=2,e.closePath(),e.fill(),e.stroke()},this.drawOffState(),n.el.append(this.el);var r=this;this.el.mouseover(function(e){r.drawOnState()}),this.el.mouseout(function(e){r.drawOffState()}),this.el.mousedown(function(e){r.dragging=!0,r.omx=e.pageX,r.omy=e.pageY;var t=r.getAbsolutePos();r.ox=t.x,r.oy=t.y,console.log("start: "),console.log(t),console.log("omx: "+r.omx+" omy: "+r.omy)}),e(document).mouseup(function(){r.dragging&&(r.dragging=!1)}),e(document).mousemove(function(e){r.dragging&&r.focal_blur_manipulator.handleMoved(r,r.ox+e.pageX-r.omx,r.oy+e.pageY-r.omy)})}return n.prototype.setPos=function(e,t){this.el.css("left",e-this.OFFSET),this.el.css("top",t-this.OFFSET)},n.prototype.getPos=function(){return{x:parseInt(this.el.css("left"))+this.OFFSET,y:parseInt(this.el.css("top"))+this.OFFSET}},n.prototype.getAbsolutePos=function(){return{x:parseInt(this.el.offset().left+this.OFFSET),y:parseInt(this.el.offset().top+this.OFFSET)}},n.prototype.isDragging=function(){return this.dragging},n.prototype.remove=function(){this.el.remove()},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n}),define("text!ui/manipulators/focal_blur_rings.html",[],function(){return'<div>\n\n<div id="focal_blur_rings" style="\n	position:absolute;\n	width:550px;\n	height:400px;\n">\n\n\n</div>\n\n<canvas id="focal_blur_rings_background" style="\n	position:absolute;\n">\n\n</canvas>\n\n</div>'}),define("app/manipulators/FocalBlurRings",["jquery","app/manipulators/FocalBlurHandle","text!ui/manipulators/focal_blur_rings.html"],function(e,t,n){function r(r,i,s,o,u){this.panel=r,this.el=e(n).find("#focal_blur_rings"),this.el_bg=e(n).find("#focal_blur_rings_background"),this.width=o,this.height=u,this.min_x=i,this.min_y=s,this.max_x=i+o,this.max_y=s+u,this.inner_gap=0,this.outer_gap=0,e("body").append(this.el_bg),e("body").append(this.el),this.handle_center=new t(this),this.handle_inner=new t(this),this.handle_outer=new t(this);var a=this;o<u?(a.handle_center.setPos(o/2,u/2),a.handle_inner.setPos(4*o/6,u/2),a.handle_outer.setPos(5*o/6,u/2),a.inner_gap=a.outer_gap=o/6):(a.handle_center.setPos(o/2,u/2),a.handle_inner.setPos(o/2+1*u/6,u/2),a.handle_outer.setPos(o/2+2*u/6,u/2),a.inner_gap=a.outer_gap=u/6)}return r.prototype.handleMoved=function(e,t,n){console.log(t+", "+n);var r={x:t-this.min_x,y:n-this.min_y},i=5;switch(e){case this.handle_center:r.x<0?r.x=0:r.x>this.width-1&&(r.x=this.width-1),r.y<0?r.y=0:r.y>this.height-1&&(r.y=this.height-1),this.handle_center.setPos(r.x,r.y),this.handle_inner.setPos(r.x+this.inner_gap,r.y),this.handle_outer.setPos(r.x+this.inner_gap+this.outer_gap,r.y);break;case this.handle_inner:r.x-i<=this.handle_center.getPos().x&&(r.x=this.handle_center.getPos().x+i),r.x+i>=this.handle_outer.getPos().x&&(r.x=this.handle_outer.getPos().x-i),this.handle_inner.setPos(r.x,this.handle_inner.getPos().y),this.inner_gap=r.x-this.handle_center.getPos().x,this.handle_outer.setPos(r.x+this.outer_gap,this.handle_inner.getPos().y);break;case this.handle_outer:r.x-i<=this.handle_inner.getPos().x&&(r.x=this.handle_inner.getPos().x+i),this.handle_outer.setPos(r.x,this.handle_outer.getPos().y),this.outer_gap=r.x-this.handle_inner.getPos().x,this.inner_gap=r.x-this.handle_center.getPos().x-this.outer_gap}this.panel.updateFocalBlur("circle",this.handle_center.getAbsolutePos(),this.inner_gap,this.outer_gap),this.drawBackground()},r.prototype.setBackgroundPos=function(e,t){this.el_bg.css("left",e),this.el_bg.css("top",t),this.drawBackground()},r.prototype.drawBackground=function(){var e=this.el_bg[0].getContext("2d");e.clearRect(0,0,this.el_bg.width(),this.el_bg.height()),e.strokeStyle="rgba(255, 255, 255, 0.8)",e.beginPath(),console.log(this.handle_center.getAbsolutePos().x),e.arc(this.handle_center.getAbsolutePos().x,this.handle_center.getAbsolutePos().y,this.inner_gap,0,Math.PI*2,!0),e.setLineDash([]),e.lineWidth=2,e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=2,e.stroke(),e.closePath(),e.beginPath(),e.arc(this.handle_center.getAbsolutePos().x,this.handle_center.getAbsolutePos().y,this.inner_gap+this.outer_gap,0,Math.PI*2,!0);var t=2*Math.PI*(this.inner_gap+this.outer_gap),n=t/60*2/3;e.setLineDash([n,2*n]),e.lineDashOffset=-n,e.lineWidth=2,e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=2,e.stroke(),e.closePath()},r.prototype.setBackgroundSize=function(e,t){var n=this.el_bg[0].getContext("2d");n.canvas.width=e,n.canvas.height=t},r.prototype.setSize=function(e,t){this.width=e,this.height=t,this.el.css("width",e),this.el.css("height",t)},r.prototype.setPos=function(e,t){this.min_x=e,this.min_y=t,this.max_x=e+this.width,this.max_y=t+this.height,this.el.css("left",e),this.el.css("top",t)},r.prototype.remove=function(){this.el.remove(),this.el_bg.remove()},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r}),define("text!ui/manipulators/focal_blur_lines.html",[],function(){return'<div>\n\n<div id="focal_blur_lines" style="\n	position:absolute;\n	width:550px;\n	height:400px;\n">\n\n\n</div>\n\n<canvas id="focal_blur_lines_background" style="\n	position:absolute;\n">\n\n</canvas>\n\n</div>'}),define("app/manipulators/FocalBlurLines",["jquery","app/manipulators/FocalBlurHandle","text!ui/manipulators/focal_blur_lines.html"],function(e,t,n){function r(r,i,s,o,u){this.panel=r,this.el=e(n).find("#focal_blur_lines"),this.el_bg=e(n).find("#focal_blur_lines_background"),this.width=o,this.height=u,this.min_x=i,this.min_y=s,this.max_x=i+o,this.max_y=s+u,this.inner_gap=0,this.outer_gap=0,this.rotation=0,e("body").append(this.el_bg),e("body").append(this.el),this.handle_center=new t(this),this.handle_inner=new t(this),this.handle_outer=new t(this),this.handle_rotation=new t(this);var a=this;o<u?(a.handle_center.setPos(o/2,u/2),a.handle_inner.setPos(o/2,u/2+1*o/6),a.handle_outer.setPos(o/2,u/2+2*o/6),a.inner_gap=a.outer_gap=o/6):(a.handle_center.setPos(o/2,u/2),a.handle_inner.setPos(o/2,u/2+1*u/6),a.handle_outer.setPos(o/2,u/2+2*u/6),a.inner_gap=a.outer_gap=u/6),this.positionHandles=function(){var e=a.handle_center.getPos(),t=a.rotation+Math.PI*5/4,n=30*Math.cos(t),r=30*Math.sin(t);a.handle_rotation.setPos(e.x+n,e.y+r),n=a.inner_gap*Math.cos(Math.PI/2+a.rotation),r=a.inner_gap*Math.sin(Math.PI/2+a.rotation),a.handle_inner.setPos(e.x+n,e.y+r),n=(a.inner_gap+a.outer_gap)*Math.cos(Math.PI/2+a.rotation),r=(a.inner_gap+a.outer_gap)*Math.sin(Math.PI/2+a.rotation),a.handle_outer.setPos(e.x+n,e.y+r)},this.positionHandles()}return r.prototype.handleMoved=function(e,t,n){console.log(t+", "+n);var r={x:t-this.min_x,y:n-this.min_y},i=5;switch(e){case this.handle_rotation:var s=this.handle_center.getPos(),o=r.x-s.x,u=r.y-s.y;console.log("rotation offset: "+o+", "+u);var a=Math.atan2(u,o)-Math.PI*5/4;console.log("angle: "+a),this.rotation=a,this.positionHandles();break;case this.handle_center:r.x<0?r.x=0:r.x>this.width-1&&(r.x=this.width-1),r.y<0?r.y=0:r.y>this.height-1&&(r.y=this.height-1),this.handle_center.setPos(r.x,r.y),this.handle_inner.setPos(r.x,r.y+this.inner_gap),this.handle_outer.setPos(r.x,r.y+this.inner_gap+this.outer_gap),this.positionHandles();break;case this.handle_inner:var s=this.handle_center.getPos(),f=this.rotation,o=Math.cos(f),u=Math.sin(f);console.log("yoffset: "+u),console.log("xoffset: "+o);if(Math.abs(u)<1e-7)o>0&&r.y-i<=this.handle_center.getPos().y?r.y=this.handle_center.getPos().y+i:o<0&&r.y+i>=this.handle_center.getPos().y&&(r.y=this.handle_center.getPos().y-i),this.inner_gap=Math.abs(r.y-this.handle_center.getPos().y),console.log("inner gap: "+this.inner_gap);else if(Math.abs(o)<1e-7)u<0&&r.x-i<=this.handle_center.getPos().x?r.x=this.handle_center.getPos().x+i:u>0&&r.x+i>=this.handle_center.getPos().x&&(r.x=this.handle_center.getPos().x-i),this.inner_gap=Math.abs(r.x-this.handle_center.getPos().x);else{var l=u/o,c=1/(l+1/l)*(r.x/l+r.y-s.y+l*s.x),h=l*(c-s.x)+s.y,p=Math.sqrt(Math.pow(c-r.x,2)+Math.pow(h-r.y,2));this.inner_gap=Math.max(i,p)}this.positionHandles();break;case this.handle_outer:var s=this.handle_center.getPos(),f=this.rotation,o=Math.cos(f),u=Math.sin(f);if(Math.abs(u)<1e-7)o>0&&r.y-i<=this.handle_inner.getPos().y?r.y=this.handle_inner.getPos().y+i:o<0&&r.y+i>=this.handle_inner.getPos().y&&(r.y=this.handle_inner.getPos().y-i),this.outer_gap=Math.abs(r.y-this.handle_center.getPos().y)-this.inner_gap;else if(Math.abs(o)<1e-7)u<0&&r.x-i<=this.handle_inner.getPos().x?r.x=this.handle_inner.getPos().x+i:u>0&&r.x+i>=this.handle_inner.getPos().x&&(r.x=this.handle_inner.getPos().x-i),this.outer_gap=Math.abs(r.x-this.handle_center.getPos().x)-this.inner_gap;else{var l=u/o,c=1/(l+1/l)*(r.x/l+r.y-s.y+l*s.x),h=l*(c-s.x)+s.y,p=Math.sqrt(Math.pow(c-r.x,2)+Math.pow(h-r.y,2));this.outer_gap=Math.max(i,p-this.inner_gap)}this.positionHandles()}this.panel.updateFocalBlur("line",this.handle_center.getAbsolutePos(),this.inner_gap,this.outer_gap,this.rotation),this.drawBackground()},r.prototype.setBackgroundPos=function(e,t){this.el_bg.css("left",e),this.el_bg.css("top",t),this.drawBackground()},r.prototype.drawBackground=function(){var e=this.el_bg[0].getContext("2d");e.clearRect(0,0,this.el_bg.width(),this.el_bg.height()),e.strokeStyle="rgba(255, 255, 255, 0.8)",e.beginPath(),e.moveTo(this.handle_center.getAbsolutePos().x,this.handle_center.getAbsolutePos().y),e.lineTo(this.handle_rotation.getAbsolutePos().x,this.handle_rotation.getAbsolutePos().y);if(Math.abs(this.rotation%Math.PI)==Math.PI/2)e.moveTo(this.handle_inner.getAbsolutePos().x,0),e.lineTo(this.handle_inner.getAbsolutePos().x,this.el_bg.height());else{var t=Math.tan(this.rotation)*this.handle_inner.getAbsolutePos().x,n=Math.tan(this.rotation)*(this.el_bg.width()-this.handle_inner.getAbsolutePos().x);e.moveTo(0,this.handle_inner.getAbsolutePos().y-t),e.lineTo(this.el_bg.width(),this.handle_inner.getAbsolutePos().y+n)}var r={x:this.handle_center.getAbsolutePos().x-(this.handle_inner.getAbsolutePos().x-this.handle_center.getAbsolutePos().x),y:this.handle_center.getAbsolutePos().y-(this.handle_inner.getAbsolutePos().y-this.handle_center.getAbsolutePos().y)};if(Math.abs(this.rotation%Math.PI)==Math.PI/2)e.moveTo(r.x,0),e.lineTo(r.x,this.el_bg.height());else{var t=Math.tan(this.rotation)*r.x,n=Math.tan(this.rotation)*(this.el_bg.width()-r.x);e.moveTo(0,r.y-t),e.lineTo(this.el_bg.width(),r.y+n)}e.setLineDash([]),e.lineWidth=2,e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=2,e.stroke(),e.closePath(),e.beginPath(),e.lineWidth=2,e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=2;if(Math.abs(this.rotation%Math.PI)==Math.PI/2)e.moveTo(this.handle_outer.getAbsolutePos().x,0),e.lineTo(this.handle_outer.getAbsolutePos().x,this.el_bg.height());else{var t=Math.tan(this.rotation)*this.handle_outer.getAbsolutePos().x,n=Math.tan(this.rotation)*(this.el_bg.width()-this.handle_outer.getAbsolutePos().x);e.moveTo(this.handle_outer.getAbsolutePos().x,this.handle_outer.getAbsolutePos().y),e.lineTo(0,this.handle_outer.getAbsolutePos().y-t),e.moveTo(this.handle_outer.getAbsolutePos().x,this.handle_outer.getAbsolutePos().y),e.lineTo(this.el_bg.width(),this.handle_outer.getAbsolutePos().y+n)}var i={x:this.handle_center.getAbsolutePos().x-(this.handle_outer.getAbsolutePos().x-this.handle_center.getAbsolutePos().x),y:this.handle_center.getAbsolutePos().y-(this.handle_outer.getAbsolutePos().y-this.handle_center.getAbsolutePos().y)};if(Math.abs(this.rotation%Math.PI)==Math.PI/2)e.moveTo(i.x,0),e.lineTo(i.x,this.el_bg.height());else{var t=Math.tan(this.rotation)*i.x,n=Math.tan(this.rotation)*(this.el_bg.width()-i.x);e.moveTo(i.x,i.y),e.lineTo(0,i.y-t),e.moveTo(i.x,i.y),e.lineTo(this.el_bg.width(),i.y+n)}e.setLineDash([10]),e.lineDashOffset=5,e.stroke(),e.closePath()},r.prototype.setBackgroundSize=function(e,t){var n=this.el_bg[0].getContext("2d");console.log("lines bg: "+e+" x "+t),n.canvas.width=e,n.canvas.height=t},r.prototype.setSize=function(e,t){this.width=e,this.height=t,this.el.css("width",e),this.el.css("height",t)},r.prototype.setPos=function(e,t){this.min_x=e,this.min_y=t,this.max_x=e+this.width,this.max_y=t+this.height,this.el.css("left",e),this.el.css("top",t)},r.prototype.remove=function(){this.el.remove(),this.el_bg.remove()},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r}),define("text!ui/panels/focal_blur_panel.html",[],function(){return'<div class="panel" id="focal_blur_panel" style="\n	position:absolute;\n	width:460px;\n">\n\n<div id="panel_label"></div>\n\n<div id="circular_button"></div>\n<div id="linear_button"></div>\n\n\n<div id="blur_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/FocalBlurPanel",["jquery","app/controls/IconButton","slider","app/controls/ButtonGroupSelect","app/controls/SliderBox","app/controls/Button","app/manipulators/FocalBlurRings","app/manipulators/FocalBlurLines","text!ui/panels/focal_blur_panel.html"],function(e,t,n,r,i,s,o,u,a){function f(){var e=Canvas.getScale(),t=e,n=e;Math.round(e*Canvas.getImageWidth()*1e5)/1e5%1>0&&(t=Math.round(e*Canvas.getImageWidth())/Canvas.getImageWidth()),Math.round(e*Canvas.getImageHeight()*1e5)/1e5%1>0&&(n=Math.round(e*Canvas.getImageHeight())/Canvas.getImageHeight());var r=Math.round((Canvas.getWidth()/2-Canvas.getImageWidth()*t/2)*1e5)/1e5,i=Math.round((Canvas.getHeight()/2-Canvas.getImageHeight()*n/2)*1e5)/1e5;return{x:r,y:i}}function l(){this.__defineGetter__("type",function(){return"focal_blur"}),this.el=e(a),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Focal Blur","/images/focal_blur_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.blur_slider=new i(e("#blur_slider"),"Blur",0,100,50),this.blur_slider.setPos(135,0),this.cancel_button=new s(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(360,45),this.accept_button=new s(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(360,0);var n=this;WebGL.scaleToFit(),Canvas.setScaleEnabled(!1),this.circular_button=new s(e("#circular_button"),null,"/images/focal_blur_circular_icon.png",40,undefined,25,25,!1),this.circular_button.setPos(90,0),this.linear_button=new s(e("#linear_button"),null,"/images/focal_blur_linear_icon.png",40,undefined,25,25,!1),this.linear_button.setPos(90,45),this.centerX=0,this.centerY=0,this.innerRadius=0,this.outterRadius=0,this.resolutionRate=0,this.blur_texture=null,this.blur_value=0,this.centerXUnscaled=0,this.centerYUnscaled=0,this.innerRadiusUnscaled=0,this.outterRadiusUnscaled=0,this.focaltype=null,this.rotation=0,this.textures=[],this.framebuffers=[],setTimeout(function(){n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),n.blur_slider.mouseup(n.renderFocalBlur),n.cancel_button.click(function(){n.exitPanel(!0),AnalyticsTracker.sendEvent("adjustment_focal_blur_cancel")}),n.accept_button.click(function(){n.accept(),AnalyticsTracker.sendEvent("adjustment_focal_blur_apply")}),AnalyticsTracker.sendEvent("adjustment_focal_blur_select");var e=f();n.focal_blur_manipulator=new o(n,Math.round(e.x),Math.round(e.y),Math.round(Canvas.getImageWidth()*Canvas.getScale()),Math.round(Canvas.getImageHeight()*Canvas.getScale())),n.onResize(),n.updateFocalBlur("circle",n.focal_blur_manipulator.handle_center.getAbsolutePos(),n.focal_blur_manipulator.inner_gap,n.focal_blur_manipulator.outer_gap,n.rotation)},20),this.onResize=function(){var t=f();console.log("onResize"),n.focal_blur_manipulator.setPos(Math.round(t.x),Math.round(t.y)),n.focal_blur_manipulator.setBackgroundSize(e(window).width(),e(window).height()),n.focal_blur_manipulator.setBackgroundPos(0,0)},this.onCircularLinearButtonClicked=function(e){console.log("flipped: "+e),n.focal_blur_manipulator.remove();var t=f();e=="circular_button"?n.focal_blur_manipulator=new o(n,Math.round(t.x),Math.round(t.y),Math.round(Canvas.getImageWidth()*Canvas.getScale()),Math.round(Canvas.getImageHeight()*Canvas.getScale())):n.focal_blur_manipulator=new u(n,Math.round(t.x),Math.round(t.y),Math.round(Canvas.getImageWidth()*Canvas.getScale()),Math.round(Canvas.getImageHeight()*Canvas.getScale())),n.rotation=0,n.onResize(),n.updateFocalBlur(e=="circular_button"?"circle":"line",n.focal_blur_manipulator.handle_center.getAbsolutePos(),n.focal_blur_manipulator.inner_gap,n.focal_blur_manipulator.outer_gap,n.rotation)},this.selectGroup=new r([this.circular_button,this.linear_button],this.circular_button,this.onCircularLinearButtonClicked),this.generateBlurTexture=function(){if(n.blur_value==n.blur_slider.getValue())return;n.blur_value=n.blur_slider.getValue(),WebGLShaders.setProgram("blur");var e=WebGLShaders.getProgram(),t=[];if(n.textures.length==0&&n.framebuffers.length==0)for(var r=0;r<2;r++){var i=WebGL.createAndSetupTexture(gl);n.textures.push(i),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,Canvas.getImageWidth()/2,Canvas.getImageHeight()/2,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var s=gl.createFramebuffer();s.width=Canvas.getImageWidth()/2,s.height=Canvas.getImageHeight()/2,n.framebuffers.push(s),gl.bindFramebuffer(gl.FRAMEBUFFER,s),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,i,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}gl.bindTexture(gl.TEXTURE_2D,WebGL.getDisplayTexture()),WebGL.setFramebuffer(n.framebuffers[0],Canvas.getImageWidth()/2,Canvas.getImageHeight()/2),gl.uniform2fv(e.delta,[n.blur_slider.getValue()/Canvas.getImageWidth(),0]),t.push(WebGL.getDisplayTexture()),WebGL.drawTexture(t),gl.bindTexture(gl.TEXTURE_2D,n.textures[0]),WebGL.setFramebuffer(n.framebuffers[1],Canvas.getImageWidth()/2,Canvas.getImageHeight()/2),gl.uniform2fv(e.delta,[0,n.blur_slider.getValue()/Canvas.getImageHeight()]),t=[],t.push(n.textures[0]),WebGL.drawTexture(t),gl.bindTexture(gl.TEXTURE_2D,null),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),this.blur_texture=n.textures[1]},this.renderFocalBlur=function(){n.generateBlurTexture();if(n.blur_texture!=null){WebGLShaders.setProgram("focalblur");var e=WebGLShaders.getProgram();gl.uniform2fv(e.center,[n.centerX,n.centerY]),gl.uniform1f(e.innerRadius,n.innerRadius),gl.uniform1f(e.outterRadius,n.outterRadius),gl.uniform1f(e.resolutionRate,n.resolutionRate),gl.uniform1i(e.type,n.focaltype=="circle"?0:1),gl.uniform1f(e.rotation,n.rotation),gl.uniform1f(e.rotateAngle,n.rotation*180/Math.PI),console.log("rotation is :"+n.rotation+"  "+n.rotation*180/Math.PI),gl.uniform1i(e.blurTexture,1),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,n.blur_texture),WebGL.drawScene()}},e(window).resize(n.onResize)}return l.prototype.updateFocalBlur=function(e,t,n,r,i){console.log(t.x),console.log("rotation: "+i);var s=f();t.x-=s.x,t.y-=s.y,console.log(e+" updateFocalBlur (scaled): ("+t.x+", "+t.y+"): "+n+", "+r);var o=Canvas.getScale();this.centerX=t.x/(Canvas.getImageWidth()*o),this.centerY=1-t.y/(Canvas.getImageHeight()*o),this.innerRadius=n/(Canvas.getImageWidth()*o),this.outterRadius=(r+n)/(Canvas.getImageWidth()*o),this.resolutionRate=Canvas.getImageWidth()==Canvas.getImageHeight()?1:Canvas.getImageWidth()/Canvas.getImageHeight(),console.log("scale  "+o),t.x/=o,t.y/=o,n/=o,r/=o,this.centerXUnscaled=t.x,this.centerYUnscaled=t.y,this.innerRadiusUnscaled=n,this.outterRadiusUnscaled=r+n,this.focaltype=e,this.rotation=i,this.renderFocalBlur(),console.log(e+" updateFocalBlur (unscaled): ("+t.x+", "+t.y+"): "+n+", "+r)},l.prototype.accept=function(){History.commit("focal_blur",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.exitPanel(),Canvas.saveCurrentImage(!1),this.releaseFramebuffer()},l.prototype.exitPanel=function(e){WebGLShaders.setProgram("passthru"),Canvas.setScaleEnabled(!0),this.el.remove(),this.focal_blur_manipulator.remove(),WebGL.drawScene(),MainMenu.show(),e&&this.releaseFramebuffer()},l.prototype.releaseFramebuffer=function(){gl.deleteFramebuffer(this.framebuffers[0]),gl.deleteFramebuffer(this.framebuffers[1]),gl.deleteTexture(this.textures[0]),gl.deleteTexture(this.textures[1]),gl.deleteTexture(this.blur_texture)},l.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},l.prototype.getWidth=function(){return this.el.width()},l.prototype.hide=function(){this.el.hide()},l.prototype.show=function(){this.el.show()},l}),define("text!ui/input_box.html",[],function(){return'<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	height:40px;\n">\n	<input id="input" type="text" style="\n		background-color:#222222;\n		font-size:14px;\n		color:white;\n		position:absolute;\n		left:12px;\n		top:8px;\n		width:45px;\n		border:solid 1px #bbbbbb;\n		padding:0px 3px;\n		text-align:right;\n		"></input>\n	<div id="title" style="font-size:14px;color:white;position:absolute;left:75px;top:10px;"></div>\n</div>'}),define("text!ui/text_area_box.html",[],function(){return'<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	width: 151px;\n	height: 85px;\n">\n	<textarea id="input" wrap="off" placeholder="Type your text here" style="\n		background-color:#222222;\n		font-size:12px;\n		color:white;\n		position:absolute;\n		left:6px;\n		top:6px;\n		border:solid 1px #bbbbbb;\n		padding:0px 3px;\n		overflow:hidden;\n		resize: none;\n		"></textarea>\n	<div id="title" style="font-size:14px;color:white;position:absolute;left:75px;top:10px;"></div>\n</div>'}),define("app/controls/InputBox",["jquery","text!ui/input_box.html","text!ui/text_area_box.html"],function(e,t,n){function r(r,i,s,o){this.el=r,this.title=i,this.changeCallback=null;var u=o?e(n):e(t);u.attr("id",e(this.el).attr("id")),u.find("#title").html(this.title),u.css("width",s),this.el.replaceWith(u),this.el=u,this.input_el=u.find("#input")}return r.prototype.setValue=function(e){!isNaN(parseFloat(e))&&isFinite(e)&&this.input_el.val(e)},r.prototype.getValue=function(){return this.input_el.val()},r.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r.prototype.change=function(e){this.changeCallback=e,this.input_el.keyup(e)},r.prototype.disableInput=function(){this.input_el.attr("disabled","disabled")},r.prototype.enableInput=function(){this.input_el.removeAttr("disabled")},r}),define("text!ui/manipulators/crop_box_handle.html",[],function(){return'<div class="crop_box_handle" style="\n	position:absolute;\n	width:10px;\n	height:10px;\n	background-color:#3da6f4;\n	border:solid 1px white;\n">\n\n\n</div>'}),define("app/manipulators/CropBoxHandle",["jquery","text!ui/manipulators/crop_box_handle.html"],function(e,t){function n(n){this.el=e(t),this.crop_box=n,this.dragging=!1,e("#crop_box").append(this.el);var r=this;this.el.mousedown(function(e){r.dragging=!0,r.omx=e.pageX,r.omy=e.pageY;var t=r.getAbsolutePos();r.ox=t.x,r.oy=t.y}),e(document).mouseup(function(){r.dragging&&(r.dragging=!1)}),e(document).mousemove(function(e){r.dragging&&r.crop_box.handleMoved(r,r.ox+e.pageX-r.omx,r.oy+e.pageY-r.omy)})}return n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.getAbsolutePos=function(){return{x:parseInt(this.el.offset().left)+6,y:parseInt(this.el.offset().top)+6}},n.prototype.isDragging=function(){return this.dragging},n.prototype.remove=function(){this.el.remove()},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n}),define("text!ui/manipulators/crop_box.html",[],function(){return'<div>\n\n<div id="crop_box" style="\n	position:absolute;\n	width:550px;\n	height:400px;\n">\n\n\n</div>\n\n<canvas id="crop_box_background" style="\n	position:absolute;\n">\n\n</canvas>\n\n</div>'}),define("app/manipulators/CropBox",["jquery","app/manipulators/CropBoxHandle","text!ui/manipulators/crop_box.html"],function(e,t,n){function r(r,i,s,o,u){this.panel=r,this.el=e(n).find("#crop_box"),this.el_bg=e(n).find("#crop_box_background"),this.width=o,this.height=u,this.min_x=i,this.min_y=s,this.max_x=i+o,this.max_y=s+u,this.aspectRatioLock=null,this.__defineGetter__("MIN_CROP_DIMENSION",function(){return 1}),e("body").append(this.el_bg),e("body").append(this.el),this.handle_tl=new t(this),this.handle_tr=new t(this),this.handle_br=new t(this),this.handle_bl=new t(this),this.setSize(o,u),this.setBackgroundSize(o,u),this.layout(),this.dragging=!1;var a=this;this.el.mousedown(function(e){a.dragging=!0,a.omx=e.pageX,a.omy=e.pageY;var t=a.getPos();a.ox=t.x,a.oy=t.y}),e(document).mouseup(function(){a.dragging=!1}),e(document).mousemove(function(e){if(a.handle_tl.isDragging()||a.handle_tr.isDragging()||a.handle_bl.isDragging()||a.handle_br.isDragging())return;a.dragging&&(a.setPos(a.ox+e.pageX-a.omx,a.oy+e.pageY-a.omy),a.drawBackground())})}return r.prototype.updateBounds=function(e,t,n,r){this.min_x=e,this.min_y=t,this.max_x=e+n,this.max_y=t+r},r.prototype.handleMoved=function(e,t,n){var r=this.min_x,i=this.min_y,s=this.max_x,o=this.max_y,u=Math.max(1,Math.round(this.MIN_CROP_DIMENSION*Canvas.getScale())),a=this.getPos(),f;switch(e){case this.handle_tl:t=Math.max(t,r),n=Math.max(n,i),f=this.handle_br.getAbsolutePos();var l=Math.max(0,f.x-t),c=Math.max(0,f.y-n);this.aspectRatioLock&&(l/c>this.aspectRatioLock?(n=f.y-c,t=Math.round(f.x-c*this.aspectRatioLock)):(t=f.x-l,n=Math.round(f.y-l/this.aspectRatioLock))),t>f.x-u&&(t=f.x-u),n>f.y-u&&(n=f.y-u);var h=this.getWidth()-(t-a.x),p=this.getHeight()-(n-a.y);this.setSize(h,p),this.setPos(t,n);break;case this.handle_tr:t=Math.min(t,s),n=Math.max(n,i),f=this.handle_bl.getAbsolutePos();var l=Math.max(0,t-f.x),c=Math.max(0,f.y-n);this.aspectRatioLock&&(l/c>this.aspectRatioLock?(n=f.y-c,t=Math.round(f.x+c*this.aspectRatioLock)):(t=f.x+l,n=Math.round(f.y-l/this.aspectRatioLock))),t<f.x+u&&(t=f.x+u),n>f.y-u&&(n=f.y-u);var h=t-a.x,p=this.getHeight()-(n-a.y);this.setSize(h,p),this.setPos(t-h,n);break;case this.handle_bl:t=Math.max(t,r),n=Math.min(n,o),f=this.handle_tr.getAbsolutePos();var l=Math.max(0,f.x-t),c=Math.max(0,n-f.y);this.aspectRatioLock&&(l/c>this.aspectRatioLock?(n=f.y+c,t=Math.round(f.x-c*this.aspectRatioLock)):(t=f.x-l,n=Math.round(f.y+l/this.aspectRatioLock))),t>f.x-u&&(t=f.x-u),n<f.y+u&&(n=f.y+u);var h=this.getWidth()-(t-a.x),p=n-a.y;this.setSize(h,p),this.setPos(t,n-p);break;case this.handle_br:t=Math.min(t,s),n=Math.min(n,o),f=this.handle_tl.getAbsolutePos();var l=Math.max(0,t-f.x),c=Math.max(0,n-f.y);this.aspectRatioLock&&(l/c>this.aspectRatioLock?(n=f.y+c,t=Math.round(f.x+c*this.aspectRatioLock)):(t=f.x+l,n=Math.round(f.y+l/this.aspectRatioLock))),t<f.x+u&&(t=f.x+u),n<f.y+u&&(n=f.y+u);var h=t-a.x,p=n-a.y;this.setSize(h,p),this.setPos(t-h,n-p)}this.layout(),this.drawBackground()},r.prototype.drawBackground=function(){var e=this.getPos();console.log("pos: "+e.x+" "+e.y);var t=this.min_x,n=this.min_y,r=e.x-t,i=e.y-n,s=this.getWidth(),o=this.getHeight();console.log("drawBackground: "+(e.x-t)+","+(e.y-n)+": "+this.el.width()+"x"+this.el.height());var u=this.el_bg[0].getContext("2d");u.clearRect(0,0,this.el_bg.width(),this.el_bg.height()),u.fillStyle="rgba(60, 60, 60, 0.7)",u.fillRect(0,0,this.el_bg.width(),this.el_bg.height()),u.clearRect(e.x-t,e.y-n,s,o),u.strokeStyle="rgba(255, 255, 255, 0.4)",u.beginPath(),u.moveTo(parseInt(r+s/3)+.5,i+.5),u.lineTo(parseInt(r+s/3)+.5,i+o-.5),u.moveTo(parseInt(r+s/3*2)+.5,i+.5),u.lineTo(parseInt(r+s/3*2)+.5,i+o-.5),u.moveTo(r+.5,parseInt(i+o/3)+.5),u.lineTo(r+s-.5,parseInt(i+o/3)+.5),u.moveTo(r+.5,parseInt(i+o/3*2)+.5),u.lineTo(r+s-.5,parseInt(i+o/3*2)+.5),u.lineWidth=1,u.stroke(),u.closePath(),u.strokeStyle="rgba(255, 255, 255, 1)",u.strokeRect(parseInt(e.x-t)+.5,parseInt(e.y-n)+.5,s-1,o-1)},r.prototype.setBackgroundSize=function(e,t){var n=this.el_bg[0].getContext("2d");n.canvas.width=e,n.canvas.height=t},r.prototype.layout=function(e){e=typeof e!="undefined"?e:!0,this.handle_tl.setPos(-6,-6),this.handle_tr.setPos(-6+this.getWidth(),-6),this.handle_br.setPos(-6+this.getWidth(),-6+this.getHeight()),this.handle_bl.setPos(-6,-6+this.getHeight()),e&&this.panel.updateCropSize(this.getWidth(),this.getHeight())},r.prototype.getAspectRatioLock=function(){return this.aspectRatioLock},r.prototype.setDimensions=function(e,t){console.log("setDimensions: "+e+"x"+t);var n=Math.round(e*Canvas.getScale()),r=Math.round(t*Canvas.getScale());this.setSize(n,r);var i=this.getPos();this.setPos(i.x,i.y),this.layout(!1),this.drawBackground()},r.prototype.setPos=function(e,t){var n=this.min_x,r=this.min_y,i=this.max_x,s=this.max_y;e<n&&(e=n),t<r&&(t=r),e+this.getWidth()>i&&(e=i-this.getWidth()),t+this.getHeight()>s&&(t=s-this.getHeight()),this.el.css("left",e),this.el.css("top",t)},r.prototype.setBackgroundPos=function(e,t){this.el_bg.css("left",e),this.el_bg.css("top",t),this.drawBackground()},r.prototype.getPos=function(){return{x:parseInt(this.el.css("left")),y:parseInt(this.el.css("top"))}},r.prototype.setAspectRatioLock=function(e){this.aspectRatioLock=e},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.setSize=function(e,t){this.width=e,this.height=t,this.el.css("width",e),this.el.css("height",t)},r.prototype.remove=function(){this.el.remove(),this.el_bg.remove()},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r}),define("text!ui/panels/crop_panel.html",[],function(){return'<div class="panel" id="crop_panel" style="\n	position:absolute;\n	width:470px;\n">\n\n<div id="panel_label"></div>\n\n<div id="aspect_x_y_button"></div>\n<div id="aspect_1_1_button"></div>\n<div id="aspect_5_4_button"></div>\n<div id="aspect_4_3_button"></div>\n<div id="aspect_3_2_button"></div>\n<div id="aspect_16_9_button"></div>\n\n<div id="width_box"></div>\n<div id="height_box"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/CropPanel",["jquery","app/controls/IconButton","app/controls/ButtonGroupSelect","slider","app/controls/SliderBox","app/controls/Button","app/controls/InputBox","app/manipulators/CropBox","text!ui/panels/crop_panel.html"],function(e,t,n,r,i,s,o,u,a){function f(){var e=Canvas.getScale(),t=e,n=e;Math.round(e*Canvas.getImageWidth()*1e5)/1e5%1>0&&(t=Math.round(e*Canvas.getImageWidth())/Canvas.getImageWidth()),Math.round(e*Canvas.getImageHeight()*1e5)/1e5%1>0&&(n=Math.round(e*Canvas.getImageHeight())/Canvas.getImageHeight());var r=Math.round((Canvas.getWidth()/2-Canvas.getImageWidth()*t/2)*1e5)/1e5,i=Math.round((Canvas.getHeight()/2-Canvas.getImageHeight()*n/2)*1e5)/1e5;return{x:r,y:i}}function l(){function d(e){return!isNaN(parseFloat(e))&&isFinite(e)}function m(e){g(v.aspectRatioDict[e])}function g(e){var t=Canvas.getImageWidth(),n=Canvas.getImageHeight();if(!e)v.crop_box.setDimensions(t,n),v.crop_box.setAspectRatioLock(null);else{console.log("set aspect ratio: "+e),v.crop_box.setAspectRatioLock(e);var r,i,s,o;t/n>e?(r=n,i=n*e,o=0,s=(t-i)/2):(i=t,r=t/e,s=0,o=(n-r)/2),console.log(v.ox+" "+v.oy);var u=Math.round(v.ox+s*Canvas.getScale()),a=Math.round(v.oy+o*Canvas.getScale());console.log("x: "+u),console.log("y: "+a),v.crop_box.setDimensions(i,r),v.crop_box.setPos(u,a),v.crop_box.drawBackground()}v.updateCropSize(v.crop_box.getWidth(),v.crop_box.getHeight())}function y(){var e=f(),t=e.x,n=e.y,r=v.crop_box.getPos().x-v.ox,i=v.crop_box.getPos().y-v.oy;v.ox=t,v.oy=n,console.log("offset: "+r+" "+i),v.crop_box.updateBounds(Math.round(t),Math.round(n),Math.round(Canvas.getImageWidth()*Canvas.getScale()),Math.round(Canvas.getImageHeight()*Canvas.getScale())),v.crop_box.setPos(Math.round(t+r),Math.round(n+i)),v.crop_box.setBackgroundPos(Math.round(t),Math.round(n))}this.__defineGetter__("type",function(){return"crop"}),this.el=e(a),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Crop","/images/crop_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),e("#menu").css("pointer-events","none"),this.el.css("pointer-events","auto"),WebGL.scaleToFit(),Canvas.setScaleEnabled(!1);var r=Canvas.getScale(),i=r,l=r,c=f(),h=c.x,p=c.y;this.width_box=new o(e("#width_box"),"Width",140),this.width_box.setPos(225,0),this.width_box.setValue(Canvas.getImageWidth()),this.height_box=new o(e("#height_box"),"Height",140),this.height_box.setPos(225,45),this.height_box.setValue(Canvas.getImageHeight()),this.width_box.change(function(){var e=parseInt(v.height_box.getValue()),t=parseInt(v.width_box.getValue()),n=v.crop_box.getAspectRatioLock();n&&(e=t/n),d(e)&&d(t)&&t>=v.crop_box.MIN_CROP_DIMENSION&&t<=Canvas.getImageWidth()&&e>=v.crop_box.MIN_CROP_DIMENSION&&e<=Canvas.getImageHeight()&&(v.crop_box.setDimensions(t,e),v.width_box.setValue(Math.round(t)),v.height_box.setValue(Math.round(e)))}),this.height_box.change(function(){var e=parseInt(v.height_box.getValue()),t=parseInt(v.width_box.getValue()),n=v.crop_box.getAspectRatioLock();n&&(t=e*n),d(e)&&d(t)&&t>=v.crop_box.MIN_CROP_DIMENSION&&t<=Canvas.getImageWidth()&&e>=v.crop_box.MIN_CROP_DIMENSION&&e<=Canvas.getImageHeight()&&(v.crop_box.setDimensions(t,e),v.width_box.setValue(Math.round(t)),v.height_box.setValue(Math.round(e)))}),this.cancel_button=new s(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(370,45),this.accept_button=new s(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(370,0),this.aspectRatioDict={aspect_x_y_button:null,aspect_1_1_button:1,aspect_3_2_button:1.5,aspect_4_3_button:4/3,aspect_5_4_button:5/4,aspect_16_9_button:16/9},this.aspect_x_y_button=new s(e("#aspect_x_y_button"),null,"/images/xy_icon.png",40,undefined,25,25,!1),this.aspect_x_y_button.setPos(90,0),this.aspect_1_1_button=new s(e("#aspect_1_1_button"),null,"/images/11_icon.png",40,undefined,25,25,!1),this.aspect_1_1_button.setPos(135,0),this.aspect_5_4_button=new s(e("#aspect_5_4_button"),null,"/images/54_icon.png",40,undefined,25,25,!1),this.aspect_5_4_button.setPos(180,0),this.aspect_4_3_button=new s(e("#aspect_4_3_button"),null,"/images/43_icon.png",40,undefined,25,25,!1),this.aspect_4_3_button.setPos(90,45),this.aspect_3_2_button=new s(e("#aspect_3_2_button"),null,"/images/32_icon.png",40,undefined,25,25,!1),this.aspect_3_2_button.setPos(135,45),this.aspect_16_9_button=new s(e("#aspect_16_9_button"),null,"/images/169_icon.png",40,undefined,25,25,!1),this.aspect_16_9_button.setPos(180,45),this.selectGroup=new n([this.aspect_x_y_button,this.aspect_1_1_button,this.aspect_3_2_button,this.aspect_4_3_button,this.aspect_16_9_button,this.aspect_5_4_button],this.aspect_x_y_button,m),this.crop_box=new u(this,Math.round(h),Math.round(p),Math.round(Canvas.getImageWidth()*Canvas.getScale()),Math.round(Canvas.getImageHeight()*Canvas.getScale())),console.log("cropbox pos: "+h+","+p),this.crop_box.setPos(Math.round(h),Math.round(p)),console.log("background pos: "+Math.round(h)+","+Math.round(p)),this.crop_box.setBackgroundPos(Math.round(h),Math.round(p)),this.ox=h,this.oy=p;var v=this;e(window).resize(y),setTimeout(function(){v.lastWidth=Canvas.getImageWidth(),v.lastHeight=Canvas.getImageHeight(),v.cancel_button.click(function(){v.exitPanel(),AnalyticsTracker.sendEvent("adjustment_crop_cancel")}),v.accept_button.click(function(){d(v.width_box.getValue())&&d(v.height_box.getValue())?parseInt(v.width_box.getValue())<=Canvas.getImageWidth()&&parseInt(v.height_box.getValue())<=Canvas.getImageHeight()?parseInt(v.width_box.getValue())>=v.crop_box.MIN_CROP_DIMENSION&&parseInt(v.height_box.getValue())>=v.crop_box.MIN_CROP_DIMENSION?(v.accept(),AnalyticsTracker.sendEvent("adjustment_crop_apply")):App.alert("Please specify a width and height of at least "+v.crop_box.MIN_CROP_DIMENSION+" pixel"+(v.crop_box.MIN_CROP_DIMENSION==1?"":"s")):App.alert("Please specify width and height that are no greater than the image size"):App.alert("Please enter valid numbers for width and height.")}),AnalyticsTracker.sendEvent("adjustment_crop_select")},10)}return l.prototype.accept=function(){var e=f(),t=e.x,n=e.y;History.commit("crop",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight);var r=this.crop_box.getPos();console.log("pos: "+r.x+","+r.y),console.log("ox: "+t+" oy: "+n);var i=Math.max(0,Math.round((r.x-Math.round(t))/Canvas.getScale())),s=Math.max(0,Math.round((r.y-Math.round(n))/Canvas.getScale())),o=parseInt(this.width_box.getValue()),u=parseInt(this.height_box.getValue());console.log("width: "+this.width_box.getValue()),console.log("height: "+this.height_box.getValue()),console.log("crop_pos: "+i+","+s),i+o>Canvas.getImageWidth()&&(i=Canvas.getImageWidth()-o),s+u>Canvas.getImageHeight()&&(s=Canvas.getImageHeight()-u),console.log("final crop_pos: "+i+","+s),WebGL.crop(i,s,o,u),this.exitPanel(),Canvas.saveCurrentImage(!1)},l.prototype.exitPanel=function(){Canvas.setScaleEnabled(!0),this.el.remove(),this.crop_box.remove(),MainMenu.show(),e("#menu").css("pointer-events","auto")},l.prototype.updateCropSize=function(e,t){var n=e/Math.round(Canvas.getImageWidth()*Canvas.getScale()),r=t/Math.round(Canvas.getImageHeight()*Canvas.getScale());this.width_box.setValue(Math.round(n*Canvas.getImageWidth())),this.height_box.setValue(Math.round(r*Canvas.getImageHeight()))},l.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},l.prototype.getWidth=function(){return this.el.width()},l.prototype.hide=function(){this.el.hide()},l.prototype.show=function(){this.el.show()},l}),define("text!ui/check_box.html",[],function(){return'<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	height:40px;\n">\n	<input id="input" type="checkbox" style="\n		background-color:#222222;\n		font-size:14px;\n		color:white;\n		position:absolute;\n		left:12px;\n		top:11px;\n		"></input>\n\n	<div id="title" style="font-size:14px;color:white;position:absolute;left:39px;top:10px;"></div>\n</div>'}),define("app/controls/CheckBox",["jquery","text!ui/check_box.html"],function(e,t){function n(n,r,i,s){this.el=n,this.title=r,this.clickCallback=null,s=typeof s!="undefined"?s:40;var o=e(t);o.attr("id",e(this.el).attr("id")),o.find("#title").html(this.title),o.css("width",i),o.css("height",s),this.el.replaceWith(o),this.el=o,this.input_el=o.find("#input"),o.find("#input").css("top",s/2-10),o.find("#title").css("top",s/2-10)}return n.prototype.setChecked=function(e){this.input_el.prop("checked",e)},n.prototype.isChecked=function(){return this.input_el.prop("checked")},n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,this.input_el.click(e)},n}),define("text!ui/panels/resize_panel.html",[],function(){return'<div class="panel" id="resize_panel" style="\n	position:absolute;\n	width:480px;\n">\n\n<div id="panel_label"></div>\n\n<div id="width_box"></div>\n<div id="height_box"></div>\n\n<div id="keep_proportions"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/ResizePanel",["jquery","app/controls/IconButton","app/controls/Button","app/controls/InputBox","app/controls/CheckBox","text!ui/panels/resize_panel.html"],function(e,t,n,r,i,s){function o(){function l(e){return!isNaN(parseInt(e))&&isFinite(e)}this.__defineGetter__("type",function(){return"resize"}),this.el=e(s),e("#menu").append(this.el);var o=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,u=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2;this.panel_label=new t(e("#panel_label"),"Resize","/images/resize_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.width_box=new r(e("#width_box"),"Width",140),this.width_box.setPos(90,0),this.width_box.setValue(Canvas.getImageWidth()),this.height_box=new r(e("#height_box"),"Height",140),this.height_box.setPos(235,0),this.height_box.setValue(Canvas.getImageHeight()),this.check_box=new i(e("#keep_proportions"),"Keep&nbsp;Proportions",285),this.check_box.setPos(90,45),this.check_box.setChecked(!0);var a=this,f=Canvas.getImageWidth()/Canvas.getImageHeight();this.width_box.change(function(){if(a.check_box.isChecked()){var e=a.width_box.getValue(),t=parseInt(e/f);a.height_box.setValue(t)}}),this.height_box.change(function(){if(a.check_box.isChecked()){var e=a.height_box.getValue(),t=parseInt(e*f);a.width_box.setValue(t)}}),this.cancel_button=new n(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(380,45),this.accept_button=new n(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(380,0);var a=this;setTimeout(function(){a.lastWidth=Canvas.getImageWidth(),a.lastHeight=Canvas.getImageHeight(),a.cancel_button.click(function(){a.exitPanel(),AnalyticsTracker.sendEvent("adjustment_resize_cancel")}),a.accept_button.click(function(){var e=a.width_box.getValue(),t=a.height_box.getValue();if(l(e)&&l(t)){var n=parseInt(e),r=parseInt(t);n<=MAX_IMAGE_DIMENSION&&r<=MAX_IMAGE_DIMENSION?n>0&&r>0?(a.accept(),AnalyticsTracker.sendEvent("adjustment_resize_apply")):App.alert("Please specify dimensions that are greater than 0"):App.alert("Please specify dimensions that are no greater than "+MAX_IMAGE_DIMENSION)}else App.alert("Please enter valid numbers for dimensions.")}),AnalyticsTracker.sendEvent("adjustment_resize_select")},10)}return o.prototype.accept=function(){History.commit("resize",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.resize(parseInt(this.width_box.getValue()),parseInt(this.height_box.getValue())),this.exitPanel(),Canvas.saveCurrentImage(!1)},o.prototype.exitPanel=function(){this.el.remove(),WebGL.drawScene(),MainMenu.show()},o.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},o.prototype.getWidth=function(){return this.el.width()},o.prototype.hide=function(){this.el.hide()},o.prototype.show=function(){this.el.show()},o}),define("text!ui/manipulators/rotate_box.html",[],function(){return'<canvas id="rotate_box" style="\n	position:absolute;\n	top:0;\n	left:0;\n">\n\n</canvas>'}),define("app/manipulators/RotateBox",["jquery","text!ui/manipulators/rotate_box.html"],function(e,t){function n(e,t){return{x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}}function r(e,t,n){return{x:e.x+t,y:e.y+n}}function i(e,t){var r=new Array;for(var i=0;i<e.length;++i)r.push(n(e[i],t));return r}function s(e,t,n){var i=new Array;for(var s=0;s<e.length;++s)i.push(r(e[s],t,n));return i}function o(e,t){var n=e[0].x,r=e[0].y,i=e[1].x,s=e[1].y,o=t[0].x,u=t[0].y,a=t[1].x,f=t[1].y;return{x:((n*s-r*i)*(o-a)-(n-i)*(o*f-u*a))/((n-i)*(u-f)-(r-s)*(o-a)),y:((n*s-r*i)*(u-f)-(r-s)*(o*f-u*a))/((n-i)*(u-f)-(r-s)*(o-a))}}function m(e){var t=e*(Math.PI/180),n=[{x:0,y:0},{x:d,y:0},{x:d,y:v},{x:0,y:v}];n=s(n,-d/2,-v/2);var r=i(n,t);return e>=0?(u=[{x:0,y:0},{x:-d/2,y:-v/2}],f=[r[0],r[3]],h=o(u,f),a=[{x:0,y:0},{x:d/2,y:-v/2}],l=[r[0],r[1]],p=o(a,l),c={x:Math.max(h.x,-p.x),y:Math.max(h.y,p.y)},[c,{x:-c.x,y:c.y},{x:-c.x,y:-c.y},{x:c.x,y:-c.y}]):(u=[{x:0,y:0},{x:d/2,y:-v/2}],f=[r[1],r[2]],p=o(u,f),a=[{x:0,y:0},{x:-d/2,y:-v/2}],l=[r[0],r[1]],h=o(a,l),c={x:Math.max(h.x,-p.x),y:Math.max(h.y,p.y)},[c,{x:-c.x,y:c.y},{x:-c.x,y:-c.y},{x:c.x,y:-c.y}])}function g(n,r,i){this.panel=n,this.el=e(t),this.width=r,this.height=i,this.offset_x=0,this.offset_y=0,this.show_lines=!1,d=this.width,v=this.height,this.crop_rect={x:0,y:0,width:r,height:i},e("body").append(this.el);var s=this}var u,a,f,l,c,h,p,d,v;return g.prototype.setImageSize=function(e,t){this.width=e,this.height=t,d=this.width,v=this.height,this.crop_rect={x:0,y:0,width:e,height:t}},g.prototype.setRotation=function(e){console.log("set rotation: "+e);var t=m(e);this.crop_rect.x=this.width/2+t[0].x,this.crop_rect.y=this.height/2+t[0].y,this.crop_rect.width=t[1].x-t[0].x,this.crop_rect.height=t[3].y-t[0].y,this.draw()},g.prototype.showLines=function(e){this.show_lines=e,this.draw()},g.prototype.draw=function(){var e=this.el[0].getContext("2d");e.clearRect(0,0,this.el.width(),this.el.height()),e.fillStyle="rgba(96, 96, 96, 1)",e.fillRect(0,0,this.el.width(),this.el.height()),e.clearRect(this.crop_rect.x+this.offset_x,this.crop_rect.y+this.offset_y,this.crop_rect.width,this.crop_rect.height);if(this.show_lines){e.strokeStyle="rgba(255, 255, 255, 0.5)",e.beginPath();for(var t=0;t<this.el.width();t+=40)t>this.crop_rect.x+this.offset_x&&t<this.crop_rect.x+this.offset_x+this.crop_rect.width&&(e.moveTo(t+.5,this.offset_y+this.crop_rect.y+.5),e.lineTo(t+.5,this.offset_y+this.crop_rect.y+this.crop_rect.height+.5));for(var n=0;n<this.el.height();n+=40)n>this.crop_rect.y+this.offset_y&&n<this.crop_rect.y+this.offset_y+this.crop_rect.height&&(e.moveTo(this.offset_x+this.crop_rect.x+.5,n+.5),e.lineTo(this.offset_x+this.crop_rect.x+this.crop_rect.width+.5,n+.5));e.lineWidth=1,e.stroke(),e.closePath()}},g.prototype.setSize=function(e,t){var n=this.el[0].getContext("2d");n.canvas.width=e,n.canvas.height=t},g.prototype.setPos=function(e,t){this.offset_x=e,this.offset_y=t,this.draw()},g.prototype.getPos=function(){return{x:parseInt(this.el.css("left")),y:parseInt(this.el.css("top"))}},g.prototype.getCropRect=function(){return this.crop_rect},g.prototype.getWidth=function(){return this.width},g.prototype.getHeight=function(){return this.height},g.prototype.remove=function(){this.el.remove()},g.prototype.hide=function(){this.el.hide()},g.prototype.show=function(){this.el.show()},g}),define("text!ui/panels/rotate_panel.html",[],function(){return'<div class="panel" id="rotate_panel" style="\n	position:absolute;\n	width:505px;\n">\n\n<div id="panel_label"></div>\n\n<div id="rotate_right_button"></div>\n<div id="rotate_left_button"></div>\n<div id="flip_horizontal_button"></div>\n<div id="flip_vertical_button"></div>\n\n<div id="straighten_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/RotatePanel",["jquery","app/controls/IconButton","slider","app/controls/SliderBox","app/controls/Button","app/manipulators/RotateBox","text!ui/panels/rotate_panel.html"],function(e,t,n,r,i,s,o){function u(){function u(){var t=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,r=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2;n.rotate_box.setSize(e(window).innerWidth(),e(window).innerHeight()),n.rotate_box.setPos(t,r)}function a(){Canvas.setRotation(n.base_rotation-n.straighten_slider.getValue()),WebGL.drawScene(!0,n.vflip,n.hflip),n.rotate_box.setRotation(n.straighten_slider.getValue())}function f(){var e,t;n.base_rotation%180!=0?(e=Canvas.getWidth()/2-Canvas.getImageHeight()*Canvas.getScale()/2,t=Canvas.getHeight()/2-Canvas.getImageWidth()*Canvas.getScale()/2,n.rotate_box.setImageSize(parseInt(Canvas.getImageHeight()*Canvas.getScale()),parseInt(Canvas.getImageWidth()*Canvas.getScale()))):(e=Canvas.getWidth()/2-Canvas.getImageWidth()*Canvas.getScale()/2,t=Canvas.getHeight()/2-Canvas.getImageHeight()*Canvas.getScale()/2,n.rotate_box.setImageSize(parseInt(Canvas.getImageWidth()*Canvas.getScale()),parseInt(Canvas.getImageHeight()*Canvas.getScale()))),n.rotate_box.setPos(e,t)}function l(){n.base_rotation-=90,Canvas.setRotation(n.base_rotation),WebGL.drawScene(!0,n.vflip,n.hflip),f(),n.straighten_slider.reset()}function c(){n.base_rotation+=90,Canvas.setRotation(n.base_rotation),WebGL.drawScene(!0,n.vflip,n.hflip),f(),n.straighten_slider.reset()}function h(){n.hflip=!n.hflip,WebGL.drawScene(!0,n.vflip,n.hflip)}function p(){n.vflip=!n.vflip,WebGL.drawScene(!0,n.vflip,n.hflip)}this.__defineGetter__("type",function(){return"rotate"}),this.el=e(o),e("#menu").append(this.el),WebGL.scaleToFit(),Canvas.setScaleEnabled(!1),this.panel_label=new t(e("#panel_label"),"Rotate","/images/rotate_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.straighten_slider=new r(e("#straighten_slider"),"Straighten",-30,30,0,.1),this.straighten_slider.setPos(180,0),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(405,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(405,0),this.flip_horizontal_button=new i(e("#flip_horizontal_button"),null,"/images/horizontal_icon.png",40,undefined,19,19,!1),this.flip_horizontal_button.setPos(90,0),this.flip_vertical_button=new i(e("#flip_vertical_button"),null,"/images/vertical_icon.png",40,undefined,19,19,!1),this.flip_vertical_button.setPos(135,0),this.rotate_left_button=new i(e("#rotate_left_button"),null,"/images/left_icon.png",40,undefined,19,19,!1),this.rotate_left_button.setPos(90,45),this.rotate_right_button=new i(e("#rotate_right_button"),null,"/images/right_icon.png",40,undefined,19,19,!1),this.rotate_right_button.setPos(135,45),this.vflip=!1,this.hflip=!1,this.base_rotation=0,this.rotate_box=new s(this,parseInt(Canvas.getImageWidth()*Canvas.getScale()),parseInt(Canvas.getImageHeight()*Canvas.getScale()));var n=this;setTimeout(function(){n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),n.straighten_slider.onchange(a),n.straighten_slider.mousedown(function(){n.rotate_box.showLines(!0)}),n.straighten_slider.mouseup(function(){n.rotate_box.showLines(!1)}),n.flip_horizontal_button.click(h),n.flip_vertical_button.click(p),n.rotate_right_button.click(l),n.rotate_left_button.click(c),n.cancel_button.click(function(){n.exitPanel(),AnalyticsTracker.sendEvent("adjustment_rotate_cancel")}),n.accept_button.click(function(){n.accept(),AnalyticsTracker.sendEvent("adjustment_rotate_apply")}),AnalyticsTracker.sendEvent("adjustment_rotate_select")},10),e(window).resize(u),u()}return u.prototype.accept=function(){History.commit("rotate",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight);var e=this.rotate_box.getCropRect(),t=Math.max(0,parseInt(e.x/Canvas.getScale())),n=Math.max(0,parseInt(e.y/Canvas.getScale())),r=parseInt(e.width/Canvas.getScale()),i=parseInt(e.height/Canvas.getScale());console.log("cropping to: "+t+","+n+" "+r+"x"+i);if(this.base_rotation%180!=0){Canvas.setRotation(this.base_rotation),WebGL.initTextureFramebuffer(Canvas.getImageHeight(),Canvas.getImageWidth());var s=Canvas.getImageWidth(),o=Canvas.getImageHeight(),u=o/s;WebGL.renderToFramebuffer(u*(this.hflip?-1:1),1/u*(this.vflip?-1:1)),Canvas.setImageWidth(o),Canvas.setImageHeight(s),WebGL.initBuffers(),WebGL.loadFromFramebuffer(),this.hflip=!1,this.vflip=!1}this.base_rotation%360==180||this.base_rotation%360==-180?Canvas.setRotation(180+ -1*this.straighten_slider.getValue()):Canvas.setRotation(-1*this.straighten_slider.getValue()),WebGL.renderToFramebuffer(this.hflip?-1:1,this.vflip?-1:1),WebGL.swapTextures(),Canvas.setRotation(0),WebGL.crop(t,n,r,i),this.exitPanel(),Canvas.saveCurrentImage(!1)},u.prototype.exitPanel=function(){WebGLShaders.setProgram("passthru"),Canvas.setScaleEnabled(!0),Canvas.setRotation(0),this.el.remove(),this.rotate_box.remove(),WebGL.drawScene(),MainMenu.show()},u.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},u.prototype.getWidth=function(){return this.el.width()},u.prototype.hide=function(){this.el.hide()},u.prototype.show=function(){this.el.show()},u}),define("text!ui/panels/touch_up_panel.html",[],function(){return'<div class="panel" id="touch_up_panel" style="\n	position:absolute;\n	width:555px;\n">\n\n<div id="panel_label"></div>\n\n<div id="brush_size_slider"></div>\n<div id="detail_toggle"></div>\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("text!ui/toggle_box.html",[],function(){return'<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	height:85px;\n">\n	<div id="title" style="font-size:14px;color:white;position:absolute;top:16px;text-align:center;"></div>\n\n	<div id="toggle" style="font-size:9px;color:white;position:absolute;top:50px;border:solid 1px #bbbbbb;background-color:#222222;\n		height:14px;width:33px;text-align:center;padding-top:1px;">\n		<div id="toggle_switch" style="position:absolute;background-color:white;width:10px;height:23px;margin-top:-5px;margin-left:-5px;"></div>\n		<div id="toggle_label" style="position:absolute;margin-left:11px;pointer-events:none;">OFF</div>\n		\n	</div>\n\n</div>'}),define("app/controls/ToggleBox",["jquery","text!ui/toggle_box.html"],function(e,t){function n(n,r,i){this.el=n,this.title=r,this.clickCallback=null,this.is_checked=!1;var s=e(t);s.attr("id",e(this.el).attr("id")),s.find("#title").html(this.title),s.find("#title").css("width",i),s.css("width",i),s.find("#toggle").css("left",Math.round(i/2-16.5)),this.el.replaceWith(s),this.el=s,this.el_toggle=s.find("#toggle");var o=this;this.el_toggle.click(function(){o.is_checked=!o.is_checked,console.log("mousedown: "+o.is_checked),o.is_checked?(e(this).css("background-color","#3da6f4"),e(this).css("border-color","#ffffff"),e(this).find("#toggle_label").text("ON"),e(this).find("#toggle_switch").css("margin-left",28),e(this).find("#toggle_label").css("margin-left",8)):(e(this).css("background-color","#222222"),e(this).css("border-color","#bbbbbb"),e(this).find("#toggle_label").text("OFF"),e(this).find("#toggle_switch").css("margin-left",-5),e(this).find("#toggle_label").css("margin-left",11)),o.clickCallback&&o.clickCallback()})}return n.prototype.setChecked=function(e){e!=this.is_checked&&this.el_toggle.trigger("mousedown")},n.prototype.isChecked=function(){return this.is_checked},n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,console.log("toggle box setting click callback")},n}),define("app/panels/TouchUpPanel",["jquery","app/controls/IconButton","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/touch_up_panel.html","app/controls/ToggleBox"],function(e,t,n,r,i,s,o){function u(){function u(){PaintCanvas.setBrushSize(n.brush_size_slider.getValue())}function a(){Canvas.loadCurrentImage(),WebGL.drawScene(),n.exitPanel()}this.__defineGetter__("type",function(){return"touchup"}),this.el=e(s),e("#menu").append(this.el),e("#menu").css("pointer-events","none"),this.el.css("pointer-events","auto"),PaintCanvas.setEnabled(!0),this.panel_label=new t(e("#panel_label"),"Touch Up","/images/touch_up_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.brush_size_slider=new r(e("#brush_size_slider"),"Brush Size",3,250,PaintCanvas.getBrushSize()),this.brush_size_slider.setPos(90,0),this.toggle_box=new o(e("#detail_toggle"),"Preserve&nbsp;Detail",145,85),this.toggle_box.setPos(315,0),this.toggle_box.setChecked(!1),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(465,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(465,0),this.undo_button=History.getUndoButton(),this.redo_button=History.getRedoButton(),this.undo_button.click(function(){NaClTouchUp.undo()}),this.redo_button.click(function(){NaClTouchUp.redo()});var n=this;setTimeout(function(){NaClTouchUp.loadImage("touch_up"),n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),n.brush_size_slider.onchange(u),n.cancel_button.click(function(){if(NaClTouchUp.isProcessing())return;a(),AnalyticsTracker.sendEvent("adjustment_touch_up_cancel")}),n.accept_button.click(function(){if(NaClTouchUp.isProcessing())return;n.accept(),AnalyticsTracker.sendEvent("adjustment_touch_up_apply")}),AnalyticsTracker.sendEvent("adjustment_touch_up_select")},10)}return u.prototype.accept=function(){History.commit("touchup",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),this.exitPanel(),Canvas.saveCurrentImage()},u.prototype.exitPanel=function(){NaClTouchUp.unloadImage(),PaintCanvas.setEnabled(!1),this.el.remove(),this.undo_button.click(null),this.redo_button.click(null),MainMenu.show(),e("#menu").css("pointer-events","auto")},u.prototype.setUndoRedoState=function(e,t){console.log("setundoredostate: "+e+" "+t),this.undo_button.setEnabled(e),this.redo_button.setEnabled(t)},u.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},u.prototype.getWidth=function(){return this.el.width()},u.prototype.hide=function(){this.el.hide()},u.prototype.isPreserveDetail=function(){return this.toggle_box.isChecked()},u.prototype.show=function(){this.el.show()},u}),define("text!ui/panels/clone_panel.html",[],function(){return'<div class="panel" id="clone_panel" style="\n	position:absolute;\n	width:405px;\n">\n\n<div id="panel_label"></div>\n\n<div id="brush_size_slider"></div>\n\n<div id="seamless_toggle"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/CloneHistoryStep",[],function(){return function(e,t,n,r,i){return{bitmap:e,x:t,y:n,width:r,height:i}}}),define("app/CloneHistory",["jquery","app/CloneHistoryStep"],function(e,t){function n(e,t,n){this.size=e,this.undobutton=t,this.redobutton=n,this.undo=[],this.redo=[]}return n.prototype.setEnabled=function(e){if(e){var n=this;this.undobutton.click(function(){console.log("clone undo clicked: "+n.undo.length);if(n.undo.length>0){var e=n.undo.pop(),r=WebGL.getPixelArray(!1,e.x,Canvas.getImageHeight()-e.y-e.height,e.width,e.height);n.redo.push(new t(r,e.x,e.y,e.width,e.height)),WebGL.loadImageDataRect(e.bitmap,e.x,e.y,e.width,e.height,!1),NaClTouchUp.cloneUpdateSource(e.bitmap,e.x,e.y,e.width,e.height),n.undo.length==0&&n.undobutton.setEnabled(!1),n.redobutton.setEnabled(!0),AnalyticsTracker.sendEvent("undo_clone")}}),this.redobutton.click(function(){console.log("clone redo clicked: "+n.redo.length);if(n.redo.length>0){var e=n.redo.pop(),r=WebGL.getPixelArray(!1,e.x,Canvas.getImageHeight()-e.y-e.height,e.width,e.height);n.undo.push(new t(r,e.x,e.y,e.width,e.height)),WebGL.loadImageDataRect(e.bitmap,e.x,e.y,e.width,e.height,!1),NaClTouchUp.cloneUpdateSource(e.bitmap,e.x,e.y,e.width,e.height),n.redo.length==0&&n.redobutton.setEnabled(!1),n.undobutton.setEnabled(!0),AnalyticsTracker.sendEvent("redo_clone")}}),this.redo.length>0?this.redobutton.setEnabled(!0):this.redobutton.setEnabled(!1),this.undo.length>0?this.undobutton.setEnabled(!0):this.undobutton.setEnabled(!1)}else this.redobutton.click(null),this.undobutton.click(null),this.redobutton.setEnabled(!1),this.undobutton.setEnabled(!1)},n.prototype.clear=function(e){this.undobutton.off("click"),this.redobutton.off("click"),this.undo=[],this.redo=[]},n.prototype.getUndoButton=function(){return this.undobutton},n.prototype.getRedoButton=function(){return this.redobutton},n.prototype.commit=function(e,n,r,i,s){this.undo.length==0&&this.undobutton.setEnabled(!0),this.redobutton.setEnabled(!1);var o=new t(e,n,r,i,s);this.undo.push(o);while(this.undo.length>this.size){console.log("shifting undo");var u=this.undo.shift();u.bitmap=null}while(this.redo.length>0)this.redo.shift()},n}),define("app/panels/ClonePanel",["jquery","app/controls/IconButton","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/clone_panel.html","app/controls/ToggleBox","app/CloneHistory"],function(e,t,n,r,i,s,o,u){function a(){function a(){PaintCanvas.setBrushSize(n.brush_size_slider.getValue())}function f(){Canvas.loadCurrentImage(),WebGL.drawScene(),n.exitPanel()}this.__defineGetter__("type",function(){return"clone"}),this.el=e(s),e("#menu").append(this.el),e("#menu").css("pointer-events","none"),this.el.css("pointer-events","auto"),PaintCanvas.setEnabled(!0),this.panel_label=new t(e("#panel_label"),"Clone","/images/clone_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.brush_size_slider=new r(e("#brush_size_slider"),"Brush Size",3,250,PaintCanvas.getBrushSize()),this.brush_size_slider.setPos(90,0),this.toggle_box=new o(e("#seamless_toggle"),"Blend&nbsp;Colors",140,85),this.toggle_box.setPos(315,0),this.toggle_box.setChecked(!1),this.toggle_box.hide(),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(315,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(315,0),this.history=new u(10,History.getUndoButton(),History.getRedoButton()),this.history.setEnabled(!0);var n=this;setTimeout(function(){NaClTouchUp.cloneLoadImage(),n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),n.brush_size_slider.onchange(a),n.toggle_box.click(function(){console.log("clicked: "+n.toggle_box.isChecked()),n.toggle_box.isChecked()?(NaClTouchUp.cloneUnloadImage(),NaClTouchUp.loadImage("seamless_clone"),n.history.setEnabled(!1)):(NaClTouchUp.unloadImage(),NaClTouchUp.cloneLoadImage(),n.history=new u(10,History.getUndoButton(),History.getRedoButton()),n.history.setEnabled(!0))}),n.cancel_button.click(function(){f(),AnalyticsTracker.sendEvent("adjustment_clone_cancel")}),n.accept_button.click(function(){n.accept(),AnalyticsTracker.sendEvent("adjustment_clone_apply")}),AnalyticsTracker.sendEvent("adjustment_clone_select")},10)}return a.prototype.getHistory=function(){return this.history},a.prototype.accept=function(){History.commit("clone",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),this.exitPanel(),Canvas.saveCurrentImage()},a.prototype.exitPanel=function(){this.toggle_box.isChecked()?NaClTouchUp.unloadImage():NaClTouchUp.cloneUnloadImage(),PaintCanvas.setEnabled(!1),this.el.remove(),this.history.setEnabled(!1),MainMenu.show(),e("#menu").css("pointer-events","auto")},a.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},a.prototype.getWidth=function(){return this.el.width()},a.prototype.hide=function(){this.el.hide()},a.prototype.show=function(){this.el.show()},a.prototype.isSeamless=function(){return this.toggle_box.isChecked()},a}),define("text!ui/scroll_menu.html",[],function(){return'<div style="position:absolute;z-index:10;">\n<div id="scroll_menu_content" style="\n	position:absolute;\n	z-index:10;\n	border-radius:5px;\n	background-color:rgba(64,64,64,0.9);\n	overflow:hidden;\n">\n\n\n</div>\n<img id="scroll_menu_arrow" src="/images/scroll_menu_arrow.png" width="15" height="8" style="position:absolute;"/>\n<div id="scroll_back"></div>\n<div id="scroll_forward"></div>\n</div>\n\n'}),define("app/ScrollMenu",["jquery","text!ui/scroll_menu.html","app/controls/Button"],function(e,t,n){function o(r,s,o,u,a){this._isMenuOpen=!1,this._buttons=o,this._buttonWidth=o[0].getWidth(),this._buttonHeight=o[0].getHeight(),this._parentSelector=s,this._bottomMargin=a,this._initialX=u,this._el=e(t),this._el.attr("id",r),this._menuEl=this._el.find("#scroll_menu_content"),this._menuEl.css("bottom",this._bottomMargin+"px"),this._menuEl.append("<div id='scroll_content' style='position:absolute;'></div>"),this._isDragging=!1,this._isMouseDown=!1,this._scrollBack=new n(this._el.find("#scroll_back"),null,"/images/undo_icon.png",35,undefined,15,15,!0),this._scrollForward=new n(this._el.find("#scroll_forward"),null,"/images/redo_icon.png",35,undefined,15,15,!0),this._scrollBackEl=this._el.find("#scroll_back"),this._scrollForwardEl=this._el.find("#scroll_forward");var f=this,l=this._menuEl.find("#scroll_content");this._isAnimating=!1,this._scrollBack.click(function(){if(f._isAnimating)return;var e=400;l.offset().left+e>f._menuMargin&&(e=f._menuMargin-l.offset().left),f._isAnimating=!0,l.animate({left:"+="+e+"px"},200,"swing",function(){console.log("complete"),f._isAnimating=!1,f.setScrollButtonState()})}),this._scrollForward.click(function(){if(f._isAnimating)return;var e=400;-l.offset().left+e+f._width+f._menuMargin>f._contentWidth+2*i&&(e=-1*(f._menuMargin-l.offset().left+f._width-f._contentWidth-2*i)),f._isAnimating=!0,l.animate({left:"-="+e+"px"},200,"swing",function(){console.log("complete"),f._isAnimating=!1,f.setScrollButtonState()})}),this.setScrollButtonState=function(){l.offset().left==f._menuMargin?f._scrollBack.setEnabled(!1):f._scrollBack.setEnabled(!0),-l.offset().left+f._width+f._menuMargin==f._contentWidth+2*i?f._scrollForward.setEnabled(!1):f._scrollForward.setEnabled(!0)},this.positionScrollArrow=function(){var e=f._el.find("#scroll_menu_arrow");console.log("arrow width: "+e.attr("width")),e.css("left",f._initialX-parseInt(e.attr("width"))/2+"px"),e.css("bottom",f._bottomMargin-parseInt(e.attr("height"))+"px")},this.mouseMoveHandler=function(e){f._isMouseDown&&(f._isDragging=!0),f._isDragging&&(console.log("dragging"),l.offset().left>f._menuMargin+50?console.log("too far from left"):-l.offset().left+f._width+f._menuMargin>f._contentWidth+2*i+50?console.log("too far from right"):l.offset({left:e.pageX-f._dragOffsetX}))},this.animateToEdge=function(){l.offset().left>f._menuMargin?(console.log("align to left"),l.animate({left:"-="+(l.offset().left-f._menuMargin)+"px"},100,"swing",f.setScrollButtonState)):-l.offset().left+f._width+f._menuMargin>f._contentWidth+2*i?(console.log("align to right"),l.animate({left:"+="+(-l.offset().left+f._width+f._menuMargin-2*i-f._contentWidth)+"px"},100,"swing",f.setScrollButtonState)):this.setScrollButtonState()},this.mouseUpHandler=function(e){console.log("mouse up - dragging: "+f._isDragging);if(!f._isDragging)return;console.log("scrollContent offset: "+l.offset().left),console.log("menuMargin: "+f._menuMargin),f.animateToEdge(),setTimeout(function(){f._isDragging=!1,f._isMouseDown=!1},10)};for(var c=0;c<this._buttons.length;c++){var h=this._buttons[c];l.append(h.getElement())}l.mousedown(function(t){console.log("dragging mousedown");var n=e(this).parent().offset(),r=t.pageX;f._isMouseDown=!0,f._dragOffsetX=r-e(this).offset().left})}var r=2,i=2,s=10;return o.prototype.isDragging=function(){return this._isDragging},o.prototype.onResize=function(){this._contentWidth=this._buttons.length*(this._buttonWidth+r)-r,this._height=this._buttonHeight+2*i;var t,n=this._contentWidth+2*i,o=e(window).innerWidth()-2*s;n<o?(this._width=n,t=(n-e(this._parentSelector).width())/2,this._scrollBackEl.css("display","none"),this._scrollForwardEl.css("display","none")):(this._width=o,t=(e(window).innerWidth()-e(this._parentSelector).width())/2-s,this._scrollBackEl.css("display","block"),this._scrollBackEl.css("left",-1*t+"px"),this._scrollBackEl.css("bottom",this._height+this._bottomMargin+4+"px"),this._scrollForwardEl.css("display","block"),this._scrollForwardEl.css("left",-1*t+39+"px"),this._scrollForwardEl.css("bottom",this._height+this._bottomMargin+4+"px")),this._menuMargin=-1*t+e(this._parentSelector).offset().left,console.log("menu width: "+this._width),this._menuEl.css("width",this._width+"px"),this._menuEl.css("height",this._height+"px"),this._menuEl.css("left",-1*t+"px"),this.positionScrollArrow(),this.setScrollButtonState();var u=this._menuEl.find("#scroll_content");u.offset().left>this._menuMargin?(console.log("align to left"),u.animate({left:"-="+(u.offset().left-this._menuMargin)+"px"},0,"swing")):-u.offset().left+this._width+this._menuMargin>this._contentWidth+2*i&&(console.log("align to right"),u.animate({left:"+="+(-u.offset().left+this._width+this._menuMargin-2*i-this._contentWidth)+"px"},0,"swing"))},o.prototype.setInitialX=function(e){this._initialX=e},o.prototype.isOpen=function(){return this._isMenuOpen},o.prototype.open=function(){var t=this;e(window).on("mousemove",t.mouseMoveHandler),e(window).on("mouseup",t.mouseUpHandler),e(this._parentSelector).append(this._el),this._isMenuOpen=!0,console.log("menu width: "+this._width);var t=this;this._el.show(),this.onResize(),console.log("buttons: "+this._buttons.length);for(var n=0;n<this._buttons.length;n++){var s=this._buttons[n];s.show(),s.setPos(i+n*(t._buttonWidth+r),i)}},o.prototype.close=function(){var t=this;e(window).off("mousemove",null,t.mouseMoveHandler),e(window).off("mouseup",null,t.mouseUpHandler),this._isMouseDown=!1,this._el.hide(),this._isMenuOpen=!1},o}),define("text!ui/preview_button.html",[],function(){return'\n<div style="\n	position:absolute;\n	background: transparent;\n	border-radius: 5px;\n	width:129px;\n	height:107px;\n	cursor:pointer;\n">\n	<img id="button_image" width="125" height="75" style="position:relative;left:2px;top:2px;border-radius:3px;"/>\n	<div id="button_title" style="font-size:13px;color:white;position:relative;top:5px;text-align:center;width:129px;"></div>\n</div>\n\n'}),define("app/controls/PreviewButton",["jquery","text!ui/preview_button.html"],function(e,t){function n(n,s,o){this.el=n,this.title=s,this.img=o,this.clickCallback=null;var u=e(t);u.attr("id",e(this.el).attr("id")),o?(u.find("#button_image").attr("src",this.img),u.find("#button_image").css("visibility","visible")):u.find("#button_image").css("visibility","hidden"),u.find("#button_title").html(this.title),u.data("id",this.title.toLowerCase()),this.el.replaceWith(u),this.el=u,this.el.mouseover(r),this.el.mouseout(i)}function r(){e(this).css("background","#3ea2ec")}function i(){e(this).css("background","transparent")}return n.prototype.getWidth=function(){return parseInt(this.el.css("width"))},n.prototype.getHeight=function(){return parseInt(this.el.css("height"))},n.prototype.getElement=function(){return this.el},n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.getPos=function(){return{x:parseInt(this.el.css("left")),y:parseInt(this.el.css("top"))}},n.prototype.setOpacity=function(e){this.el.css("opacity",e)},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,this.el.click(e)},n.prototype.getId=function(){return this.el.data("id")},n.prototype.setTitle=function(e){this.title=e,this.el.find("#button_title").html(this.title)},n.prototype.setImage=function(e){this.img=e,this.el.find("#button_image").attr("src",e),this.el.find("#button_image").css("visibility","visible")},n}),define("text!ui/effect_button.html",[],function(){return'\n<div class="small" style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	width:89px;\n	height:85px;\n	cursor:pointer;\n">\n	<img id="button_image" width="85" height="50" style="position:relative;left:2px;top:2px;border-radius:3px;"/>\n	<div id="button_title" style="font-size:13px;color:white;position:relative;top:5px;text-align:center;width:89px;"></div>\n</div>\n\n'}),define("app/controls/EffectButton",["jquery","text!ui/effect_button.html"],function(e,t){function n(n,s,o){this.el=n,this.title=s,this.img=o,this.clickCallback=null,this.targetX=0,this.targetY=0;var u=e(t);u.attr("id",e(this.el).attr("id")),o?(u.find("#button_image").attr("src",this.img),u.find("#button_image").css("visibility","visible")):u.find("#button_image").css("visibility","hidden"),u.find("#button_title").html(this.title),u.data("id",this.title.toLowerCase().replace(" ","_")),this.el.replaceWith(u),this.el=u,this.el.mouseover(r),this.el.mouseout(i)}function r(){e(this).css("background","#3ea2ec")}function i(){e(this).css("background","#434343")}return n.prototype.getWidth=function(){return parseInt(this.el.css("width"))},n.prototype.getHeight=function(){return parseInt(this.el.css("height"))},n.prototype.getElement=function(){return this.el},n.prototype.animate=function(e){e=typeof e!="undefined"?e:function(){};var t=this.targetX-parseInt(this.el.css("left")),n=this.targetY-parseInt(this.el.css("top"));this.el.animate({left:"+="+t+"px",top:"+="+n+"px",opacity:"+=1.0"},100,"swing",e)},n.prototype.fadeOut=function(e,t){this.el.fadeOut(e,t)},n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.getPos=function(){return{x:parseInt(this.el.css("left")),y:parseInt(this.el.css("top"))}},n.prototype.setOpacity=function(e){this.el.css("opacity",e)},n.prototype.setTargetPos=function(e,t){this.targetX=e,this.targetY=t},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,this.el.click(e)},n.prototype.getId=function(){return this.el.data("id")},n.prototype.setTitle=function(e){this.title=e,this.el.find("#button_title").html(this.title)},n.prototype.setImage=function(e){this.img=e,this.el.find("#button_image").attr("src",e),this.el.find("#button_image").css("visibility","visible")},n.prototype.isEnabled=function(){return this.is_enabled},n.prototype.setEnabled=function(e){this.is_enabled=e,e?(this.el.mouseover(r),this.el.mouseout(i),this.el.click(this.clickCallback),this.el.css("cursor","pointer")):(this.el.css("background","#434343"),this.el.off("mouseover"),this.el.off("mouseout"),this.el.off("click"),this.el.css("cursor","default"))},n.prototype.setSelected=function(e){console.log("setSelected: "+e),console.log(this.el.mouseover),e?(this.el.css("background","#3ea2ec"),this.el.off("mouseover"),this.el.off("mouseout")):(this.el.css("background","#434343"),this.el.mouseover(r),this.el.mouseout(i))},n}),define("text!ui/panels/effects_panel.html",[],function(){return'<div class="panel" id="effects_panel" style="\n	position:absolute;\n	width:594px;\n">\n\n<div id="panel_label"></div>\n\n<div id="menu_button"></div>\n<div id="effect_button"></div>\n<div id="amount_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n\n<!--\n<div id="categories_menu" style="display:none;position:absolute;bottom:95px;left:-200px;">\n	<div id=\'classic_button\'></div>\n	<div id=\'subtle_button\'></div>\n	<div id=\'vintage_button\'></div>\n	<div id=\'aged_button\'></div>\n	<div id=\'unicolor_button\'></div>\n	<div id=\'soft_button\'></div>\n</div>\n-->\n\n\n\n</div>'}),define("text!effects/aladin.pxs",[],function(){return'{\r\n	"name" : "Aladin",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "mapping",\r\n			"param" :\r\n			{\r\n				"red" : [54,54,55,55,55,56,56,57,57,57,58,58,58,59,59,60,60,60,61,61,61,62,62,63,63,63,64,64,65,65,65,66,66,67,67,67,68,68,69,69,69,70,70,71,71,72,72,73,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,85,85,86,86,87,87,88,89,89,90,90,91,92,92,93,94,94,95,96,96,97,98,98,99,100,100,101,102,102,103,104,105,105,106,107,107,108,109,110,111,111,112,113,114,114,115,116,117,118,118,119,120,121,122,123,123,124,125,126,127,128,128,129,130,131,132,133,134,135,135,136,137,138,139,140,141,142,143,144,145,146,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,207,208,209,210,211,212,213,214,215,216,217,219,220,221,222,223,224,225,226,227,228,230,231,232,233,234,235,236,237,238,239,241,242,243,244,245,246,247,248,249,251,252,253,254,255],\r\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,160,161,162,163,164,165,166,167,168,169,170,171,171,172,173,174,175,176,177,177,178,179,180,181,181,182,183,184,184,185,186,187,187,188,189,189,190,191,191,192,193,193,194,194,195,195,196,197,197,198,198,199,199,199,200,200,201,201,202,202,202,203,203,203,204,204,204,205,205,205,206,206,206,207,207,207,207,208,208,208,209,209,209,209,209,210,210,210,210,211,211,211,211,212,212,212],\r\n				"blue" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,61,62,63,64,65,66,67,68,69,70,70,71,72,73,74,75,76,77,77,78,79,80,81,82,82,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,100,101,102,102,103,104,104,105,106,106,107,107,108,109,109,110,110,111,111,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,119,120,120,121,121,122,122,122,123,123,124,124,124,125,125,125,126,126,126,127,127,127,128,128,128,129,129,129,129,130,130,130,131,131,131,131,132,132,132,132,133,133,133,133,134,134,134,134,134,135,135,135,135,135,136,136,136,136,136,136,137,137,137,137,137,137,138,138,138,138,138,138,139,139,139,139,139,139,139,140,140,140,140,140,140,140,140,141,141,141,141,141,141,141,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/amber.pxs",[],function(){return'{\r\n	"name" : "Amber",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "mapping",\r\n			"param" :\r\n			{\r\n				"red" : [0,2,3,5,7,8,10,12,13,15,17,18,20,22,24,25,27,29,30,32,34,35,37,38,40,42,43,45,47,48,50,52,53,55,57,58,60,61,63,65,66,68,69,71,73,74,76,77,79,80,82,83,85,87,88,90,91,93,94,96,97,99,100,102,103,105,106,107,109,110,112,113,115,116,117,119,120,121,123,124,126,127,128,130,131,132,133,135,136,137,139,140,141,142,143,145,146,147,148,149,151,152,153,154,155,156,157,158,159,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,179,180,181,182,183,184,185,186,187,187,188,189,190,191,192,192,193,194,195,196,196,197,198,199,199,200,201,202,202,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,216,217,218,218,219,219,220,221,221,222,222,223,224,224,225,225,226,226,227,227,228,228,229,230,230,231,231,232,232,233,233,234,234,235,235,236,236,237,237,238,238,238,239,239,240,240,241,241,242,242,243,243,244,244,244,245,245,246,246,247,247,248,248,248,249,249,250,250,251,251,252,252,252,253,253,254,254,255,255],\r\n				"green" : [0,1,1,2,3,3,4,4,5,6,6,7,8,8,9,10,10,11,11,12,13,13,14,15,15,16,17,17,18,19,19,20,20,21,22,22,23,24,24,25,26,26,27,28,28,29,30,30,31,32,33,33,34,35,35,36,37,37,38,39,40,40,41,42,42,43,44,45,45,46,47,47,48,49,50,50,51,52,53,53,54,55,56,57,57,58,59,60,60,61,62,63,64,65,65,66,67,68,69,69,70,71,72,73,74,75,75,76,77,78,79,80,81,82,83,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,118,119,120,121,122,123,124,125,127,128,129,130,131,132,133,135,136,137,138,139,141,142,143,144,145,147,148,149,150,152,153,154,155,157,158,159,160,162,163,164,165,167,168,169,171,172,173,174,176,177,178,180,181,182,184,185,186,188,189,190,192,193,194,196,197,198,200,201,202,204,205,207,208,209,211,212,213,215,216,217,219,220,222,223,224,226,227,229,230,231,233,234,235,237,238,240,241,242,244,245,247,248,249,251,252,254,255],\r\n				"blue" : [127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/karen.pxs",[],function(){return'{\r\n	"name" : "Karen",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "mapping",\r\n			"param" :\r\n			{\r\n				"red" : [0,2,4,6,7,9,11,13,15,17,18,20,22,24,26,27,29,31,33,35,37,38,40,42,44,46,47,49,51,53,54,56,58,60,61,63,65,67,68,70,72,74,75,77,79,80,82,84,85,87,89,90,92,94,95,97,98,100,102,103,105,106,108,109,111,113,114,116,117,119,120,121,123,124,126,127,129,130,131,133,134,135,137,138,139,141,142,143,145,146,147,148,150,151,152,153,154,156,157,158,159,160,161,162,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,185,186,187,188,189,190,191,192,192,193,194,195,196,197,197,198,199,200,200,201,202,203,203,204,205,206,206,207,208,208,209,210,210,211,212,212,213,214,214,215,215,216,217,217,218,218,219,220,220,221,221,222,222,223,224,224,225,225,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,233,234,234,235,235,236,236,237,237,237,238,238,239,239,240,240,240,241,241,242,242,242,243,243,244,244,244,245,245,245,246,246,247,247,247,248,248,248,249,249,250,250,250,251,251,251,252,252,252,253,253,254,254,254,255,255],\r\n				"green" : [0,1,2,2,3,4,5,5,6,7,8,8,9,10,11,12,12,13,14,15,15,16,17,18,19,19,20,21,22,22,23,24,25,26,26,27,28,29,30,30,31,32,33,34,34,35,36,37,37,38,39,40,41,42,42,43,44,45,46,46,47,48,49,50,50,51,52,53,54,55,55,56,57,58,59,60,60,61,62,63,64,65,66,66,67,68,69,70,71,72,73,73,74,75,76,77,78,79,80,81,81,82,83,84,85,86,87,88,89,90,91,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,148,149,150,151,152,153,154,155,157,158,159,160,161,162,163,165,166,167,168,169,170,172,173,174,175,176,177,179,180,181,182,183,185,186,187,188,189,191,192,193,194,195,197,198,199,200,202,203,204,205,206,208,209,210,211,213,214,215,216,218,219,220,221,222,224,225,226,227,229,230,231,232,234,235,236,237,239,240,241,242,244,245,246,247,249,250,251,252,254,255],\r\n				"blue" : [0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,7,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,13,13,14,14,14,15,15,15,16,16,17,17,17,18,18,19,19,19,20,20,21,21,22,22,23,23,23,24,24,25,25,26,27,27,28,28,29,29,30,30,31,32,32,33,34,34,35,35,36,37,37,38,39,40,40,41,42,43,43,44,45,46,46,47,48,49,50,51,52,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,73,74,75,76,77,78,80,81,82,83,84,86,87,88,90,91,92,94,95,96,98,99,101,102,104,105,106,108,109,111,113,114,116,117,119,120,122,124,125,127,129,130,132,134,136,137,139,141,143,145,146,148,150,152,154,156,157,159,161,163,165,167,169,171,173,175,177,179,181,183,185,187,189,191,193,195,197,199,201,203,205,207,209,211,213,215,217,219,221,223,226,228,230,232,234,236,238,240,242,244,247,249,251,253,255]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/peter.pxs",[],function(){return'{\r\n	"name" : "Peter",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "mapping",\r\n			"param" :\r\n			{\r\n				"red" : [12,13,13,14,14,15,16,16,17,17,18,18,19,19,20,20,20,21,21,21,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,26,26,27,27,28,29,29,30,31,32,32,33,34,35,36,37,38,39,40,41,42,43,44,46,47,48,49,50,52,53,54,55,57,58,59,60,62,63,64,66,67,68,70,71,72,74,75,76,78,79,80,81,83,84,85,87,88,89,91,92,93,94,96,97,98,100,101,102,103,105,106,107,109,110,111,112,114,115,116,117,119,120,121,122,124,125,126,127,129,130,131,132,133,135,136,137,138,139,141,142,143,144,145,146,148,149,150,151,152,153,154,156,157,158,159,160,161,162,163,164,165,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,187,188,189,190,191,192,193,194,195,195,196,197,198,199,200,200,201,202,203,204,204,205,206,207,208,208,209,210,211,211,212,213,214,214,215,216,216,217,218,218,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234],\r\n				"green" : [9,10,10,11,11,12,13,13,14,14,15,16,16,17,18,19,20,20,21,22,23,24,25,26,27,28,29,31,32,33,34,35,37,38,39,41,42,43,45,46,48,49,50,52,53,55,56,57,59,60,62,63,64,66,67,68,70,71,72,74,75,76,77,79,80,81,82,84,85,86,87,88,89,91,92,93,94,95,96,97,98,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,128,129,130,131,132,133,134,135,136,137,137,138,139,140,141,142,143,143,144,145,146,147,148,148,149,150,151,152,153,153,154,155,156,157,157,158,159,160,160,161,162,163,164,164,165,166,167,167,168,169,170,170,171,172,172,173,174,175,175,176,177,178,178,179,180,180,181,182,183,183,184,185,185,186,187,187,188,189,190,190,191,192,192,193,194,194,195,196,196,197,198,198,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,214,215,216,216,217,218,218,219,220,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234],\r\n				"blue" : [32,33,34,35,36,37,38,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,100,101,102,103,104,105,106,107,108,109,110,111,112,113,113,114,115,116,117,118,119,119,120,121,122,123,123,124,125,126,126,127,128,128,129,130,130,131,132,132,133,134,134,135,135,136,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,144,145,145,146,146,146,147,147,148,148,148,149,149,149,150,150,150,151,151,151,152,152,152,153,153,153,154,154,154,155,155,155,156,156,156,157,157,157,158,158,158,159,159,159,160,160,160,161,161,161,162,162,162,163,163,163,164,164,164,165,165,166,166,166,167,167,168,168,168,169,169,169,170,170,171,171,171,172,172,172,173,173,173,174,174,174,175,175,175,175,176,176,176,176,176,177,177,177,177,177,177,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/amy.pxs",[],function(){return'{\r\n	"name" : "Amy",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [7999745,8000001,8000258,8066051,8066308,8132357,8132614,8198407,8198664,8264457,8264969,8330762,8331019,8396812,8397069,8463118,8463375,8529168,8529425,8595218,8595730,8661523,8661780,8727573,8727830,8793879,8794136,8859929,8860186,8925979,8926491,8992284,8992541,9058334,9058591,9059104,9124897,9125154,9190947,9191204,9257252,9257509,9323302,9323559,9389352,9389865,9455658,9455915,9521708,9521965,9588013,9588270,9654063,9654320,9720113,9720626,9786419,9786676,9852469,9852726,9918774,9919031,9984824,9985081,10050874,10051387,10117180,10117437,10183230,10183743,10183999,10249792,10250049,10315842,10316355,10382148,10382405,10448198,10448455,10514503,10514760,10580553,10580810,10646603,10647116,10712909,10713166,10778959,10779216,10845264,10845521,10911314,10911571,10977364,10977877,11043670,11043927,11109720,11109977,11176025,11176282,11242075,11242332,11308125,11308638,11308895,11374688,11374945,11440738,11441250,11507043,11507300,11573093,11573350,11639399,11639656,11705449,11705706,11771499,11772011,11837804,11838061,11903854,11904111,11970160,11970417,12036210,12036467,12102260,12102772,12168565,12168822,12234615,12234872,12300921,12301178,12366971,12367228,12433277,12433278,12433535,12433536,12433793,12499330,12499587,12499588,12499845,12565382,12565639,12565896,12565897,12566154,12631691,12631948,12631949,12632206,12697743,12698000,12698001,12698258,12698515,12764052,12764310,12764311,12764568,12830105,12830362,12830363,12830620,12830621,12896414,12896671,12896672,12896929,12962466,12962723,12962724,12962981,12962982,13028775,13028776,13029033,13029290,13094827,13095084,13095086,13095343,13095344,13161137,13161138,13161395,13161396,13227189,13227446,13227447,13227704,13227705,13293498,13293499,13293756,13293757,13359550,13359807,13359808,13360065,13360066,13425859,13425860,13426117,13426119,13491912,13491913,13492170,13492427,13492428,13558221,13558222,13558479,13558480,13624273,13624274,13624531,13624532,13624789,13690582,13690583,13690840,13690841,13756634,13756635,13756892,13756893,13757151,13822688,13822945,13823202,13823203,13888996,13888997,13889254,13889255,13889512,13955049,13955306,13955307,13955564,14021357,14021358,14021615,14021616,14021873,14087410,14087667,14087668,14087925,14153719]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/danie.pxs",[],function(){return'{\r\n	"name" : "Danie",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [7086200,7086456,7086713,7086970,7087227,7153020,7153276,7153533,7153790,7154047,7219840,7220096,7220353,7220610,7220867,7286660,7286917,7287173,7287430,7287687,7353480,7353737,7353993,7354250,7354507,7420300,7420557,7420814,7421070,7421327,7487120,7487377,7487634,7487890,7488147,7553940,7554197,7554454,7554710,7554967,7620760,7621017,7621274,7621531,7621787,7687580,7687837,7688094,7688351,7688607,7754400,7754657,7754914,7755171,7820964,7821220,7821477,7821734,7821991,7887784,7888040,7888297,7888554,7888811,7954604,7954861,7955117,7955374,7955631,8021424,8021681,8021937,8022194,8022451,8088244,8088501,8088757,8089014,8089271,8155064,8155321,8155578,8155834,8156091,8221884,8222141,8222398,8222654,8222911,8288704,8288961,8289218,8289475,8289731,8355524,8355781,8356038,8356295,8356551,8422344,8422601,8422858,8423115,8489164,8554700,8620492,8686285,8752077,8817613,8883406,8949198,9014991,9080527,9146319,9212112,9343440,9409232,9474769,9540561,9606354,9672146,9737682,9803475,9869267,9935059,10000852,10131924,10197717,10263509,10329301,10394838,10460630,10526422,10592215,10658007,10723544,10789336,10920664,10986457,11051993,11117786,11183578,11249370,11314907,11380699,11446491,11512284,11578076,11709149,11774941,11840733,11906526,11972062,12037854,12103647,12169439,12235232,12300768,12366560,12497889,12563681,12629217,12695010,12760802,12826595,12892387,12957923,13023716,13089508,13155300,13286373,13352165,13417958,13483750,13549542,13615079,13680871,13746664,13812456,13877992,13943785,14075113,14140905,14206442,14272234,14338027,14403819,14469611,14535148,14600940,14666732,14732525,14863597,14929390,14995182,15060974,15126767,15192303,15258095,15323888,15389680,15455217,15521009,15652337,15718130,15783922,15849458,15915251,15981043,16046836,16112372,16178164,16243957,16309749,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078,16441078]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/elenore.pxs",[],function(){return'{\r\n	"name" : "Elenore",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [5721417,5721417,5787210,5852746,5918539,5984075,6049868,6115404,6181197,6246733,6312526,6312526,6378319,6443855,6509648,6575184,6640977,6706513,6772306,6838098,6903635,6969427,6969428,7035220,7100757,7166549,7232086,7297878,7363415,7429207,7494744,7560536,7560537,7626329,7691866,7757658,7823451,7888987,7954780,8020316,8086109,8151645,8217438,8217438,8283231,8348767,8414560,8480096,8545889,8611425,8677218,8742754,8808547,8874339,8874340,8940132,9005669,9071461,9136998,9202790,9268327,9334119,9399656,9465448,9465449,9531241,9596778,9662570,9728107,9793899,9859692,9925228,9991021,10056557,10122350,10122350,10188143,10253679,10319472,10385008,10450801,10516337,10582130,10647666,10713459,10713459,10779252,10845044,10910581,10976373,11041910,11107702,11173239,11239031,11304568,11370360,11370361,11436153,11501690,11567482,11633019,11698811,11764348,11830140,11895933,11961469,12027262,12027262,12093055,12158591,12224384,12289920,12355713,12421249,12487042,12552578,12618371,12618371,12684164,12749700,12815493,12881285,12946822,13012614,13078151,13143943,13209480,13275272,13275273,13341065,13406602,13472394,13537931,13603723,13669260,13735052,13800589,13866381,13932174,13932174,13932431,13932687,13998480,13998736,13998737,14064530,14064786,14065043,14065299,14130836,14131092,14131349,14197142,14197398,14197399,14263191,14263448,14263705,14263961,14329754,14329754,14330011,14395803,14396060,14396317,14461853,14462110,14462366,14462623,14528416,14528416,14528673,14594465,14594722,14594978,14660771,14660772,14661028,14661285,14727077,14727334,14727334,14793127,14793384,14793640,14859433,14859433,14859690,14859947,14925739,14925996,14926252,14991789,14992045,14992302,15058095,15058351,15058352,15058608,15124401,15124658,15124914,15190451,15190707,15190964,15256756,15257013,15257270,15257270,15323063,15323319,15323576,15389369,15389369,15389626,15455418,15455675,15455931,15455932,15521725,15521981,15522238,15588030,15588287,15588287,15654080,15654337,15654593,15654850,15720386,15720643,15720900,15786692,15786949,15786949,15852742,15852998,15853255,15853512,15919304,15919305,15919561,15985354,15985611,15985867,16051404,16051660,16051917,16052173,16117966,16117967,16118223,16184016,16184272,16184529,16250322]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/penelope.pxs",[],function(){return'{\r\n	"name" : "Penelope",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [6162489,6162489,6162745,6162746,6163002,6163259,6228795,6229052,6229052,6229308,6229565,6229565,6295358,6295358,6295615,6295871,6295871,6296128,6361920,6361921,6362177,6362178,6362434,6362690,6428227,6428483,6428484,6428740,6428997,6428997,6494789,6494790,6495046,6495303,6495303,6561096,6561352,6561353,6561609,6561609,6561866,6627658,6627659,6627915,6627916,6628172,6628428,6693965,6694221,6694222,6694478,6694735,6694735,6760527,6760784,6760784,6761041,6761041,6761298,6827090,6827090,6827347,6827347,6827604,6827860,6893397,6893653,6893910,6893910,6894166,6959703,6959959,6960216,6960216,6960473,6960473,7026265,7026522,7026522,7026779,7026779,7027036,7092828,7092828,7093085,7093341,7093342,7093598,7159135,7159391,7159647,7159648,7159904,7159905,7225697,7225954,7225954,7226210,7226211,7226467,7292260,7292260,7292517,7292773,7292774,7358566,7358566,7358823,7359079,7359080,7359336,7424873,7425129,7425385,7425386,7425642,7425643,7491435,7491692,7491692,7491948,7492205,7492205,7557998,7557998,7558255,7558511,7558511,7558768,7624304,7624561,7624817,7624818,7625074,7690867,7756659,7888243,7954292,8085620,8151669,8283253,8414582,8480630,8612215,8678007,8809592,8941176,9006968,9138553,9204601,9335930,9467514,9533563,9664891,9730940,9862524,9928573,10059901,10191486,10257534,10388862,10454911,10586495,10717824,10783872,10915457,10981249,11112834,11244418,11310211,11441795,11507843,11639172,11705220,11836805,11968133,12034182,12165766,12231815,12363143,12494728,12560776,12692105,12758153,12889737,13021066,13087114,13218699,13284491,13416076,13482124,13613453,13745037,13811086,13942414,14008462,14140047,14271375,14337424,14469008,14535057,14666385,14797970,14864018,14995347,15061395,15192980,15258772,15390356,15521941,15587733,15719318,15785366,15916695,16048279,16114328,16245656,16311705,16443289,16574874,16574876,16575135,16575138,16575397,16575656,16575658,16575917,16575920,16576179,16576438,16576440,16642235,16642238,16642497,16642756,16642758,16643017,16643276,16643279,16643538,16643540,16643799,16644058,16709597,16709856,16709858,16710117,16710376,16710379,16710638,16710640,16710899,16711158,16711161,16711420,16777215]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/greg.pxs",[],function(){return'{\r\n	"name" : "Greg",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "mapping",\r\n			"param" :\r\n			{\r\n				"red" : [0,1,1,2,2,3,3,4,5,5,6,6,7,8,8,9,9,10,11,11,12,12,13,14,14,15,16,16,17,17,18,19,19,20,21,21,22,23,24,24,25,26,26,27,28,29,29,30,31,32,33,33,34,35,36,37,38,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,63,64,65,66,67,68,70,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,112,113,115,116,118,119,121,122,124,125,126,128,130,131,133,134,136,137,139,140,142,143,145,146,148,149,151,152,154,155,157,158,160,161,163,164,166,167,169,170,172,173,175,176,177,179,180,182,183,184,186,187,188,189,191,192,193,194,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,216,217,218,219,220,221,222,222,223,224,225,226,226,227,228,229,229,230,231,232,232,233,234,234,235,236,236,237,238,238,239,240,240,241,241,242,243,243,244,244,245,246,246,247,247,248,248,249,249,250,251,251,252,252,253,253,254,254,255],\r\n				"green" : [0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,4,4,5,5,6,6,7,7,8,9,9,10,11,12,13,14,14,15,17,18,19,20,21,23,24,25,27,28,30,32,33,35,37,39,41,43,45,47,49,52,54,56,59,61,64,66,69,72,74,77,80,83,85,88,91,94,97,99,102,105,108,110,113,116,118,121,123,126,128,131,133,136,138,140,142,144,146,149,151,152,154,156,158,160,162,163,165,167,168,170,171,173,174,176,177,178,180,181,182,183,184,185,187,188,189,190,191,191,192,193,194,195,196,196,197,198,199,199,200,200,201,202,202,203,203,204,204,204,205,205,206,206,206,207,207,207,207,208,208,208,208,208,209,209,209,209,209,209,209,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209],\r\n				"blue" : [0,0,0,0,1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,6,6,6,7,7,7,8,8,9,9,10,10,11,11,12,13,13,14,15,15,16,17,18,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,39,40,41,43,44,45,47,48,50,51,53,54,56,57,59,60,62,63,65,67,68,70,71,73,75,77,78,80,82,83,85,87,89,90,92,94,96,98,99,101,103,105,107,108,110,112,114,116,118,119,121,123,125,127,129,131,132,134,136,138,140,142,143,145,147,149,151,152,154,156,158,160,161,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,191,193,194,196,197,199,200,202,203,205,206,207,209,210,211,213,214,215,216,217,219,220,221,222,223,224,225,226,227,228,229,230,231,232,232,233,234,235,235,236,237,238,238,239,239,240,241,241,242,242,243,243,244,244,245,245,246,246,246,247,247,248,248,248,249,249,249,250,250,250,250,251,251,251,251,252,252,252,252,252,253,253,253,253,253,253,254,254,254,254,254,254,254,255,255,255,255]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/derek.pxs",[],function(){return'{\r\n	"name" : "Derek",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [4215378,4215378,4281171,4346963,4412756,4478549,4544341,4610134,4675927,4741719,4807512,4807769,4873561,4939354,5005146,5070939,5136476,5202268,5268061,5333854,5399646,5399903,5465696,5531488,5597281,5663074,5728866,5794659,5860451,5926244,5992037,5992037,6057830,6123623,6189415,6255208,6321001,6386793,6452586,6518379,6584171,6584428,6650220,6716013,6781806,6847598,6913135,6978928,7044720,7110513,7176306,7176562,7242355,7308148,7373940,7439733,7505525,7571318,7637111,7702903,7768696,7768697,7834489,7900282,7966075,8031867,8097660,8163452,8229245,8295038,8360830,8361087,8426880,8492672,8558465,8624258,8689794,8755587,8821380,8887172,8952965,8953221,9019014,9084807,9150599,9216392,9282185,9347977,9413770,9479563,9545355,9545356,9611149,9676941,9742734,9808526,9874319,9940112,10005904,10071697,10137490,10137746,10203539,10269332,10335124,10400917,10466454,10532246,10598039,10663831,10729624,10729881,10795673,10861466,10927259,10993051,11058844,11124637,11190429,11256222,11322015,11322015,11387551,11387551,11453343,11453343,11518879,11519136,11584672,11584672,11650464,11650464,11716000,11716256,11781793,11781793,11847329,11847585,11913121,11913121,11978913,11978914,12044450,12044706,12110242,12110242,12176034,12241571,12241571,12307363,12307363,12372899,12372899,12438691,12438692,12504228,12504484,12570020,12570020,12635812,12635812,12701349,12701605,12767141,12767141,12832933,12832933,12898469,12898470,12964262,12964262,13029798,13030054,13095590,13161127,13161383,13226919,13226919,13292711,13292711,13358247,13358248,13424040,13424040,13489576,13489832,13555368,13555368,13621161,13621161,13686697,13686953,13752489,13752489,13818281,13818282,13883818,13883818,13949610,13949610,14015146,14080939,14080939,14146475,14146731,14212267,14212267,14278059,14278060,14343596,14343852,14409388,14409388,14474924,14475180,14540717,14540717,14606509,14606509,14672045,14672301,14737837,14737838,14803630,14803630,14869166,14869166,14934958,15000495,15000495,15066287,15066287,15131823,15132079,15197615,15197616,15263408,15263408,15328944,15329200,15394736,15394736,15460273,15460529,15526065,15526065,15591857,15591857,15657393,15657650,15723186,15723186,15788978,15788978,15854514,15920307]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/george.pxs",[],function(){return'{\r\n	"name" : "George",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [481088,546624,612416,678209,743745,809538,875330,940866,1006659,1137987,1203524,1269316,1335108,1400645,1466437,1532230,1597766,1729094,1794887,1860423,1926216,1992008,2057545,2123337,2189129,2254666,2385994,2451787,2517323,2583115,2648908,2714444,2780237,2846029,2977101,3042894,3108686,3174223,3240015,3305808,3371344,3437136,3502929,3634001,3699794,3765586,3831122,3896915,3962707,4028244,4094036,4225364,4290901,4356693,4422486,4488022,4553815,4619607,4685143,4816472,4882264,4947801,5013593,5079385,5144922,5210714,5276507,5342043,5473371,5539164,5604700,5670493,5736285,5801822,5867614,5933406,6064479,6130271,6196064,6261600,6327392,6393185,6458721,6524514,6590306,6721378,6787171,6852963,6918500,6984292,7050084,7115621,7181413,7312742,7378278,7444071,7509863,7575399,7641192,7706984,7772521,7838313,7969641,8035178,8100970,8166763,8232299,8298091,8363884,8429420,8560749,8626541,8692078,8757870,8823662,8889199,8954991,9020784,9151856,9217648,9283441,9348977,9414770,9480562,9546098,9611891,9677683,9808756,9874548,9940341,10005877,10071669,10137462,10202998,10268791,10400119,10465655,10531448,10597240,10662777,10728569,10794361,10859898,10925690,11057019,11122555,11188348,11254140,11319676,11385469,11451261,11516798,11648126,11713918,11779455,11845247,11911040,11976576,12042368,12108161,12173697,12305026,12370818,12436354,12502147,12567939,12633476,12699268,12765061,12896133,12961925,13027718,13093254,13159047,13224839,13290375,13356168,13487496,13553033,13618825,13684617,13750154,13815946,13881739,13947275,14013068,14144396,14209932,14275725,14341517,14407054,14472846,14538638,14604175,14735503,14801296,14866832,14932624,14998417,15063953,15129746,15195538,15261075,15392403,15458195,15523732,15589524,15655317,15720853,15786645,15852438,15983510,16049303,16115095,16180631,16246424,16312216,16377753,16443545,16574874,16574876,16575135,16575138,16575397,16575656,16575658,16575917,16575920,16576179,16576438,16576440,16642235,16642238,16642497,16642756,16642758,16643017,16643276,16643279,16643538,16643540,16643799,16644058,16709597,16709856,16709858,16710117,16710376,16710379,16710638,16710640,16710899,16711158,16711161,16711420,16777215]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/gram.pxs",[],function(){return'{\r\n	"name" : "Gram",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [2689537,2689793,2755586,2821379,2821636,2887429,2953222,2953479,3019528,3085321,3085578,3151371,3217164,3282957,3283214,3349262,3415055,3415312,3481105,3546898,3547155,3612948,3678741,3744790,3745047,3810840,3876633,3876890,3942683,4008476,4008988,4074781,4140574,4206367,4206624,4272417,4338210,4338723,4404516,4470309,4470566,4536359,4602152,4667945,4668202,4734250,4800043,4800300,4866093,4931886,4932143,4997936,5063985,5129778,5130035,5195828,5261621,5261878,5327671,5393464,5393976,5459769,5525562,5591355,5591612,5657405,5723198,5723711,5789504,5855297,5855554,5921347,5987140,6052933,6053445,6119238,6185031,6185288,6251081,6316874,6317131,6382924,6448973,6514766,6515023,6580816,6646609,6646866,6712659,6778707,6778964,6844757,6910550,6976343,6976600,7042393,7108186,7108699,7174492,7240285,7240542,7306335,7372128,7437921,7438433,7504226,7570019,7570276,7636069,7701862,7702119,7768168,7833961,7899754,7900011,7965804,8031597,8031854,8097647,8163695,8163952,8229745,8295538,8361331,8361588,8427381,8493430,8493687,8559480,8625273,8625530,8691323,8757116,8823165,8823165,8888958,8954495,9020287,9086080,9151617,9217409,9283202,9348739,9414532,9480324,9545861,9611654,9677446,9742983,9808776,9874569,9940105,10005898,10071691,10071691,10137484,10203277,10268814,10334606,10400399,10465936,10531728,10597521,10663058,10728851,10794387,10860180,10925973,10991509,11057302,11123095,11188632,11254424,11320217,11320218,11386010,11451803,11517340,11583133,11648925,11714462,11780255,11846047,11911584,11977377,12043170,12108706,12174499,12240292,12305828,12371621,12437414,12502951,12568743,12634536,12634537,12700329,12765866,12831659,12897452,12962988,13028781,13094574,13160110,13225903,13291696,13357233,13423025,13488818,13554355,13620147,13685940,13751477,13817270,13883062,13883063,13948856,14014648,14080185,14145978,14211771,14277307,14343100,14408893,14474429,14540222,14605759,14671552,14737344,14802881,14868674,14934466,15000003,15065796,15131589,15131589,15197382,15263175,15328711,15394504,15460297,15525834,15591626,15657419,15722956,15788748,15854541,15920078,15985871,16051663,16117200,16182993,16248785,16314322,16380115,16445908]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/joyce.pxs",[],function(){return'{\r\n	"name" : "Joyce",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [6160384,6160641,6160898,6226692,6226949,6227206,6293256,6293513,6359306,6359564,6359821,6425870,6426128,6491921,6492178,6492436,6558485,6558742,6624536,6624793,6625050,6691100,6691357,6757150,6757408,6757665,6823714,6823972,6889765,6890022,6890280,6956329,6956586,7022380,7022637,7022894,7088944,7089201,7154994,7155252,7155509,7221558,7221816,7287609,7287866,7288124,7354173,7354430,7420224,7420481,7420738,7486532,7487045,7552838,7553096,7553353,7619146,7619660,7685453,7685710,7685968,7751761,7752274,7818068,7818325,7818582,7884376,7884889,7950682,7950940,7951197,8016990,8017504,8083297,8083554,8083812,8149605,8150118,8215912,8216169,8216426,8282220,8282733,8348526,8348784,8349041,8414834,8415348,8481141,8481398,8481656,8547449,8547962,8613756,8614013,8614270,8680064,8680321,8746370,8746628,8746885,8812678,8812936,8878985,8879242,8879500,8945293,8945550,9011600,9011857,9012114,9077908,9078165,9144214,9144472,9144729,9210522,9210780,9276829,9277086,9277344,9343137,9343394,9409444,9409701,9409958,9475752,9476009,9542058,9542316,9542573,9608366,9608624,9674673,9674930,9675188,9740981,9741238,9807288,9807288,9873080,9938616,10004408,10069944,10135736,10135992,10201528,10267320,10332856,10398648,10464440,10464440,10530232,10595768,10661560,10727352,10792888,10793144,10858680,10924472,10990008,11055800,11121592,11121592,11187384,11252920,11318712,11384504,11450040,11450296,11515832,11581624,11647416,11712952,11778744,11778744,11844536,11910328,11975864,12041656,12107192,12172984,12172984,12238776,12304568,12370104,12435896,12501432,12501688,12567480,12633016,12698808,12764344,12830136,12830392,12895928,12961720,13027257,13093049,13158585,13158841,13224633,13290169,13355961,13421497,13487289,13487545,13553081,13618873,13684409,13750201,13815993,13815993,13881785,13947321,14013113,14078905,14144441,14210233,14210233,14276025,14341561,14407353,14473145,14538681,14538937,14604473,14670265,14736057,14801593,14867385,14867385,14933177,14998969,15064505,15130297,15195833,15196089,15261625,15327417,15393209,15458745,15524537,15524537,15590329,15656121,15721657,15787449,15852985,15853241,15919033,15984569,16050361,16115897,16181689,16247482]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/mio.pxs",[],function(){return'{\r\n	"name" : "Mio",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [6688035,6688034,6688034,6688034,6688034,6753570,6753569,6753569,6753569,6819105,6819105,6819105,6819104,6884640,6884640,6884640,6884896,6950432,6950431,6950431,6950431,7015967,7015967,7015967,7015966,7081502,7081502,7081502,7081502,7147038,7147037,7147037,7147293,7147293,7212829,7212829,7212828,7212828,7278364,7278364,7278364,7278364,7343899,7343899,7343899,7343899,7409435,7409435,7409690,7409690,7475226,7475226,7475226,7475226,7540761,7540761,7540761,7540761,7606297,7606297,7606296,7606296,7671832,7671832,7672088,7672088,7672087,7737623,7737623,7737623,7737623,7803159,7803158,7803158,7803158,7868694,7868694,7868694,7868693,7934229,7934485,7934485,7934485,8000021,8000020,8000020,8000020,8065556,8065556,8065556,8065555,8131091,8131091,8131091,8131091,8196883,8262931,8328980,8395029,8461078,8527127,8593176,8724761,8790810,8856859,8922908,8988957,9055006,9186847,9252896,9318945,9384994,9451043,9517091,9648676,9714725,9780774,9846823,9912872,9978921,10044970,10176811,10242860,10308909,10374958,10441007,10507056,10638641,10704690,10770739,10836788,10902836,10968885,11100726,11166775,11232824,11298873,11364922,11430971,11562556,11628605,11694654,11760703,11826752,11892801,11958850,12090691,12156740,12222788,12288837,12354886,12420935,12552520,12618569,12684618,12750667,12816716,12882765,13014606,13080655,13146704,13212753,13278802,13344851,13410900,13542485,13608533,13674582,13740631,13806680,13872729,14004570,14070619,14136668,14202717,14268766,14334815,14466400,14532449,14598498,14664547,14730596,14796645,14928486,14928488,14928746,14994540,14994542,14994800,15060594,15060852,15126391,15126649,15126907,15192701,15192703,15258497,15258755,15259013,15324552,15324810,15390604,15390606,15390864,15456658,15456916,15456918,15522713,15522971,15588765,15588767,15589025,15654819,15655077,15720615,15720874,15721132,15786926,15786928,15852722,15852980,15852982,15918776,15919035,15919293,15984831,15985089,16050883,16051141,16051143,16116937,16117196,16182990,16182992,16183250,16249044,16249302,16314840,16315098,16315357,16380895,16381153,16381411,16447205,16447207,16513001,16513259,16513518,16579056,16579314,16645108,16645366,16645368,16711162,16711420,16777215]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/mirja.pxs",[],function(){return'{\r\n	"name" : "Mirja",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [11361891,11361891,11361891,11362147,11427684,11427940,11427940,11427941,11493733,11493733,11493990,11559526,11559526,11559783,11559783,11625575,11625575,11625576,11691368,11691368,11691625,11691625,11757161,11757418,11757418,11823210,11823211,11823211,11823467,11889004,11889260,11889260,11954796,11955053,11955053,11955309,12020846,12021102,12021102,12086639,12086895,12086895,12087152,12152688,12152688,12152945,12218481,12218737,12218737,12218738,12284530,12284530,12284787,12284787,12350323,12350580,12350580,12416372,12416373,12416373,12416629,12482166,12482422,12482422,12547958,12548215,12548215,12548471,12614008,12614264,12614264,12679801,12680057,12680057,12680314,12745850,12745850,12746106,12811643,12811899,12811899,12811900,12877692,12877692,12877949,12943485,12943485,12943742,12943742,13009534,13009535,13009535,13075327,13075327,13075584,13075584,13141120,13141377,13141377,13141633,13207170,13207170,13207426,13272963,13273219,13273219,13273476,13339012,13339012,13339268,13404805,13405061,13405061,13405062,13470854,13470854,13471111,13536647,13536647,13536904,13536904,13602696,13602697,13602697,13668489,13668489,13668746,13668746,13734282,13734539,13734539,13800331,13800332,13800332,13800588,13866125,13866381,13866381,13932174,13932174,13932430,13932687,13932943,13933200,13933456,13933456,13933713,13933969,13934226,14000018,14000275,14000531,14000531,14000788,14001044,14001301,14001557,14001814,14002070,14002070,14067863,14068119,14068376,14068632,14068889,14069145,14069145,14069402,14069658,14069915,14135707,14135964,14136220,14136220,14136477,14136733,14136990,14137246,14137503,14137759,14137759,14203552,14203808,14204065,14204321,14204578,14204834,14204834,14205091,14205347,14205604,14205860,14271653,14271909,14271909,14272166,14272422,14272679,14272935,14273192,14273192,14273448,14339241,14339497,14339754,14340010,14340267,14340267,14340523,14340780,14341036,14341293,14341549,14407342,14407342,14407598,14407855,14408111,14408368,14408624,14408881,14408881,14409137,14409394,14475186,14475443,14475699,14475956,14475956,14476212,14476469,14476725,14476982,14477238,14543031,14543031,14543287,14543544,14543800,14544057,14544313,14544570,14544570,14544826,14545083,14610875,14611132,14611388,14611645,14611645,14611901,14612158,14612414,14612671,14612927,14678720]		\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/subtle/adrian.pxs",[],function(){return'{\n	"name" : "Adrian",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [54,54,55,55,55,56,56,57,57,57,58,58,58,59,59,60,60,60,61,61,61,62,62,63,63,63,64,64,65,65,65,66,66,67,67,67,68,68,69,69,69,70,70,71,71,72,72,73,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,85,85,86,86,87,87,88,89,89,90,90,91,92,92,93,94,94,95,96,96,97,98,98,99,100,100,101,102,102,103,104,105,105,106,107,107,108,109,110,111,111,112,113,114,114,115,116,117,118,118,119,120,121,122,123,123,124,125,126,127,128,128,129,130,131,132,133,134,135,135,136,137,138,139,140,141,142,143,144,145,146,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,207,208,209,210,211,212,213,214,215,216,217,219,220,221,222,223,224,225,226,227,228,230,231,232,233,234,235,236,237,238,239,241,242,243,244,245,246,247,248,249,251,252,253,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,160,161,162,163,164,165,166,167,168,169,170,171,171,172,173,174,175,176,177,177,178,179,180,181,181,182,183,184,184,185,186,187,187,188,189,189,190,191,191,192,193,193,194,194,195,195,196,197,197,198,198,199,199,199,200,200,201,201,202,202,202,203,203,203,204,204,204,205,205,205,206,206,206,207,207,207,207,208,208,208,209,209,209,209,209,210,210,210,210,211,211,211,211,212,212,212],\n				"blue" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,61,62,63,64,65,66,67,68,69,70,70,71,72,73,74,75,76,77,77,78,79,80,81,82,82,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,100,101,102,102,103,104,104,105,106,106,107,107,108,109,109,110,110,111,111,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,119,120,120,121,121,122,122,122,123,123,124,124,124,125,125,125,126,126,126,127,127,127,128,128,128,129,129,129,129,130,130,130,131,131,131,131,132,132,132,132,133,133,133,133,134,134,134,134,134,135,135,135,135,135,136,136,136,136,136,136,137,137,137,137,137,137,138,138,138,138,138,138,139,139,139,139,139,139,139,140,140,140,140,140,140,140,140,141,141,141,141,141,141,141,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity":55\n			}\n		}\n	]\n}'}),define("text!effects/subtle/alex.pxs",[],function(){return'{\n	"name" : "Alex",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "desaturate",\n			"param" : { }\n\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 10\n			}\n			\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "hardlight",\n				"opacity" : 60\n			}\n		}\n	]\n}'}),define("text!effects/subtle/ian.pxs",[],function(){return'{\n	"name" : "Ian",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [655538,721072,852143,983213,1114284,1245355,1376425,1507496,1638566,1769637,1900708,2031778,2097313,2228383,2359454,2490525,2621595,2752666,2883736,3014807,3145878,3276948,3408019,3539090,3604624,3735695,3866765,3997836,4128907,4259977,4391048,4522118,4653189,4784260,4915330,4980865,5111935,5243006,5374077,5505147,5636218,5767288,5898359,6029430,6160500,6291571,6422642,6488176,6619247,6750317,6881388,7012459,7143529,7274600,7405670,7536741,7667812,7798882,7929953,7995487,8126558,8257629,8388699,8519770,8650841,8781911,8912982,9044052,9175123,9306194,9371728,9502799,9633869,9764940,9896011,10027081,10158152,10289222,10420293,10551364,10682434,10813505,10879039,11010110,11141181,11272251,11403322,11534393,11665463,11796534,11927604,12058675,12189746,12320816,12386351,12517421,12648492,12779563,12910633,13041704,13172774,13303845,13434916,13565986,13697057,13762591,13893662,14024733,14155803,14286874,14417945,14549015,14680086,14811156,14942227,15073298,15204368,15269903,15400973,15532044,15663115,15794185,15925256,16056326,16187397,16318468,16449538,16580609,16711680,16711936,16712448,16712960,16713472,16713984,16714496,16715008,16715520,16716032,16716544,16717056,16717568,16718080,16718592,16719104,16719616,16720128,16720640,16721152,16721664,16722176,16722688,16723200,16723712,16724224,16724736,16725248,16725760,16726272,16726784,16727296,16727808,16728320,16728832,16729344,16729856,16730368,16730880,16731392,16731904,16732416,16732928,16733440,16733952,16734464,16734976,16735488,16736000,16736512,16737024,16737536,16738048,16738560,16739072,16739584,16740096,16740608,16741120,16741632,16742144,16742656,16743168,16743680,16743936,16744448,16744960,16745472,16745984,16746496,16747008,16747520,16748032,16748544,16749056,16749568,16750080,16750592,16751104,16751616,16752128,16752640,16753152,16753664,16754176,16754688,16755200,16755712,16756224,16756736,16757248,16757760,16758272,16758784,16759296,16759808,16760320,16760832,16761344,16761856,16762368,16762880,16763392,16763904,16764416,16764928,16765440,16765952,16766464,16766976,16767488,16768000,16768512,16769024,16769536,16770048,16770560,16771072,16771584,16772096,16772608,16773120,16773632,16774144,16774656,16775168,16775680,16776192]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity" : 25,\n				"blend" : "overlay"\n			}\n		}\n	]\n}'}),define("text!effects/subtle/ingrid.pxs",[],function(){return'{\n	"name" : "Ingrid",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "invert",\n			"target" : 1,\n			"param" : { }\n		},\n		{\n			"type" : "desaturate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" : \n			{\n				"amount" : 50,\n				"quality" : 10\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay"\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 1,\n			"param" : { }\n		},\n		{\n			"type" : "invert",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 3\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity" : 40\n			}\n		},\n		{\n			"type" : "levels",\n			"param" :\n			{\n				"min" : 85,\n				"max" : 170\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/subtle/janine.pxs",[],function(){return'{\n	"name" : "Janine",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [63,64,65,65,66,67,68,68,69,70,71,71,72,73,74,74,75,76,77,77,78,79,80,80,81,82,83,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,101,101,102,103,104,104,105,106,107,107,108,109,110,110,111,112,113,113,114,115,116,116,117,118,119,119,120,121,122,122,123,124,125,125,126,127,128,129,129,130,131,132,132,133,134,135,135,136,137,138,138,139,140,141,141,142,143,144,144,145,146,147,147,148,149,150,150,151,152,153,153,154,155,156,156,157,158,159,159,160,161,162,162,163,164,165,165,166,167,168,168,169,170,171,171,172,173,174,174,175,176,177,177,178,179,180,180,181,182,183,183,184,185,186,186,187,188,189,189,190,191,192,193,193,194,195,196,196,197,198,199,199,200,201,202,202,203,204,205,205,206,207,208,208,209,210,211,211,212,213,214,214,215,216,217,217,218,219,220,220,221,222,223,223,224,225,226,226,227,228,229,229,230,231,232,232,233,234,235,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,247,248,249,250,250,251,252,253,253,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],\n				"blue" : [63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99,100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,156,157,157,158,158,159,159,160,160,161,161,162,162,163,163,164,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179,180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,189,190,190,191]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity":50\n			}\n		}\n	]\n}'}),define("text!effects/subtle/merissa.pxs",[],function(){return'{\n	"name" : "Merissa",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [63,64,65,65,66,67,68,68,69,70,71,71,72,73,74,74,75,76,77,77,78,79,80,80,81,82,83,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,101,101,102,103,104,104,105,106,107,107,108,109,110,110,111,112,113,113,114,115,116,116,117,118,119,119,120,121,122,122,123,124,125,125,126,127,128,129,129,130,131,132,132,133,134,135,135,136,137,138,138,139,140,141,141,142,143,144,144,145,146,147,147,148,149,150,150,151,152,153,153,154,155,156,156,157,158,159,159,160,161,162,162,163,164,165,165,166,167,168,168,169,170,171,171,172,173,174,174,175,176,177,177,178,179,180,180,181,182,183,183,184,185,186,186,187,188,189,189,190,191,192,193,193,194,195,196,196,197,198,199,199,200,201,202,202,203,204,205,205,206,207,208,208,209,210,211,211,212,213,214,214,215,216,217,217,218,219,220,220,221,222,223,223,224,225,226,226,227,228,229,229,230,231,232,232,233,234,235,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,247,248,249,250,250,251,252,253,253,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],\n				"blue" : [63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99,100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,156,157,157,158,158,159,159,160,160,161,161,162,162,163,163,164,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179,180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,189,190,190,191]\n			}\n		}\n	]\n}'}),define("text!effects/subtle/ronny.pxs",[],function(){return'{\n	"name" : "Ronny",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,0,1,1,1,2,2,2,3,3,4,4,4,5,5,5,6,6,7,7,7,8,8,9,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,20,20,21,22,22,23,23,24,25,26,26,27,28,29,29,30,31,32,33,34,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,53,54,56,57,58,59,61,62,63,64,66,67,68,70,71,73,74,75,77,78,80,81,82,84,85,87,88,90,91,93,94,96,97,99,100,102,104,105,107,108,110,111,113,115,116,118,119,121,122,124,126,127,129,130,132,134,135,137,138,140,142,143,145,146,148,149,151,153,154,156,157,159,160,162,163,165,166,168,170,171,173,174,175,177,178,180,181,183,184,186,187,188,190,191,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,211,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,229,230,231,232,233,233,234,235,236,236,237,238,238,239,239,240,241,241,242,242,243,244,244,245,245,246,246,247,247,248,248,249,249,250,250,251,251,251,252,252,253,253,254,254,255,255],\n				"green" : [0,1,2,2,3,4,5,5,6,7,8,8,9,10,11,11,12,13,14,15,15,16,17,18,18,19,20,21,21,22,23,24,25,25,26,27,28,29,29,30,31,32,33,33,34,35,36,37,38,38,39,40,41,42,43,43,44,45,46,47,48,48,49,50,51,52,53,54,55,56,56,57,58,59,60,61,62,63,64,65,66,67,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,110,111,112,113,114,116,117,118,119,120,122,123,124,125,127,128,129,131,132,133,135,136,137,138,140,141,142,144,145,147,148,149,151,152,153,155,156,157,159,160,162,163,164,166,167,168,170,171,172,174,175,176,178,179,180,182,183,184,186,187,188,190,191,192,193,195,196,197,198,199,201,202,203,204,205,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,227,228,229,230,231,232,232,233,234,235,236,236,237,238,239,239,240,241,242,242,243,244,245,245,246,247,247,248,249,249,250,251,252,252,253,254,254,255],\n				"blue" : [56,56,56,56,56,56,56,56,56,56,57,57,58,58,59,60,60,61,62,62,63,63,64,65,65,66,67,67,68,68,69,70,70,71,71,72,73,73,74,75,75,76,76,77,78,78,79,79,80,81,81,82,83,83,84,84,85,86,86,87,88,88,89,89,90,91,91,92,92,93,94,94,95,96,96,97,97,98,99,99,100,100,101,102,102,103,104,104,105,105,106,107,107,108,109,109,110,110,111,112,112,113,113,114,115,115,116,117,117,118,118,119,120,120,121,121,122,123,123,124,125,125,126,126,127,128,128,129,130,130,131,131,132,133,133,134,134,135,136,136,137,138,138,139,139,140,141,141,142,143,143,144,144,145,146,146,147,147,148,149,149,150,151,151,152,152,153,154,154,155,155,156,157,157,158,159,159,160,160,161,162,162,163,164,164,165,165,166,167,167,168,168,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,180,180,181,181,182,183,183,184,185,185,186,186,187,188,188,189,189,190,191,191,192,193,193,194,194,195,196,196,197,197,198,199,199,200,201,201,202,202,203,204,204,205,206,206,207,207,208]\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [22,22,22,22,22,22,22,22,22,22,22,22,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,104,105,106,107,108,109,110,111,111,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,127,128,129,130,131,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,143,144,145,146,146,147,148,148,149,150,151,151,152,153,153,154,155,155,156,157,157,158,159,159,160,161,161,162,162,163,164,164,165,166,166,167,167,168,169,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,179,180,180,181,182,182,183,183,184,184,185,185,186,187,187,188,188,189,189,190,190,191,192,192,193,193,194,194,195,195,196,196,197,197,198,199,199,200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208],\n				"green" : [22,22,22,22,22,22,22,22,22,22,22,22,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,104,105,106,107,108,109,110,111,111,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,127,128,129,130,131,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,143,144,145,146,146,147,148,148,149,150,151,151,152,153,153,154,155,155,156,157,157,158,159,159,160,161,161,162,162,163,164,164,165,166,166,167,167,168,169,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,179,180,180,181,182,182,183,183,184,184,185,185,186,187,187,188,188,189,189,190,190,191,192,192,193,193,194,194,195,195,196,196,197,197,198,199,199,200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208],\n				"blue" : [22,22,22,22,22,22,22,22,22,22,22,22,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,104,105,106,107,108,109,110,111,111,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,127,128,129,130,131,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,143,144,145,146,146,147,148,148,149,150,151,151,152,153,153,154,155,155,156,157,157,158,159,159,160,161,161,162,162,163,164,164,165,166,166,167,167,168,169,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,179,180,180,181,182,182,183,183,184,184,185,185,186,187,187,188,188,189,189,190,190,191,192,192,193,193,194,194,195,195,196,196,197,197,198,199,199,200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity":68\n			}\n		}\n	]\n}'}),define("text!effects/subtle/roxy.pxs",[],function(){return'{\n	"name" : "Roxy",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,2,3,5,7,8,10,12,13,15,17,18,20,22,24,25,27,29,30,32,34,35,37,38,40,42,43,45,47,48,50,52,53,55,57,58,60,61,63,65,66,68,69,71,73,74,76,77,79,80,82,83,85,87,88,90,91,93,94,96,97,99,100,102,103,105,106,107,109,110,112,113,115,116,117,119,120,121,123,124,126,127,128,130,131,132,133,135,136,137,139,140,141,142,143,145,146,147,148,149,151,152,153,154,155,156,157,158,159,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,179,180,181,182,183,184,185,186,187,187,188,189,190,191,192,192,193,194,195,196,196,197,198,199,199,200,201,202,202,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,216,217,218,218,219,219,220,221,221,222,222,223,224,224,225,225,226,226,227,227,228,228,229,230,230,231,231,232,232,233,233,234,234,235,235,236,236,237,237,238,238,238,239,239,240,240,241,241,242,242,243,243,244,244,244,245,245,246,246,247,247,248,248,248,249,249,250,250,251,251,252,252,252,253,253,254,254,255,255],\n				"green" : [0,1,1,2,3,3,4,4,5,6,6,7,8,8,9,10,10,11,11,12,13,13,14,15,15,16,17,17,18,19,19,20,20,21,22,22,23,24,24,25,26,26,27,28,28,29,30,30,31,32,33,33,34,35,35,36,37,37,38,39,40,40,41,42,42,43,44,45,45,46,47,47,48,49,50,50,51,52,53,53,54,55,56,57,57,58,59,60,60,61,62,63,64,65,65,66,67,68,69,69,70,71,72,73,74,75,75,76,77,78,79,80,81,82,83,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,118,119,120,121,122,123,124,125,127,128,129,130,131,132,133,135,136,137,138,139,141,142,143,144,145,147,148,149,150,152,153,154,155,157,158,159,160,162,163,164,165,167,168,169,171,172,173,174,176,177,178,180,181,182,184,185,186,188,189,190,192,193,194,196,197,198,200,201,202,204,205,207,208,209,211,212,213,215,216,217,219,220,222,223,224,226,227,229,230,231,233,234,235,237,238,240,241,242,244,245,247,248,249,251,252,254,255],\n				"blue" : [127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity":45\n			}\n		}\n	]\n}'}),define("text!effects/subtle/sanna.pxs",[],function(){return'{\n	"name" : "Sanna",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,1,2,2,3,4,4,5,5,6,7,7,8,8,9,10,10,11,11,12,13,13,14,14,15,16,16,17,18,18,19,19,20,21,21,22,23,23,24,25,25,26,27,27,28,29,29,30,31,32,32,33,34,34,35,36,37,37,38,39,40,40,41,42,43,44,44,45,46,47,48,48,49,50,51,52,53,54,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,83,84,85,86,87,88,90,91,92,93,94,96,97,98,99,101,102,103,104,106,107,108,110,111,112,114,115,116,118,119,120,122,123,125,126,127,129,130,132,133,134,136,137,139,140,142,143,145,146,148,149,151,152,154,155,157,158,160,161,163,164,166,167,169,170,172,174,175,177,178,180,181,183,185,186,188,189,191,193,194,196,197,199,201,202,204,205,207,209,210,212,214,215,217,219,220,222,223,225,227,228,230,232,233,235,237,238,240,242,243,245,247,248,250,252,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],\n				"green" : [0,1,2,3,3,4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,21,22,23,24,24,25,26,27,28,29,30,31,32,33,33,34,35,36,37,38,39,40,41,42,43,44,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,99,100,101,102,103,104,106,107,108,109,110,112,113,114,115,116,117,119,120,121,122,124,125,126,127,128,130,131,132,133,134,136,137,138,139,141,142,143,144,145,147,148,149,150,151,153,154,155,156,157,159,160,161,162,163,165,166,167,168,169,170,172,173,174,175,176,177,178,180,181,182,183,184,185,186,187,188,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,215,216,217,218,219,220,221,222,222,223,224,225,226,227,227,228,229,230,231,232,232,233,234,235,235,236,237,238,239,239,240,241,242,242,243,244,245,245,246,247,248,248,249,250,251,251,252,253,254,254,255],\n				"blue" : [22,23,24,24,25,26,27,28,29,29,30,31,32,33,33,34,35,36,37,37,38,39,40,41,42,42,43,44,45,46,46,47,48,49,50,51,51,52,53,54,55,55,56,57,58,59,60,60,61,62,63,64,64,65,66,67,68,68,69,70,71,72,73,73,74,75,76,77,77,78,79,80,81,82,82,83,84,85,86,86,87,88,89,90,91,91,92,93,94,95,95,96,97,98,99,99,100,101,102,103,104,104,105,106,107,108,108,109,110,111,112,113,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,126,127,128,129,130,130,131,132,133,134,135,135,136,137,138,139,139,140,141,142,143,144,144,145,146,147,148,148,149,150,151,152,153,153,154,155,156,157,157,158,159,160,161,161,162,163,164,165,166,166,167,168,169,170,170,171,172,173,174,175,175,176,177,178,179,179,180,181,182,183,184,184,185,186,187,188,188,189,190,191,192,192,193,194,195,196,197,197,198,199,200,201,201,202,203,204,205,206,206,207,208,209,210,210,211,212,213,214,215,215,216,217,218,219,219,220,221,222,223,223,224,225,226,227,228,228,229,230]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity":50\n			}\n		}\n	]\n}'}),define("text!effects/too_old/agatha.pxs",[],function(){return'{\n	"name" : "Agatha",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "desaturate",\n			"param" : { }\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "noise",\n			"param" : \n			{\n				"amount" : 400\n			}\n		},\n		{\n			"type" : "blur",\n			"param" : \n			{\n				"amount" : 2,\n				"quality" : 10\n			}\n		},\n		{\n			"type" : "noise",\n			"param" : \n			{\n				"amount" : 5\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/too_old/agnes.pxs",[],function(){return'{\n	"name" : "Agnes",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "desaturate",\n			"param" :\n			{\n\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" :\n			{\n				"amount" : 50\n			}\n		}\n	]\n}'}),define("text!effects/too_old/gordon.pxs",[],function(){return'{\n	"name" : "Gordon",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "desaturate",\n			"param" :\n			{\n\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,2,3,5,6,8,9,11,12,14,15,17,18,20,21,23,24,26,27,29,30,32,33,35,36,38,39,41,42,44,45,47,48,50,51,53,54,56,57,59,60,61,63,64,66,67,69,70,72,73,74,76,77,79,80,82,83,84,86,87,89,90,91,93,94,95,97,98,100,101,102,104,105,106,108,109,110,112,113,114,115,117,118,119,121,122,123,124,126,127,128,129,130,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,152,153,154,155,157,158,159,160,161,162,163,164,165,166,167,168,169,170,170,171,172,173,174,175,176,177,178,179,180,181,181,182,183,184,185,186,187,187,188,189,190,191,191,192,193,194,195,195,196,197,198,199,199,200,201,202,202,203,204,204,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,222,223,224,224,225,226,226,227,227,228,229,229,230,230,231,231,232,233,233,234,234,235,235,236,237,237,238,238,239,239,240,240,241,242,242,243,243,244,244,245,245,246,246,247,248,248,249,249,250,250,251,251,252,252,253,253,254,254,255],\n				"green" : [0,1,2,4,5,6,7,9,10,11,12,14,15,16,17,19,20,21,22,24,25,26,27,29,30,31,32,33,35,36,37,38,40,41,42,43,44,46,47,48,49,51,52,53,54,55,57,58,59,60,61,63,64,65,66,67,69,70,71,72,73,75,76,77,78,79,80,82,83,84,85,86,88,89,90,91,92,93,94,96,97,98,99,100,101,102,104,105,106,107,108,109,110,111,112,114,115,116,117,118,119,120,121,122,123,124,125,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,162,163,164,165,166,167,168,169,170,171,172,173,174,174,175,176,177,178,179,180,181,182,182,183,184,185,186,187,188,189,189,190,191,192,193,194,195,195,196,197,198,199,200,200,201,202,203,204,205,205,206,207,208,209,210,210,211,212,213,214,214,215,216,217,218,218,219,220,221,222,222,223,224,225,226,226,227,228,229,229,230,231,232,233,233,234,235,236,236,237,238,239,240,240,241,242,243,243,244,245,246,247,247,248,249,250,250,251,252,253,253,254,255],\n				"blue" : [0,1,1,2,3,4,4,5,6,6,7,8,8,9,10,11,11,12,13,13,14,15,16,16,17,18,18,19,20,20,21,22,23,23,24,25,26,26,27,28,28,29,30,31,31,32,33,34,34,35,36,37,37,38,39,40,40,41,42,43,43,44,45,46,46,47,48,49,50,50,51,52,53,53,54,55,56,57,57,58,59,60,61,62,62,63,64,65,66,66,67,68,69,70,71,72,72,73,74,75,76,77,78,79,79,80,81,82,83,84,85,86,87,88,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,144,145,146,147,148,149,151,152,153,154,155,157,158,159,160,161,163,164,165,166,167,169,170,171,172,174,175,176,177,178,180,181,182,184,185,186,187,189,190,191,192,194,195,196,197,199,200,201,203,204,205,206,208,209,210,212,213,214,216,217,218,219,221,222,223,225,226,227,229,230,231,233,234,235,237,238,239,240,242,243,244,246,247,248,250,251,252,254,255]\n			}\n		}\n	]\n}'}),define("text!effects/too_old/harrison.pxs",[],function(){return'{\n	"name" : "Harrison",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [2692874,2692874,2758667,2824460,2890253,2956046,3021583,3021839,3087632,3153425,3219218,3285011,3350548,3350804,3416597,3482390,3548183,3613976,3679513,3679769,3745562,3811355,3877148,3942685,4008478,4008734,4074527,4140320,4206113,4271650,4337443,4403236,4403492,4469285,4535078,4600615,4666408,4732201,4732457,4798250,4863787,4929580,4995373,5061166,5061422,5127215,5192752,5258545,5324338,5390131,5390387,5456180,5521717,5587510,5653303,5719096,5719352,5784889,5850682,5916475,5982268,6048061,6113854,6113854,6179647,6245440,6311233,6377026,6442819,6442819,6508612,6574405,6640198,6705991,6771528,6771784,6837577,6903370,6969163,7034956,7100493,7100749,7166542,7232335,7298128,7363921,7429458,7495251,7495507,7561300,7627093,7692630,7758423,7824216,7824472,7890265,7956058,8021595,8087388,8153181,8153437,8219230,8285023,8350560,8416353,8482146,8482402,8548195,8613732,8679525,8745318,8811111,8811367,8877160,8942697,9008490,9074283,9140076,9205869,9206125,9271662,9337455,9403248,9469041,9534834,9534834,9600627,9666420,9732213,9798006,9863799,9863799,9929592,9995385,10061178,10126971,10192764,10192764,10258557,10324350,10390143,10455936,10521473,10587266,10587522,10653315,10719108,10784901,10850438,10916231,10916487,10982280,11048073,11113866,11179403,11245196,11245452,11311245,11377038,11442575,11508368,11574161,11574417,11640210,11706003,11771540,11837333,11903126,11903382,11969175,12034968,12100505,12166298,12232091,12297884,12298140,12363677,12429470,12495263,12561056,12626849,12627105,12692642,12758435,12824228,12890021,12955814,12956070,13021607,13087400,13153193,13218986,13284779,13284779,13350572,13416365,13482158,13547951,13613744,13679281,13679537,13745330,13811123,13876916,13942709,14008246,14008502,14074295,14140088,14205881,14271418,14337211,14337467,14403260,14469053,14534846,14600383,14666176,14666432,14732225,14798018,14863811,14929348,14995141,14995397,15061190,15126983,15192520,15258313,15324106,15389899,15390155,15455948,15521485,15587278,15653071,15718864,15719120,15784913,15850450,15916243,15982036,16047829,16048085,16113622,16179415,16245208,16311001,16376794,16377050,16442587,16508380,16574173,16639966,16705759,16771552]\n			}\n		},\n		{\n			"type" : "noise",\n			"param" :\n			{\n				"amount" : 20\n			}\n		}\n	]\n}'}),define("text!effects/too_old/henry.pxs",[],function(){return'{\n	"name" : "Henry",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [2691082,2691082,2756875,2822668,2888461,2954254,3020047,3020304,3086097,3151890,3217683,3283476,3349269,3349526,3415319,3481112,3546649,3612442,3678235,3678492,3744285,3810078,3875871,3941664,4007457,4007714,4073506,4139299,4205092,4270885,4336678,4402471,4402472,4468265,4534058,4599851,4665644,4731437,4731694,4797487,4863280,4929073,4994866,5060659,5060916,5126709,5192502,5258295,5323832,5389625,5389882,5455675,5521467,5587260,5653053,5718846,5719103,5784896,5850689,5916482,5982275,6048068,6113861,6114118,6179655,6245448,6311241,6377034,6442827,6443084,6508877,6574670,6640463,6706256,6772049,6772306,6838099,6903891,6969684,7035477,7101014,7101271,7167064,7232857,7298650,7364443,7430236,7496029,7496286,7562079,7627872,7693665,7759458,7825251,7825508,7891301,7956838,8022631,8088424,8154217,8154474,8220267,8286060,8351852,8417645,8483438,8483695,8549488,8615281,8681074,8746867,8812660,8812661,8878454,8944247,9010040,9075833,9141626,9207419,9207676,9273469,9339262,9405055,9470848,9536641,9536898,9602691,9668484,9734020,9799813,9865606,9865863,9931656,9997449,10063242,10129035,10194828,10195085,10260878,10326671,10392464,10458257,10524050,10589843,10589844,10655637,10721430,10787223,10853016,10918809,10919066,10984859,11050652,11116445,11182237,11248030,11248287,11314080,11379873,11445666,11511203,11576996,11577253,11643046,11708839,11774632,11840425,11906218,11906475,11972268,12038061,12103854,12169647,12235440,12301233,12301490,12367027,12432820,12498613,12564405,12630198,12630455,12696248,12762041,12827834,12893627,12959420,12959677,13025470,13091263,13157056,13222849,13288386,13288643,13354436,13420229,13486022,13551815,13617608,13683401,13683658,13749451,13815244,13881037,13946830,14012622,14012879,14078672,14144209,14210002,14275795,14341588,14341845,14407638,14473431,14539224,14605017,14670810,14671067,14736860,14802653,14868446,14934239,15000032,15000033,15065826,15131619,15197412,15263205,15328998,15394790,15395047,15460840,15526633,15592426,15658219,15724012,15724269,15790062,15855855,15921392,15987185,16052978,16053235,16119028,16184821,16250614,16316407,16382200,16382457,16448250,16514043,16579836,16645629,16711422,16777215]\n			}\n		}\n	]\n}'}),define("text!effects/too_old/logan.pxs",[],function(){return'{\n	"name" : "Logan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "desaturate",\n			"param" :\n			{\n\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "sharpen",\n			"param" : { }\n		},\n		{\n			"type" : "sharpen",\n			"param" : { }\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 75\n			}\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [3022596,3022596,3088389,3154182,3154182,3219975,3285768,3285769,3351561,3417354,3483147,3483148,3548940,3614733,3614734,3680527,3746319,3812112,3812113,3877906,3943698,3943699,4009492,4075285,4141077,4141078,4206871,4272664,4272664,4338457,4404250,4470043,4470043,4535836,4601629,4601630,4667422,4733215,4733216,4799009,4864801,4930594,4930595,4996388,5062180,5062181,5127974,5193767,5259559,5259560,5325353,5391146,5391146,5456939,5522732,5588525,5588525,5654318,5720111,5720112,5785904,5851697,5917490,5917491,5983283,6049076,6049077,6114870,6180662,6180663,6246456,6312249,6378041,6378042,6443835,6509628,6509628,6575421,6641214,6707007,6707007,6772800,6838593,6838594,6904386,6970179,7035972,7035973,7101765,7167558,7167559,7233352,7299144,7364937,7364938,7430731,7496523,7496524,7562317,7628110,7628110,7693903,7759696,7825489,7825489,7891282,7957075,7957076,8022868,8088661,8154454,8154455,8220247,8286040,8286041,8351834,8417626,8483419,8483420,8549213,8615005,8615006,8680799,8746592,8812384,8812385,8878178,8943971,8943971,9009764,9075557,9075558,9141350,9207143,9272936,9272937,9338729,9404522,9404523,9470316,9536108,9601901,9601902,9667695,9733487,9733488,9799281,9865074,9930866,9930867,9996660,10062453,10062453,10128246,10194039,10259832,10259832,10325625,10391418,10391419,10457211,10523004,10523005,10588798,10654590,10720383,10720384,10786177,10851969,10851970,10917763,10983556,11049348,11049349,11115142,11180935,11180935,11246728,11312521,11378314,11378314,11444107,11509900,11509901,11575693,11641486,11707279,11707280,11773072,11838865,11838866,11904659,11970451,11970452,12036245,12102038,12167830,12167831,12233624,12299417,12299417,12365210,12431003,12496796,12496796,12562589,12628382,12628383,12694175,12759968,12825761,12825762,12891554,12957347,12957348,13023141,13088933,13154726,13154727,13220520,13286312,13286313,13352106,13417899,13417899,13483692,13549485,13615278,13615278,13681071,13746864,13746865,13812657,13878450,13944243,13944244,14010036,14075829,14075830,14141623,14207415,14273208,14273209,14339002,14404794,14404795,14470588,14536381,14602173,14602174,14667967,14733760,14733760,14799553,14865346,14931139]\n			}\n		},\n		{\n			"type" : "blur",\n			"target" : 0,\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 5 \n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "overlay"\n			}\n		},\n		{\n			"type" : "noise",\n			"param" : \n			{\n				"amount" : 15\n			}\n		}\n	]\n}'}),define("text!effects/too_old/shaan.pxs",[],function(){return'{\n	"name" : "Shaan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "desaturate",\n			"param" :\n			{\n\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,2,3,4,5,6,6,7,8,9,10,11,12,13,14,15,16,17,17,18,19,20,21,22,23,24,25,26,27,28,29,29,30,31,32,33,34,35,36,37,38,39,40,41,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,209,210,211,212,213,214,215,216,217,218,219,220,221,223,224,225,226,227,228,229,230,231,232,233,234,236,237,238,239,240,241,242,243,244,245,246,247,248,250,251,252,253,254,255],\n				"green" : [0,1,1,2,3,3,4,5,6,6,7,8,8,9,10,10,11,12,12,13,14,15,15,16,17,17,18,19,19,20,21,22,22,23,24,24,25,26,27,27,28,29,29,30,31,32,32,33,34,34,35,36,37,37,38,39,40,40,41,42,43,43,44,45,46,46,47,48,49,50,50,51,52,53,53,54,55,56,57,57,58,59,60,61,61,62,63,64,65,66,66,67,68,69,70,71,72,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,122,123,124,125,126,127,128,129,130,131,133,134,135,136,137,138,139,141,142,143,144,145,146,148,149,150,151,152,153,155,156,157,158,160,161,162,163,164,166,167,168,169,171,172,173,174,176,177,178,179,181,182,183,184,186,187,188,189,191,192,193,195,196,197,198,200,201,202,204,205,206,207,209,210,211,213,214,215,217,218,219,221,222,223,225,226,227,228,230,231,232,234,235,236,238,239,240,242,243,244,246,247,248,250,251,252,254,255],\n				"blue" : [0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,9,9,10,10,11,11,12,12,13,13,14,15,15,16,16,17,17,18,18,19,20,20,21,21,22,22,23,24,24,25,25,26,26,27,28,28,29,29,30,31,31,32,33,33,34,34,35,36,36,37,38,38,39,40,40,41,41,42,43,43,44,45,46,46,47,48,48,49,50,50,51,52,53,53,54,55,56,56,57,58,59,59,60,61,62,63,63,64,65,66,67,67,68,69,70,71,72,73,73,74,75,76,77,78,79,80,81,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,106,107,108,109,110,111,112,113,115,116,117,118,119,120,122,123,124,125,126,128,129,130,131,133,134,135,136,138,139,140,142,143,144,146,147,148,150,151,152,154,155,156,158,159,160,162,163,165,166,167,169,170,172,173,174,176,177,179,180,182,183,184,186,187,189,190,192,193,195,196,198,199,201,202,203,205,206,208,209,211,212,214,215,217,218,220,221,223,225,226,228,229,231,232,234,235,237,238,240,241,243,244,246,247,249,250,252,253,255]\n			}\n		}\n	]\n}'}),define("text!effects/vintage/borg.pxs",[],function(){return'{\n	"name" : "Borg",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,1,2,2,3,3,4,5,5,6,6,7,8,8,9,9,10,11,11,12,12,13,14,14,15,15,16,17,17,18,19,19,20,21,21,22,23,23,24,25,25,26,27,27,28,29,29,30,31,32,32,33,34,35,35,36,37,38,38,39,40,41,42,42,43,44,45,46,47,48,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,79,80,81,82,83,84,86,87,88,89,90,91,93,94,95,96,98,99,100,101,103,104,105,106,108,109,110,111,113,114,115,117,118,119,121,122,123,125,126,127,129,130,132,133,134,136,137,139,140,141,143,144,146,147,149,150,151,153,154,156,157,159,160,162,163,165,166,167,169,170,172,173,175,176,178,179,181,182,184,186,187,189,190,192,193,195,196,198,199,201,202,204,205,207,209,210,212,213,215,216,218,219,221,223,224,226,227,229,230,232,234,235,237,238,240,241,243,245,246,248,249,251,252,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,72,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,90,92,93,94,95,96,97,98,100,101,102,103,104,105,106,108,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,137,139,140,141,142,143,144,145,147,148,149,150,151,152,153,154,156,157,158,159,160,161,162,163,164,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,199,200,201,202,203,204,205,206,207,208,209,210,210,211,212,213,214,215,216,217,217,218,219,220,221,222,222,223,224,225,226,226,227,228,229,230,230,231,232,233,233,234,235,236,237,237,238,239,240,240,241,242,243,243,244,245,245,246,247,248,248,249,250,251,251,252,253,254,254,255],\n				"blue" : [19,19,20,21,21,22,23,24,25,26,26,27,28,29,30,31,31,32,33,34,35,36,36,37,38,39,40,40,41,42,43,44,45,45,46,47,48,49,50,50,51,52,53,54,55,55,56,57,58,59,60,60,61,62,63,64,64,65,66,67,68,69,69,70,71,72,73,74,74,75,76,77,78,79,79,80,81,82,83,83,84,85,86,87,88,88,89,90,91,92,93,93,94,95,96,97,98,98,99,100,101,102,103,103,104,105,106,107,107,108,109,110,111,112,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,126,127,128,129,130,131,131,132,133,134,135,136,136,137,138,139,140,141,141,142,143,144,145,145,146,147,148,149,150,150,151,152,153,154,155,155,156,157,158,159,160,160,161,162,163,164,165,165,166,167,168,169,169,170,171,172,173,174,174,175,176,177,178,179,179,180,181,182,183,184,184,185,186,187,188,188,189,190,191,192,193,193,194,195,196,197,198,198,199,200,201,202,203,203,204,205,206,207,208,208,209,210,211,212,212,213,214,215,216,217,217,218,219,220,221,222,222,223,224,225,226,227,227,228,229]\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xccff00"\n			}\n		},\n		{\n			"type" : "merge",\n			"param" : \n			{\n				"opacity" : 10\n			}\n		}\n	]\n}'}),define("text!effects/vintage/carl.pxs",[],function(){return'{\n	"name" : "Carl",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 6,\n				"color" : "0x000000"\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 15\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,1,2,2,3,3,4,5,5,6,6,7,8,8,9,9,10,11,11,12,12,13,14,14,15,15,16,17,17,18,19,19,20,21,21,22,23,23,24,25,25,26,27,27,28,29,29,30,31,32,32,33,34,35,35,36,37,38,38,39,40,41,42,42,43,44,45,46,47,48,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,79,80,81,82,83,84,86,87,88,89,90,91,93,94,95,96,98,99,100,101,103,104,105,106,108,109,110,111,113,114,115,117,118,119,121,122,123,125,126,127,129,130,132,133,134,136,137,139,140,141,143,144,146,147,149,150,151,153,154,156,157,159,160,162,163,165,166,167,169,170,172,173,175,176,178,179,181,182,184,186,187,189,190,192,193,195,196,198,199,201,202,204,205,207,209,210,212,213,215,216,218,219,221,223,224,226,227,229,230,232,234,235,237,238,240,241,243,245,246,248,249,251,252,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,72,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,90,92,93,94,95,96,97,98,100,101,102,103,104,105,106,108,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,137,139,140,141,142,143,144,145,147,148,149,150,151,152,153,154,156,157,158,159,160,161,162,163,164,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,199,200,201,202,203,204,205,206,207,208,209,210,210,211,212,213,214,215,216,217,217,218,219,220,221,222,222,223,224,225,226,226,227,228,229,230,230,231,232,233,233,234,235,236,237,237,238,239,240,240,241,242,243,243,244,245,245,246,247,248,248,249,250,251,251,252,253,254,254,255],\n				"blue" : [19,19,20,21,21,22,23,24,25,26,26,27,28,29,30,31,31,32,33,34,35,36,36,37,38,39,40,40,41,42,43,44,45,45,46,47,48,49,50,50,51,52,53,54,55,55,56,57,58,59,60,60,61,62,63,64,64,65,66,67,68,69,69,70,71,72,73,74,74,75,76,77,78,79,79,80,81,82,83,83,84,85,86,87,88,88,89,90,91,92,93,93,94,95,96,97,98,98,99,100,101,102,103,103,104,105,106,107,107,108,109,110,111,112,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,126,127,128,129,130,131,131,132,133,134,135,136,136,137,138,139,140,141,141,142,143,144,145,145,146,147,148,149,150,150,151,152,153,154,155,155,156,157,158,159,160,160,161,162,163,164,165,165,166,167,168,169,169,170,171,172,173,174,174,175,176,177,178,179,179,180,181,182,183,184,184,185,186,187,188,188,189,190,191,192,193,193,194,195,196,197,198,198,199,200,201,202,203,203,204,205,206,207,208,208,209,210,211,212,212,213,214,215,216,217,217,218,219,220,221,222,222,223,224,225,226,227,227,228,229]\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : -30\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xff005a"\n			}\n		},\n		{\n			"type" : "merge",\n			"param" : \n			{\n				"opacity" : 10\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xe7d3a7"\n			}\n		},\n		{\n			"type" : "merge",\n			"param" : \n			{\n				"opacity"  : 50,\n				"blend" : "multiply"\n			}\n		}\n	]\n}'}),define("text!effects/vintage/doris.pxs",[],function(){return'{\n	"name" : "Doris",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,1,2,2,3,3,4,4,5,5,6,7,7,8,8,9,9,10,11,11,12,12,13,14,14,15,15,16,17,17,18,18,19,20,20,21,22,22,23,24,25,25,26,27,27,28,29,30,30,31,32,33,34,34,35,36,37,38,39,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,61,62,63,64,65,67,68,69,70,72,73,74,75,77,78,79,80,82,83,84,86,87,88,90,91,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,114,115,117,118,119,121,122,124,125,127,128,130,131,133,134,135,137,138,140,141,143,144,145,147,148,150,151,153,154,155,157,158,160,161,162,164,165,166,168,169,171,172,173,175,176,177,178,180,181,182,184,185,186,187,188,190,191,192,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,219,220,221,222,223,224,225,225,226,227,228,228,229,230,231,232,232,233,234,234,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,252,253,254,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,108,109,110,111,112,113,115,116,117,118,119,121,122,123,124,125,126,128,129,130,131,132,133,135,136,137,138,139,140,142,143,144,145,146,147,149,150,151,152,153,154,155,156,158,159,160,161,162,163,164,165,167,168,169,170,171,172,173,174,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,201,202,203,204,205,206,207,208,209,210,211,211,212,213,214,215,216,217,217,218,219,220,221,221,222,223,224,225,225,226,227,228,228,229,230,231,232,232,233,234,234,235,236,237,237,238,239,240,240,241,242,242,243,244,245,245,246,247,247,248,249,249,250,251,252,252,253,254,254,255],\n				"blue" : [56,57,57,58,58,59,60,60,61,62,62,63,63,64,65,65,66,67,67,68,68,69,70,70,71,71,72,73,73,74,75,75,76,76,77,78,78,79,79,80,81,81,82,83,83,84,84,85,86,86,87,88,88,89,89,90,91,91,92,92,93,94,94,95,96,96,97,97,98,99,99,100,101,101,102,102,103,104,104,105,105,106,107,107,108,109,109,110,110,111,112,112,113,113,114,115,115,116,117,117,118,118,119,120,120,121,122,122,123,123,124,125,125,126,126,127,128,128,129,130,130,131,131,132,133,133,134,134,135,136,136,137,138,138,139,139,140,141,141,142,143,143,144,144,145,146,146,147,147,148,149,149,150,151,151,152,152,153,154,154,155,156,156,157,157,158,159,159,160,160,161,162,162,163,164,164,165,165,166,167,167,168,168,169,170,170,171,172,172,173,173,174,175,175,176,177,177,178,178,179,180,180,181,181,182,183,183,184,185,185,186,186,187,188,188,189,190,190,191,191,192,193,193,194,194,195,196,196,197,198,198,199,199,200,201,201,202,202,203,204,204,205,206,206,207,207,208,209,209,210,211,211,212,212,213,213]\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : -20\n			}\n		},\n		{\n			"type" : "gradient",\n			"param" :\n			{\n				"type" : "radial",\n				"colors" : ["0xFFFFFF","0x000000"],\n				"alphas" : [1,1],\n				"ratios" : [0,255]\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 25\n			}\n		}\n	]\n}'}),define("text!effects/vintage/doug.pxs",[],function(){return'{\n	"name" : "Doug",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [63,64,65,65,66,67,68,68,69,70,71,71,72,73,74,74,75,76,77,77,78,79,80,80,81,82,83,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,101,101,102,103,104,104,105,106,107,107,108,109,110,110,111,112,113,113,114,115,116,116,117,118,119,119,120,121,122,122,123,124,125,125,126,127,128,129,129,130,131,132,132,133,134,135,135,136,137,138,138,139,140,141,141,142,143,144,144,145,146,147,147,148,149,150,150,151,152,153,153,154,155,156,156,157,158,159,159,160,161,162,162,163,164,165,165,166,167,168,168,169,170,171,171,172,173,174,174,175,176,177,177,178,179,180,180,181,182,183,183,184,185,186,186,187,188,189,189,190,191,192,193,193,194,195,196,196,197,198,199,199,200,201,202,202,203,204,205,205,206,207,208,208,209,210,211,211,212,213,214,214,215,216,217,217,218,219,220,220,221,222,223,223,224,225,226,226,227,228,229,229,230,231,232,232,233,234,235,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,247,248,249,250,250,251,252,253,253,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],\n				"blue" : [63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99,100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,156,157,157,158,158,159,159,160,160,161,161,162,162,163,163,164,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179,180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,189,190,190,191]\n			}\n		}\n	]\n}'}),define("text!effects/vintage/earl.pxs",[],function(){return'{\n	"name" : "Earl",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 10,\n				"color" : "0x000000"\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,53,54,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,73,74,75,76,78,79,80,81,82,83,84,85,86,87,88,89,90,92,93,94,95,96,97,98,99,100,101,102,103,104,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,133,134,135,136,137,138,139,140,141,142,143,144,145,147,148,149,150,151,152,153,154,155,156,157,158,159,161,162,163,164,165,166,167,168,169,170,171,172,173,175,176,177,178,179,180,181,182,183,184,185,186,187,189,190,191,192,193,194,195,196,197,198,199,200,201,203,204,205,206,207,208,209,210,211,212,213,214,215,217,218,219,220,221,222,223,224,225,226,227,228,229,231,232,233,234,235,236,237,238,239,240,241,242,243,245,246,247,248,249,250,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251],\n				"green" : [41,41,42,43,44,45,46,47,47,48,49,50,51,52,53,54,55,56,57,58,59,59,60,61,62,63,64,65,66,67,68,69,70,71,71,72,73,74,75,76,77,78,79,80,81,82,83,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,105,106,106,107,108,109,110,111,112,113,114,115,116,117,118,118,119,120,121,122,123,124,125,126,127,128,129,130,130,131,132,133,134,135,136,137,138,139,140,141,142,142,143,144,145,146,147,148,149,150,151,152,153,154,154,155,156,157,158,159,160,161,162,163,164,165,166,166,167,168,169,170,171,172,173,174,175,176,177,178,178,179,180,181,182,183,184,185,186,187,188,189,190,190,191,192,193,194,195,196,197,198,199,200,201,201,202,203,204,205,206,207,208,209,210,211,212,213,213,214,215,216,217,218,219,220,221,222,223,224,225,225,226,227,228,229,230,231,232,233,234,235,236,237,237,238,239,240,241,242,243,244,245,246,247,248,249,249,250,251,252,253,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],\n				"blue" : [132,132,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,157,157,158,158,159,159,160,160,161,161,162,162,163,163,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,189,189,190,190,191,191,192,192,193,193,194,194,195,195,196,196,197,198,198,199,199,200,200,201,201,202,202,203,203,204,204,205,206,206,207,207,208,208,209,209,210,210,211,211,212,212,213,214,214,215,215,216,216,217,217,218,218,219,219,220,220,221,222,222,223,223,224,224,225,225,226,226,227,227,228,228,229,230,230,231,231,232,232,233,233,234,234,235,235,236,236,237,238,238,239,239,240,240,241,241,242,242,243,243,244,244,245,246,246,247,247,248,248,249,249,250,250,251,251,252,252,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253]\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xf7daae"\n			}\n		},\n		{\n			"type" : "merge",\n			"param" : \n			{\n				"blend" : "multiply"\n			}\n		}\n	]\n}'}),define("text!effects/vintage/harper.pxs",[],function(){return'{\n	"name" : "Harper",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [11993284,11993283,11993538,11993793,12059584,12059584,12059839,12060094,12125885,12125885,12126140,12191931,12192186,12192186,12192441,12258232,12258487,12258742,12324278,12324533,12324788,12325043,12390579,12390834,12391089,12456880,12456880,12457135,12457390,12523181,12523436,12523436,12589227,12589482,12589737,12589737,12655528,12655783,12656038,12721574,12721829,12722084,12722339,12788130,12788130,12788385,12788640,12854431,12854431,12854686,12920477,12920732,12920732,12920987,12986778,12987033,12987288,13052824,13053079,13053334,13053589,13119125,13119380,13119635,13185426,13185426,13185681,13185936,13251727,13251982,13251982,13317773,13318028,13318283,13318283,13384074,13384329,13384584,13450120,13450375,13450630,13450885,13516676,13516676,13516931,13582722,13582977,13582977,13583232,13649023,13649278,13649278,13649533,13715324,13715579,13715834,13781370,13781625,13781880,13782135,13847671,13847926,13848181,13913972,13913972,13914227,13914482,13980273,13980528,13980528,14046319,14046574,14046829,14046829,14112620,14112875,14113130,14178666,14178921,14179176,14179431,14245222,14245222,14245477,14311268,14311523,14311523,14311778,14377569,14377824,14377824,14378079,14443870,14444125,14444125,14509916,14510171,14510426,14510681,14576217,14576472,14576727,14642518,14642518,14642773,14643028,14708819,14708819,14709074,14774865,14775120,14775375,14775375,14841166,14841421,14841676,14907212,14907467,14907722,14907977,14973513,14973768,14974023,15039814,15040069,15040069,15040324,15106115,15106370,15106370,15172161,15172416,15172671,15172671,15238462,15238717,15238972,15239227,15304763,15305018,15305273,15371064,15371064,15371319,15371574,15437365,15437365,15437620,15503411,15503666,15503921,15503921,15569712,15569967,15570222,15635758,15636013,15636268,15636523,15702059,15702314,15702569,15768360,15768615,15768615,15768870,15834661,15834916,15834916,15900707,15900962,15901217,15901217,15967008,15967263,15967518,15967773,16033309,16033564,16033819,16099610,16099610,16099865,16100120,16165911,16165911,16166166,16231957,16232212,16232467,16232467,16298258,16298513,16298768,16364304,16364559,16364814,16365069,16430605,16430860,16431115,16496906,16497161,16497161,16497416,16563207,16563462,16563462,16629253,16629508,16629763,16629763,16695554,16695809,16696064,16761856]\n			}\n		},\n		{\n			"type" : "saturation",\n			"target" : 0,\n			"param" :\n			{\n				"amount" : -60\n			}\n		},\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 8,\n				"color" : "0x000000"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "lighten",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/vintage/jyler.pxs",[],function(){return'{\n	"name" : "Jyler",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xca8d21"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "softlight",\n				"opacity" : 70\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0x07383c"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "screen",\n				"opacity" : 70\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0x575656"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "softlight",\n				"opacity" : 70\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : -20\n			}\n		}\n	]\n}'}),define("text!effects/vintage/kevin.pxs",[],function(){return'{\n	"name" : "Kevin",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,3,6,9,12,15,18,21,24,27,30,32,35,38,41,44,47,50,53,55,58,61,64,67,69,72,75,78,80,83,86,88,91,93,96,99,101,104,106,108,111,113,115,118,120,122,124,127,129,131,133,135,137,139,141,143,145,146,148,150,152,153,155,157,158,160,161,163,164,166,167,168,170,171,172,173,175,176,177,178,179,180,181,183,184,185,186,187,188,188,189,190,191,192,193,194,194,195,196,197,198,198,199,200,200,201,202,203,203,204,204,205,206,206,207,208,208,209,209,210,211,211,212,212,213,213,214,215,215,216,216,217,217,218,218,219,219,220,220,221,221,222,222,223,223,223,224,224,225,225,226,226,227,227,227,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,237,238,238,238,239,239,239,240,240,240,240,241,241,241,242,242,242,242,243,243,243,243,244,244,244,244,245,245,245,245,246,246,246,246,247,247,247,247,248,248,248,248,249,249,249,249,249,250,250,250,250,250,251,251,251,251,252,252,252,252,252,253,253,253,253,253,254,254,254,254,254,255,255,255],\n				"green" : [31,32,33,35,36,37,38,39,41,42,43,44,45,46,48,49,50,51,52,53,55,56,57,58,59,60,62,63,64,65,66,67,69,70,71,72,73,74,75,76,78,79,80,81,82,83,84,85,86,87,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,122,123,124,125,126,127,128,129,130,131,131,132,133,134,135,136,137,137,138,139,140,141,142,142,143,144,145,146,147,147,148,149,150,151,151,152,153,154,155,155,156,157,158,158,159,160,161,161,162,163,164,164,165,166,167,167,168,169,170,170,171,172,172,173,174,175,175,176,177,177,178,179,180,180,181,182,182,183,184,184,185,186,186,187,188,188,189,190,190,191,192,192,193,194,194,195,196,196,197,198,198,199,200,200,201,202,202,203,204,204,205,206,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,216,217,218,218,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219],\n				"blue" : [78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,81,81,81,81,81,82,82,82,82,83,83,83,83,84,84,84,85,85,85,86,86,86,87,87,88,88,88,89,89,90,90,91,91,92,92,93,94,94,95,95,96,97,97,98,99,99,100,101,101,102,103,104,104,105,106,107,108,109,109,110,111,112,113,114,115,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,163,164,165,166,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167]\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 15\n			}\n		}\n	]\n}'}),define("text!effects/vintage/lumina.pxs",[],function(){return'{\n	"name" : "Lumina",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [7876736,7876735,7942527,7942783,8008574,8008830,8074366,8074622,8140413,8140669,8206461,8206461,8272252,8272508,8338300,8338556,8404091,8404347,8470139,8470395,8536186,8536442,8601978,8602233,8668025,8668281,8734073,8734072,8799864,8800120,8865912,8866167,8931703,8931959,8997751,8998006,9063798,9064054,9129590,9129845,9195637,9195893,9261684,9261684,9327476,9327732,9393523,9393779,9459315,9459571,9525362,9525618,9591410,9591666,9657201,9657457,9723249,9723505,9789296,9789296,9855088,9855343,9921135,9921391,9986927,9987182,10052974,10053230,10119022,10119277,10184813,10185069,10250861,10251116,10316908,10316908,10382700,10382955,10448747,10449003,10514538,10514794,10580586,10580842,10646633,10712425,10712425,10778217,10778472,10844264,10844520,10910056,10910311,10976103,10976359,11042151,11042150,11107942,11108198,11173989,11174245,11239781,11240037,11305828,11306084,11371876,11372132,11437667,11437923,11503715,11503971,11569762,11569762,11635554,11635810,11701601,11701857,11767393,11767648,11833440,11833696,11899488,11899743,11965279,11965535,12031327,12031582,12097374,12097374,12163166,12163421,12229213,12229469,12295005,12295260,12361052,12361308,12427100,12427355,12492891,12493147,12558938,12559194,12624986,12624986,12690777,12691033,12756825,12757081,12822616,12822872,12888664,12888920,12954711,12954967,13020503,13020759,13086550,13086806,13152598,13152597,13218389,13218645,13284437,13284692,13350228,13350484,13416276,13416531,13482323,13548115,13548115,13613906,13614162,13679954,13680210,13745745,13746001,13811793,13812048,13877840,13877840,13943632,13943887,14009679,14009935,14075471,14075726,14141518,14141774,14207566,14207821,14273357,14273613,14339405,14339660,14405452,14405452,14471243,14471499,14537291,14537547,14603082,14603338,14669130,14669386,14735177,14735433,14800969,14801225,14867016,14867272,14933064,14933064,14998855,14999111,15064903,15065158,15130694,15130950,15196742,15196997,15262789,15263045,15328581,15328836,15394628,15394884,15460676,15460675,15526467,15526723,15592515,15592770,15658306,15658562,15724353,15724609,15790401,15790657,15856192,15856448,15922240,15922496,15988287,15988287,16054079,16054335,16120126,16120382,16185918,16186174,16251965,16252221,16318013,16383805]\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"opacity" : 35\n			}\n		},\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 20,\n				"color" : "0x000000"\n			}\n		}\n	]\n}'}),define("text!effects/vintage/nash.pxs",[],function(){return'{\n	"name" : "Nash",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,53,54,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,73,74,75,76,78,79,80,81,82,83,84,85,86,87,88,89,90,92,93,94,95,96,97,98,99,100,101,102,103,104,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,133,134,135,136,137,138,139,140,141,142,143,144,145,147,148,149,150,151,152,153,154,155,156,157,158,159,161,162,163,164,165,166,167,168,169,170,171,172,173,175,176,177,178,179,180,181,182,183,184,185,186,187,189,190,191,192,193,194,195,196,197,198,199,200,201,203,204,205,206,207,208,209,210,211,212,213,214,215,217,218,219,220,221,222,223,224,225,226,227,228,229,231,232,233,234,235,236,237,238,239,240,241,242,243,245,246,247,248,249,250,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251,251],\n				"green" : [41,41,42,43,44,45,46,47,47,48,49,50,51,52,53,54,55,56,57,58,59,59,60,61,62,63,64,65,66,67,68,69,70,71,71,72,73,74,75,76,77,78,79,80,81,82,83,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,105,106,106,107,108,109,110,111,112,113,114,115,116,117,118,118,119,120,121,122,123,124,125,126,127,128,129,130,130,131,132,133,134,135,136,137,138,139,140,141,142,142,143,144,145,146,147,148,149,150,151,152,153,154,154,155,156,157,158,159,160,161,162,163,164,165,166,166,167,168,169,170,171,172,173,174,175,176,177,178,178,179,180,181,182,183,184,185,186,187,188,189,190,190,191,192,193,194,195,196,197,198,199,200,201,201,202,203,204,205,206,207,208,209,210,211,212,213,213,214,215,216,217,218,219,220,221,222,223,224,225,225,226,227,228,229,230,231,232,233,234,235,236,237,237,238,239,240,241,242,243,244,245,246,247,248,249,249,250,251,252,253,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],\n				"blue" : [132,132,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,157,157,158,158,159,159,160,160,161,161,162,162,163,163,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,189,189,190,190,191,191,192,192,193,193,194,194,195,195,196,196,197,198,198,199,199,200,200,201,201,202,202,203,203,204,204,205,206,206,207,207,208,208,209,209,210,210,211,211,212,212,213,214,214,215,215,216,216,217,217,218,218,219,219,220,220,221,222,222,223,223,224,224,225,225,226,226,227,227,228,228,229,230,230,231,231,232,232,233,233,234,234,235,235,236,236,237,238,238,239,239,240,240,241,241,242,242,243,243,244,244,245,246,246,247,247,248,248,249,249,250,250,251,251,252,252,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253,253]\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" : \n			{\n				"amount" : 8\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 30\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xf7daae"\n			}\n		},\n		{\n			"type" : "merge",\n			"param" : \n			{\n				"blend" : "multiply"\n			}\n		}\n	]\n}'}),define("text!effects/vintage/polak.pxs",[],function(){return'{\n	"name" : "Polak",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 10,\n				"color" : "0x000000"\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63,65,67,69,71,73,75,77,79,81,83,85,87,89,91,93,95,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,159,161,163,165,167,169,171,173,175,177,179,181,183,185,187,189,191,193,195,197,199,201,203,205,207,209,211,213,215,217,219,221,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254],\n				"green" : [0,1,2,3,4,6,7,8,9,10,11,12,13,14,16,17,18,19,20,21,22,23,24,26,27,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,45,47,48,49,50,51,52,53,54,55,56,58,59,60,61,62,63,64,65,66,67,68,70,71,72,73,74,75,76,77,78,79,80,81,83,84,85,86,87,88,89,90,91,92,93,94,95,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,184,185,186,187,188,189,190,191,192,193,194,195,196,197,197,198,199,200,201,202,203,204,205,206,206,207,208,209,210,211,212,213,214,214,215,216,217,218,219,220,221,221,222,223,224,225,226,227,228,228,229,230,231,232,233,234,234,235,236,237,238,239,240,240,241,242,243,244,245,246,246,247,248,249,250,251,252,252,253,254,255],\n				"blue" : [0,1,1,2,3,3,4,4,5,6,6,7,8,8,9,9,10,11,11,12,13,13,14,15,15,16,16,17,18,18,19,20,20,21,22,22,23,24,24,25,26,26,27,28,28,29,30,30,31,32,32,33,34,34,35,36,36,37,38,38,39,40,40,41,42,43,43,44,45,45,46,47,48,48,49,50,50,51,52,53,53,54,55,56,56,57,58,59,59,60,61,62,63,63,64,65,66,67,67,68,69,70,71,71,72,73,74,75,76,76,77,78,79,80,81,82,82,83,84,85,86,87,88,89,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,108,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,130,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,151,152,153,154,156,157,158,159,161,162,163,164,166,167,168,170,171,172,174,175,176,178,179,180,182,183,185,186,187,189,190,192,193,195,196,197,199,200,202,203,205,206,208,209,211,212,214,215,217,218,220,221,223,224,226,227,229,230,232,233,235,236,238,240,241,243,244,246,247,249,250,252,253,255]\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 3\n			}\n		},\n		{\n			"type" : "gradient",\n			"param" :\n			{\n				"type" : "radial",\n				"rotation" : 40,\n				"colors" : ["0x000000","0x000000","0x00ff00"],\n				"alphas" : [0,0,1],\n				"ratios" : [0,100,255]\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"mask" : "2"\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : -50\n			}\n		}\n	]\n}'}),define("text!effects/vintage/rusty.pxs",[],function(){return'{\n	"name" : "Rusty",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [7876736,7876735,7942527,7942783,8008574,8008830,8074366,8074622,8140413,8140669,8206461,8206461,8272252,8272508,8338300,8338556,8404091,8404347,8470139,8470395,8536186,8536442,8601978,8602233,8668025,8668281,8734073,8734072,8799864,8800120,8865912,8866167,8931703,8931959,8997751,8998006,9063798,9064054,9129590,9129845,9195637,9195893,9261684,9261684,9327476,9327732,9393523,9393779,9459315,9459571,9525362,9525618,9591410,9591666,9657201,9657457,9723249,9723505,9789296,9789296,9855088,9855343,9921135,9921391,9986927,9987182,10052974,10053230,10119022,10119277,10184813,10185069,10250861,10251116,10316908,10316908,10382700,10382955,10448747,10449003,10514538,10514794,10580586,10580842,10646633,10712425,10712425,10778217,10778472,10844264,10844520,10910056,10910311,10976103,10976359,11042151,11042150,11107942,11108198,11173989,11174245,11239781,11240037,11305828,11306084,11371876,11372132,11437667,11437923,11503715,11503971,11569762,11569762,11635554,11635810,11701601,11701857,11767393,11767648,11833440,11833696,11899488,11899743,11965279,11965535,12031327,12031582,12097374,12097374,12163166,12163421,12229213,12229469,12295005,12295260,12361052,12361308,12427100,12427355,12492891,12493147,12558938,12559194,12624986,12624986,12690777,12691033,12756825,12757081,12822616,12822872,12888664,12888920,12954711,12954967,13020503,13020759,13086550,13086806,13152598,13152597,13218389,13218645,13284437,13284692,13350228,13350484,13416276,13416531,13482323,13548115,13548115,13613906,13614162,13679954,13680210,13745745,13746001,13811793,13812048,13877840,13877840,13943632,13943887,14009679,14009935,14075471,14075726,14141518,14141774,14207566,14207821,14273357,14273613,14339405,14339660,14405452,14405452,14471243,14471499,14537291,14537547,14603082,14603338,14669130,14669386,14735177,14735433,14800969,14801225,14867016,14867272,14933064,14933064,14998855,14999111,15064903,15065158,15130694,15130950,15196742,15196997,15262789,15263045,15328581,15328836,15394628,15394884,15460676,15460675,15526467,15526723,15592515,15592770,15658306,15658562,15724353,15724609,15790401,15790657,15856192,15856448,15922240,15922496,15988287,15988287,16054079,16054335,16120126,16120382,16185918,16186174,16251965,16252221,16318013,16383805]\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target": 0,\n			"param" : { }\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [400944,400944,466736,532529,598065,663858,729650,795443,860979,926772,992564,1058356,1123893,1189685,1255478,1321270,1386807,1452599,1518392,1584184,1649721,1715513,1781305,1847098,1912634,1978427,2044219,2110012,2175548,2241341,2307133,2372925,2438462,2504254,2570047,2635839,2701376,2767168,2832961,2898753,2964290,3030082,3095874,3096131,3161667,3227460,3293252,3359045,3424581,3490374,3556166,3621959,3687495,3753287,3819080,3884616,3950409,4016201,4081994,4147530,4213323,4279115,4344907,4410444,4476236,4542029,4607821,4673358,4739150,4804943,4870735,4936272,5002064,5067856,5133649,5199185,5264978,5330770,5396563,5462099,5527892,5593684,5659476,5725013,5790805,5856598,5856854,5922391,5988183,6053976,6119768,6185305,6251097,6316889,6382682,6448218,6514011,6579803,6645596,6711132,6776925,6842717,6908510,6974046,7039838,7105631,7171167,7236960,7302752,7368545,7434081,7499874,7565666,7631458,7696995,7762787,7828580,7894372,7959909,8025701,8091494,8157286,8222823,8288615,8354407,8420200,8485736,8551529,8551785,8617578,8683114,8748907,8814699,8880491,8946028,9011820,9077613,9143405,9208942,9274734,9340527,9406319,9471856,9537648,9603440,9669233,9734769,9800562,9866354,9932147,9997683,10063476,10129268,10195061,10260597,10326389,10392182,10457718,10523511,10589303,10655096,10720632,10786425,10852217,10918009,10983546,11049338,11115131,11180923,11246460,11312252,11312509,11378301,11443838,11509630,11575422,11641215,11706751,11772544,11838336,11904129,11969665,12035458,12101250,12167042,12232579,12298371,12364164,12429956,12495493,12561285,12627078,12692870,12758407,12824199,12889991,12955784,13021320,13087113,13152905,13218698,13284234,13350027,13415819,13481612,13547148,13612940,13678733,13744269,13810062,13875854,13941647,14007183,14007440,14073232,14139024,14204561,14270353,14336146,14401938,14467475,14533267,14599060,14664852,14730389,14796181,14861973,14927766,14993302,15059095,15124887,15190680,15256216,15322009,15387801,15453593,15519130,15584922,15650715,15716507,15782044,15847836,15913629,15979421,16044958,16110750,16176542,16242335,16307871,16373664,16439456,16505249,16570785,16636578,16702370,16768163]\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"opacity" : 25\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"opacity" : 21\n			}\n		},\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 20,\n				"color" : "0x000000"\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" : \n			{\n				"amount" : 10\n			}\n		}\n	]\n}'}),define("text!effects/vintage/satya.pxs",[],function(){return'{\n	"name" : "Satya",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,0,1,1,2,2,3,3,3,4,4,5,5,6,6,7,7,8,8,9,9,9,10,10,11,11,12,13,13,14,14,15,15,16,16,17,18,18,19,20,20,21,21,22,23,24,24,25,26,26,27,28,29,30,30,31,32,33,34,35,36,37,38,38,39,40,41,42,44,45,46,47,48,49,50,51,53,54,55,56,58,59,60,62,63,64,66,67,69,70,72,73,75,76,78,79,81,83,84,86,88,89,91,93,94,96,98,100,101,103,105,107,109,110,112,114,116,118,119,121,123,125,127,128,130,132,134,136,137,139,141,143,145,146,148,150,152,153,155,157,159,160,162,164,165,167,169,170,172,173,175,177,178,180,181,183,184,186,187,188,190,191,192,194,195,196,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,221,222,223,224,225,225,226,227,228,228,229,230,230,231,232,232,233,234,234,235,235,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,244,244,245,245,245,246,246,247,247,247,248,248,249,249,249,250,250,250,251,251,252,252,252,253,253,253,254,254,254,255,255],\n				"green" : [0,0,1,1,2,2,3,3,3,4,4,5,5,6,6,7,7,8,8,9,9,9,10,10,11,11,12,13,13,14,14,15,15,16,16,17,18,18,19,20,20,21,21,22,23,24,24,25,26,26,27,28,29,30,30,31,32,33,34,35,36,37,38,38,39,40,41,42,44,45,46,47,48,49,50,51,53,54,55,56,58,59,60,62,63,64,66,67,69,70,72,73,75,76,78,79,81,83,84,86,88,89,91,93,94,96,98,100,101,103,105,107,109,110,112,114,116,118,119,121,123,125,127,128,130,132,134,136,137,139,141,143,145,146,148,150,152,153,155,157,159,160,162,164,165,167,169,170,172,173,175,177,178,180,181,183,184,186,187,188,190,191,192,194,195,196,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,221,222,223,224,225,225,226,227,228,228,229,230,230,231,232,232,233,234,234,235,235,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,244,244,245,245,245,246,246,247,247,247,248,248,249,249,249,250,250,250,251,251,252,252,252,253,253,253,254,254,254,255,255],\n				"blue" : [0,0,1,1,2,2,3,3,3,4,4,5,5,6,6,7,7,8,8,9,9,9,10,10,11,11,12,13,13,14,14,15,15,16,16,17,18,18,19,20,20,21,21,22,23,24,24,25,26,26,27,28,29,30,30,31,32,33,34,35,36,37,38,38,39,40,41,42,44,45,46,47,48,49,50,51,53,54,55,56,58,59,60,62,63,64,66,67,69,70,72,73,75,76,78,79,81,83,84,86,88,89,91,93,94,96,98,100,101,103,105,107,109,110,112,114,116,118,119,121,123,125,127,128,130,132,134,136,137,139,141,143,145,146,148,150,152,153,155,157,159,160,162,164,165,167,169,170,172,173,175,177,178,180,181,183,184,186,187,188,190,191,192,194,195,196,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,221,222,223,224,225,225,226,227,228,228,229,230,230,231,232,232,233,234,234,235,235,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,244,244,245,245,245,246,246,247,247,247,248,248,249,249,249,250,250,250,251,251,252,252,252,253,253,253,254,254,254,255,255]\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,1,2,3,4,4,5,6,7,7,8,9,10,10,11,12,13,13,14,15,16,17,17,18,19,20,20,21,22,23,24,24,25,26,27,28,29,29,30,31,32,33,34,34,35,36,37,38,39,40,41,42,43,44,45,45,46,47,48,49,50,51,52,53,54,55,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,75,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,99,100,101,103,104,105,107,108,109,111,112,113,115,116,117,119,120,122,123,124,126,127,128,130,131,132,134,135,136,138,139,140,142,143,145,146,147,149,150,151,152,154,155,156,158,159,160,162,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,182,183,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,212,213,214,215,216,217,217,218,219,220,221,222,222,223,224,225,225,226,227,228,228,229,230,231,231,232,233,234,234,235,236,236,237,238,238,239,240,241,241,242,243,243,244,245,245,246,247,247,248,248,249,250,250,251,252,252,253,254,254,255],\n				"green" : [0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,11,11,12,12,13,13,14,15,15,16,16,17,18,18,19,19,20,21,21,22,23,23,24,25,26,26,27,28,28,29,30,31,32,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,59,60,61,62,63,65,66,67,68,70,71,72,74,75,76,78,79,80,82,83,84,86,87,89,90,91,93,94,96,97,99,100,102,103,104,106,107,109,110,112,113,115,116,118,119,121,122,124,125,127,128,130,131,133,134,136,137,139,140,142,143,145,146,148,149,151,152,154,155,157,158,160,161,163,164,165,167,168,170,171,172,174,175,176,178,179,180,182,183,184,186,187,188,189,191,192,193,194,195,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,220,221,222,223,224,225,225,226,227,228,228,229,230,231,231,232,233,234,234,235,236,236,237,238,238,239,240,240,241,241,242,243,243,244,245,245,246,246,247,247,248,249,249,250,250,251,252,252,253,253,254,254,255],\n				"blue" : [0,2,3,5,7,8,10,11,13,15,16,18,20,21,23,24,26,27,29,31,32,34,35,37,38,40,41,43,44,46,47,49,50,51,53,54,56,57,58,60,61,62,64,65,66,67,68,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,87,88,89,90,91,91,92,93,93,94,95,95,96,97,97,98,99,99,100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,108,109,109,110,110,110,111,111,112,112,112,113,113,113,114,114,114,115,115,115,116,116,116,117,117,118,118,118,119,119,119,120,120,120,121,121,122,122,122,123,123,124,124,124,125,125,126,126,127,127,128,128,128,129,129,130,131,131,132,132,133,133,134,135,135,136,136,137,138,139,139,140,141,141,142,143,144,145,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,164,165,166,167,169,170,171,172,174,175,176,178,179,181,182,184,185,186,188,189,191,192,194,196,197,199,200,202,204,205,207,208,210,212,213,215,217,218,220,222,224,225,227,229,230,232,234,236,237,239,241,243,244,246,248,250,251,253,255]\n			}\n		},\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 25,\n				"color" : "0x000000"\n			}\n		}\n	]\n}'}),define("text!effects/vintage/stan.pxs",[],function(){return'{\n	"name" : "Stan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [119,120,121,121,122,123,124,124,125,126,127,128,128,129,130,131,131,132,133,134,134,135,136,136,137,138,139,139,140,141,141,142,143,143,144,144,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,155,156,156,157,157,157,158,158,158,159,159,159,160,160,160,161,161,161,162,162,162,163,163,163,164,164,164,164,165,165,165,166,166,166,166,167,167,167,168,168,168,168,169,169,169,170,170,170,170,171,171,171,172,172,172,172,173,173,173,174,174,174,175,175,175,176,176,176,177,177,177,178,178,179,179,179,180,180,181,181,182,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,190,190,191,191,192,193,193,194,194,195,196,196,197,198,198,199,200,200,201,202,202,203,204,205,205,206,207,208,208,209,210,211,212,212,213,214,215,216,216,217,218,219,220,221,221,222,223,224,225,225,226,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,238,239,240,240,241,241,242,242,243,243,244,244,245,245,246,246,247,247,248,248,249,249,250,250,251,251,252,252,252,253,253,254,254,255,255],\n				"green" : [63,64,65,66,67,68,69,70,71,72,72,73,74,75,76,77,78,79,80,81,82,82,83,84,85,86,87,87,88,89,90,91,91,92,93,94,94,95,96,96,97,98,98,99,99,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,109,110,110,111,111,112,112,112,113,113,113,114,114,115,115,115,116,116,116,117,117,118,118,118,119,119,119,120,120,121,121,121,122,122,123,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,134,134,135,135,136,137,138,138,139,140,140,141,142,143,143,144,145,146,147,148,149,150,151,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,170,171,172,173,174,175,175,176,177,177,178,179,179,180,181,181,182,182,183,184,184,185,186,187,187,188,189,190,191,192,193,194,195,197,198,199,201,202,204,205,206,208,210,211,213,214,216,217,219,220,221,223,224,225,227,228,229,230,231,232,233,234,234,235,236,236,237,237,238,238,238,239,239,239,239,239,239,239,240,240,240,239,239,239,239,239,239,239,239,239,238,238,238],\n				"blue" : [86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,95,96,96,97,97,98,98,99,99,99,100,100,101,101,101,102,102,103,103,103,104,104,104,105,105,105,106,106,106,107,107,108,108,108,109,109,109,110,110,110,110,111,111,111,112,112,112,113,113,113,114,114,114,115,115,115,116,116,116,116,117,117,117,118,118,118,119,119,119,120,120,120,121,121,121,122,122,123,123,123,124,124,124,125,125,125,126,126,127,127,127,128,128,129,129,129,130,130,131,131,132,132,133,133,134,134,135,135,135,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,147,148,148,149,149,149,149,150,150,150,150,151,151,151,151,151,151,151,151,151,151,151,151,150,150,150,150,149,149,149,149,148,148,148,148,147,147,147,147,147,146,146,146,146,146,146,146,146,146,146,147,147,147,148,148,149,149,150,150,151,152,153,154,155,156,157,159,160,161,163,164,166,167,168,170,171,172,174,175,176,177,178,179,180,181,181,182,182,183,183,184,184,184,184,185,185,185,185,185,185,185,185,185,185]\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 30\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity" : 80\n			}\n		}\n	]\n}'}),define("text!effects/vintage/sun.pxs",[],function(){return'{\n	"name" : "Sun",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 2\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "vignette",\n			"param" : \n			{\n				"size" : 5,\n				"color" : "0xffffff"\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xfbf2a3"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "multiply",\n				"opacity" : 85\n			}\n		},\n		{\n			"type" : "fill",\n			"param" :\n			{\n				"x" : 0,\n				"y" : 0,\n				"width" : 100,\n				"height" : 100,\n				"color" : "0xac65b3"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "screen",\n				"opacity" : 20\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 10\n			}\n		}\n	]\n}'}),define("text!effects/default/anne.pxs",[],function(){return'{\n	"name" : "Anne",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,13,13,14,15,15,16,17,17,18,19,20,20,21,22,23,24,25,26,27,28,28,30,31,32,33,34,35,36,37,39,40,41,42,44,45,47,48,49,51,53,54,56,57,59,61,63,64,66,68,70,72,74,76,78,80,82,84,87,89,91,93,96,98,100,103,105,107,109,111,114,116,118,120,122,124,126,128,130,132,134,136,138,140,141,143,145,147,149,150,152,154,155,157,159,160,162,163,165,166,168,169,171,172,174,175,177,178,179,181,182,183,185,186,187,188,190,191,192,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,213,214,215,216,217,218,218,219,220,221,221,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,232,233,233,234,235,235,236,236,237,237,237,238,238,239,239,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,249,250,250,250,250,251,251,251,252,252,252,252,253,253,253,253,254,254,254,254,255,255,255],\n				"green" : [0,1,1,2,2,3,4,4,5,6,6,7,7,8,9,9,10,11,11,12,13,13,14,15,15,16,17,17,18,19,19,20,21,22,22,23,24,25,25,26,27,28,28,29,30,31,32,32,33,34,35,36,37,38,39,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,55,56,57,58,59,60,61,63,64,65,66,68,69,70,71,73,74,75,77,78,80,81,82,84,85,87,88,90,92,93,95,96,98,100,101,103,105,106,108,110,112,114,115,117,119,121,123,124,126,128,130,132,133,135,137,138,140,142,143,145,147,148,150,151,153,154,156,157,159,160,162,163,165,166,167,169,170,171,173,174,175,177,178,179,180,182,183,184,185,186,187,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,209,210,211,212,213,214,214,215,216,217,218,218,219,220,221,221,222,223,224,224,225,226,226,227,228,228,229,230,230,231,232,232,233,234,234,235,235,236,237,237,238,238,239,239,240,241,241,242,242,243,243,244,244,245,245,246,246,247,247,248,248,249,249,250,250,251,251,252,252,253,254,254,255,255],\n				"blue" : [0,1,2,3,4,5,6,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,67,68,69,70,71,72,73,74,75,76,77,77,78,79,80,81,82,83,84,84,85,86,87,88,89,89,90,91,92,93,93,94,95,96,96,97,98,99,100,100,101,102,103,103,104,105,106,106,107,108,109,109,110,111,112,113,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,128,129,130,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,173,174,175,176,177,178,179,180,181,182,184,185,186,187,188,189,190,191,193,194,195,196,197,198,199,201,202,203,204,205,206,208,209,210,211,212,213,215,216,217,218,219,220,222,223,224,225,226,228,229,230,231,232,233,235,236,237,238,239,241,242,243,244,245,247,248,249,250,251,253,254,255]\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" :\n			{\n				"amount" : 25\n			}\n		}\n	]\n}'}),define("text!effects/default/antonio.pxs",[],function(){return'{\n	"name" : "Antonio",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "desaturate",\n			"param" : { }\n\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 10\n			}\n			\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "hardlight"\n			}\n		}\n	]\n}'}),define("text!effects/default/bob.pxs",[],function(){return'{\n	"name" : "Bob",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : -60\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "screen",\n				"opacity" : 40\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" : \n			{\n				"blend" : "hardlight",\n				"opacity" : 40\n			}\n		}\n	]\n}'}),define("text!effects/default/dean.pxs",[],function(){return'{\n	"name" : "Dean",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "threshold",\n			"param" :\n			{\n				"value" : 180\n			}\n		},\n		{\n			"type" : "boxblur",\n			"param" :\n			{\n				"amount" : 100\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "screen"\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "colorize",\n			"param" : \n			{\n				"hue" : 110\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/default/fred.pxs",[],function(){return'{\n	"name" : "Fred",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "threshold",\n			"param" :\n			{\n				"value" : 180\n			}\n		},\n		{\n			"type" : "boxblur",\n			"param" :\n			{\n				"amount" : 100\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "screen"\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "colorize",\n			"param" : \n			{\n				"hue" : 190\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : 40\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/default/harry.pxs",[],function(){return'{\n	"name" : "Harry",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "colorize",\n			"param" : \n			{\n				"hue" : 30\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "screen"\n			}\n		},\n		{\n			"type" : "noise",\n			"param" :\n			{\n				"amount" : 30\n			}\n		}\n	]\n}'}),define("text!effects/default/hagrid.pxs",[],function(){return'{\n	"name" : "Hagrid",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "invert",\n			"target" : 1,\n			"param" : { }\n		},\n		{\n			"type" : "desaturate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" : \n			{\n				"amount" : 50,\n				"quality" : 10\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay"\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 1,\n			"param" : { }\n		},\n		{\n			"type" : "invert",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 3\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity" : 40\n			}\n		},\n		{\n			"type" : "levels",\n			"param" :\n			{\n				"min" : 85,\n				"max" : 170\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay"\n			}\n		}\n	]\n}'}),define("text!effects/default/ivan.pxs",[],function(){return'{\n	"name" : "Ivan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [655538,721072,852143,983213,1114284,1245355,1376425,1507496,1638566,1769637,1900708,2031778,2097313,2228383,2359454,2490525,2621595,2752666,2883736,3014807,3145878,3276948,3408019,3539090,3604624,3735695,3866765,3997836,4128907,4259977,4391048,4522118,4653189,4784260,4915330,4980865,5111935,5243006,5374077,5505147,5636218,5767288,5898359,6029430,6160500,6291571,6422642,6488176,6619247,6750317,6881388,7012459,7143529,7274600,7405670,7536741,7667812,7798882,7929953,7995487,8126558,8257629,8388699,8519770,8650841,8781911,8912982,9044052,9175123,9306194,9371728,9502799,9633869,9764940,9896011,10027081,10158152,10289222,10420293,10551364,10682434,10813505,10879039,11010110,11141181,11272251,11403322,11534393,11665463,11796534,11927604,12058675,12189746,12320816,12386351,12517421,12648492,12779563,12910633,13041704,13172774,13303845,13434916,13565986,13697057,13762591,13893662,14024733,14155803,14286874,14417945,14549015,14680086,14811156,14942227,15073298,15204368,15269903,15400973,15532044,15663115,15794185,15925256,16056326,16187397,16318468,16449538,16580609,16711680,16711936,16712448,16712960,16713472,16713984,16714496,16715008,16715520,16716032,16716544,16717056,16717568,16718080,16718592,16719104,16719616,16720128,16720640,16721152,16721664,16722176,16722688,16723200,16723712,16724224,16724736,16725248,16725760,16726272,16726784,16727296,16727808,16728320,16728832,16729344,16729856,16730368,16730880,16731392,16731904,16732416,16732928,16733440,16733952,16734464,16734976,16735488,16736000,16736512,16737024,16737536,16738048,16738560,16739072,16739584,16740096,16740608,16741120,16741632,16742144,16742656,16743168,16743680,16743936,16744448,16744960,16745472,16745984,16746496,16747008,16747520,16748032,16748544,16749056,16749568,16750080,16750592,16751104,16751616,16752128,16752640,16753152,16753664,16754176,16754688,16755200,16755712,16756224,16756736,16757248,16757760,16758272,16758784,16759296,16759808,16760320,16760832,16761344,16761856,16762368,16762880,16763392,16763904,16764416,16764928,16765440,16765952,16766464,16766976,16767488,16768000,16768512,16769024,16769536,16770048,16770560,16771072,16771584,16772096,16772608,16773120,16773632,16774144,16774656,16775168,16775680,16776192]\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"opacity" : 50,\n				"blend" : "overlay"\n			}\n		}\n	]\n}'}),define("text!effects/default/jean.pxs",[],function(){return'{\n	"name" : "Jean",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "waterdown",\n			"param" : { }\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 50\n			}\n		},\n		{\n			"type" : "waterdown",\n			"param" : { }\n		},\n		{\n			"type" : "noise",\n			"param" :\n			{\n				"amount" : 20\n			}\n		}\n	]\n}'}),define("text!effects/default/josh.pxs",[],function(){return'{\n	"name" : "Josh",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],\n				"blue" : [62,63,64,64,65,66,67,68,68,69,70,71,71,72,73,74,75,75,76,77,78,79,79,80,81,82,82,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,101,101,102,103,104,104,105,106,107,107,108,109,110,110,111,112,112,113,114,115,115,116,117,117,118,119,119,120,121,122,122,123,124,124,125,126,126,127,128,128,129,129,130,131,131,132,133,133,134,135,135,136,136,137,138,138,139,139,140,141,141,142,142,143,143,144,145,145,146,146,147,147,148,148,149,149,150,150,151,152,152,153,153,153,154,154,155,155,156,156,157,157,158,158,159,159,159,160,160,161,161,162,162,162,163,163,164,164,164,165,165,166,166,166,167,167,167,168,168,169,169,169,170,170,170,171,171,171,172,172,172,173,173,173,174,174,174,175,175,175,175,176,176,176,177,177,177,178,178,178,178,179,179,179,180,180,180,180,181,181,181,181,182,182,182,182,183,183,183,183,184,184,184,184,185,185,185,185,186,186,186,186,187,187,187,187,188,188,188,188,189,189,189,189,189,190,190,190,190,191,191,191,191,192,192,192]\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" :\n			{\n				"amount" : 35\n			}\n		}\n	]\n}'}),define("text!effects/default/julia.pxs",[],function(){return'{\n	"name" : "Julia",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : 100\n			}\n		},\n		{\n			"type" : "waterdown",\n			"param" : { }\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : 100\n			}\n		},\n		{\n			"type" : "contrast",\n			"param" : \n			{\n				"amount" : 10\n			}\n		}\n	]\n}'}),define("text!effects/default/lucas.pxs",[],function(){return'{\n	"name" : "Lucas",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "waterdown",\n			"param" : { }\n		}\n	]\n}'}),define("text!effects/default/melissa.pxs",[],function(){return'{\n	"name" : "Melissa",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [63,64,65,65,66,67,68,68,69,70,71,71,72,73,74,74,75,76,77,77,78,79,80,80,81,82,83,83,84,85,86,86,87,88,89,89,90,91,92,92,93,94,95,95,96,97,98,98,99,100,101,101,102,103,104,104,105,106,107,107,108,109,110,110,111,112,113,113,114,115,116,116,117,118,119,119,120,121,122,122,123,124,125,125,126,127,128,129,129,130,131,132,132,133,134,135,135,136,137,138,138,139,140,141,141,142,143,144,144,145,146,147,147,148,149,150,150,151,152,153,153,154,155,156,156,157,158,159,159,160,161,162,162,163,164,165,165,166,167,168,168,169,170,171,171,172,173,174,174,175,176,177,177,178,179,180,180,181,182,183,183,184,185,186,186,187,188,189,189,190,191,192,193,193,194,195,196,196,197,198,199,199,200,201,202,202,203,204,205,205,206,207,208,208,209,210,211,211,212,213,214,214,215,216,217,217,218,219,220,220,221,222,223,223,224,225,226,226,227,228,229,229,230,231,232,232,233,234,235,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,247,248,249,250,250,251,252,253,253,254,255],\n				"green" : [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],\n				"blue" : [63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99,100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,156,157,157,158,158,159,159,160,160,161,161,162,162,163,163,164,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179,180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,189,190,190,191]\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 3\n			}\n		},\n		{\n			"type" : "noise",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "gradient",\n			"param" :\n			{\n				"type" : "linear",\n				"rotation" : 40,\n				"colors" : ["0x000000","0x000000","0x000000","0x000000"],\n				"alphas" : [1,0,0,1],\n				"ratios" : [0,80,165,255]\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"mask" : "2"\n			}\n		}\n	]\n}'}),define("text!effects/default/ramona.pxs",[],function(){return'{\n	"name" : "Ramona",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "threshold",\n			"param" :\n			{\n				"value" : 180\n			}\n		},\n		{\n			"type" : "boxblur",\n			"param" :\n			{\n				"amount" : 100\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "screen"\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "colorize",\n			"param" : \n			{\n				"hue" : 265\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/default/samantha.pxs",[],function(){return'{\n	"name" : "Samantha",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "threshold",\n			"param" :\n			{\n				"value" : 180\n			}\n		},\n		{\n			"type" : "boxblur",\n			"param" :\n			{\n				"amount" : 100\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "screen"\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "colorize",\n			"param" : \n			{\n				"hue" : 340\n			}\n		},\n		{\n			"type" : "saturation",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" : \n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "overlay",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/default/sara.pxs",[],function(){return'{\n	"name" : "Sara",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : 100\n			}\n\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 3\n			}\n			\n		},\n		{\n			"type" : "contrast",\n			"target" : 0,\n			"param" :\n			{\n				"amount" : 25\n			}\n\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "lighten",\n				"opacity" : 80\n			}\n		}\n	]\n}'}),define("text!effects/default/salomon.pxs",[],function(){return'{\n	"name" : "Salomon",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,0,1,1,1,2,2,2,3,3,4,4,4,5,5,5,6,6,7,7,7,8,8,9,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,20,20,21,22,22,23,23,24,25,26,26,27,28,29,29,30,31,32,33,34,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,53,54,56,57,58,59,61,62,63,64,66,67,68,70,71,73,74,75,77,78,80,81,82,84,85,87,88,90,91,93,94,96,97,99,100,102,104,105,107,108,110,111,113,115,116,118,119,121,122,124,126,127,129,130,132,134,135,137,138,140,142,143,145,146,148,149,151,153,154,156,157,159,160,162,163,165,166,168,170,171,173,174,175,177,178,180,181,183,184,186,187,188,190,191,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,211,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,229,230,231,232,233,233,234,235,236,236,237,238,238,239,239,240,241,241,242,242,243,244,244,245,245,246,246,247,247,248,248,249,249,250,250,251,251,251,252,252,253,253,254,254,255,255],\n				"green" : [0,1,2,2,3,4,5,5,6,7,8,8,9,10,11,11,12,13,14,15,15,16,17,18,18,19,20,21,21,22,23,24,25,25,26,27,28,29,29,30,31,32,33,33,34,35,36,37,38,38,39,40,41,42,43,43,44,45,46,47,48,48,49,50,51,52,53,54,55,56,56,57,58,59,60,61,62,63,64,65,66,67,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,110,111,112,113,114,116,117,118,119,120,122,123,124,125,127,128,129,131,132,133,135,136,137,138,140,141,142,144,145,147,148,149,151,152,153,155,156,157,159,160,162,163,164,166,167,168,170,171,172,174,175,176,178,179,180,182,183,184,186,187,188,190,191,192,193,195,196,197,198,199,201,202,203,204,205,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,227,228,229,230,231,232,232,233,234,235,236,236,237,238,239,239,240,241,242,242,243,244,245,245,246,247,247,248,249,249,250,251,252,252,253,254,254,255],\n				"blue" : [56,56,56,56,56,56,56,56,56,56,57,57,58,58,59,60,60,61,62,62,63,63,64,65,65,66,67,67,68,68,69,70,70,71,71,72,73,73,74,75,75,76,76,77,78,78,79,79,80,81,81,82,83,83,84,84,85,86,86,87,88,88,89,89,90,91,91,92,92,93,94,94,95,96,96,97,97,98,99,99,100,100,101,102,102,103,104,104,105,105,106,107,107,108,109,109,110,110,111,112,112,113,113,114,115,115,116,117,117,118,118,119,120,120,121,121,122,123,123,124,125,125,126,126,127,128,128,129,130,130,131,131,132,133,133,134,134,135,136,136,137,138,138,139,139,140,141,141,142,143,143,144,144,145,146,146,147,147,148,149,149,150,151,151,152,152,153,154,154,155,155,156,157,157,158,159,159,160,160,161,162,162,163,164,164,165,165,166,167,167,168,168,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,180,180,181,181,182,183,183,184,185,185,186,186,187,188,188,189,189,190,191,191,192,193,193,194,194,195,196,196,197,197,198,199,199,200,201,201,202,202,203,204,204,205,206,206,207,207,208]\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [22,22,22,22,22,22,22,22,22,22,22,22,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,104,105,106,107,108,109,110,111,111,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,127,128,129,130,131,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,143,144,145,146,146,147,148,148,149,150,151,151,152,153,153,154,155,155,156,157,157,158,159,159,160,161,161,162,162,163,164,164,165,166,166,167,167,168,169,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,179,180,180,181,182,182,183,183,184,184,185,185,186,187,187,188,188,189,189,190,190,191,192,192,193,193,194,194,195,195,196,196,197,197,198,199,199,200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208],\n				"green" : [22,22,22,22,22,22,22,22,22,22,22,22,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,104,105,106,107,108,109,110,111,111,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,127,128,129,130,131,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,143,144,145,146,146,147,148,148,149,150,151,151,152,153,153,154,155,155,156,157,157,158,159,159,160,161,161,162,162,163,164,164,165,166,166,167,167,168,169,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,179,180,180,181,182,182,183,183,184,184,185,185,186,187,187,188,188,189,189,190,190,191,192,192,193,193,194,194,195,195,196,196,197,197,198,199,199,200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208],\n				"blue" : [22,22,22,22,22,22,22,22,22,22,22,22,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,94,95,96,97,98,99,100,101,102,103,104,104,105,106,107,108,109,110,111,111,112,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,127,127,128,129,130,131,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,143,144,145,146,146,147,148,148,149,150,151,151,152,153,153,154,155,155,156,157,157,158,159,159,160,161,161,162,162,163,164,164,165,166,166,167,167,168,169,169,170,170,171,172,172,173,173,174,175,175,176,176,177,178,178,179,179,180,180,181,182,182,183,183,184,184,185,185,186,187,187,188,188,189,189,190,190,191,192,192,193,193,194,194,195,195,196,196,197,197,198,199,199,200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208]\n			}\n		}\n	]\n}'}),define("text!effects/default/sophia.pxs",[],function(){return'{\n	"name" : "Sophia",\n	"description" : "Vintage colors with a hint of vignette",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : 40\n			}\n		},\n		{\n			"type" : "vignette",\n			"param" :\n			{\n				"color" : "0x000000",\n				"size" : 30\n			}\n		},\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,1,1,2,2,3,4,4,5,5,6,7,7,8,8,9,10,10,11,11,12,13,13,14,14,15,16,16,17,18,18,19,19,20,21,21,22,23,23,24,25,25,26,27,27,28,29,29,30,31,32,32,33,34,34,35,36,37,37,38,39,40,40,41,42,43,44,44,45,46,47,48,48,49,50,51,52,53,54,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,83,84,85,86,87,88,90,91,92,93,94,96,97,98,99,101,102,103,104,106,107,108,110,111,112,114,115,116,118,119,120,122,123,125,126,127,129,130,132,133,134,136,137,139,140,142,143,145,146,148,149,151,152,154,155,157,158,160,161,163,164,166,167,169,170,172,174,175,177,178,180,181,183,185,186,188,189,191,193,194,196,197,199,201,202,204,205,207,209,210,212,214,215,217,219,220,222,223,225,227,228,230,232,233,235,237,238,240,242,243,245,247,248,250,252,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],\n				"green" : [0,1,2,3,3,4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,21,22,23,24,24,25,26,27,28,29,30,31,32,33,33,34,35,36,37,38,39,40,41,42,43,44,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,99,100,101,102,103,104,106,107,108,109,110,112,113,114,115,116,117,119,120,121,122,124,125,126,127,128,130,131,132,133,134,136,137,138,139,141,142,143,144,145,147,148,149,150,151,153,154,155,156,157,159,160,161,162,163,165,166,167,168,169,170,172,173,174,175,176,177,178,180,181,182,183,184,185,186,187,188,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,215,216,217,218,219,220,221,222,222,223,224,225,226,227,227,228,229,230,231,232,232,233,234,235,235,236,237,238,239,239,240,241,242,242,243,244,245,245,246,247,248,248,249,250,251,251,252,253,254,254,255],\n				"blue" : [22,23,24,24,25,26,27,28,29,29,30,31,32,33,33,34,35,36,37,37,38,39,40,41,42,42,43,44,45,46,46,47,48,49,50,51,51,52,53,54,55,55,56,57,58,59,60,60,61,62,63,64,64,65,66,67,68,68,69,70,71,72,73,73,74,75,76,77,77,78,79,80,81,82,82,83,84,85,86,86,87,88,89,90,91,91,92,93,94,95,95,96,97,98,99,99,100,101,102,103,104,104,105,106,107,108,108,109,110,111,112,113,113,114,115,116,117,117,118,119,120,121,122,122,123,124,125,126,126,127,128,129,130,130,131,132,133,134,135,135,136,137,138,139,139,140,141,142,143,144,144,145,146,147,148,148,149,150,151,152,153,153,154,155,156,157,157,158,159,160,161,161,162,163,164,165,166,166,167,168,169,170,170,171,172,173,174,175,175,176,177,178,179,179,180,181,182,183,184,184,185,186,187,188,188,189,190,191,192,192,193,194,195,196,197,197,198,199,200,201,201,202,203,204,205,206,206,207,208,209,210,210,211,212,213,214,215,215,216,217,218,219,219,220,221,222,223,223,224,225,226,227,228,228,229,230]\n			}\n		}\n	]\n}'}),define("text!effects/default/tom.pxs",[],function(){return'{\n	"name" : "Tom",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "desaturate",\n			"param" : \n			{\n	\n			}\n		}\n	]\n}'}),define("text!effects/default/tony.pxs",[],function(){return'{\n	"name" : "Tony",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "mapping",\n			"param" :\n			{\n				"red" : [0,0,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,8,8,8,9,9,9,9,9,9,11,11,11,12,12,12,14,14,14,15,15,15,17,17,17,18,18,18,20,20,21,21,21,23,23,23,24,26,26,27,29,29,30,32,32,33,35,35,36,38,38,39,41,41,42,44,44,45,48,48,50,53,53,54,56,56,59,62,62,63,65,65,66,71,71,72,74,74,78,78,78,83,84,84,87,90,90,92,96,96,98,101,101,104,105,105,108,111,111,116,117,117,120,123,123,125,129,129,131,132,132,137,138,138,143,146,146,147,152,152,153,155,155,159,162,162,164,168,168,170,173,173,176,179,179,182,183,183,186,189,189,191,192,192,195,197,197,201,203,203,206,206,206,209,212,212,215,216,216,218,219,219,222,225,225,227,228,228,231,233,233,234,236,236,237,240,240,242,245,245,248,249,249,249,251,251,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254],\n				"green" : [0,2,3,3,5,6,6,8,9,9,9,11,11,12,14,14,15,17,17,17,18,18,20,21,21,23,24,24,24,26,26,27,29,29,30,32,32,33,35,35,36,38,38,41,41,41,42,44,44,45,47,47,50,50,50,51,53,53,54,56,56,59,60,60,62,63,63,66,68,68,69,71,71,72,74,74,75,78,78,80,83,83,84,86,86,89,90,90,92,95,95,96,98,98,101,102,102,105,107,107,108,110,110,113,116,116,117,119,119,122,123,123,125,128,128,129,132,132,134,137,137,138,140,140,141,144,144,146,149,149,150,153,153,155,156,156,159,161,161,162,165,165,167,168,168,171,173,173,174,176,176,179,180,180,182,185,185,186,188,188,189,191,191,192,194,194,195,198,198,200,201,201,203,204,204,206,207,207,209,210,210,212,213,213,215,215,215,216,218,218,219,221,221,222,224,224,224,225,225,227,227,227,228,230,230,230,231,231,233,233,233,234,234,234,236,236,236,237,237,237,239,239,239,240,240,240,242,243,243,243,243,243,245,245,245,246,246,246,248,248,248,249,249,249,249,251,251,251,252,252,252,252,252,254,254,254],\n				"blue" : [23,24,26,26,27,29,29,30,32,32,32,33,33,35,36,36,36,38,38,39,41,41,41,44,44,45,47,47,47,48,48,50,51,51,51,53,53,54,56,56,57,59,59,60,62,62,62,63,63,65,66,66,66,68,68,69,71,71,72,74,74,75,75,75,77,78,78,80,81,81,81,83,83,84,86,86,87,87,87,89,90,90,92,93,93,95,96,96,98,99,99,99,101,101,102,104,104,105,105,105,107,108,108,110,110,110,111,113,113,114,116,116,117,119,119,119,120,120,122,123,123,125,125,125,126,128,128,129,131,131,132,134,134,134,135,135,137,138,138,140,141,141,143,143,143,144,146,146,147,149,149,149,150,150,152,153,153,153,155,155,156,158,158,159,161,161,162,162,162,164,165,165,167,168,168,170,171,171,171,173,173,174,176,176,177,177,177,179,180,180,182,183,183,185,186,186,186,188,188,189,191,191,191,192,192,194,195,195,197,198,198,200,201,201,203,203,203,204,206,206,207,207,207,209,210,210,212,213,213,215,216,216,218,218,218,219,221,221,222,222,222,224,225,225,227,228,228,230,230,230,231,233,233,234,236,236]\n			}\n		},\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : -50\n			}\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 3\n			}\n		},\n		{\n			"type" : "gradient",\n			"param" :\n			{\n				"type" : "radial",\n				"rotation" : 40,\n				"colors" : ["0x000000","0x000000","0x000000"],\n				"alphas" : [0,0,1],\n				"ratios" : [0,120,255]\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"mask" : "2"\n			}\n		}\n	]\n}'}),define("text!effects/tida.pxs",[],function(){return'{\r\n	"name" : "Tida",\r\n	"description" : "",\r\n	"author" : "Ola Sevandersson",\r\n	"version" : 1,\r\n\r\n	"engine" :\r\n	{\r\n		"power" : "v6",\r\n		"version" : 1\r\n	},\r\n	\r\n	"actions" :\r\n	[\r\n		{\r\n			"type" : "lookup",\r\n			"param" :\r\n			{\r\n				"data" : [277340,342620,407900,538972,604252,669789,800605,866141,931421,1062494,1127774,1258846,1324126,1389663,1520479,1586015,1651295,1782367,1847648,1978720,2044000,2109536,2240353,2305889,2371169,2502241,2567522,2698594,2763874,2829154,2960227,3025507,3091043,3221859,3287395,3352676,3483748,3549028,3680100,3745381,3810917,3941733,4007269,4072550,4203622,4268902,4399974,4465255,4530791,4661607,4727143,4792423,4923496,4988776,5119848,5185128,5250409,5381481,5446761,5512297,5643114,5708650,5773930,5905002,5970283,6101355,6166635,6232171,6362987,6428524,6493804,6624876,6690156,6821229,6886509,6952045,7082861,7148398,7213678,7344750,7410030,7541103,7541614,7607662,7673710,7739758,7805806,7871854,7872366,7938414,8004462,8070510,8136558,8202606,8268654,8269166,8335214,8401262,8467310,8533358,8599406,8665454,8665966,8732014,8798062,8864110,8930158,8996206,9062254,9062765,9128813,9194861,9260909,9326957,9393005,9393517,9459565,9525613,9591661,9657709,9723757,9789805,9790317,9856365,9922413,9988461,10054509,10120557,10186605,10187117,10253165,10319213,10385261,10451309,10517357,10583405,10583916,10649964,10716012,10782060,10848108,10914156,10914668,10980716,11046764,11112812,11178860,11244908,11310956,11311468,11377516,11443564,11509612,11575660,11641708,11707756,11708268,11774316,11840364,11906412,11972460,12038508,12104812,12170605,12236398,12302192,12433777,12499571,12565364,12631158,12762743,12828537,12894330,12960124,13091709,13157503,13223296,13354626,13420675,13486469,13552262,13683592,13749641,13815435,13881228,14012558,14078607,14144400,14275730,14341523,14407573,14473366,14604696,14670489,14736539,14802332,14933662,14999455,15065505,15196834,15262628,15328421,15394471,15525800,15591594,15657387,15723437,15854766,15920560,15986353,16117939,16117940,16117942,16118200,16118201,16183739,16183997,16183998,16184000,16249794,16249795,16249797,16250055,16250056,16315594,16315852,16315854,16315855,16381649,16381651,16381652,16381910,16381912,16447449,16447707,16447709,16447710,16513504,16513506,16513507,16513765,16513767,16579305,16579562,16579564,16579566,16645359,16645361,16645363,16645620,16645622,16711160,16711417,16711419,16711421,16777215]\r\n			}\r\n		}\r\n	]\r\n}'}),define("text!effects/soft/camille.pxs",[],function(){return'{\n	"name" : "Camille",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 200\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "lighten"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/hans.pxs",[],function(){return'{\n	"name" : "Hans",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 280\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "multiply",\n				"opacity" : 100\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/jessica.pxs",[],function(){return'{\n	"name" : "Jessica",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "saturation",\n			"param" :\n			{\n				"amount" : 100\n			}\n\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 10\n			}\n			\n		},\n		{\n			"type" : "contrast",\n			"target" : 0,\n			"param" :\n			{\n				"amount" : 40\n			}\n\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "lighten",\n				"opacity" : 85\n			}\n		}\n	]\n}'}),define("text!effects/soft/jones.pxs",[],function(){return'{\n	"name" : "Jones",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 140\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "multiply",\n				"opacity" : 50\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/laila.pxs",[],function(){return'{\n	"name" : "Laila",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 330\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "lighten"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/mary.pxs",[],function(){return'{\n	"name" : "Mary",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 60\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "lighten"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/per.pxs",[],function(){return'{\n	"name" : "Per",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 330\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "multiply",\n				"opacity" : 50\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/robert.pxs",[],function(){return'{\n	"name" : "Robert",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 200\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "multiply",\n				"opacity" : 50\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/rose.pxs",[],function(){return'{\n	"name" : "Rose",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 280\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "lighten"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/sarah.pxs",[],function(){return'{\n	"name" : "Sarah",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 140\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "lighten"\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/soft/thomas.pxs",[],function(){return'{\n	"name" : "Thomas",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "duplicate",\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 10,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "colorize",\n			"param" :\n			{\n				"hue" : 60\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "duplicate",\n			"target" : 0,\n			"param" : { }\n		},\n		{\n			"type" : "blur",\n			"param" :\n			{\n				"amount" : 5,\n				"quality" : 15\n			}\n		},\n		{\n			"type" : "brightness",\n			"param" :\n			{\n				"amount" : 20\n			}\n		},\n		{\n			"type" : "merge",\n			"param" :\n			{\n				"blend" : "multiply",\n				"opacity" : 50\n			}\n		},\n		{\n			"type" : "merge",\n			"target" : 1,\n			"param" :\n			{\n				"blend" : "add",\n				"opacity" : 50\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/chloe.pxs",[],function(){return'{\n	"name" : "Chloe",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "contrast",\n			"param" :\n			{\n				"amount" : 25\n			}\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [0,0,65536,131329,196865,262658,328194,393987,459523,525316,590852,591109,656645,722438,787974,853767,919303,984839,1050632,1116168,1181961,1181961,1247754,1313290,1379083,1444619,1510412,1575948,1641741,1707277,1773070,1773070,1838606,1904399,1969935,2035728,2101264,2167057,2232593,2298386,2363922,2364179,2429715,2495508,2561044,2626837,2692373,2757909,2823702,2889238,2955031,3020567,3020824,3086360,3152153,3217689,3283482,3349018,3414811,3480347,3546140,3611676,3611676,3677469,3743005,3808798,3874334,3940127,4005663,4071456,4136992,4202785,4202785,4268578,4334114,4399907,4465443,4530979,4596772,4662308,4728101,4793637,4793894,4859430,4925223,4990759,5056552,5122088,5187881,5253417,5319210,5384746,5384746,5450539,5516075,5581868,5647404,5713197,5778733,5844526,5910062,5975855,6041391,6041648,6107184,6172977,6238513,6304049,6369842,6435378,6501171,6566707,6632500,6632500,6698293,6763829,6829622,6895158,6960951,7026487,7092280,7157816,7223352,7223609,7289145,7354938,7420474,7486267,7551803,7617596,7683132,7748925,7814461,7814718,7880254,7946047,8011583,8077119,8142912,8208448,8274241,8339777,8405570,8405570,8471363,8536899,8602692,8668228,8734021,8799557,8865350,8930886,8996422,9062215,9062215,9128008,9193544,9259337,9324873,9390666,9456202,9521995,9587531,9653324,9653324,9719117,9784653,9850189,9915982,9981518,10047311,10112847,10178640,10244176,10244433,10309969,10375762,10441298,10507091,10572627,10638420,10703956,10769492,10835285,10835285,10901078,10966614,11032407,11097943,11163736,11229272,11295065,11360601,11426394,11426394,11492187,11557723,11623259,11689052,11754588,11820381,11885917,11951710,12017246,12083039,12083039,12148832,12214368,12280161,12345697,12411490,12477026,12542562,12608355,12673891,12674148,12739684,12805477,12871013,12936806,13002342,13068135,13133671,13199464,13265000,13265257,13330793,13396329,13462122,13527658,13593451,13658987,13724780,13790316,13856109,13856109,13921902,13987438,14053231,14118767,14184560,14250096,14315632,14381425,14446961,14447218,14512754,14578547,14644083,14709876,14775412,14841205,14906741,14972534,15038070,15103863]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/ethan.pxs",[],function(){return'{\n	"name" : "Ethan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "contrast",\n			"param" :\n			{\n				"amount" : 25\n			}\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [0,0,65792,131328,197120,262912,262912,328704,394496,460032,525824,525825,591617,657409,722945,788737,788993,854529,920321,985857,1051649,1117442,1117442,1183234,1249026,1314562,1380354,1380610,1446146,1511938,1577474,1643267,1643523,1709059,1774851,1840643,1906179,1971971,1971971,2037763,2103555,2169092,2234884,2235140,2300676,2366468,2432260,2497796,2498052,2563588,2629380,2695173,2760709,2826501,2826757,2892293,2958085,3023621,3089413,3089669,3155205,3220997,3286790,3352326,3352582,3418374,3483910,3549702,3615238,3681030,3681286,3746822,3812615,3878407,3943943,3944199,4009735,4075527,4141319,4206855,4207111,4272903,4338440,4404232,4470024,4535560,4535816,4601352,4667144,4732936,4798472,4798728,4864521,4930057,4995849,5061385,5061641,5127433,5192969,5258761,5324553,5324553,5390346,5456138,5521674,5587466,5653002,5653258,5719050,5784586,5850378,5916170,5916170,5981963,6047499,6113291,6179083,6179083,6244875,6310667,6376203,6441995,6507787,6507788,6573580,6639116,6704908,6770700,6770700,6836492,6902284,6967820,7033612,7033613,7099405,7165197,7230733,7296525,7362317,7362317,7428109,7493901,7559437,7625230,7625230,7691022,7756814,7822350,7888142,7888398,7953934,8019726,8085262,8151055,8216847,8216847,8282639,8348431,8413967,8479759,8480015,8545551,8611343,8676879,8742672,8742928,8808464,8874256,8940048,9005584,9071376,9071376,9137168,9202960,9268497,9334289,9334545,9400081,9465873,9531665,9597201,9597457,9662993,9728785,9794578,9860114,9860370,9926162,9991698,10057490,10123026,10188818,10189074,10254610,10320403,10386195,10451731,10451987,10517779,10583315,10649107,10714643,10714899,10780691,10846228,10912020,10977812,11043348,11043604,11109140,11174932,11240724,11306260,11306516,11372308,11437845,11503637,11569429,11569429,11635221,11700757,11766549,11832341,11897877,11898133,11963926,12029462,12095254,12160790,12161046,12226838,12292374,12358166,12423958,12423958,12489751,12555543,12621079,12686871,12752407,12752663,12818455,12883991,12949783,13015575,13015576,13081368,13146904,13212696,13278488,13278488,13344280,13410072,13475608,13541400,13607193]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/james.pxs",[],function(){return'{\n	"name" : "James",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [2362881,2362881,2428673,2428674,2494466,2494466,2560259,2560259,2626052,2626052,2691844,2757381,2757637,2823173,2823430,2888966,2889223,2954759,2955015,3020552,3086344,3086345,3152137,3152137,3217930,3217930,3283722,3283723,3349515,3415308,3415308,3481100,3481101,3546893,3546893,3612686,3612686,3678479,3744015,3744271,3809808,3810064,3875601,3875857,3941393,3941650,4007186,4072978,4072979,4138771,4138772,4204564,4204564,4270357,4270357,4336150,4401942,4401942,4467735,4467735,4533527,4533528,4599320,4599321,4665113,4730649,4730906,4796442,4796698,4862235,4862491,4928028,4928284,4993820,5059613,5059613,5125406,5125406,5191198,5191199,5256991,5256991,5322784,5388576,5388577,5454369,5454369,5520162,5520162,5585954,5585955,5651747,5717284,5717540,5783076,5783333,5848869,5849126,5914662,5914918,5980455,6046247,6046247,6112040,6112040,6177833,6177833,6243625,6243626,6309418,6375211,6441004,6506797,6572590,6638384,6704433,6770226,6836019,6901813,6967606,7033655,7099449,7165242,7231035,7296828,7362878,7428671,7494464,7560257,7626051,7692100,7757893,7823687,7889480,7955273,8021322,8087116,8152909,8218702,8350288,8416081,8481874,8547667,8613461,8679510,8745303,8811096,8876890,8942683,9008732,9074526,9140319,9206112,9271905,9337955,9403748,9469541,9535334,9601128,9667177,9732970,9798764,9864557,9930350,9996399,10062193,10127986,10193779,10325365,10391158,10456951,10522744,10588538,10654587,10720380,10786173,10851967,10917760,10983809,11049603,11115396,11181189,11246982,11313032,11378825,11444618,11510411,11576205,11642254,11708047,11773841,11839634,11905427,11971476,12037270,12103063,12168856,12300442,12366235,12432028,12497821,12563615,12629664,12695457,12761250,12827044,12892837,12958886,13024680,13090473,13156266,13222059,13288109,13353902,13419695,13485488,13551282,13617331,13683124,13748918,13814711,13880504,13946553,14012347,14078140,14143933,14275519,14341312,14407105,14472898,14538692,14604741,14670534,14736327,14802121,14867914,14933963,14999757,15065550,15131343,15197136,15263186,15328979,15394772,15460565,15526359,15592408,15658201,15723995,15789788,15855581,15921630,15987424,16053217,16119010,16250596]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/jayden.pxs",[],function(){return'{\n	"name" : "Jayden",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "contrast",\n			"param" :\n			{\n				"amount" : 25\n			}\n		},\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [0,0,257,257,66050,66050,66307,131844,132100,132101,197893,197894,198151,263943,263944,264200,329737,329994,329994,395787,395787,396044,396044,461837,462094,462094,527887,527887,528144,593681,593937,593938,659730,659731,659988,725780,725781,726037,791574,791830,791831,857624,857624,857881,857881,923674,923931,923931,989724,989724,989981,1055518,1055774,1055775,1121567,1121568,1121824,1187617,1187618,1187874,1253411,1253667,1253668,1319461,1319461,1319718,1319718,1385511,1385768,1385768,1451561,1451561,1451818,1517354,1517611,1517612,1583404,1583405,1583661,1649454,1649455,1649711,1715248,1715504,1715505,1781298,1781298,1781555,1781555,1847348,1847604,1847605,1913398,1913398,1913655,1979191,1979448,1979449,2045241,2045242,2045498,2111291,2111292,2111548,2177085,2177341,2177342,2177598,2243135,2243392,2243392,2309185,2309441,2309442,2375235,2375235,2375492,2441028,2441285,2441286,2507078,2507079,2507335,2573128,2573128,2573385,2638922,2639178,2639179,2639435,2704972,2705229,2705229,2771022,2771278,2771279,2837072,2837072,2837329,2902865,2903122,2903122,2968915,2968916,2969172,3034965,3034965,3035222,3100759,3101015,3101016,3101272,3166809,3167066,3167066,3232859,3233115,3233116,3298908,3298909,3299166,3364702,3364959,3364959,3430752,3430753,3431009,3496802,3496802,3497059,3562596,3562852,3562853,3563109,3628646,3628902,3628903,3694696,3694952,3694953,3760745,3760746,3761003,3826539,3826796,3826796,3892589,3892590,3892846,3958639,3958639,3958896,3958896,4024689,4024690,4024946,4090483,4090739,4090740,4156533,4156789,4156790,4222582,4222583,4222840,4288376,4288633,4288633,4354426,4354426,4354683,4420476,4420476,4420733,4420733,4486526,4486527,4486783,4552320,4552576,4552577,4618370,4618626,4618627,4684419,4684420,4684676,4750213,4750470,4750470,4816263,4816263,4816520,4882313,4882313,4882570,4882570,4948363,4948364,4948620,5014157,5014413,5014414,5080206,5080463,5080464,5146256,5146257,5146513,5212050,5212307,5212307,5278100,5278100,5278357,5344150]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/jonathan.pxs",[],function(){return'{\n	"name" : "Jonathan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [6686251,6686251,6686508,6752300,6752557,6818349,6818606,6884398,6884655,6950447,6950704,7016496,7016753,7082545,7082802,7148595,7148851,7214644,7214900,7280693,7280949,7346742,7346998,7412791,7413047,7478840,7479096,7479353,7545146,7545402,7611195,7611451,7677244,7677500,7743293,7743549,7809342,7809598,7875391,7875647,7941440,7941697,8007489,8007746,8073538,8073795,8139587,8139844,8205636,8205893,8271685,8271942,8337734,8337991,8338248,8404040,8404297,8470089,8470346,8536138,8536395,8602187,8602444,8668236,8668493,8734285,8734542,8800335,8800591,8866384,8866640,8932433,8932689,8998482,8998738,9064531,9064787,9130580,9130836,9196629,9196886,9196886,9262679,9262935,9328728,9328984,9394777,9395033,9460826,9461082,9526875,9527131,9592924,9593180,9658973,9659230,9725022,9725279,9791071,9791328,9857120,9857377,9923169,9923426,9989218,9989475,10055267,10055524,10055781,10121573,10121830,10187622,10187879,10253671,10253928,10319720,10319977,10385769,10386026,10451818,10452075,10517868,10518124,10583917,10584173,10649966,10650222,10716015,10716271,10782064,10782320,10848113,10848369,10914162,10914419,10914675,10980468,10980724,11046517,11046773,11112566,11112822,11178615,11178871,11244664,11244920,11310713,11310970,11376762,11377019,11442811,11443068,11508860,11509117,11574909,11575166,11640958,11641215,11707007,11707264,11773057,11773057,11838849,11904641,11970434,11970690,12036482,12102274,12168067,12168067,12233859,12299651,12365444,12365700,12431492,12497284,12563077,12628869,12628869,12694662,12760454,12826246,12826502,12892295,12958087,13023879,13023879,13089672,13155464,13221256,13287048,13287305,13353097,13418889,13484681,13484682,13550474,13616266,13682059,13682315,13748107,13813899,13879692,13945484,13945484,14011276,14077069,14142861,14143117,14208909,14274702,14340494,14340494,14406286,14472079,14537871,14603663,14603920,14669712,14735504,14801296,14801297,14867089,14932881,14998673,14998930,15064722,15130514,15196306,15262099,15262099,15327891,15393683,15459476,15459732,15525524,15591317,15657109,15657109,15722901,15788694,15854486,15920278,15920534,15986327,16052119,16117911,16117911,16183704,16249496,16315288,16315544,16381337,16447129,16512921,16578714]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/justin.pxs",[],function(){return'{\n	"name" : "Justin",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [6160384,6160641,6226434,6226691,6292484,6358533,6358790,6424583,6424840,6490889,6556682,6556939,6622732,6623245,6689038,6754831,6755088,6821137,6821394,6887187,6952980,6953493,7019286,7019543,7085336,7151385,7151642,7217435,7217692,7283741,7349535,7349792,7415585,7415842,7481891,7547684,7547941,7613734,7614247,7680040,7745833,7746090,7812139,7812396,7878189,7943982,7944495,8010288,8010545,8076338,8142387,8142644,8208437,8208694,8274743,8340536,8340793,8406586,8407099,8472892,8538686,8538943,8604736,8605249,8671042,8736835,8737092,8803141,8803398,8869191,8934984,8935497,9001290,9001547,9067340,9133389,9133646,9199439,9199696,9265745,9331538,9331795,9397588,9398101,9463894,9529687,9529944,9595993,9596250,9662043,9727837,9728094,9794143,9794400,9860193,9925986,9926499,9992292,9992549,10058342,10124391,10124648,10190441,10190698,10256747,10322540,10322797,10388590,10389103,10454896,10520689,10520946,10586995,10587252,10653045,10718838,10719351,10785144,10785401,10851194,10917244,10917244,10983036,10983037,11048829,11114622,11114622,11180415,11180671,11246208,11312000,11312001,11377793,11378049,11443586,11509378,11509635,11575171,11575428,11640964,11706757,11707013,11772550,11772806,11838599,11904135,11904391,11970184,11970184,12035977,12101513,12101770,12167562,12167563,12233355,12299148,12299148,12364940,12364941,12430733,12496526,12496526,12562319,12562575,12628112,12693904,12693905,12759697,12759954,12825490,12891282,12891539,12957075,12957332,13023124,13088661,13088917,13154454,13154710,13220503,13286039,13286296,13352088,13352088,13417881,13483417,13483674,13549466,13549467,13615259,13681052,13681052,13746845,13746845,13812637,13878430,13878430,13944223,13944479,14010016,14075808,14076065,14141601,14141858,14207394,14273187,14273443,14338979,14339236,14405028,14470565,14470821,14536358,14536614,14602407,14667943,14668200,14733992,14733993,14799785,14865321,14865578,14931370,14931371,14997163,15062956,15062956,15128749,15129005,15194542,15260334,15260334,15326127,15326383,15391920,15457712,15457969,15523505,15523762,15589298,15655091,15655347,15720884,15721140,15786932,15852469,15852725,15918262,15918518,15984311,16049847,16050104,16115896,16115897,16181689,16247482]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/kirsten.pxs",[],function(){return'{\n	"name" : "Kirsten",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [4007168,4007168,4072961,4138753,4138754,4204546,4270339,4270596,4336132,4401925,4402181,4467974,4533511,4533767,4599560,4665352,4665353,4731145,4796938,4797195,4862731,4928524,4928780,4994573,5060110,5060366,5126159,5191695,5191952,5257745,5323537,5323538,5389330,5455123,5455379,5520916,5586709,5586965,5652758,5718294,5718551,5784344,5850136,5850137,5915929,5981722,5981979,6047515,6113308,6113564,6179101,6244893,6245150,6310943,6376479,6376736,6442528,6508321,6508322,6574114,6639907,6640163,6705700,6771492,6771749,6837542,6903078,6903335,6969127,7034920,7034921,7100713,7166506,7166506,7232299,7298092,7298348,7363885,7429677,7429934,7495726,7561263,7561520,7627312,7693105,7693105,7758898,7824691,7824947,7890484,7956276,7956533,8022326,8087862,8088119,8153911,8219448,8219704,8285497,8351290,8351290,8417083,8482875,8483132,8548669,8614461,8614718,8680510,8746047,8746303,8812096,8877889,8877889,8943682,9009474,9009731,9075268,9141060,9141317,9206853,9272646,9272903,9338695,9404232,9404488,9470281,9536073,9536074,9601867,9667659,9667916,9733452,9799245,9799502,9865294,9930831,9931087,9996880,10062673,10062674,10128467,10194260,10260054,10325847,10326104,10391898,10457691,10523484,10589278,10589279,10655072,10720866,10786659,10852452,10852710,10918503,10984296,11050090,11115883,11116140,11181677,11247471,11313264,11379057,11379315,11445108,11510901,11576695,11642488,11642745,11708283,11774076,11839869,11905663,11905920,11971713,12037507,12103300,12169093,12169350,12235144,12300681,12366474,12432268,12432525,12498318,12564112,12629905,12695698,12695956,12761749,12827542,12893080,12958873,12959130,13024924,13090717,13156510,13222303,13288097,13288354,13354147,13419685,13485478,13551271,13551529,13617322,13683115,13748909,13814702,13814959,13880753,13946546,14012083,14077877,14078134,14143927,14209720,14275514,14341307,14341564,14407358,14473151,14538944,14604482,14604739,14670532,14736326,14802119,14867912,14868170,14933963,14999756,15065550,15131087,15131344,15197137,15262931,15328724,15394517,15394775,15460568,15526361,15592155,15657948,15657949,15723743,15789536,15855329,15921123,15921380,15987173,16052967,16118760,16184553,16250347]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/luke.pxs",[],function(){return'{\n	"name" : "Luke",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [3547421,3547421,3613214,3679007,3744800,3745056,3810849,3876642,3942435,4008228,4008484,4074021,4139814,4205607,4205864,4271656,4337449,4403242,4469035,4469292,4535084,4600877,4666414,4732207,4732464,4798256,4864049,4929842,4930099,4995891,5061684,5127477,5193270,5193271,5259063,5324856,5390649,5390906,5456699,5522491,5588284,5654077,5654334,5720127,5785663,5851456,5917249,5917506,5983299,6049091,6114884,6115141,6180934,6246726,6312519,6378056,6378313,6444106,6509898,6575691,6641484,6641741,6707534,6773326,6839119,6839376,6904913,6970706,7036498,7102291,7102548,7168341,7234134,7299926,7300183,7365976,7431769,7497305,7563098,7563355,7629148,7694941,7760733,7826526,7826783,7892576,7958369,8024161,8024162,8089955,8155748,8221541,8287333,8287590,8353383,8419176,8484969,8485225,8551018,8616555,8682348,8748140,8748397,8814190,8879983,8945776,9011568,9011825,9077618,9143411,9208948,9209204,9274997,9340790,9406583,9472376,9472632,9538425,9604218,9670011,9735804,9735804,9801597,9867389,9867390,9933182,9998975,9998975,10064768,10130561,10130561,10196354,10262146,10262403,10327939,10393732,10393988,10459525,10525318,10525574,10591111,10656903,10657160,10722952,10788489,10854281,10854538,10920075,10985867,10986124,11051660,11117453,11117709,11183246,11249038,11249295,11315088,11380624,11380881,11446673,11512210,11512466,11578259,11643795,11644052,11709845,11775637,11841174,11841430,11907223,11972759,11973016,12038808,12104345,12104602,12170394,12235931,12236187,12301980,12367772,12367773,12433565,12499358,12499359,12565151,12630944,12630944,12696737,12762529,12828322,12828322,12894115,12959908,12959908,13025701,13091493,13091494,13157286,13223079,13223335,13288872,13354665,13354921,13420458,13486250,13486507,13552043,13617836,13618092,13683629,13749422,13815214,13815471,13881007,13946800,13947056,14012593,14078385,14078642,14144179,14209971,14210228,14276020,14341557,14341813,14407606,14473142,14473399,14539192,14604728,14604985,14670777,14736314,14802106,14802363,14868155,14933692,14933949,14999741,15065278,15065534,15131327,15196863,15197120,15262912,15328705,15328706,15394498,15460291,15460291,15526084,15591876,15591877,15657669,15723462,15789255]\n			}\n		}\n	]\n}'}),define("text!effects/unicolor/ryan.pxs",[],function(){return'{\n	"name" : "Ryan",\n	"description" : "",\n	"author" : "Ola Sevandersson",\n	"version" : 1,\n\n	"engine" :\n	{\n		"power" : "v6",\n		"version" : 1\n	},\n	\n	"actions" :\n	[\n		{\n			"type" : "lookup",\n			"param" :\n			{\n				"data" : [529008,529007,594543,594543,660079,725615,725614,791406,791406,856942,922478,922478,988013,988269,1053805,1119341,1119341,1184876,1250412,1250668,1316204,1316204,1381740,1447275,1447275,1513067,1513067,1578603,1644139,1644138,1709674,1775466,1775466,1841002,1841001,1906537,1972073,1972329,2037865,2037865,2103400,2168936,2168936,2234728,2300264,2300263,2365799,2365799,2431335,2497127,2497127,2562662,2562662,2628198,2693734,2693990,2759526,2825061,2825061,2890597,2890597,2956389,3021924,3021924,3087460,3087460,3152996,3218788,3218787,3284323,3349859,3349859,3415395,3415394,3481186,3546722,3546722,3612258,3612258,3677793,3743585,3743585,3809121,3809121,3874657,3940192,3940448,4005984,4071520,4071520,4137055,4137055,4202847,4268383,4268383,4333919,4333918,4399454,4465246,4465246,4530782,4596317,4596317,4661853,4662109,4727645,4793181,4793180,4858716,4858716,4924508,4990044,4990044,5055579,5121115,5121115,5186907,5186907,5252442,5317978,5317978,5383514,5383770,5449306,5514841,5514841,5580377,5645913,5646169,5711704,5711704,5777240,5842776,5842776,5908568,5908567,5974103,6039639,6039639,6105175,6170967,6236758,6302549,6434133,6499924,6565716,6697299,6763090,6828882,6960465,7026257,7092048,7223632,7289423,7355214,7486798,7552589,7683917,7749964,7815755,7947083,8013130,8078922,8210505,8276297,8342088,8473671,8539463,8605254,8736838,8802629,8933956,9000004,9065795,9197123,9263170,9328962,9460289,9526336,9592128,9723455,9789503,9855294,9986621,10052669,10183996,10250044,10315835,10447163,10513210,10579001,10710329,10776376,10842168,10973495,11039542,11105334,11236661,11302709,11434036,11499828,11565875,11697202,11762994,11829041,11960369,12026160,12092207,12223535,12289582,12355374,12486701,12552749,12684076,12749867,12815915,12947242,13013034,13079081,13210408,13276200,13342247,13473575,13539366,13605414,13736741,13802532,13934116,13999907,14065699,14197282,14263073,14329121,14460448,14526240,14592287,14723615,14789406,14855453,14986781,15052572,15184156,15249947,15315738,15447322,15513113,15578905,15710488,15776280,15842071,15973654,16039446,16105237,16236821,16302612,16434196]\n			}\n		}\n	]\n}'}),define("app/panels/EffectsPanel",["jquery","app/AnimatedMenu","app/ScrollMenu","app/controls/PreviewButton","slider","app/controls/SliderBox","app/controls/Button","app/controls/EffectButton","app/controls/IconButton","text!ui/panels/effects_panel.html","text!effects/aladin.pxs","text!effects/amber.pxs","text!effects/karen.pxs","text!effects/peter.pxs","text!effects/amy.pxs","text!effects/danie.pxs","text!effects/elenore.pxs","text!effects/penelope.pxs","text!effects/greg.pxs","text!effects/derek.pxs","text!effects/george.pxs","text!effects/gram.pxs","text!effects/joyce.pxs","text!effects/mio.pxs","text!effects/mirja.pxs","text!effects/subtle/adrian.pxs","text!effects/subtle/alex.pxs","text!effects/subtle/ian.pxs","text!effects/subtle/ingrid.pxs","text!effects/subtle/janine.pxs","text!effects/subtle/merissa.pxs","text!effects/subtle/ronny.pxs","text!effects/subtle/roxy.pxs","text!effects/subtle/sanna.pxs","text!effects/too_old/agatha.pxs","text!effects/too_old/agnes.pxs","text!effects/too_old/gordon.pxs","text!effects/too_old/harrison.pxs","text!effects/too_old/henry.pxs","text!effects/too_old/logan.pxs","text!effects/too_old/shaan.pxs","text!effects/vintage/borg.pxs","text!effects/vintage/carl.pxs","text!effects/vintage/doris.pxs","text!effects/vintage/doug.pxs","text!effects/vintage/earl.pxs","text!effects/vintage/harper.pxs","text!effects/vintage/jyler.pxs","text!effects/vintage/kevin.pxs","text!effects/vintage/lumina.pxs","text!effects/vintage/nash.pxs","text!effects/vintage/polak.pxs","text!effects/vintage/rusty.pxs","text!effects/vintage/satya.pxs","text!effects/vintage/stan.pxs","text!effects/vintage/sun.pxs","text!effects/default/anne.pxs","text!effects/default/antonio.pxs","text!effects/default/bob.pxs","text!effects/default/dean.pxs","text!effects/default/fred.pxs","text!effects/default/harry.pxs","text!effects/default/hagrid.pxs","text!effects/default/ivan.pxs","text!effects/default/jean.pxs","text!effects/default/josh.pxs","text!effects/default/julia.pxs","text!effects/default/lucas.pxs","text!effects/default/melissa.pxs","text!effects/default/ramona.pxs","text!effects/default/samantha.pxs","text!effects/default/sara.pxs","text!effects/default/salomon.pxs","text!effects/default/sophia.pxs","text!effects/default/tom.pxs","text!effects/default/tony.pxs","text!effects/tida.pxs","text!effects/soft/camille.pxs","text!effects/soft/hans.pxs","text!effects/soft/jessica.pxs","text!effects/soft/jones.pxs","text!effects/soft/laila.pxs","text!effects/soft/mary.pxs","text!effects/soft/per.pxs","text!effects/soft/robert.pxs","text!effects/soft/rose.pxs","text!effects/soft/sarah.pxs","text!effects/soft/thomas.pxs","text!effects/unicolor/chloe.pxs","text!effects/unicolor/ethan.pxs","text!effects/unicolor/james.pxs","text!effects/unicolor/jayden.pxs","text!effects/unicolor/jonathan.pxs","text!effects/unicolor/justin.pxs","text!effects/unicolor/kirsten.pxs","text!effects/unicolor/luke.pxs","text!effects/unicolor/ryan.pxs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut){function Jt(){function l(e){if(i.thumbnails[e]!=undefined)return;var t=Canvas.getImageWidth(),n=Canvas.getImageHeight();t/n<1.667?WebGL.setFramebufferSize($t,Math.round(250*n/t)):WebGL.setFramebufferSize(Math.round(150*t/n),150);if(e=="none")i.thumbnails.none=h(null,null);else{i.thumbnails[e]={};for(var r in zt[e])console.log("effect: "+r),i.thumbnails[e][r]=h(e,r)}WebGL.setFramebufferSize(t,n),WebGLShaders.setProgram("passthru")}function c(){console.log("rendering effect");var e=WebGLShaders.getProgram();gl.uniform1f(e.uAmount,i.amount_slider.getValue()/100),WebGL.drawScene()}function h(t,n){var r=null;return n&&(r=e.parseJSON(zt[t][n])),WebGLEffects.generateThumbnailForEffect(r).src}function p(t){function c(){WebGL.restoreDisplayTexture(),i.current_effect="none",i.effect_button.setTitle("None"),i.effect_button.setImage(i.thumbnails.none),WebGLShaders.setProgram("passthru"),WebGL.drawScene(),l(t);for(var s in zt[t]){var o=new r(e('<div id="'+s+'_effect_button"></div>'),m(s),i.thumbnails[t][s]);i.effect_buttons.push(o),o.click(function(){if(Vt.isDragging())return;console.log(e(this).data("id")),v(t,e(this).data("id"))})}Vt=new n("effects_menu","#effects_panel",i.effect_buttons,i.effect_button.getPos().x+i.effect_button.getWidth()/2,10),Vt.open()}i.effect_buttons=[],e("#effects_menu").html("");var s=!1,o=Math.ceil(i.effect_buttons.length/8)*95;i.current_category=="none"&&(s=!0),i.current_category=t;if(s)c();else{var u;for(var a=0;a<i.menu_buttons.length;a++){var f=i.menu_buttons[a];if(f.getId()==t){u=f;continue}f.fadeOut(200)}setTimeout(function(){e("#menu_button").css("z-index","auto"),u.setTargetPos(89.5,o+95),u.animate(),u.setEnabled(!1),setTimeout(function(){u.setEnabled(!0),i.menu_button.setTitle(m(t)),i.menu_button.setImage("/images/effects_preview_"+t+".png"),c(),setTimeout(function(){Xt.close()},0)},400)},0)}}function d(){i.menu_buttons.push(new u(e('<div id="classic_button"></div>'),"Classic","/images/effects_preview_classic.png")),i.menu_buttons.push(new u(e('<div id="subtle_button"></div>'),"Subtle","/images/effects_preview_subtle.png")),i.menu_buttons.push(new u(e('<div id="vintage_button"></div>'),"Vintage","/images/effects_preview_vintage.png")),i.menu_buttons.push(new u(e('<div id="aged_button"></div>'),"Aged","/images/effects_preview_aged.png")),i.menu_buttons.push(new u(e('<div id="unicolor_button"></div>'),"Unicolor","/images/effects_preview_unicolor.png")),i.menu_buttons.push(new u(e('<div id="soft_button"></div>'),"Soft","/images/effects_preview_soft.png"));for(var n=0;n<i.menu_buttons.length;n++){var r=i.menu_buttons[n];r.click(function(){var t=e(this).data("id");p(t)})}Xt=new t("packs_menu","#effects_panel",i.menu_buttons,i.menu_button.getPos().x+i.menu_button.getWidth()/2,10),p("classic")}function v(t,n){Canvas.loadCurrentImage();var r=e.parseJSON(zt[t][n]);WebGLEffects.setEffect(r,!1),Vt.close(),i.effect_button.setTitle(m(n)),i.effect_button.setImage(i.thumbnails[t][n]),i.current_effect=n,AnalyticsTracker.sendEvent("effect_"+n+"_select"),c()}function m(e){return e.charAt(0).toUpperCase()+e.slice(1)}this.__defineGetter__("type",function(){return"effects"}),this.current_effect="none",this.current_category="none",this.el=e(f),e("#menu").append(this.el),this.effect_buttons=[],this.menu_buttons=[],this.thumbnails={},this.panel_label=new a(e("#panel_label"),"Effects","/images/effects_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.amount_slider=new s(e("#amount_slider"),"Amount",0,100,100),this.amount_slider.setPos(279,0),this.cancel_button=new o(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(504,45),this.accept_button=new o(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(504,0),this.menu_button=new u(e("#menu_button"),"Classic","/images/effects_preview_classic.png"),this.menu_button.setPos(90,0),this.effect_button=new u(e("#effect_button"),"None",null),this.effect_button.setPos(185,0);var i=this;setTimeout(function(){l("none"),i.effect_button=new u(e("#effect_button"),"None",i.thumbnails.none),i.effect_button.setPos(185,0),i.effect_button.click(function(){Vt.isOpen()?Vt.close():(Vt.open(),Xt.close(),i.menu_button.setTitle(m(i.current_category)))}),d(),i.menu_button.click(function(){Xt.isOpen()?(Xt.animateClosed(),i.menu_button.setTitle(m(i.current_category))):(e("#menu_button").css("z-index",10),Vt.isOpen()&&Vt.close(),i.effect_button.setTitle(m(i.current_effect)),Xt.animateOpen())}),i.lastWidth=Canvas.getImageWidth(),i.lastHeight=Canvas.getImageHeight(),i.amount_slider.onchange(c),i.cancel_button.click(function(){i.exitPanel(),AnalyticsTracker.sendEvent("effect_cancel")}),i.accept_button.click(function(){i.accept(),AnalyticsTracker.sendEvent("effect_"+i.current_effect+"_apply")}),AnalyticsTracker.sendEvent("effect_select")},10),this.onResize=function(){Vt&&Vt.onResize()},e(window).resize(i.onResize),this.onResize()}var zt={classic:{aladin:l,amber:c,karen:h,peter:p,anne:nt,antonio:rt,bob:it,dean:st,fred:ot,harry:ut,hagrid:at,jean:lt,ivan:ft,josh:ct,julia:ht,lucas:pt,melissa:dt,ramona:vt,samantha:mt,sara:gt,salomon:yt,sophia:bt,tom:wt,tony:Et,greg:y},unicolor:{amy:d,danie:v,elenore:m,penelope:g,derek:b,george:w,gram:E,joyce:S,mio:x,mirja:T,tida:St,chloe:Pt,ethan:Ht,james:Bt,jayden:jt,jonathan:Ft,justin:It,kirsten:qt,luke:Rt,ryan:Ut},subtle:{adrian:N,alex:C,ian:k,ingrid:L,janine:A,merissa:O,ronny:M,roxy:_,sanna:D},aged:{agatha:P,agnes:H,gordon:B,harrison:j,henry:F,shaan:q,logan:I},vintage:{borg:R,carl:U,doris:z,doug:W,earl:X,harper:V,jyler:$,kevin:J,lumina:K,nash:Q,polak:G,rusty:Y,satya:Z,stan:et,sun:tt},soft:{camillie:xt,hans:Tt,jessica:Nt,jones:Ct,laila:kt,mary:Lt,per:At,robert:Ot,rose:Mt,sarah:_t,thomas:Dt}},Wt=new Array("adrian","antonio","alex","bob","dean","fred","ian","janine","ronny","roxy","sanna","agatha","agnes","gordon","harrison","shaan","logan","borg","carl","doris","earl","harper","jyler","kevin","lumina","nash","polak","rusty","satya","stan","sun","anne","harry","ivan","jean","josh","julia","salomon","sophia","camillie","hans","jessica","jones","laila","mary","per","robert","rose","sarah","thomas","jayden","ethan","chloe","ingrid","hagrid","sara","ramona","samantha","tony","melissa"),Xt,Vt,$t=250;return Jt.prototype.accept=function(e){History.commit("effects",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGLEffects.isTextureResized()&&WebGL.resize(Canvas.getImageWidth(),Canvas.getImageHeight()),WebGL.render(),WebGL.setEffectTexture(!0),this.exitPanel(!0),Canvas.saveCurrentImage(!1)},Jt.prototype.exitPanel=function(t){WebGLShaders.setProgram("passthru"),this.el.remove(),!t&&e.inArray(this.current_effect,Wt)!=-1&&(WebGL.restoreDisplayTexture(),WebGLEffects.isTextureResized()&&WebGL.resize(WebGL.getDisplayTexture().width,WebGL.getDisplayTexture().height));var n=this;e(window).off("resize",null,n.onResize),WebGL.drawScene(),MainMenu.show()},Jt.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},Jt.prototype.getWidth=function(){return this.el.width()},Jt.prototype.hide=function(){this.el.hide()},Jt.prototype.show=function(){this.el.show()},Jt}),define("text!ui/panels/blur_panel.html",[],function(){return'<div class="panel" id="blur_panel" style="\n	position:absolute;\n	width:440px;\n">\n\n<div id="panel_label"></div>\n\n<div id="amount_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/BlurPanel",["jquery","app/controls/IconButton","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/blur_panel.html"],function(e,t,n,r,i,s){function o(){function o(){a(),WebGL.setBlurTexture(n.blur_texture),WebGLShaders.setProgram("passthru"),WebGL.drawScene()}function u(){Canvas.loadCurrentImage(),n.exitPanel(!0)}function a(){WebGL.setBlurTexture(null),n.blur_value=n.amount_slider.getValue(),WebGLShaders.setProgram("blur");var e=WebGLShaders.getProgram(),t=[];if(n.textures.length==0&&n.framebuffers.length==0)for(var r=0;r<2;r++){var i=WebGL.createAndSetupTexture(gl);n.textures.push(i),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,Canvas.getImageWidth()/2,Canvas.getImageHeight()/2,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var s=gl.createFramebuffer();s.width=Canvas.getImageWidth()/2,s.height=Canvas.getImageHeight()/2,n.framebuffers.push(s),gl.bindFramebuffer(gl.FRAMEBUFFER,s),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,i,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}var o=n.amount_slider.getValue()/2;gl.bindTexture(gl.TEXTURE_2D,WebGL.getDisplayTexture()),WebGL.setFramebuffer(n.framebuffers[0],Canvas.getImageWidth()/2,Canvas.getImageHeight()/2),gl.uniform2fv(e.delta,[o/Canvas.getImageWidth(),0]),t.push(WebGL.getDisplayTexture()),WebGL.drawTexture(t),gl.bindTexture(gl.TEXTURE_2D,n.textures[0]),WebGL.setFramebuffer(n.framebuffers[1],Canvas.getImageWidth()/2,Canvas.getImageHeight()/2),gl.uniform2fv(e.delta,[0,o/Canvas.getImageHeight()]),t=[],t.push(n.textures[0]),WebGL.drawTexture(t),gl.bindTexture(gl.TEXTURE_2D,null),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),n.blur_texture=n.textures[1]}this.__defineGetter__("type",function(){return"blur"}),this.el=e(s),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Blur","/images/blur_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.amount_slider=new r(e("#amount_slider"),"Amount",0,100,25,1),this.amount_slider.setPos(90,0),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(315,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(315,0),this.blur_texture=null,this.textures=[],this.framebuffers=[],this.blur_value=0;var n=this;setTimeout(function(){n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),o(),n.amount_slider.mouseup(o),n.cancel_button.click(function(){u(),AnalyticsTracker.sendEvent("adjustment_blur_cancel")}),n.accept_button.click(function(){n.accept(),AnalyticsTracker.sendEvent("adjustment_blur_apply")}),AnalyticsTracker.sendEvent("adjustment_blur_select")},10)}return o.prototype.releaseFramebuffer=function(){gl.deleteFramebuffer(this.framebuffers[0]),gl.deleteFramebuffer(this.framebuffers[1]),gl.deleteTexture(this.textures[0]),gl.deleteTexture(this.textures[1]),gl.deleteTexture(this.blur_texture)},o.prototype.accept=function(){History.commit("blur",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.exitPanel(!1),Canvas.saveCurrentImage()},o.prototype.exitPanel=function(e){this.el.remove(),MainMenu.show(),WebGL.setBlurTexture(null),WebGLShaders.setProgram("passthru"),WebGL.drawScene(),e&&this.releaseFramebuffer()},o.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},o.prototype.getWidth=function(){return this.el.width()},o.prototype.hide=function(){this.el.hide()},o.prototype.show=function(){this.el.show()},o}),define("text!ui/panels/overlay_panel.html",[],function(){return'<div class="panel" id="overlay_panel" style="\n	position:absolute;\n	width:684px;\n">\n\n<div id="panel_label"></div>\n\n<div id="menu_button"></div>\n<div id="overlay_button"></div>\n<div id="amount_slider"></div>\n<div id="rotate_right_button"></div>\n<div id="rotate_left_button"></div>\n<div id="flip_horizontal_button"></div>\n<div id="flip_vertical_button"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n\n\n<div id="categories_menu" style="display:none;position:absolute;bottom:95px;left:-200px;">\n	<div id=\'bokeh_button\'></div>\n	<div id=\'canvas_button\'></div>\n	<div id=\'chem_burn_button\'></div>\n	<div id=\'color_correction_button\'></div>\n	<div id=\'default_button\'></div>\n	<div id=\'fireworks_button\'></div>\n</div>\n\n<div id="overlay_menu" style="display:none;position:absolute;bottom:190px;left:-175px;">\n</div>\n\n</div>'}),define("app/panels/OverlayPanel",["jquery","app/controls/IconButton","app/AnimatedMenu","app/ScrollMenu","app/controls/PreviewButton","slider","app/controls/SliderBox","app/controls/Button","app/controls/EffectButton","app/controls/IconButton","text!ui/panels/overlay_panel.html"],function(e,t,n,r,i,s,o,u,a,t,f){function p(){function h(){var e=Canvas.getImageWidth(),t=Canvas.getImageHeight();e/t<1.7?WebGL.setFramebufferSize(170,Math.round(170*t/e)):WebGL.setFramebufferSize(Math.round(100*e/t),100),s.overlays.none=WebGLEffects.generateThumbnailForEffect(null).src,WebGL.setFramebufferSize(e,t)}function p(){var e=0;s.base_rotation=[Math.cos(e/180*Math.PI),Math.sin(e/180*Math.PI)],b(!1)}function d(){var e=180;s.base_rotation=[Math.cos(e/180*Math.PI),Math.sin(e/180*Math.PI)],b(!1)}function v(){s.hflip=!s.hflip,s.base_rotation=[0,1],b(!0),s.hflip=!1}function m(){s.vflip=!s.vflip,s.base_rotation=[0,1],b(!0),s.vflip=!1}function g(){console.log("rendering effect");var e=WebGLShaders.getProgram();gl.uniform1f(e.amount,s.amount_slider.getValue()/100),WebGL.drawScene()}function y(t){function d(e,t){var n="/overlay/"+e+"/"+s.overlays[e][t],r=s.overlays[e][t].indexOf("_")+1,i=s.overlays[e][t].indexOf("."),o=s.overlays[e][t].substring(r,i),u;switch(o){case"add":s.blendMode=1;break;case"multiply":s.blendMode=2;break;case"screen":s.blendMode=3;break;case"darken":s.blendMode=4;break;case"lighten":s.blendMode=5;break;case"overlay":s.blendMode=6;break;case"softlight":s.blendMode=7;break;case"hardlight":s.blendMode=8}console.log(s.blendMode);var a=WebGLShaders.setProgram("blend",s.blendMode),f=gl.getUniformLocation(a,"Sample0"),l=gl.getUniformLocation(a,"Sample1");gl.uniform1i(f,0),gl.uniform1i(l,1),gl.uniform1f(a.amount,s.amount_slider.getValue()/100);var h=new Image;h.onload=function(){s.overlayTexture!=null&&gl.deleteTexture(s.overlayTexture),s.overlayTexture=gl.createTexture(),WebGL.handleLoadedTexture(s.overlayTexture,h,!0,h.width,h.height,!0),s.overlayWidth=h.width,s.overlayHeight=h.height,gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,s.overlayTexture),WebGL.drawScene()},h.src=n,c.close(),s.overlay_button.setTitle(S(t.replace("_"," "))),s.overlay_button.setImage(n),s.current_overlay=t,AnalyticsTracker.sendEvent("overlay_"+t+"_select")}function v(){WebGL.restoreDisplayTexture(),s.overlayTexture!=null&&(gl.deleteTexture(s.overlayTexture),s.overlayTexture=null),s.current_overlay="none",s.overlay_button.setTitle("None"),s.overlays["none"]["none"]==""&&h(),s.overlay_button.setImage(s.overlays.none),WebGLShaders.setProgram("passthru"),WebGL.drawScene();for(var n in s.overlays[t]){var o=new i(e('<div id="'+n+'_overlay_button"></div>'),S(n),"/overlay/"+t+"/thumb/"+s.overlays[t][n]);s.overlay_buttons.push(o),o.click(function(){if(c.isDragging())return;console.log(e(this).data("id")),d(t,e(this).data("id"))})}c=new r("overlays_menu","#overlay_panel",s.overlay_buttons,s.overlay_button.getPos().x+s.overlay_button.getWidth()/2,10),c.open()}s.overlay_buttons=[],e("#overlay_menu").html("");var n=!1,o=Math.ceil(s.overlay_buttons.length/8)*95;s.current_category=="none"&&(n=!0),s.current_category=t;if(n)v();else{var u;for(var a=0;a<s.menu_buttons.length;a++){var f=s.menu_buttons[a],p=f.getId();p=p.replace(" ","_"),console.log("which: "+t+" - id: "+p);if(p==t){u=f;continue}f.fadeOut(200)}setTimeout(function(){e("#menu_button").css("z-index","auto"),u.setTargetPos(89.5,o+95),u.animate(),u.setEnabled(!1),setTimeout(function(){u.setEnabled(!0),s.menu_button.setTitle(S(t.replace("_"," "))),s.menu_button.setImage("/images/overlay_preview_"+t+".jpg"),v(t),setTimeout(function(){l.close()},0)},400)},0)}}function b(e){if(s.overlayTexture==null)return;w(e);var t=WebGLShaders.setProgram("blend",s.blendMode),n=gl.getUniformLocation(t,"Sample0"),r=gl.getUniformLocation(t,"Sample1");gl.uniform1i(n,0),gl.uniform1i(r,1),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,s.overlayTexture),gl.uniform1f(t.amount,s.amount_slider.getValue()/100),WebGL.drawScene()}function w(e){WebGLShaders.setProgram("passthru");var t=WebGLShaders.getProgram(),n=[],r=e?s.overlayWidth:s.overlayHeight,i=e?s.overlayHeight:s.overlayWidth,o=WebGL.createAndSetupTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,r,i,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var u=gl.createFramebuffer();u.width=r,u.height=i,gl.bindFramebuffer(gl.FRAMEBUFFER,u),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,o,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.bindTexture(gl.TEXTURE_2D,s.overlayTexture),WebGL.setFramebuffer(u,u.width,u.height),n.push(s.overlayTexture);var a=u.height/u.width,f=e?s.hflip?-1:1:a*(s.hflip?-1:1),l=e?s.vflip?-1:1:1/(a*(s.vflip?-1:1));WebGL.drawTexture(n,s.base_rotation,f,l,u.width,u.height),gl.bindTexture(gl.TEXTURE_2D,null),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),gl.deleteTexture(s.overlayTexture),s.overlayTexture=o,s.overlayHeight=u.height,s.overlayWidth=u.width}function E(){s.menu_buttons.push(new a(e('<div id="classic_button"></div>'),"Classic","/images/overlay_preview_classic.jpg")),s.menu_buttons.push(new a(e('<div id="vignette_button"></div>'),"Vignette","/images/overlay_preview_vignette.jpg")),s.menu_buttons.push(new a(e('<div id="light_paint_button"></div>'),"Light paint","/images/overlay_preview_light_paint.jpg")),s.menu_buttons.push(new a(e('<div id="bokeh_button"></div>'),"Bokeh","/images/overlay_preview_bokeh.jpg")),s.menu_buttons.push(new a(e('<div id="fireworks_button"></div>'),"Fireworks","/images/overlay_preview_fireworks.jpg")),s.menu_buttons.push(new a(e('<div id="leaking_button"></div>'),"Leaking","/images/overlay_preview_leaking.jpg"));for(var t=0;t<s.menu_buttons.length;t++){var r=s.menu_buttons[t];r.click(function(){var t=e(this).data("id");y(t)})}l=new n("packs_menu","#overlay_panel",s.menu_buttons,s.menu_button.getPos().x+s.menu_button.getWidth()/2,10),y("classic")}function S(e){return e.charAt(0).toUpperCase()+e.slice(1)}this.__defineGetter__("type",function(){return"overlay"}),this.current_overlay="none",this.current_category="none",this.el=e(f),e("#menu").append(this.el),this.overlay_buttons=[],this.menu_buttons=[],this.overlays={none:{none:""},classic:{beep:"beep_screen.jpg",bocea:"bocea_overlay.jpg",bubble:"bubble_overlay.jpg",burn:"burn_overlay.jpg",cyborg:"cyborg_screen.jpg",devine:"devine_overlay.jpg",focal:"focal_add.jpg",foggy:"foggy_lighten.jpg",gaze:"gaze_screen.jpg",glitter:"glitter_screen.jpg",kryptonite:"kryptonite_overlay.jpg",leak:"leak_screen.jpg",local:"local_screen.jpg",metal:"metal_overlay.jpg",morning:"morning_overlay.jpg",paint:"paint_overlay.jpg",rain:"rain_overlay.jpg",rainbow:"rainbow_overlay.jpg",redrum:"redrum_screen.jpg",scratches:"scratches_overlay.jpg",shine:"shine_overlay.jpg",stop:"stop_screen.jpg",street:"street_screen.jpg",stripe:"stripe_screen.jpg",subtle:"subtle_screen.jpg",trails:"trails_screen.jpg",twinkle:"twinkle_screen.jpg",vignette:"vignette_multiply.jpg",wave:"wave_overlay.jpg",worn:"worn_screen.jpg"},vignette:{ball:"ball_multiply.jpg",bronze:"bronze_multiply.jpg",center:"center_multiply.jpg",clean:"clean_multiply.jpg",dim:"dim_multiply.jpg",frame:"frame_multiply.jpg",horizon:"horizon_multiply.jpg",light:"light_add.jpg",opposite:"opposite_multiply.jpg",parallele:"parallele_multiply.jpg",redone:"redone_multiply.jpg",small:"small_multiply.jpg",soft:"soft_multiply.jpg",standards:"standards_multiply.jpg",uneven:"uneven_multiply.jpg"},light_paint:{co:"co_add.jpg",free:"free_add.jpg",home:"home_add.jpg",hope:"hope_add.jpg",joy:"joy_add.jpg",love:"love_add.jpg",lovenpeace:"lovenpeace_add.jpg",moon:"moon_add.jpg",moonstar:"moonstar_add.jpg",peacenlove:"peacenlove_add.jpg",pinkjoy:"pinkjoy_add.jpg",pinksexy:"pinksexy_add.jpg",scribble:"scribble_add.jpg",sexy:"sexy_add.jpg",sohope:"sohope_add.jpg",spin:"spin_add.jpg",tinylove:"tinylove_add.jpg",twister:"twister_add.jpg",wave:"wave_add.jpg",wiggle:"wiggle_add.jpg"},bokeh:{birds:"birds_lighten.jpg",butterfly:"butterfly_overlay.jpg",citrus:"citrus_multiply.jpg",dewy:"dewy_multiply.jpg",dreamscape:"dreamscape_multiply.jpg",morning:"morning_overlay.jpg",night:"night_overlay.jpg",princess:"princess_overlay.jpg",sign:"sign_screen.jpg",spiderweb:"spiderweb_overlay.jpg",stars:"stars_overlay.jpg",summer:"summer_screen.jpg"},leaking:{after:"after_screen.jpg",cool:"cool_screen.jpg",focal:"focal_screen.jpg",gazer:"gazer_screen.jpg",glocal:"glocal_screen.jpg",orange:"orange_screen.jpg",ovverride:"ovverride_screen.jpg",pop:"pop_screen.jpg",rad:"rad_screen.jpg",road:"road_screen.jpg",rose:"rose_add.jpg",sided:"sided_add.jpg",spotty:"spotty_add.jpg",strike:"strike_add.jpg",sunday:"sunday_screen.jpg"},fireworks:{amaze:"amaze_lighten.jpg",burst:"burst_lighten.jpg",engage:"engage_lighten.jpg",excited:"excited_lighten.jpg",fever:"fever_lighten.jpg",forward:"forward_lighten.jpg",fun:"fun_lighten.jpg",games:"games_lighten.jpg",giggle:"giggle_lighten.jpg",happening:"happening_lighten.jpg",happy:"happy_lighten.jpg",join:"join_lighten.jpg",joy:"joy_lighten.jpg",party:"party_lighten.jpg",play:"play_lighten.jpg",rise:"rise_lighten.jpg",shout:"shout_lighten.jpg",standout:"standout_lighten.jpg",upwards:"upwards_lighten.jpg"}},this.panel_label=new t(e("#panel_label"),"Overlays","/images/overlays_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.amount_slider=new o(e("#amount_slider"),"Amount",0,100,100),this.amount_slider.setPos(369,0),this.cancel_button=new u(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(594,45),this.accept_button=new u(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(594,0),this.menu_button=new a(e("#menu_button"),"Classic","/images/overlay_preview_classic.jpg"),this.menu_button.setPos(90,0),this.overlay_button=new a(e("#overlay_button"),"None",null),this.overlay_button.setPos(185,0),this.flip_horizontal_button=new u(e("#flip_horizontal_button"),null,"/images/horizontal_icon.png",40,undefined,19,19,!1),this.flip_horizontal_button.setPos(279,0),this.flip_vertical_button=new u(e("#flip_vertical_button"),null,"/images/vertical_icon.png",40,undefined,19,19,!1),this.flip_vertical_button.setPos(324,0),this.rotate_left_button=new u(e("#rotate_left_button"),null,"/images/left_icon.png",40,undefined,19,19,!1),this.rotate_left_button.setPos(279,45),this.rotate_right_button=new u(e("#rotate_right_button"),null,"/images/right_icon.png",40,undefined,19,19,!1),this.rotate_right_button.setPos(324,45),this.overlayTexture=null,this.base_rotation=[0,1],this.blendMode=null,this.overlayWidth=0,this.overlayHeight=0,this.vflip=!1,this.hflip=!1;var s=this;setTimeout(function(){h(),s.overlay_button=new a(e("#overlay_button"),"None",s.overlays.none),s.overlay_button.setPos(185,0),s.overlay_button.click(function(){c.isOpen()?c.close():(c.open(),l.close(),s.menu_button.setTitle(S(s.current_category)))}),E(),s.menu_button.click(function(){l.isOpen()?(l.animateClosed(),s.menu_button.setTitle(S(s.current_category))):(e("#menu_button").css("z-index",10),c.isOpen()&&c.close(),s.overlay_button.setTitle(S(s.current_overlay)),l.animateOpen())}),s.lastWidth=Canvas.getImageWidth(),s.lastHeight=Canvas.getImageHeight(),s.amount_slider.onchange(g),s.flip_horizontal_button.click(v),s.flip_vertical_button.click(m),s.rotate_right_button.click(p),s.rotate_left_button.click(d),s.cancel_button.click(function(){s.exitPanel(),AnalyticsTracker.sendEvent("overlay_cancel")}),s.accept_button.click(function(){s.accept(),AnalyticsTracker.sendEvent("overlay_"+s.current_overlay+"_apply")}),AnalyticsTracker.sendEvent("overlay_select")},10),this.onResize=function(){c&&c.onResize()},e(window).resize(s.onResize),this.onResize()}var l,c,h=250;return p.prototype.accept=function(e){History.commit("overlay",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.exitPanel(!0),Canvas.saveCurrentImage(!1)},p.prototype.exitPanel=function(t){WebGLShaders.setProgram("passthru"),this.el.remove(),this.overlayTexture!=null&&(gl.deleteTexture(this.overlayTexture),this.overlayTexture=null);var n=this;e(window).off("resize",null,n.onResize),WebGL.drawScene(),MainMenu.show()},p.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},p.prototype.getWidth=function(){return this.el.width()},p.prototype.hide=function(){this.el.hide()},p.prototype.show=function(){this.el.show()},p}),define("text!ui/panels/sharpen_panel.html",[],function(){return'<div class="panel" id="sharpen_panel" style="\n	position:absolute;\n	width:550px;\n">\n\n<div id="panel_label"></div>\n\n<div id="amount_slider"></div>\n<div id="radius_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/SharpenPanel",["jquery","app/controls/IconButton","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/sharpen_panel.html"],function(e,t,n,r,i,s){function o(){function o(){f();if(n.blur_texture!=null){var e=WebGLShaders.setProgram("unsharpmask");gl.uniform1f(e.amount,n.amount_slider.getValue()/100),gl.uniform1i(e.blurredTexture,1),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,n.blur_texture),WebGL.drawScene()}}function u(){o()}function a(){o()}function f(){if(n.blur_value==n.radius_slider.getValue())return;n.blur_value=n.radius_slider.getValue()*10,WebGLShaders.setProgram("blur");var e=WebGLShaders.getProgram(),t=[];if(n.textures.length==0&&n.framebuffers.length==0)for(var r=0;r<2;r++){var i=WebGL.createAndSetupTexture(gl);n.textures.push(i),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,Canvas.getImageWidth()/2,Canvas.getImageHeight()/2,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var s=gl.createFramebuffer();s.width=Canvas.getImageWidth()/2,s.height=Canvas.getImageHeight()/2,n.framebuffers.push(s),gl.bindFramebuffer(gl.FRAMEBUFFER,s),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,i,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}gl.bindTexture(gl.TEXTURE_2D,WebGL.getDisplayTexture()),WebGL.setFramebuffer(n.framebuffers[0],Canvas.getImageWidth()/2,Canvas.getImageHeight()/2),gl.uniform2fv(e.delta,[n.radius_slider.getValue()/Canvas.getImageWidth(),0]),t.push(WebGL.getDisplayTexture()),WebGL.drawTexture(t),gl.bindTexture(gl.TEXTURE_2D,n.textures[0]),WebGL.setFramebuffer(n.framebuffers[1],Canvas.getImageWidth()/2,Canvas.getImageHeight()/2),gl.uniform2fv(e.delta,[0,n.radius_slider.getValue()/Canvas.getImageHeight()]),t=[],t.push(n.textures[0]),WebGL.drawTexture(t),gl.bindTexture(gl.TEXTURE_2D,null),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),n.blur_texture=n.textures[1]}function l(){Canvas.loadCurrentImage(),WebGLShaders.setProgram("passthru"),WebGL.drawScene(),n.exitPanel(!0)}this.__defineGetter__("type",function(){return"sharpen"}),this.el=e(s),e("#menu").append(this.el),this.panel_label=new t(e("#panel_label"),"Sharpen","/images/sharpen_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.amount_slider=new r(e("#amount_slider"),"Amount",0,200,50,1),this.amount_slider.setPos(90,0),this.radius_slider=new r(e("#radius_slider"),"Radius",5,20,10,.1),this.radius_slider.setPos(315,0),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(540,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(540,0);var n=this;this.blur_texture=null,this.textures=[],this.framebuffers=[],this.blur_value=0,setTimeout(function(){n.lastWidth=Canvas.getImageWidth(),n.lastHeight=Canvas.getImageHeight(),n.amount_slider.mouseup(u),n.radius_slider.mouseup(a),n.cancel_button.click(function(){l(),AnalyticsTracker.sendEvent("adjustment_sharpen_cancel")}),n.accept_button.click(function(){n.accept(),AnalyticsTracker.sendEvent("adjustment_sharpen_apply")}),AnalyticsTracker.sendEvent("adjustment_sharpen_select"),o()},10)}return o.prototype.releaseFramebuffer=function(){gl.deleteFramebuffer(this.framebuffers[0]),gl.deleteFramebuffer(this.framebuffers[1]),gl.deleteTexture(this.textures[0]),gl.deleteTexture(this.textures[1]),gl.deleteTexture(this.blurTexture)},o.prototype.accept=function(){History.commit("sharpen",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),this.releaseFramebuffer(),this.exitPanel(),Canvas.saveCurrentImage()},o.prototype.exitPanel=function(e){WebGLShaders.setProgram("passthru"),this.el.remove(),MainMenu.show(),e&&this.releaseFramebuffer()},o.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},o.prototype.getWidth=function(){return this.el.width()},o.prototype.hide=function(){this.el.hide()},o.prototype.show=function(){this.el.show()},o}),define("text!ui/panels/airbrush_panel.html",[],function(){return'<div class="panel" id="airbrush_panel" style="\n	position:absolute;\n	width:735px;\n">\n\n<div id="panel_label"></div>\n\n<div id="brush_button"></div>\n<div id="erase_button"></div>\n<div id="brushsize_slider"></div>\n<div id="intensity_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/AirbrushPanel",["jquery","slider","app/controls/ButtonGroupSelect","app/controls/SliderBox","app/controls/Button","text!ui/panels/airbrush_panel.html","app/controls/IconButton","app/image/ColorMatrix"],function(e,t,n,r,i,s,o,u){function a(){function a(){t.cached_texture!=null&&gl.deleteTexture(t.cached_texture),t.cached_texture=gl.createTexture(),t.cached_image=Canvas.getCurrentImage(),WebGL.handleLoadedTexture(t.cached_texture,t.cached_image,!1,Canvas.getImageWidth(),Canvas.getImageHeight(),!0)}function f(){var e=Math.round(Canvas.getImageWidth()),n=Math.round(Canvas.getImageHeight());if(t.textures.length==0&&t.framebuffers.length==0)for(var r=0;r<2;r++){var i=WebGL.createAndSetupTexture(gl);t.textures.push(i),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,e,n,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var s=gl.createFramebuffer();s.width=e,s.height=n,t.framebuffers.push(s),gl.bindFramebuffer(gl.FRAMEBUFFER,s),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,i,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}}function l(e){WebGLShaders.setProgram("blur");var n=WebGLShaders.getProgram(),r=[];f();var i=e,s=Math.round(Canvas.getImageWidth()),o=Math.round(Canvas.getImageHeight());gl.bindTexture(gl.TEXTURE_2D,WebGL.getDisplayTexture()),WebGL.setFramebuffer(t.framebuffers[0],s,o),gl.uniform2fv(n.delta,[i/Canvas.getImageWidth(),0]),r.push(WebGL.getDisplayTexture()),WebGL.drawTexture(r),gl.bindTexture(gl.TEXTURE_2D,t.textures[0]),WebGL.setFramebuffer(t.framebuffers[1],s,o),gl.uniform2fv(n.delta,[0,i/Canvas.getImageHeight()]),r=[],r.push(t.textures[0]),WebGL.drawTexture(r),gl.bindTexture(gl.TEXTURE_2D,null),t.pixels==null&&(t.pixels=new Uint8Array(s*o*4)),gl.readPixels(0,0,s,o,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels);var u=gl.createTexture();return WebGL.handleLoadedTexture(u,t.pixels,!1,s,o,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),u}function c(e,n,r){switch(r){case"add":WebGLShaders.setProgram("blend",1);break;case"substract":WebGLShaders.setProgram("blend",11)}var i=WebGLShaders.getProgram(),s=gl.getUniformLocation(i,"Sample0"),o=gl.getUniformLocation(i,"Sample1");gl.uniform1i(s,0),gl.uniform1i(o,1);var u=[];u.push(e),u.push(n),f();var a=Math.round(Canvas.getImageWidth()),l=Math.round(Canvas.getImageHeight());WebGL.setFramebuffer(t.framebuffers[0],a,l),WebGL.drawTexture(u),t.pixels==null&&(t.pixels=new Uint8Array(a*l*4)),gl.readPixels(0,0,a,l,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels);var c=gl.createTexture();return WebGL.handleLoadedTexture(c,t.pixels,!1,a,l,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),c}function h(e){var n=WebGLShaders.setProgram("colormatrix"),r=new u;r=r.BlackAndWhite(.333,.333,.333),gl.uniformMatrix4fv(n.colormatrix,!1,r);var i=[];i.push(e),f();var s=Math.round(Canvas.getImageWidth()),o=Math.round(Canvas.getImageHeight());return WebGL.setFramebuffer(t.framebuffers[0],s,o),WebGL.drawTexture(i),gl.deleteTexture(e),t.pixels==null&&(t.pixels=new Uint8Array(s*o*4)),gl.readPixels(0,0,s,o,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels),e=gl.createTexture(),WebGL.handleLoadedTexture(e,t.pixels,!1,s,o,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function p(e,n){var r=0,i=255/n,s=new Array(256),o=new Array(256),u=new Array(256),a;while(r<256)a=Math.round(r*i),a<0?a=0:a>255&&(a=255),s[r]=a<<16,o[r]=a<<8,u[r]=a,r++;console.log(s),console.log(o),console.log(u);var l=WebGLEffects.createTextureFromRawRGB(s,"red",!0),c=WebGLEffects.createTextureFromRawRGB(o,"green",!0),h=WebGLEffects.createTextureFromRawRGB(u,"blue",!0),p=WebGLShaders.setProgram("autofix");gl.uniform1i(p.uRed,1),gl.uniform1i(p.uGreen,2),gl.uniform1i(p.uBlue,3),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,l),gl.activeTexture(gl.TEXTURE0+2),gl.bindTexture(gl.TEXTURE_2D,c),gl.activeTexture(gl.TEXTURE0+3),gl.bindTexture(gl.TEXTURE_2D,h);var d=[];d.push(e),d.push(l),d.push(c),d.push(h),f();var v=Math.round(Canvas.getImageWidth()),m=Math.round(Canvas.getImageHeight());return WebGL.setFramebuffer(t.framebuffers[0],v,m),WebGL.drawTexture(d),gl.deleteTexture(e),t.pixels==null&&(t.pixels=new Uint8Array(v*m*4)),gl.readPixels(0,0,v,m,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels),e=gl.createTexture(),WebGL.handleLoadedTexture(e,t.pixels,!1,v,m,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function d(e){WebGLShaders.setProgram("invert");var n=[];n.push(e),f();var r=Math.round(Canvas.getImageWidth()),i=Math.round(Canvas.getImageHeight());return WebGL.setFramebuffer(t.framebuffers[0],r,i),WebGL.drawTexture(n),gl.deleteTexture(e),t.pixels==null&&(t.pixels=new Uint8Array(r*i*4)),gl.readPixels(0,0,r,i,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels),e=gl.createTexture(),WebGL.handleLoadedTexture(e,t.pixels,!1,r,i,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function v(e){WebGLShaders.setProgram("copychanel");var n=[];n.push(e),f();var r=Math.round(Canvas.getImageWidth()),i=Math.round(Canvas.getImageHeight());return WebGL.setFramebuffer(t.framebuffers[0],r,i),WebGL.drawTexture(n),gl.deleteTexture(e),t.pixels==null&&(t.pixels=new Uint8Array(r*i*4)),gl.readPixels(0,0,r,i,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels),e=gl.createTexture(),WebGL.handleLoadedTexture(e,t.pixels,!1,r,i,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function m(e,n){var r=WebGLShaders.setProgram("copypixel");gl.uniform1i(r.sourceTexture,1),gl.uniform1i(r.alphaTexture,2),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,e),gl.activeTexture(gl.TEXTURE0+2),gl.bindTexture(gl.TEXTURE_2D,n);var i=[];i.push(WebGL.getDisplayTexture()),i.push(e),i.push(n),f();var s=Math.round(Canvas.getImageWidth()),o=Math.round(Canvas.getImageHeight());WebGL.setFramebuffer(t.framebuffers[0],s,o),WebGL.drawTexture(i),t.pixels==null&&(t.pixels=new Uint8Array(s*o*4)),gl.readPixels(0,0,s,o,gl.RGBA,gl.UNSIGNED_BYTE,t.pixels);var u=gl.createTexture();return WebGL.handleLoadedTexture(u,t.pixels,!1,s,o,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),u}function g(){var e=(Canvas.getImageWidth()+Canvas.getImageHeight())/2048*12,n=l(e),r=l(e/2),i=c(n,r,"substract"),s=c(r,n,"substract");gl.deleteTexture(r),r=s,r=h(r),i=h(i);var o=c(r,i,"add");gl.deleteTexture(i),gl.deleteTexture(r),r=o,r=p(r,Math.round(e)),r=d(r),r=v(r),t.blur_texture=m(n,r),gl.deleteTexture(n),gl.deleteTexture(r)}function y(){Canvas.setCurrentImage(t.cached_image),Canvas.loadCurrentImage(),t.exitPanel()}function b(){PaintCanvas.setBrushSize(t.brushsize_slider.getValue())}function w(){PaintCanvas.setBrushIntensity(t.intensity_slider.getValue())}this.__defineGetter__("type",function(){return"airbrush"}),this.el=e(s),e("#menu").append(this.el),e("#menu").css("pointer-events","none"),this.el.css("pointer-events","auto"),PaintCanvas.setEnabled(!0),this.panel_label=new o(e("#panel_label"),"Airbrush","/images/airbrush_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.brush_button=new i(e("#brush_button"),"Brush","/images/brush_icon.png",90),this.brush_button.setPos(90,0),this.erase_button=new i(e("#erase_button"),"Erase","/images/eraser_icon.png",90),this.erase_button.setPos(90,45),this.brushsize_slider=new r(e("#brushsize_slider"),"Brush size",3,100,35,1),this.brushsize_slider.setPos(185,0),this.intensity_slider=new r(e("#intensity_slider"),"Intensity",0,100,75,1),this.intensity_slider.setPos(410,0),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(635,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(635,0),this.brush_mode=0,this.masking_texture=null,this.blur_texture=null,this.textures=[],this.framebuffers=[],this.cached_texture=null,this.cached_image=null,this.pixels=null;var t=this;setTimeout(function(){t.lastWidth=Canvas.getImageWidth(),t.lastHeight=Canvas.getImageHeight(),t.brushsize_slider.mouseup(b),t.intensity_slider.mouseup(w),t.cancel_button.click(function(){y(),AnalyticsTracker.sendEvent("adjustment_airbrush_cancel")}),t.accept_button.click(function(){t.accept(),AnalyticsTracker.sendEvent("adjustment_airbrush_apply")}),AnalyticsTracker.sendEvent("adjustment_airbrush_select"),t.onBrushEraseClicked=function(e){WebGL.render(),Canvas.saveCurrentImage(),PaintCanvas.clearAirbrushCanvas();switch(e){case"brush_button":t.brush_mode=0;break;case"erase_button":t.brush_mode=1}},t.selectGroup=new n([t.brush_button,t.erase_button],t.brush_button,t.onBrushEraseClicked),a(),g(),WebGLShaders.setProgram("passthru")},10),b()}return a.prototype.releaseResources=function(){this.cached_texture!=null&&gl.deleteTexture(this.cached_texture),this.blur_texture!=null&&gl.deleteTexture(this.blur_texture),gl.deleteFramebuffer(this.framebuffers[0]),gl.deleteFramebuffer(this.framebuffers[1]),gl.deleteTexture(this.textures[0]),gl.deleteTexture(this.textures[1])},a.prototype.generateMaskingTexture=function(e){this.masking_texture=e},a.prototype.render=function(){var e=WebGLShaders.setProgram("copypixel");this.brush_mode==0?(gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,this.blur_texture),gl.uniform1i(e.sourceTexture,1),gl.activeTexture(gl.TEXTURE2),gl.bindTexture(gl.TEXTURE_2D,this.masking_texture),gl.uniform1i(e.alphaTexture,2)):(gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,this.cached_texture),gl.uniform1i(e.sourceTexture,1),gl.activeTexture(gl.TEXTURE2),gl.bindTexture(gl.TEXTURE_2D,this.masking_texture),gl.uniform1i(e.alphaTexture,2)),WebGL.drawScene()},a.prototype.accept=function(){History.commit("airbrush",this.cached_image,this.lastWidth,this.lastHeight),WebGL.render(),Canvas.saveCurrentImage(),this.exitPanel()},a.prototype.exitPanel=function(){this.el.remove(),WebGLShaders.setProgram("passthru"),WebGL.drawScene(),MainMenu.show(),PaintCanvas.clearAirbrushCanvas(),PaintCanvas.setEnabled(!1),e("#menu").css("pointer-events","auto"),this.releaseResources()},a.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},a.prototype.getWidth=function(){return this.el.width()},a.prototype.hide=function(){this.el.hide()},a.prototype.show=function(){this.el.show()},a}),define("text!ui/panels/denoise_panel.html",[],function(){return'<div class="panel" id="denoise_panel" style="\n	position:absolute;\n	width:440px;\n">\n\n<div id="panel_label"></div>\n\n<div id="amount_slider"></div>\n\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/DenoisePanel",["jquery","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/denoise_panel.html","app/controls/IconButton","app/image/ColorMatrix"],function(e,t,n,r,i,s,o){function u(){function u(){var e=Math.round(Canvas.getImageWidth()/2),n=Math.round(Canvas.getImageHeight()/2);if(t.textures.length==0&&t.framebuffers.length==0)for(var r=0;r<2;r++){var i=WebGL.createAndSetupTexture(gl);t.textures.push(i),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,e,n,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var s=gl.createFramebuffer();s.width=e,s.height=n,t.framebuffers.push(s),gl.bindFramebuffer(gl.FRAMEBUFFER,s),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,i,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}}function a(e){WebGLShaders.setProgram("blur");var n=WebGLShaders.getProgram(),r=[];u();var i=e,s=Math.round(Canvas.getImageWidth()/2),o=Math.round(Canvas.getImageHeight()/2);gl.bindTexture(gl.TEXTURE_2D,WebGL.getDisplayTexture()),WebGL.setFramebuffer(t.framebuffers[0],s,o),gl.uniform2fv(n.delta,[i/Canvas.getImageWidth(),0]),r.push(WebGL.getDisplayTexture()),WebGL.drawTexture(r),gl.bindTexture(gl.TEXTURE_2D,t.textures[0]),WebGL.setFramebuffer(t.framebuffers[1],s,o),gl.uniform2fv(n.delta,[0,i/Canvas.getImageHeight()]),r=[],r.push(t.textures[0]),WebGL.drawTexture(r),gl.bindTexture(gl.TEXTURE_2D,null);var a=new Uint8Array(s*o*4);gl.readPixels(0,0,s,o,gl.RGBA,gl.UNSIGNED_BYTE,a);var f=gl.createTexture();return WebGL.handleLoadedTexture(f,a,!1,s,o,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),f}function f(e,n,r){switch(r){case"add":WebGLShaders.setProgram("blend",1);break;case"substract":WebGLShaders.setProgram("blend",11)}var i=WebGLShaders.getProgram(),s=gl.getUniformLocation(i,"Sample0"),o=gl.getUniformLocation(i,"Sample1");gl.uniform1i(s,0),gl.uniform1i(o,1);var a=[];a.push(e),a.push(n),u();var f=Math.round(Canvas.getImageWidth()/2),l=Math.round(Canvas.getImageHeight()/2);WebGL.setFramebuffer(t.framebuffers[0],f,l),WebGL.drawTexture(a);var c=new Uint8Array(f*l*4);gl.readPixels(0,0,f,l,gl.RGBA,gl.UNSIGNED_BYTE,c);var h=gl.createTexture();return WebGL.handleLoadedTexture(h,c,!1,f,l,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),h}function l(e){var n=WebGLShaders.setProgram("colormatrix"),r=new o;r=r.BlackAndWhite(.333,.333,.333),gl.uniformMatrix4fv(n.colormatrix,!1,r);var i=[];i.push(e),u();var s=Math.round(Canvas.getImageWidth()/2),a=Math.round(Canvas.getImageHeight()/2);WebGL.setFramebuffer(t.framebuffers[0],s,a),WebGL.drawTexture(i),gl.deleteTexture(e);var f=new Uint8Array(s*a*4);return gl.readPixels(0,0,s,a,gl.RGBA,gl.UNSIGNED_BYTE,f),e=gl.createTexture(),WebGL.handleLoadedTexture(e,f,!1,s,a,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function c(e,n){var r=0,i=255/n,s=new Array(256),o=new Array(256),a=new Array(256),f;while(r<256)f=Math.round(r*i),f<0?f=0:f>255&&(f=255),s[r]=f<<16,o[r]=f<<8,a[r]=f,r++;console.log(s),console.log(o),console.log(a);var l=WebGLEffects.createTextureFromRawRGB(s,"red",!0),c=WebGLEffects.createTextureFromRawRGB(o,"green",!0),h=WebGLEffects.createTextureFromRawRGB(a,"blue",!0),p=WebGLShaders.setProgram("autofix");gl.uniform1i(p.uRed,1),gl.uniform1i(p.uGreen,2),gl.uniform1i(p.uBlue,3),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,l),gl.activeTexture(gl.TEXTURE0+2),gl.bindTexture(gl.TEXTURE_2D,c),gl.activeTexture(gl.TEXTURE0+3),gl.bindTexture(gl.TEXTURE_2D,h);var d=[];d.push(e),d.push(l),d.push(c),d.push(h),u();var v=Math.round(Canvas.getImageWidth()/2),m=Math.round(Canvas.getImageHeight()/2);WebGL.setFramebuffer(t.framebuffers[0],v,m),WebGL.drawTexture(d),gl.deleteTexture(e);var g=new Uint8Array(v*m*4);return gl.readPixels(0,0,v,m,gl.RGBA,gl.UNSIGNED_BYTE,g),e=gl.createTexture(),WebGL.handleLoadedTexture(e,g,!1,v,m,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function h(e){WebGLShaders.setProgram("invert");var n=[];n.push(e),u();var r=Math.round(Canvas.getImageWidth()/2),i=Math.round(Canvas.getImageHeight()/2);WebGL.setFramebuffer(t.framebuffers[0],r,i),WebGL.drawTexture(n),gl.deleteTexture(e);var s=new Uint8Array(r*i*4);return gl.readPixels(0,0,r,i,gl.RGBA,gl.UNSIGNED_BYTE,s),e=gl.createTexture(),WebGL.handleLoadedTexture(e,s,!1,r,i,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function p(e){WebGLShaders.setProgram("copychanel");var n=[];n.push(e),u();var r=Math.round(Canvas.getImageWidth()/2),i=Math.round(Canvas.getImageHeight()/2);WebGL.setFramebuffer(t.framebuffers[0],r,i),WebGL.drawTexture(n),gl.deleteTexture(e);var s=new Uint8Array(r*i*4);return gl.readPixels(0,0,r,i,gl.RGBA,gl.UNSIGNED_BYTE,s),e=gl.createTexture(),WebGL.handleLoadedTexture(e,s,!1,r,i,!0),WebGL.setFramebuffer(null,Canvas.getWidth(),Canvas.getHeight()),e}function d(e,t){var n=WebGLShaders.setProgram("copypixel");gl.uniform1i(n.sourceTexture,1),gl.uniform1i(n.alphaTexture,2),gl.activeTexture(gl.TEXTURE0+1),gl.bindTexture(gl.TEXTURE_2D,e),gl.activeTexture(gl.TEXTURE0+2),gl.bindTexture(gl.TEXTURE_2D,t),WebGL.drawScene()}function v(){t.soft_texture!=null&&gl.deleteTexture(t.soft_texture),t.masking_texture!=null&&gl.deleteTexture(t.masking_texture);var e=(Canvas.getImageWidth()+Canvas.getImageHeight())/2048*(1+t.amount_slider.getValue()),n=a(e),r=a(e/2.5),i=f(n,r,"substract"),s=f(r,n,"substract");gl.deleteTexture(r),r=s,r=l(r),i=l(i);var o=f(r,i,"add");gl.deleteTexture(i),gl.deleteTexture(r),r=o,r=c(r,Math.round(e)),r=h(r),r=p(r),d(n,r),t.soft_texture=n,t.masking_texture=r}function m(){Canvas.loadCurrentImage(),t.exitPanel()}this.__defineGetter__("type",function(){return"denoise"}),this.el=e(i),e("#menu").append(this.el),this.panel_label=new s(e("#panel_label"),"Smooth","/images/denoise_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.amount_slider=new n(e("#amount_slider"),"Amount",1,15,2,.1),this.amount_slider.setPos(90,0),this.cancel_button=new r(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(315,45),this.accept_button=new r(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(315,0),this.masking_texture=null,this.soft_texture=null,this.textures=[],this.framebuffers=[];var t=this;setTimeout(function(){t.lastWidth=Canvas.getImageWidth(),t.lastHeight=Canvas.getImageHeight(),t.amount_slider.mouseup(v),t.cancel_button.click(function(){m(),AnalyticsTracker.sendEvent("adjustment_denoise_cancel")}),t.accept_button.click(function(){t.accept(),AnalyticsTracker.sendEvent("adjustment_denoise_apply")}),AnalyticsTracker.sendEvent("adjustment_denoise_select"),WebGLShaders.setProgram("passthru"),v()},10)}return u.prototype.releaseResources=function(){this.soft_texture!=null&&gl.deleteTexture(this.soft_texture),this.masking_texture!=null&&gl.deleteTexture(this.masking_texture),gl.deleteFramebuffer(this.framebuffers[0]),gl.deleteFramebuffer(this.framebuffers[1]),gl.deleteTexture(this.textures[0]),gl.deleteTexture(this.textures[1])},u.prototype.accept=function(){History.commit("denoise",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),WebGL.render(),Canvas.saveCurrentImage(),this.exitPanel()},u.prototype.exitPanel=function(){this.el.remove(),WebGLShaders.setProgram("passthru"),WebGL.drawScene(),MainMenu.show(),this.releaseResources()},u.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},u.prototype.getWidth=function(){return this.el.width()},u.prototype.hide=function(){this.el.hide()},u.prototype.show=function(){this.el.show()},u}),define("text!ui/panels/liquify_panel.html",[],function(){return'<div class="panel" id="liquify_panel" style="\n	position:absolute;\n	width:790px;\n">\n\n<div id="panel_label"></div>\n\n<div id="enlarge_button"></div>\n<div id="shrink_button"></div>\n<div id="push_button"></div>\n<div id="insta_thin_button"></div>\n<div id="insta_tall_button"></div>\n<div id="reset_button"></div>\n\n<div id="brush_size_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/LiquifyPanel",["jquery","slider","app/controls/ButtonGroupSelect","app/controls/SliderBox","app/controls/Button","text!ui/panels/liquify_panel.html","app/controls/IconButton"],function(e,t,n,r,i,s,o){function u(){function u(){PaintCanvas.setBrushSize(t.brush_size_slider.getValue())}function a(){t.render()}function f(){var e=Canvas.getImageWidth(),n=Canvas.getImageHeight();if(t.textures.length==0&&t.framebuffers.length==0)for(var r=0;r<2;r++){var i=WebGL.createAndSetupTexture(gl);t.textures.push(i),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,e,n,0,gl.RGBA,gl.UNSIGNED_BYTE,null);var s=gl.createFramebuffer();s.width=e,s.height=n,t.framebuffers.push(s),gl.bindFramebuffer(gl.FRAMEBUFFER,s),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,i,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)}}function l(){if(Canvas.getImageWidth()>t.max_image_size||Canvas.getImageHeight()>t.max_image_size){var e,n;Canvas.getImageWidth()>Canvas.getImageHeight()?(e=t.max_image_size,n=t.max_image_size*Canvas.getImageHeight()/Canvas.getImageWidth()):(n=t.max_image_size,e=t.max_image_size*Canvas.getImageWidth()/Canvas.getImageHeight()),WebGL.resize(e,n),Canvas.saveCurrentImage(),t.resizedImage=Canvas.getCurrentImage(),t.resizedWidth=Canvas.getImageWidth(),t.resizedHeight=Canvas.getImageHeight(),t.imageResized=!0}}this.__defineGetter__("type",function(){return"liquify"}),this.el=e(s),e("#menu").append(this.el),e("#menu").css("pointer-events","none"),this.el.css("pointer-events","auto"),PaintCanvas.setEnabled(!0),this.panel_label=new o(e("#panel_label"),"Liquify","/images/liquify_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.enlarge_button=new i(e("#enlarge_button"),"Enlarge","/images/expand_icon.png",120),this.enlarge_button.setPos(90,0),this.shrink_button=new i(e("#shrink_button"),"Shrink","/images/contract_icon.png",120),this.shrink_button.setPos(215,0),this.push_button=new i(e("#push_button"),"Push","/images/push_icon.png",120),this.push_button.setPos(340,0),this.insta_thin_button=new i(e("#insta_thin_button"),"Instant-Thin","/images/thin_icon.png",120),this.insta_thin_button.setPos(90,45),this.insta_tall_button=new i(e("#insta_tall_button"),"Instant-Tall","/images/tall_icon.png",120),this.insta_tall_button.setPos(215,45),this.reset_button=new i(e("#reset_button"),"Reset","/images/reset_icon.png",120),this.reset_button.setPos(340,45),this.brush_size_slider=new r(e("#brush_size_slider"),"Brush Size",20,750,200),this.brush_size_slider.setPos(465,0),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(690,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(690,0),this.liquifyMode="enlarge",this.strength=0,this.historyImage=Canvas.getCurrentImage(),this.lastWidth=Canvas.getImageWidth(),this.lastHeight=Canvas.getImageHeight(),this.resizedImage=null,this.resizedWidth=0,this.resizedHeight=0,this.displacementThinMap=null,this.displacementTallMap=null,this.displacementPushMap=null,this.max_image_size=2048,this.brush_background=null,this.textures=[],this.framebuffers=[],this.imageResized=!1,this.imageSaved=!1,this.pixels=null;var t=this;setTimeout(function(){l();var e=WebGLShaders.setProgram("liquify");gl.uniform1i(e.liquify_mode,0),t.cancel_button.click(function(){t.exitPanel(!0),AnalyticsTracker.sendEvent("adjustment_liquify_cancel")}),t.accept_button.click(function(){t.accept(),AnalyticsTracker.sendEvent("adjustment_liquify_apply")}),AnalyticsTracker.sendEvent("adjustment_liquify_select"),t.brush_size_slider.onchange(u),t.onLiquifyModeButtonClicked=function(e){console.log("click: "+e);switch(e){case"enlarge_button":t.liquifyMode="enlarge",t.strength=0;break;case"shrink_button":t.liquifyMode="shrink",t.strength=0;break;case"push_button":t.liquifyMode="push";break;case"insta_thin_button":t.liquifyMode="insta_thin",t.strength=0;break;case"insta_tall_button":t.liquifyMode="insta_tall",t.strength=0;break;case"reset_button":t.liquifyMode="reset",WebGLShaders.setProgram("passthru"),Canvas.setCurrentImage(t.imageResized?t.resizedImage:t.historyImage),Canvas.loadCurrentImage(),WebGL.drawScene(),t.liquifyMode=null,t.strength=0,t.reset()}},t.selectGroup=new n([t.enlarge_button,t.shrink_button,t.push_button],t.enlarge_button,t.onLiquifyModeButtonClicked),t.insta_thin_button.click(function(){console.log("insta_thin click");var e=t.liquifyMode;t.liquifyMode="insta_thin",t.strength=0,t.render(),t.saveCurrentImage(),t.reset(),t.liquifyMode=e}),t.insta_tall_button.click(function(){console.log("insta_tall click");var e=t.liquifyMode;t.liquifyMode="insta_tall",t.strength=0,t.render(),t.saveCurrentImage(),t.reset(),t.liquifyMode=e}),t.reset_button.click(function(){var e=t.liquifyMode;t.liquifyMode="reset",WebGLShaders.setProgram("passthru"),Canvas.setCurrentImage(t.imageResized?t.resizedImage:t.historyImage),Canvas.loadCurrentImage(),WebGL.drawScene(),t.liquifyMode=null,t.strength=0,t.reset(),t.liquifyMode=e});var r=new Image;r.onload=function(){t.displacementThinMap=gl.createTexture(),WebGL.handleLoadedTexture(t.displacementThinMap,r,!1)},r.src="images/thin.png";var i=new Image;i.onload=function(){t.displacementTallMap=gl.createTexture(),WebGL.handleLoadedTexture(t.displacementTallMap,i,!1)},i.src="images/tall.jpg",f(),t.reset(),t.pixels=new Uint8Array(Canvas.getImageWidth()*Canvas.getImageHeight()*4)},10),u()}return u.prototype.accept=function(){this.imageResized==1?History.commit("liquify",this.resizedImage,this.resizedWidth,this.resizedHeight):History.commit("liquify",this.historyImage,this.lastWidth,this.lastHeight),this.saveCurrentImage(),this.exitPanel(!1)},u.prototype.exitPanel=function(t){WebGLShaders.setProgram("passthru"),PaintCanvas.clearLiquifyPushCanvas(),PaintCanvas.setEnabled(!1),this.el.remove(),t&&(this.imageResized==1&&(Canvas.setImageWidth(this.lastWidth),Canvas.setImageHeight(this.lastHeight),WebGL.reset(),this.imageResized=!1),Canvas.setCurrentImage(this.historyImage),Canvas.loadCurrentImage()),WebGL.drawScene(),MainMenu.show(),e("#menu").css("pointer-events","auto")},u.prototype.releaseFramebuffers=function(){gl.deleteFramebuffer(_this.framebuffers[0]),gl.deleteFramebuffer(_this.framebuffers[1]),gl.deleteTexture(_this.textures[0]),gl.deleteTexture(_this.textures[1]),gl.deleteTexture(_this.brush_background),this.displacementPushMap!=null&&gl.deleteTexture(this.displacementPushMap)},u.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},u.prototype.getWidth=function(){return this.el.width()},u.prototype.hide=function(){this.el.hide()},u.prototype.show=function(){this.el.show()},u.prototype.getLiquifyMode=function(){return this.liquifyMode},u.prototype.generatePushDisplacementMap=function(e){var t=WebGLShaders.setProgram("blend",12),n=gl.getUniformLocation(t,"Sample0"),r=gl.getUniformLocation(t,"Sample1");gl.uniform1i(n,0),gl.uniform1i(r,1);var i=[];i.push(this.brush_background),i.push(e);var s=Canvas.getImageWidth(),o=Canvas.getImageHeight();WebGL.setFramebuffer(this.framebuffers[0],s,o),WebGL.drawTexture(i),gl.readPixels(0,0,s,o,gl.RGBA,gl.UNSIGNED_BYTE,this.pixels),this.displacementPushMap!=null&&gl.deleteTexture(this.displacementPushMap),this.displacementPushMap=gl.createTexture(),WebGL.handleLoadedTexture(this.brush_background,this.pixels,!1,s,o,!0),WebGL.handleLoadedTexture(this.displacementPushMap,this.pixels,!1,s,o,!0),WebGL.setFramebuffer(null,Canvas.getImageWidth(),Canvas.getImageHeight()),WebGLShaders.setProgram("liquify")},u.prototype.saveCurrentImage=function(){this.imageSaved==0&&(WebGL.render(),Canvas.saveCurrentImage(),WebGLShaders.setProgram("passthru"),this.imageSaved=!0)},u.prototype.reset=function(){var e=document.createElement("canvas");e.width=Canvas.getImageWidth(),e.height=Canvas.getImageHeight();var t=e.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height),t.fillStyle="#008080",t.fillRect(0,0,t.canvas.width,t.canvas.height),this.brush_background&&gl.deleteTexture(this.brush_background),this.brush_background=gl.createTexture(),WebGL.handleLoadedTexture(this.brush_background,e,t.canvas.width,t.canvas.height,!0)},u.prototype.render=function(){if(this.liquifyMode==null)return;WebGLShaders.setProgram("liquify");var e=WebGLShaders.getProgram(),t=PaintCanvas.getBrushCenter();switch(this.liquifyMode){case"enlarge":this.strength=.02,gl.uniform2fv(e.center,[t.centerX,Canvas.getImageHeight()-t.centerY]),gl.uniform1f(e.radius,this.brush_size_slider.getValue()/2),gl.uniform2fv(e.texSize,[Canvas.getImageWidth(),Canvas.getImageHeight()]),gl.uniform1i(e.liquify_mode,1);break;case"shrink":this.strength=-0.02,gl.uniform2fv(e.center,[t.centerX,Canvas.getImageHeight()-t.centerY]),gl.uniform1f(e.radius,this.brush_size_slider.getValue()/2),gl.uniform2fv(e.texSize,[Canvas.getImageWidth(),Canvas.getImageHeight()]),gl.uniform1i(e.liquify_mode,2);break;case"push":this.strength=.02,gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,this.displacementPushMap),gl.uniform1i(e.dis_tex,1),gl.uniform1i(e.liquify_mode,3);break;case"insta_thin":this.strength=.02,gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,this.displacementThinMap),gl.uniform1i(e.dis_tex,1),gl.uniform1i(e.liquify_mode,4);break;case"insta_tall":this.strength=.02,gl.activeTexture(gl.TEXTURE1),gl.bindTexture(gl.TEXTURE_2D,this.displacementTallMap),gl.uniform1i(e.dis_tex,1),gl.uniform1i(e.liquify_mode,5)}console.log(this.strength),gl.uniform1f(e.strength,this.strength),WebGL.drawScene(),this.imageSaved=!1},u}),define("text!ui/font_button.html",[],function(){return'\n<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	width:235px;\n	height:40px;\n	cursor:pointer;\n">\n	<img id="button_image" src="/images/button_open_computer.png" width="150" height="33" style="position:relative;left:42px;top:3px;"/>\n</div>\n'}),define("app/controls/FontButton",["jquery","text!ui/font_button.html"],function(e,t){function n(n,s,o){this.el=n,this.img=o,this.clickCallback=null,this.is_enabled=!0;var u=e(t);u.attr("id",e(this.el).attr("id")),u.data("id",s),u.find("#button_image").attr("src",this.img),this.el.replaceWith(u),this.el=u,this.el.mouseover(r),this.el.mouseout(i)}function r(){e(this).css("background","#3ea2ec")}function i(){e(this).css("background","#434343")}return n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.setId=function(e){this.el.data("id",e)},n.prototype.setImage=function(e){this.img=e,this.el.find("#button_image").attr("src",e)},n.prototype.getId=function(){return this.el.data("id")},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,this.el.click(e)},n.prototype.isEnabled=function(){return this.is_enabled},n.prototype.setEnabled=function(e){this.is_enabled=e,e?(this.el.mouseover(r),this.el.mouseout(i),this.el.click(this.clickCallback),this.el.css("cursor","pointer")):(this.el.css("background","#434343"),this.el.off("mouseover"),this.el.off("mouseout"),this.el.off("click"),this.el.css("cursor","default"))},n.prototype.setSelected=function(e){e?(this.el.css("background","#3ea2ec"),this.el.off("mouseover"),this.el.off("mouseout")):(this.el.css("background","#434343"),this.el.mouseover(r),this.el.mouseout(i))},n}),define("text!ui/opacity_control.html",[],function(){return'<div id="opacity_control" style="\n	position:absolute;\n	border-radius:5px;\n	color:#ffffff;\n	background-color:#444444;\n	width:235px;\n	height:40px;\n">\n\n<div id="button_title" style="font-size:14px;color:white;position:absolute;left:15px;top:10px;">Opacity</div>\n\n<input type="text" id="input" size="4" maxlength="3" style="\n	position:absolute;\n	top:9px;\n	right:5px;\n	color:#ffffff;\n	border:0;\n	background-color:transparent;\n	font-size:13px;\n	pointer-events:none;\n	width:46px;\n"/>\n\n<div id="slider" style="\n	position:absolute;\n	top:7px;\n	left:72px;\n	width:100px;\n"></div>\n\n\n\n</div>'}),define("app/controls/OpacityControl",["jquery","text!ui/opacity_control.html","slider"],function(e,t,n){function r(r){this.el=r;var i=e(t);this.slider=new n(i.find("#slider")[0],i.find("#input")[0],"horizontal"),this.slider.displayFilter(function(e){return Math.round(e)+"%"}),this.slider.setMinimum(0),this.slider.setMaximum(100),this.slider.setValue(100),this.el.replaceWith(i),this.el=i}return r.prototype.mousedown=function(e){this.slider.mousedown(e)},r.prototype.mouseup=function(e){this.slider.mouseup(e)},r.prototype.change=function(e){this.slider.onchange=e},r.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},r.prototype.getValue=function(){return this.slider.getValue()},r.prototype.setValue=function(e){this.slider.setValue(e)},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r}),function(e){var t=function(){var t={},n,r=65,i,s='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',o={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ffff00",livePreview:!0,flat:!1},u=function(t,n){var r=q(t);e(n).data("colorpicker").fields.eq(1).val(r.r).end().eq(2).val(r.g).end().eq(3).val(r.b).end()},a=function(t,n){e(n).data("colorpicker").fields.eq(4).val(t.h).end().eq(5).val(t.s).end().eq(6).val(t.b).end()},f=function(t,n){e(n).data("colorpicker").fields.eq(0).val(U(t)).end()},l=function(t,n){e(n).data("colorpicker").selector.css("backgroundColor","#"+U({h:t.h,s:100,b:100})),e(n).data("colorpicker").selectorIndic.css({left:parseInt(150*t.s/100,10),top:parseInt(150*(100-t.b)/100,10)})},c=function(t,n){e(n).data("colorpicker").hue.css("top",parseInt(150-150*t.h/360,10))},h=function(t,n){e(n).data("colorpicker").currentColor.css("backgroundColor","#"+U(t))},p=function(t,n){e(n).data("colorpicker").newColor.css("backgroundColor","#"+U(t))},d=function(t){var n=t.charCode||t.keyCode||-1;if(n>r&&n<=90||n==32)return!1;var i=e(this).parent().parent();i.data("colorpicker").livePreview===!0&&v.apply(this)},v=function(t){var n=e(this).parent().parent(),r;this.parentNode.className.indexOf("_hex")>0?n.data("colorpicker").color=r=F(B(this.value)):this.parentNode.className.indexOf("_hsb")>0?n.data("colorpicker").color=r=P({h:parseInt(n.data("colorpicker").fields.eq(4).val(),10),s:parseInt(n.data("colorpicker").fields.eq(5).val(),10),b:parseInt(n.data("colorpicker").fields.eq(6).val(),10)}):n.data("colorpicker").color=r=I(H({r:parseInt(n.data("colorpicker").fields.eq(1).val(),10),g:parseInt(n.data("colorpicker").fields.eq(2).val(),10),b:parseInt(n.data("colorpicker").fields.eq(3).val(),10)})),t&&(u(r,n.get(0)),f(r,n.get(0)),a(r,n.get(0))),l(r,n.get(0)),c(r,n.get(0)),p(r,n.get(0)),n.data("colorpicker").onChange.apply(n,[r,U(r),q(r)])},m=function(t){var n=e(this).parent().parent();n.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},g=function(){r=this.parentNode.className.indexOf("_hex")>0?70:65,e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),e(this).parent().addClass("colorpicker_focus")},y=function(t){var n=e(this).parent().find("input").focus(),r={el:e(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:n,val:parseInt(n.val(),10),preview:e(this).parent().parent().data("colorpicker").livePreview};e(document).bind("mouseup",r,w),e(document).bind("mousemove",r,b),e(document).bind("mousedown",r,b)},b=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&v.apply(e.data.field.get(0),[!0]),!1},w=function(t){return v.apply(t.data.field.get(0),[!0]),t.data.el.removeClass("colorpicker_slider").find("input").focus(),e(document).unbind("mouseup",w),e(document).unbind("mousemove",b),e(document).unbind("mousedown",b),!1},E=function(t){var n={cal:e(this).parent(),y:e(this).offset().top};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,x),e(document).bind("mousemove",n,S),e(document).bind("mousedown",n,S)},S=function(e){return v.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},x=function(t){return u(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),f(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",x),e(document).unbind("mousemove",S),e(document).unbind("mousedown",S),!1},T=function(t){console.log("downSelector"),console.log(t);var n={cal:e(this).parent(),pos:e(this).offset()};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,C),e(document).bind("mousemove",n,N),t.data=n,N(t)},N=function(e){return v.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},C=function(t){return u(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),f(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",C),e(document).unbind("mousemove",N),!1},k=function(t){e(this).addClass("colorpicker_focus")},L=function(t){e(this).removeClass("colorpicker_focus")},A=function(t){var n=e(this).parent(),r=n.data("colorpicker").color;n.data("colorpicker").origColor=r,h(r,n.get(0)),n.data("colorpicker").onSubmit(r,U(r),q(r),n.data("colorpicker").el)},O=function(t){var n=e("#"+e(this).data("colorpickerId"));n.data("colorpicker").onBeforeShow.apply(this,[n.get(0)]);var r=e(this).offset(),i=D(),s=r.top+this.offsetHeight,o=r.left;return s+176>i.t+i.h&&(s-=this.offsetHeight+176),o+356>i.l+i.w&&(o-=356),n.css({left:o+"px",top:s+"px"}),n.data("colorpicker").onShow.apply(this,[n.get(0)])!=0&&n.show(),e(document).bind("mousedown",{cal:n},M),!1},M=function(t){_(t.data.cal.get(0),t.target,t.data.cal.get(0))||(t.data.cal.data("colorpicker").onHide.apply(this,[t.data.cal.get(0)])!=0&&t.data.cal.hide(),e(document).unbind("mousedown",M))},_=function(e,t,n){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(e.compareDocumentPosition(t)&16);var r=t.parentNode;while(r&&r!=n){if(r==e)return!0;r=r.parentNode}return!1},D=function(){var e=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},P=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},H=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},B=function(e){var t=6-e.length;if(t>0){var n=[];for(var r=0;r<t;r++)n.push("0");n.push(e),e=n.join("")}return e},j=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}},F=function(e){return I(j(e))},I=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-n;return t.b=r,r!=0,t.s=r!=0?255*i/r:0,t.s!=0?e.r==r?t.h=(e.g-e.b)/i:e.g==r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},q=function(e){var t={},n=Math.round(e.h),r=Math.round(e.s*255/100),i=Math.round(e.b*255/100);if(r==0)t.r=t.g=t.b=i;else{var s=i,o=(255-r)*i/255,u=(s-o)*(n%60)/60;n==360&&(n=0),n<60?(t.r=s,t.b=o,t.g=o+u):n<120?(t.g=s,t.b=o,t.r=s-u):n<180?(t.g=s,t.r=o,t.b=o+u):n<240?(t.b=s,t.r=o,t.g=s-u):n<300?(t.b=s,t.g=o,t.r=o+u):n<360?(t.r=s,t.g=o,t.b=s-u):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},R=function(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(n,function(e,t){t.length==1&&(n[e]="0"+t)}),n.join("")},U=function(e){return R(q(e))},z=function(){var t=e(this).parent(),n=t.data("colorpicker").origColor;t.data("colorpicker").color=n,u(n,t.get(0)),f(n,t.get(0)),a(n,t.get(0)),l(n,t.get(0)),c(n,t.get(0)),p(n,t.get(0))};return{init:function(t){t=e.extend({},o,t||{});if(typeof t.color=="string")t.color=F(t.color);else if(t.color.r!=undefined&&t.color.g!=undefined&&t.color.b!=undefined)t.color=I(t.color);else{if(t.color.h==undefined||t.color.s==undefined||t.color.b==undefined)return this;t.color=P(t.color)}return this.each(function(){if(!e(this).data("colorpickerId")){var n=e.extend({},t);n.origColor=t.color,console.log("origColor is "+n.origColor),console.log(n.origColor);var r="collorpicker_"+parseInt(Math.random()*1e3);e(this).data("colorpickerId",r);var i=e(s).attr("id",r);n.flat?i.appendTo(this).show():i.appendTo(document.body),n.fields=i.find("input").bind("keyup",d).bind("change",v).bind("blur",m).bind("focus",g),i.find("span").bind("mousedown",y).end().find(">div.colorpicker_current_color").bind("click",z),n.selector=i.find("div.colorpicker_color").bind("mousedown",T),n.selectorIndic=n.selector.find("div div"),n.el=this,n.hue=i.find("div.colorpicker_hue div"),i.find("div.colorpicker_hue").bind("mousedown",E),n.newColor=i.find("div.colorpicker_new_color"),n.currentColor=i.find("div.colorpicker_current_color"),i.data("colorpicker",n),i.find("div.colorpicker_submit").bind("mouseenter",k).bind("mouseleave",L).bind("click",A),u(n.color,i.get(0)),a(n.color,i.get(0)),f(n.color,i.get(0)),c(n.color,i.get(0)),l(n.color,i.get(0)),h(n.color,i.get(0)),p(n.color,i.get(0)),n.flat?i.css({position:"relative",display:"block"}):e(this).bind(n.eventName,O)}})},showPicker:function(){return this.each(function(){e(this).data("colorpickerId")&&O.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colorpickerId")&&e("#"+e(this).data("colorpickerId")).hide()})},setColor:function(t){if(typeof t=="string")t=F(t);else if(t.r!=undefined&&t.g!=undefined&&t.b!=undefined)t=I(t);else{if(t.h==undefined||t.s==undefined||t.b==undefined)return this;t=P(t)}return this.each(function(){if(e(this).data("colorpickerId")){var n=e("#"+e(this).data("colorpickerId"));n.data("colorpicker").color=t,n.data("colorpicker").origColor=t,u(t,n.get(0)),a(t,n.get(0)),f(t,n.get(0)),c(t,n.get(0)),l(t,n.get(0)),h(t,n.get(0)),p(t,n.get(0))}})}}}();e.fn.extend({ColorPicker:t.init,ColorPickerHide:t.hidePicker,ColorPickerShow:t.showPicker,ColorPickerSetColor:t.setColor})}(jQuery),define("colorpicker",function(){}),define("text!ui/color_box.html",[],function(){return'<div style="\n	position:absolute;\n	background: #434343;\n	border-radius: 5px;\n	height:40px;\n">\n<!--\n	<div id="input" type="color" width="50" height="25" style="\n		border:0;\n		outline:none;\n		font-size:18px;\n		position:absolute;\n		left:70px;\n		background:transparent;\n		margin-top:-2px;\n		"></input>-->\n	<div id="color_selector_input"></div>\n	<div id="color_selector_box" style="border:solid 1px #888;position:absolute;background-color: #0000ff;width:50px;height:25px;left:68px;top:6px;"></div>\n	<div id="title" style="font-size:14px;color:white;position:absolute;left:18px;top:10px;"></div>\n</div>'}),define("app/controls/ColorBox",["jquery","colorpicker","text!ui/color_box.html"],function(e,t,n){function r(t,r,i){this.el=t,this.title=r,this.changeCallback=null,$height=40;var s=e(n);s.attr("id",e(this.el).attr("id")),s.find("#title").html(this.title),s.css("width",i),s.css("height",$height),this.el.replaceWith(s),this.el=s,s.find("#title").css("top",$height/2-10);var o=s.find("#color_selector_box"),u=this;o.css("backgroundColor",TEXT_PANEL_COLOR),console.log("currentColor: "+TEXT_PANEL_COLOR),e("#color_selector_input").ColorPicker({color:TEXT_PANEL_COLOR.substring(1),flat:!0,onChange:function(t,n,r){console.log("new color: "+n),e("#color_selector_box").css("backgroundColor","#"+n),TEXT_PANEL_COLOR="#"+n,console.log(u.changeCallback),u.changeCallback()}}),e("#color_selector_input").css("position","absolute"),e("#color_selector_input").css("top","-182px"),e("#color_selector_input").css("left","-10px"),e("#color_selector_input").hide(),o.click(function(){e("#color_selector_input").css("display")=="none"?e("#color_selector_input").show():e("#color_selector_input").hide()})}return r.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},r.prototype.getValue=function(){return TEXT_PANEL_COLOR},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r.prototype.change=function(e){this.changeCallback=e},r}),define("text!ui/panels/text_panel.html",[],function(){return'<div class="panel" id="color_panel" style="\n	position:absolute;\n	width:740px;\n">\n\n<div id="panel_label"></div>\n<div id="text_input"></div>\n<div id="align_left_button"></div>\n<div id="align_center_button"></div>\n<div id="align_right_button"></div>\n\n<div id="color_selector"></div>\n<div id="font_button"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n<div id="opacity_control"></div>\n\n<div id="font_menu" style="display:none"></div>\n\n</div>'}),define("app/Texture",[],function(){function e(e,t){this.width=100,this.height=100,this.hasLoaded=!1,this.source=e,this.active=!1,this.visible=!0,this.quadVertexPositionBuffer=null,this.quadVertexTextureCoordBuffer=null,this.quadVertexIndexBuffer=null,this.quadVertexPositionBufferUnscaled=null,this.glTexture=null,this.xOffset=0,this.yOffset=0,this.dragging=0,this.shaderProgram=null,this.effectName="NONE",this.effectFile=null,this.alpha=1,this.blendMode="normal",this.rotation=0,this.scale=1,this.wheelScale=!1,this.canvasScale=1,this.drawFramebuffer=!1,this.thumbnail=null,this.color=null,this.canvasWidth=null,this.canvasHeight=null;if(!e)return;if(this.source instanceof Image||this.source instanceof HTMLImageElement)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,this.initBuffers(),t(this);else{var n=this;this.source.onload=function(){n.hasLoaded=!0,n.width=n.source.width,n.height=n.source.height,t(n),n.initBuffers()}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,t(this)}return e.prototype.constructor=e,e.prototype.destroy=function(){this.source instanceof Image&&(this.source.src=null),this.source=null,this.glTexture!=null&&gl.deleteTexture(this.glTexture)},e.prototype.setActive=function(e){this.active=e},e.prototype.setVisible=function(e){this.visible=e},e.prototype.setDragging=function(e){this.dragging=e},e.prototype.isActive=function(){return this.active},e.prototype.setAlpha=function(e){this.alpha=e},e.prototype.setRotation=function(e){this.rotation=e},e.prototype.setScale=function(e){this.scale=e},e.prototype.setWheelScale=function(e){this.wheelScale=e},e.prototype.setBlendMode=function(e){this.blendMode=e},e.prototype.setShaderProgram=function(e){this.shaderProgram=e},e.prototype.getBlendMode=function(){return this.blendMode},e.prototype.getAlpha=function(){return this.alpha},e.prototype.getThumbnail=function(){return this.thumbnail},e.prototype.setThumbnail=function(e){this.thumbnail=e},e.prototype.setColor=function(e){this.color=e},e.prototype.getColor=function(e){return this.color},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getScale=function(){return this.scale},e.prototype.getCanvasScale=function(){return this.canvasScale},e.prototype.updateOffset=function(e,t){this.xOffset=e,this.yOffset=t},e.prototype.fromImage=function(t,n){var r=new Image;r.src=t;var i=new e(r,n);return i},e.prototype.fromText=function(t,n){var r=new e(t,n);return r},e.prototype.setCanvas=function(e,t){this.canvasWidth=e,this.canvasHeight=t,this.initBuffers()},e.prototype.initBuffers=function(){this.quadVertexTextureCoordBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.quadVertexTextureCoordBuffer);var e=[0,0,1,0,1,1,0,1];gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(e),gl.STATIC_DRAW),this.quadVertexTextureCoordBuffer.itemSize=2,this.quadVertexTextureCoordBuffer.numItems=4,this.quadVertexIndexBuffer=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.quadVertexIndexBuffer);var t=[0,1,2,0,2,3];gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),gl.STATIC_DRAW),this.quadVertexIndexBuffer.itemSize=1,this.quadVertexIndexBuffer.numItems=6,this.quadVertexPositionBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.quadVertexPositionBuffer);var n=1,r=1;if(this.width<=this.canvasWidth&&this.height<=this.canvasHeight)n=this.width/this.canvasWidth,r=this.height/this.canvasHeight;else if(this.width/this.canvasWidth<this.height/this.canvasHeight){var i=this.canvasHeight/this.height,s=this.width*i;n=s/this.canvasWidth,this.canvasScale=i}else{var i=this.canvasWidth/this.width,o=this.height*i;r=o/this.canvasHeight,this.canvasScale=i}vertices=[-n,-r,0,n,-r,0,n,r,0,-n,r,0],console.log("vertices::: "+vertices),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(vertices),gl.STATIC_DRAW),this.quadVertexPositionBuffer.itemSize=3,this.quadVertexPositionBuffer.numItems=4,this.quadVertexPositionBufferUnscaled=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.quadVertexPositionBufferUnscaled),vertices=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(vertices),gl.STATIC_DRAW),this.quadVertexPositionBufferUnscaled.itemSize=3,this.quadVertexPositionBufferUnscaled.numItems=4},e.prototype.updateTexture=function(){this.glTexture||(this.glTexture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,this.glTexture),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,this.source),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.bindTexture(gl.TEXTURE_2D,null))},e.prototype.draw=function(e){var t=this.shaderProgram;this.updateTexture(),gl.bindBuffer(gl.ARRAY_BUFFER,this.quadVertexPositionBuffer),gl.vertexAttribPointer(t.aVertexPosition,this.quadVertexPositionBuffer.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,this.quadVertexTextureCoordBuffer),gl.vertexAttribPointer(t.aTextureCoord,this.quadVertexTextureCoordBuffer.itemSize,gl.FLOAT,!1,0,0),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.glTexture),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.quadVertexIndexBuffer),gl.uniform1f(t.uAlpha,this.alpha),gl.blendEquation(gl.FUNC_ADD),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),gl.uniform1f(t.uXoffset,this.xOffset),gl.uniform1f(t.uYoffset,this.yOffset),gl.uniform1f(t.uFlip,e),gl.uniform1f(t.uScaleX,this.scale),gl.uniform1f(t.uScaleY,this.scale);if(this.color){var n=this.hexToRgb(this.color).r,r=this.hexToRgb(this.color).g,i=this.hexToRgb(this.color).b;gl.uniform1f(t.colorR,n/255),gl.uniform1f(t.colorG,r/255),gl.uniform1f(t.colorB,i/255)}gl.uniform2f(t.uResolution,this.canvasWidth,this.canvasHeight),gl.uniform2fv(t.uRotation,[Math.cos(this.rotation+Math.PI/2),Math.sin(this.rotation+Math.PI/2)]),console.log(this.rotation),gl.drawElements(gl.TRIANGLES,this.quadVertexIndexBuffer.numItems,gl.UNSIGNED_SHORT,0),gl.bindTexture(gl.TEXTURE_2D,null)},e.prototype.drawToFramebuffer=function(e,t,n){this.drawFramebuffer=!0,this.draw(n),this.drawFramebuffer=!1},e}),define("text!ui/manipulators/text_box.html",[],function(){return'<div>\n<div id="text_box" style="\n	position:absolute;\n">\n\n\n</div>\n<canvas id="text_box_background" style="\n	position:absolute;\n">\n\n</canvas>\n\n</div>'}),define("app/manipulators/TextManipulator",["jquery","app/manipulators/FocalBlurHandle","text!ui/manipulators/text_box.html"],function(e,t,n){function r(r,i,s,o,u){this.panel=r,this.el=e(n).find("#text_box"),this.el_bg=e(n).find("#text_box_background"),this.dragging=!1,this.OFFSET=10,this.width=o,this.height=u,this.min_x=i,this.min_y=s,this.max_x=i+o,this.max_y=s+u,this.cx=null,this.cy=null,this.w=50,this.h=50,this.r=0,this.s=.25,this.ctx=this.el_bg[0].getContext("2d"),this.textAlign="center",this.font=null,this.text=null,this.textColor="white",this.textAlpha=null,this.textHeight="300",this.textTexture=null,this.lastScale=Canvas.getScale(),this.lastTextScale=this.s,this.originalCanvasScale=Canvas.getScale(),this.saveCanvas=null,this.saveCanvasContext=null,this.saveCanvasCx=0,this.saveCanvasCy=0,this.saveCanvasScale=.25,this.paint_canvas=document.getElementById("paint-canvas"),this.paint_ctx=this.paint_canvas.getContext("2d"),e("body").append(this.el_bg),e("body").append(this.el),this.handle_scale_bottom=new t(this),this.handle_scale_right=new t(this),this.handle_rotation=new t(this),this.handle_scale_bottom.hide(),this.handle_scale_right.hide(),this.handle_rotation.hide();var a=this,f=0,l=0;this.positionHandles=function(){var e={x:a.cx+a.el_bg.offset().left,y:a.cy+a.el_bg.offset().top},t=a.r,n=(a.h/2+30)*Math.sin(t),r=-(a.h/2+30)*Math.cos(t)-15;a.handle_rotation.setPos(e.x+n,e.y+r),n=-a.h/2*Math.sin(t),r=a.h/2*Math.cos(t)-15,a.handle_scale_bottom.setPos(e.x+n,e.y+r),n=a.w/2*Math.cos(t),r=a.w/2*Math.sin(t)-15,a.handle_scale_right.setPos(e.x+n,e.y+r)},this.el_bg.mousedown(function(e){if(e.button===0){var t=parseInt(e.clientX-a.el_bg.offset().left),n=parseInt(e.clientY-a.el_bg.offset().top);f=t,l=n,a.drawRect(),a.paint_ctx.isPointInPath(t+a.el_bg.offset().left,n+a.el_bg.offset().top)?a.dragging=!0:a.dragging=!1}}),this.el_bg.mouseup(function(){a.dragging=!1}),this.el_bg.mousemove(function(e){if(a.dragging){var t=e.clientX-this.offsetLeft,n=e.clientY-this.offsetTop,r=t-f,i=n-l;a.cx=a.cx+r,a.cy=a.cy+i,a.saveCanvasCx=(a.cx+r)*Canvas.getImageWidth()/a.el_bg[0].width,a.saveCanvasCy=(a.cy+i)*Canvas.getImageHeight()/a.el_bg[0].height,a.drawBackground(),f=t,l=n}})}return r.prototype.handleMoved=function(e,t,n){console.log(t+", "+n);var r={x:t-this.min_x,y:n-this.min_y},i=r.x-this.cx,s=r.y-this.cy;console.log("offset: "+i+", "+s);var o=this.text.split("\n").length,u=214;switch(e){case this.handle_rotation:var a=Math.atan2(s,i);console.log("angle: "+a),this.r=a+Math.PI/2;break;case this.handle_scale_bottom:var f=Math.abs(Math.cos(this.r))>Math.abs(Math.sin(this.r))?Math.abs(s/Math.cos(this.r)):Math.abs(i/Math.sin(this.r));this.s=f/o/u,this.saveCanvasScale=this.s,this.lastTextScale=this.s,this.originalCanvasScale=Canvas.getScale();break;case this.handle_scale_right:var f=Math.abs(Math.sin(this.r))>Math.abs(Math.cos(this.r))?Math.abs(s/Math.sin(this.r)):Math.abs(i/Math.cos(this.r)),l=this.w>.1?this.h/this.w:1;this.s=l*f/o/u,this.saveCanvasScale=this.s,this.lastTextScale=this.s,this.originalCanvasScale=Canvas.getScale()}this.drawBackground(),console.log("this.s: "+this.s)},r.prototype.setTextTexture=function(e){this.textTexture=e},r.prototype.draw=function(){var t=Canvas.getScale(),n=t,r=t;Math.round(t*Canvas.getImageWidth()*1e5)/1e5%1>0&&(n=Math.round(t*Canvas.getImageWidth())/Canvas.getImageWidth()),Math.round(t*Canvas.getImageHeight()*1e5)/1e5%1>0&&(r=Math.round(t*Canvas.getImageHeight())/Canvas.getImageHeight());var i=Math.round((Canvas.getWidth()/2-Canvas.getImageWidth()*n/2)*1e5)/1e5,s=Math.round((Canvas.getHeight()/2-Canvas.getImageHeight()*r/2)*1e5)/1e5,o=Canvas.getImageWidth()*Canvas.getScale(),u=Canvas.getImageHeight()*Canvas.getScale(),a=Canvas.getOffset().x*Canvas.getImageWidth()*n,f=Canvas.getOffset().y*Canvas.getImageHeight()*r,l=e(window).innerWidth()/2-o/2+a/2,c=e(window).innerHeight()/2-u/2-f/2;this.min_x=i+a/2,this.min_y=s-f/2,this.max_x=this.min_x+o,this.max_y=this.min_y+u,this.width=o,this.height=u,console.log("text canvas width...."+o),console.log("text canvas height...."+u),this.setBackgroundSize(o,u),this.setBackgroundPos(l,c),this.text!=null&&(this.s=this.lastTextScale*Canvas.getScale()/this.originalCanvasScale,this.saveCanvasScale=this.lastTextScale*Canvas.getScale()/this.originalCanvasScale,this.drawBackground())},r.prototype.setBackgroundInfo=function(e,t,n){this.w=e,this.h=t,this.r=n},r.prototype.drawRect=function(){if(this.paint_ctx!=null&&this.text!=null){this.paint_ctx.clearRect(0,0,this.paint_canvas.width,this.paint_canvas.height);if(this.text==""){this.handle_scale_bottom.hide(),this.handle_scale_right.hide(),this.handle_rotation.hide();return}this.handle_scale_bottom.show(),this.handle_scale_right.show(),this.handle_rotation.show(),this.paint_ctx.save(),this.paint_ctx.translate(this.cx+this.el_bg.offset().left,this.cy+this.el_bg.offset().top),this.paint_ctx.rotate(this.r),this.paint_ctx.beginPath(),this.paint_ctx.rect(-this.w/2,-this.h/2,this.w,this.h),this.paint_ctx.lineWidth=2,this.paint_ctx.strokeStyle="white",this.paint_ctx.moveTo(0,-this.h/2-30),this.paint_ctx.lineTo(0,-this.h/2),this.paint_ctx.stroke(),this.paint_ctx.restore()}},r.prototype.setBackgroundPos=function(e,t){this.el_bg.css("left",e),this.el_bg.css("top",t)},r.prototype.drawBackground=function(){if(this.text==null)return;this.ctx.clearRect(0,0,this.el_bg.width(),this.el_bg.height()),this.drawText(),this.drawRect(),this.positionHandles()},r.prototype.drawSavingCanvas=function(){if(this.saveCanvasContext!=null&&this.text!=null){this.saveCanvasContext.clearRect(0,0,this.saveCanvas.width,this.saveCanvas.height);var e=this.textHeight+"px "+(this.font!=null?this.font:"Architects Daughter");this.saveCanvasContext.font=e,this.saveCanvasContext.textAlign=this.textAlign,this.saveCanvasContext.textBaseline="middle",this.saveCanvasContext.fillStyle=this.textColor,this.saveCanvasContext.save(),this.saveCanvasContext.translate(this.saveCanvasCx,this.saveCanvasCy);var t=0;this.textAlign=="left"?t=0-this.w/2/this.saveCanvasScale:this.textAlign=="right"&&(t=this.w/2/this.saveCanvasScale),this.saveCanvasContext.scale(this.saveCanvasScale/Canvas.getScale(),this.saveCanvasScale/Canvas.getScale()),this.saveCanvasContext.rotate(this.r);var n=this.text.split("\n"),r=0,i=0;for(var s=0;s<n.length;s++)n[s].length>i&&(r=s,i=n[s].length),this.saveCanvasContext.fillText(n[s],t,(s-(n.length-1)/2)*this.textHeight);return this.saveCanvasContext.restore(),console.log(this.saveCanvas.toDataURL()),!0}return!1},r.prototype.setText=function(e){this.text=e},r.prototype.drawText=function(){if(this.text!=null){var e=this.textHeight+"px "+(this.font!=null?this.font:"Architects Daughter");this.ctx.font=e,this.ctx.textAlign=this.textAlign,this.ctx.textBaseline="middle",this.ctx.fillStyle=this.textColor,this.ctx.save(),this.ctx.translate(this.cx,this.cy),this.ctx.scale(this.s,this.s),this.ctx.rotate(this.r);var t=this.text.split("\n"),n=0,r=0;for(var i=0;i<t.length;i++)t[i].length>r&&(n=i,r=t[i].length);this.w=this.ctx.measureText(t[n]).width*this.s;var s=0;this.textAlign=="left"?s=0-this.w/2/this.s:this.textAlign=="right"&&(s=this.w/2/this.s);for(var i=0;i<t.length;i++)this.ctx.fillText(t[i],s,(i-(t.length-1)/2)*this.textHeight);this.ctx.restore(),this.h=this.textHeight*this.s*t.length*1.4,console.log(this.el_bg[0].toDataURL())}},r.prototype.setFont=function(e){this.font=e},r.prototype.setTextAlpha=function(e){this.textAlpha=e,this.ctx.globalAlpha=this.textAlpha,this.saveCanvasContext.globalAlpha=this.textAlpha},r.prototype.setTextAlign=function(e){this.textAlign=e},r.prototype.setTextColor=function(e){this.textColor=e},r.prototype.getTextTexture=function(){return this.drawSavingCanvas()?this.saveCanvas:null},r.prototype.setBackgroundSize=function(e,t){var n=this.el_bg[0].getContext("2d");n.canvas.width=e,n.canvas.height=t,this.cx==null&&this.cy==null?(this.cx=e/2,this.cy=t/2):(this.cx=this.cx*Canvas.getScale()/this.lastScale,this.cy=this.cy*Canvas.getScale()/this.lastScale,this.lastScale=Canvas.getScale()),this.el_bg.css("width",e),this.el_bg.css("height",t),this.saveCanvas==null?(this.saveCanvas=document.createElement("canvas"),this.saveCanvasContext=this.saveCanvas.getContext("2d"),this.saveCanvas.width=Canvas.getImageWidth(),this.saveCanvas.height=Canvas.getImageHeight(),this.saveCanvasCx=this.saveCanvas.width/2,this.saveCanvasCy=this.saveCanvas.height/2):(this.saveCanvasCx=this.cx*Canvas.getImageWidth()/this.el_bg[0].width,this.saveCanvasCy=this.cy*Canvas.getImageHeight()/this.el_bg[0].height)},r.prototype.setSize=function(e,t){this.width=e,this.height=t},r.prototype.remove=function(){this.paint_ctx.clearRect(0,0,this.paint_canvas.width,this.paint_canvas.height),this.el_bg.remove(),this.el.remove()},r}),function(e,t,n){function o(e){return function(){return this[e]}}function a(e,t){var n=e.split("."),r=u;!(n[0]in r)&&r.execScript&&r.execScript("var "+n[0]);for(var i;n.length&&(i=n.shift());)!n.length&&void 0!==t?r[i]=t:r=r[i]?r[i]:r[i]={}}function f(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:l,c.apply(i,arguments)}function p(e,t){this.G=e,this.v=t||e,this.z=this.v.document}function d(e,n,r){e=e.z.getElementsByTagName(n)[0],e||(e=t.documentElement),e&&e.lastChild&&e.insertBefore(r,e.lastChild)}function v(e,t){for(var n=e.className.split(/\s+/),r=0,i=n.length;r<i;r++)if(n[r]==t)return;n.push(t),e.className=n.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function m(e,t){for(var n=e.className.split(/\s+/),r=[],i=0,s=n.length;i<s;i++)n[i]!=t&&r.push(n[i]);e.className=r.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function g(e,t){for(var n=e.className.split(/\s+/),i=0,o=n.length;i<o;i++)if(n[i]==t)return r;return s}function y(e){var t=e.v.location.protocol;return"about:"==t&&(t=e.G.location.protocol),"https:"==t?"https:":"http:"}function b(e,t){var n=e.createElement("link",{rel:"stylesheet",href:t}),i=s;n.onload=function(){i||(i=r)},n.onerror=function(){i||(i=r)},d(e,"head",n)}function w(t,n,o,u){var a=t.z.getElementsByTagName("head")[0];if(a){var f=t.createElement("script",{src:n}),l=s;return f.onload=f.onreadystatechange=function(){!l&&(!this.readyState||"loaded"==this.readyState||"complete"==this.readyState)&&(l=r,o&&o(i),f.onload=f.onreadystatechange=i,"HEAD"==f.parentNode.tagName&&a.removeChild(f))},a.appendChild(f),e.setTimeout(function(){l||(l=r,o&&o(Error("Script load timeout")))},u||5e3),f}return i}function E(e,t,n){this.M=e,this.U=t,this.Aa=n}function S(e,t,n,r){this.d=e!=i?e:i,this.o=t!=i?t:i,this.aa=n!=i?n:i,this.f=r!=i?r:i}function T(e){e=x.exec(e);var t=i,n=i,r=i,s=i;return e&&(e[1]!==i&&e[1]&&(t=parseInt(e[1],10)),e[2]!==i&&e[2]&&(n=parseInt(e[2],10)),e[3]!==i&&e[3]&&(r=parseInt(e[3],10)),e[4]!==i&&e[4]&&(s=/^[0-9]+$/.test(e[4])?parseInt(e[4],10):e[4])),new S(t,n,r,s)}function N(e,t,n,r,i,s,o,u,a,f,l){this.K=e,this.Ga=t,this.za=n,this.fa=r,this.Ea=i,this.ea=s,this.wa=o,this.Fa=u,this.va=a,this.da=f,this.k=l}function C(e,t){this.a=e,this.I=t}function L(e){var t=M(e.a,/(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/,1);return""!=t?(/BB\d{2}/.test(t)&&(t="BlackBerry"),t):(e=M(e.a,/(Linux|Mac_PowerPC|Macintosh|Windows|CrOS)/,1),""!=e?("Mac_PowerPC"==e&&(e="Macintosh"),e):"Unknown")}function A(e){var t=M(e.a,/(OS X|Windows NT|Android) ([^;)]+)/,2);if(t||(t=M(e.a,/Windows Phone( OS)? ([^;)]+)/,2))||(t=M(e.a,/(iPhone )?OS ([\d_]+)/,2)))return t;if(t=M(e.a,/(?:Linux|CrOS) ([^;)]+)/,1))for(var t=t.split(/\s/),n=0;n<t.length;n+=1)if(/^[\d\._]+$/.test(t[n]))return t[n];return(e=M(e.a,/(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/,2))?e:"Unknown"}function O(e){var t=L(e),n=A(e),r=T(n),i=M(e.a,/AppleWeb(?:K|k)it\/([\d\.\+]+)/,1),o=T(i),u="Unknown",a=new S,f="Unknown",l=s;return/OPR\/[\d.]+/.test(e.a)?u="Opera":-1!=e.a.indexOf("Chrome")||-1!=e.a.indexOf("CrMo")||-1!=e.a.indexOf("CriOS")?u="Chrome":/Silk\/\d/.test(e.a)?u="Silk":"BlackBerry"==t||"Android"==t?u="BuiltinBrowser":-1!=e.a.indexOf("PhantomJS")?u="PhantomJS":-1!=e.a.indexOf("Safari")?u="Safari":-1!=e.a.indexOf("AdobeAIR")&&(u="AdobeAIR"),"BuiltinBrowser"==u?f="Unknown":"Silk"==u?f=M(e.a,/Silk\/([\d\._]+)/,1):"Chrome"==u?f=M(e.a,/(Chrome|CrMo|CriOS)\/([\d\.]+)/,2):-1!=e.a.indexOf("Version/")?f=M(e.a,/Version\/([\d\.\w]+)/,1):"AdobeAIR"==u?f=M(e.a,/AdobeAIR\/([\d\.]+)/,1):"Opera"==u?f=M(e.a,/OPR\/([\d.]+)/,1):"PhantomJS"==u&&(f=M(e.a,/PhantomJS\/([\d.]+)/,1)),a=T(f),l="AdobeAIR"==u?2<a.d||2==a.d&&5<=a.o:"BlackBerry"==t?10<=r.d:"Android"==t?2<r.d||2==r.d&&1<r.o:526<=o.d||525<=o.d&&13<=o.o,new N(u,a,f,"AppleWebKit",o,i,t,r,n,_(e.I),new E(l,536>o.d||536==o.d&&11>o.o,"iPhone"==t||"iPad"==t||"iPod"==t||"Macintosh"==t))}function M(e,t,n){return(e=e.match(t))&&e[n]?e[n]:""}function _(e){if(e.documentMode)return e.documentMode}function D(e){this.ua=e||"-"}function P(e,t){this.K=e,this.V=4,this.L="n";var n=(t||"n4").match(/^([nio])([1-9])$/i);n&&(this.L=n[1],this.V=parseInt(n[2],10))}function H(e){return e.L+e.V}function B(e){var t=4,n="n",r=i;return e&&((r=e.match(/(normal|oblique|italic)/i))&&r[1]&&(n=r[1].substr(0,1).toLowerCase()),(r=e.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?t=7:/[1-9]00/.test(r[1])&&(t=parseInt(r[1].substr(0,1),10)))),n+t}function j(e,t,n){this.c=e,this.h=t,this.O=n,this.j="wf",this.g=new D("-")}function F(e){m(e.h,e.g.f(e.j,"loading")),g(e.h,e.g.f(e.j,"active"))||v(e.h,e.g.f(e.j,"inactive")),I(e,"inactive")}function I(e,t,n){e.O[t]&&(n?e.O[t](n.getName(),H(n)):e.O[t]())}function q(){this.w={}}function R(e,t){this.c=e,this.C=t,this.s=this.c.createElement("span",{"aria-hidden":"true"},this.C)}function U(e,t){var n;n=[];for(var r=t.K.split(/,\s*/),i=0;i<r.length;i++){var s=r[i].replace(/['"]/g,"");-1==s.indexOf(" ")?n.push(s):n.push("'"+s+"'")}n=n.join(","),r="normal",i=t.V+"00","o"===t.L?r="oblique":"i"===t.L&&(r="italic"),e.s.style.cssText="position:absolute;top:-999px;left:-999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+n+";"+("font-style:"+r+";font-weight:"+i+";")}function z(e){d(e.c,"body",e.s)}function W(e,t,n,r,s,o,u,a){this.W=e,this.sa=t,this.c=n,this.q=r,this.C=a||"BESbswy",this.k=s,this.F={},this.T=o||5e3,this.Z=u||i,this.B=this.A=i,e=new R(this.c,this.C),z(e);for(var f in X)X.hasOwnProperty(f)&&(U(e,new P(X[f],H(this.q))),this.F[X[f]]=e.s.offsetWidth);e.remove()}function V(e,t,n){for(var i in X)if(X.hasOwnProperty(i)&&t===e.F[X[i]]&&n===e.F[X[i]])return r;return s}function $(e){var t=e.A.s.offsetWidth,n=e.B.s.offsetWidth;t===e.F.serif&&n===e.F["sans-serif"]||e.k.U&&V(e,t,n)?h()-e.xa>=e.T?e.k.U&&V(e,t,n)&&(e.Z===i||e.Z.hasOwnProperty(e.q.getName()))?J(e,e.W):J(e,e.sa):setTimeout(c(function(){$(this)},e),25):J(e,e.W)}function J(e,t){e.A.remove(),e.B.remove(),t(e.q)}function K(e,t,n,r){this.c=t,this.t=n,this.P=0,this.ba=this.Y=s,this.T=r,this.k=e.k}function Q(e,t,n,r,i){if(0===t.length&&i)F(e.t);else{e.P+=t.length,i&&(e.Y=i);for(i=0;i<t.length;i++){var s=t[i],o=n[s.getName()],u=e.t,a=s;v(u.h,u.g.f(u.j,a.getName(),H(a).toString(),"loading")),I(u,"fontloading",a),(new W(c(e.ga,e),c(e.ha,e),e.c,s,e.k,e.T,r,o)).start()}}}function G(e){0==--e.P&&e.Y&&(e.ba?(e=e.t,m(e.h,e.g.f(e.j,"loading")),m(e.h,e.g.f(e.j,"inactive")),v(e.h,e.g.f(e.j,"active")),I(e,"active")):F(e.t))}function Y(e){this.G=e,this.u=new q,this.ya=new C(e.navigator.userAgent,e.document),this.a=this.ya.parse(),this.Q=this.R=0}function Z(e,t){this.c=e,this.e=t,this.m=[]}function et(e,t){this.c=e,this.e=t}function tt(e,t){this.c=e,this.e=t,this.m=[]}function nt(e,t){this.c=e,this.e=t,this.m=[]}function rt(e,t,n){this.N=e?e:t+it,this.p=[],this.S=[],this.ca=n||""}function st(e){this.p=e,this.$=[],this.J={}}function lt(e,n){this.a=(new C(navigator.userAgent,t)).parse(),this.c=e,this.e=n}var r=!0,i=null,s=!1,u=this,h=Date.now||function(){return+(new Date)};p.prototype.createElement=function(e,t,n){e=this.z.createElement(e);if(t)for(var r in t)t.hasOwnProperty(r)&&("style"==r?e.style.cssText=t[r]:e.setAttribute(r,t[r]));return n&&e.appendChild(this.z.createTextNode(n)),e},a("webfont.BrowserInfo",E),E.prototype.pa=o("M"),E.prototype.hasWebFontSupport=E.prototype.pa,E.prototype.qa=o("U"),E.prototype.hasWebKitFallbackBug=E.prototype.qa,E.prototype.ra=o("Aa"),E.prototype.hasWebKitMetricsBug=E.prototype.ra;var x=/^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;S.prototype.toString=function(){return[this.d,this.o||"",this.aa||"",this.f||""].join("")},a("webfont.UserAgent",N),N.prototype.getName=o("K"),N.prototype.getName=N.prototype.getName,N.prototype.oa=o("za"),N.prototype.getVersion=N.prototype.oa,N.prototype.ka=o("fa"),N.prototype.getEngine=N.prototype.ka,N.prototype.la=o("ea"),N.prototype.getEngineVersion=N.prototype.la,N.prototype.ma=o("wa"),N.prototype.getPlatform=N.prototype.ma,N.prototype.na=o("va"),N.prototype.getPlatformVersion=N.prototype.na,N.prototype.ja=o("da"),N.prototype.getDocumentMode=N.prototype.ja,N.prototype.ia=o("k"),N.prototype.getBrowserInfo=N.prototype.ia;var k=new N("Unknown",new S,"Unknown","Unknown",new S,"Unknown","Unknown",new S,"Unknown",void 0,new E(s,s,s));C.prototype.parse=function(){var e;if(-1!=this.a.indexOf("MSIE")||-1!=this.a.indexOf("Trident/")){e=L(this);var t=A(this),n=T(t),r=i,o=i,u=i,a=i,f=M(this.a,/Trident\/([\d\w\.]+)/,1),l=_(this.I),r=-1!=this.a.indexOf("MSIE")?M(this.a,/MSIE ([\d\w\.]+)/,1):M(this.a,/rv:([\d\w\.]+)/,1),o=T(r);""!=f?(u="Trident",a=T(f)):(u="Unknown",a=new S,f="Unknown"),e=new N("MSIE",o,r,u,a,f,e,n,t,l,new E("Windows"==e&&6<=o.d||"Windows Phone"==e&&8<=n.d,s,s))}else if(-1!=this.a.indexOf("Opera"))e:if(e="Unknown",t=M(this.a,/Presto\/([\d\w\.]+)/,1),n=T(t),r=A(this),o=T(r),u=_(this.I),n.d!==i?e="Presto":(-1!=this.a.indexOf("Gecko")&&(e="Gecko"),t=M(this.a,/rv:([^\)]+)/,1),n=T(t)),-1!=this.a.indexOf("Opera Mini/"))a=M(this.a,/Opera Mini\/([\d\.]+)/,1),f=T(a),e=new N("OperaMini",f,a,e,n,t,L(this),o,r,u,new E(s,s,s));else{if(-1!=this.a.indexOf("Version/")&&(a=M(this.a,/Version\/([\d\.]+)/,1),f=T(a),f.d!==i)){e=new N("Opera",f,a,e,n,t,L(this),o,r,u,new E(10<=f.d,s,s));break e}a=M(this.a,/Opera[\/ ]([\d\.]+)/,1),f=T(a),e=f.d!==i?new N("Opera",f,a,e,n,t,L(this),o,r,u,new E(10<=f.d,s,s)):new N("Opera",new S,"Unknown",e,n,t,L(this),o,r,u,new E(s,s,s))}else/OPR\/[\d.]+/.test(this.a)?e=O(this):/AppleWeb(K|k)it/.test(this.a)?e=O(this):-1!=this.a.indexOf("Gecko")?(e="Unknown",t=new S,n="Unknown",r=A(this),o=T(r),u=s,-1!=this.a.indexOf("Firefox")?(e="Firefox",n=M(this.a,/Firefox\/([\d\w\.]+)/,1),t=T(n),u=3<=t.d&&5<=t.o):-1!=this.a.indexOf("Mozilla")&&(e="Mozilla"),a=M(this.a,/rv:([^\)]+)/,1),f=T(a),u||(u=1<f.d||1==f.d&&9<f.o||1==f.d&&9==f.o&&2<=f.aa||a.match(/1\.9\.1b[123]/)!=i||a.match(/1\.9\.1\.[\d\.]+/)!=i),e=new N(e,t,n,"Gecko",f,a,L(this),o,r,_(this.I),new E(u,s,s))):e=k;return e},D.prototype.f=function(e){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.ua)},P.prototype.getName=o("K"),R.prototype.remove=function(){var e=this.s;e.parentNode&&e.parentNode.removeChild(e)};var X={Da:"serif",Ca:"sans-serif",Ba:"monospace"};W.prototype.start=function(){this.A=new R(this.c,this.C),z(this.A),this.B=new R(this.c,this.C),z(this.B),this.xa=h(),U(this.A,new P(this.q.getName()+",serif",H(this.q))),U(this.B,new P(this.q.getName()+",sans-serif",H(this.q))),$(this)},K.prototype.ga=function(e){var t=this.t;m(t.h,t.g.f(t.j,e.getName(),H(e).toString(),"loading")),m(t.h,t.g.f(t.j,e.getName(),H(e).toString(),"inactive")),v(t.h,t.g.f(t.j,e.getName(),H(e).toString(),"active")),I(t,"fontactive",e),this.ba=r,G(this)},K.prototype.ha=function(e){var t=this.t;m(t.h,t.g.f(t.j,e.getName(),H(e).toString(),"loading")),g(t.h,t.g.f(t.j,e.getName(),H(e).toString(),"active"))||v(t.h,t.g.f(t.j,e.getName(),H(e).toString(),"inactive")),I(t,"fontinactive",e),G(this)},Y.prototype.load=function(e){var t=e.context||this.G;this.c=new p(this.G,t);var t=new j(this.c,t.document.documentElement,e),n=[],r=e.timeout;v(t.h,t.g.f(t.j,"loading")),I(t,"loading");var n=this.u,i=this.c,s=[],o;for(o in e)if(e.hasOwnProperty(o)){var u=n.w[o];u&&s.push(u(e[o],i))}n=s,this.Q=this.R=n.length,e=new K(this.a,this.c,t,r),o=0;for(r=n.length;o<r;o++)i=n[o],i.H(this.a,c(this.ta,this,i,t,e))},Y.prototype.ta=function(e,t,n,r){var s=this;r?e.load(function(e,t,r){var o=0==--s.R;setTimeout(function(){Q(n,e,t||{},r||i,o)},0)}):(e=0==--this.R,this.Q--,e&&0==this.Q&&F(t),Q(n,[],{},i,e))},Z.prototype.H=function(e,t){var n=this,r=n.e.projectId,i=n.e.version;if(r){var o=n.c.v;w(this.c,n.D(r,i),function(i){if(i)t(s);else{if(o["__mti_fntLst"+r]&&(i=o["__mti_fntLst"+r]()))for(var u=0;u<i.length;u++)n.m.push(new P(i[u].fontfamily));t(e.k.M)}}).id="__MonotypeAPIScript__"+r}else t(s)},Z.prototype.D=function(e,t){var n=y(this.c),r=(this.e.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return n+"//"+r+"/"+e+".js"+(t?"?v="+t:"")},Z.prototype.load=function(e){e(this.m)},et.prototype.load=function(e){var t,n,r=this.e.urls||[],i=this.e.families||[],s=this.e.testStrings||{};t=0;for(n=r.length;t<n;t++)b(this.c,r[t]);r=[],t=0;for(n=i.length;t<n;t++){var o=i[t].split(":");if(o[1])for(var u=o[1].split(","),a=0;a<u.length;a+=1)r.push(new P(o[0],u[a]));else r.push(new P(o[0]))}e(r,s)},et.prototype.H=function(e,t){return t(e.k.M)},tt.prototype.D=function(e){return y(this.c)+(this.e.api||"//f.fontdeck.com/s/css/js/")+(this.c.v.location.hostname||this.c.G.location.hostname)+"/"+e+".js"},tt.prototype.H=function(e,t){var n=this.e.id,r=this.c.v,i=this;n?(r.__webfontfontdeckmodule__||(r.__webfontfontdeckmodule__={}),r.__webfontfontdeckmodule__[n]=function(e,n){for(var r=0,s=n.fonts.length;r<s;++r){var o=n.fonts[r];i.m.push(new P(o.name,B("font-weight:"+o.weight+";font-style:"+o.style)))}t(e)},w(this.c,this.D(n),function(e){e&&t(s)})):t(s)},tt.prototype.load=function(e){e(this.m)},nt.prototype.D=function(e){var t=y(this.c);return(this.e.api||t+"//use.typekit.net")+"/"+e+".js"},nt.prototype.H=function(e,t){var n=this.e.id,r=this.e,i=this.c.v,o=this;n?(i.__webfonttypekitmodule__||(i.__webfonttypekitmodule__={}),i.__webfonttypekitmodule__[n]=function(n){n(e,r,function(e,n,r){for(var i=0;i<n.length;i+=1){var s=r[n[i]];if(s)for(var u=0;u<s.length;u+=1)o.m.push(new P(n[i],s[u]));else o.m.push(new P(n[i]))}t(e)})},w(this.c,this.D(n),function(e){e&&t(s)},2e3)):t(s)},nt.prototype.load=function(e){e(this.m)};var it="//fonts.googleapis.com/css";rt.prototype.f=function(){if(0==this.p.length)throw Error("No fonts to load !");if(-1!=this.N.indexOf("kit="))return this.N;for(var e=this.p.length,t=[],n=0;n<e;n++)t.push(this.p[n].replace(/ /g,"+"));return e=this.N+"?family="+t.join("%7C"),0<this.S.length&&(e+="&subset="+this.S.join(",")),0<this.ca.length&&(e+="&text="+encodeURIComponent(this.ca)),e};var ot={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},ut={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},at={i:"i",italic:"i",n:"n",normal:"n"},ft=RegExp("^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$");st.prototype.parse=function(){for(var e=this.p.length,t=0;t<e;t++){var n=this.p[t].split(":"),r=n[0].replace(/\+/g," "),s=["n4"];if(2<=n.length){var o,u=n[1];o=[];if(u)for(var u=u.split(","),a=u.length,f=0;f<a;f++){var l;l=u[f];if(l.match(/^[\w]+$/)){l=ft.exec(l.toLowerCase());var c=void 0;if(l==i)c="";else{c=void 0,c=l[1];if(c==i||""==c)c="4";else var h=ut[c],c=h?h:isNaN(c)?"4":c.substr(0,1);c=[l[2]==i||""==l[2]?"n":at[l[2]],c].join("")}l=c}else l="";l&&o.push(l)}0<o.length&&(s=o),3==n.length&&(n=n[2],o=[],n=n?n.split(","):o,0<n.length&&(n=ot[n[0]])&&(this.J[r]=n))}this.J[r]||(n=ot[r])&&(this.J[r]=n);for(n=0;n<s.length;n+=1)this.$.push(new P(r,s[n]))}};var ct={Arimo:r,Cousine:r,Tinos:r};lt.prototype.H=function(e,t){t(e.k.M)},lt.prototype.load=function(e){var t=this.c;if("MSIE"==this.a.getName()&&this.e.blocking!=r){var n=c(this.X,this,e),i=function(){t.z.body?n():setTimeout(i,0)};i()}else this.X(e)},lt.prototype.X=function(e){for(var t=this.c,n=new rt(this.e.api,y(t),this.e.text),r=this.e.families,i=r.length,s=0;s<i;s++){var o=r[s].split(":");3==o.length&&n.S.push(o.pop());var u="";2==o.length&&""!=o[1]&&(u=":"),n.p.push(o.join(u))}r=new st(r),r.parse(),b(t,n.f()),e(r.$,r.J,ct)};var ht=new Y(u);ht.u.w.custom=function(e,t){return new et(t,e)},ht.u.w.fontdeck=function(e,t){return new tt(t,e)},ht.u.w.monotype=function(e,t){return new Z(t,e)},ht.u.w.typekit=function(e,t){return new nt(t,e)},ht.u.w.google=function(e,t){return new lt(t,e)},u.WebFont||(u.WebFont={},u.WebFont.load=c(ht.load,ht),u.WebFontConfig&&ht.load(u.WebFontConfig))}(this,document),define("webfont",function(){}),define("app/panels/TextPanel",["jquery","app/controls/FontButton","app/controls/OpacityControl","app/controls/ButtonGroupSelect","app/controls/Button","app/controls/InputBox","app/controls/ColorBox","text!ui/panels/text_panel.html","app/Texture","app/controls/SliderBox","app/manipulators/TextManipulator","webfont","app/controls/EffectButton","app/controls/IconButton"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){function v(){var e=Canvas.getScale(),t=e,n=e;Math.round(e*Canvas.getImageWidth()*1e5)/1e5%1>0&&(t=Math.round(e*Canvas.getImageWidth())/Canvas.getImageWidth()),Math.round(e*Canvas.getImageHeight()*1e5)/1e5%1>0&&(n=Math.round(e*Canvas.getImageHeight())/Canvas.getImageHeight());var r=Math.round((Canvas.getWidth()/2-Canvas.getImageWidth()*t/2)*1e5)/1e5,i=Math.round((Canvas.getHeight()/2-Canvas.getImageHeight()*n/2)*1e5)/1e5;return{x:r,y:i}}function m(){function f(e){switch(e){case"align_left_button":g("left");break;case"align_center_button":g("center");break;case"align_right_button":g("right")}}function c(){a.exitPanel(!0)}function h(){console.log("updating alpha: "+a.opacity_control.getValue()),a.text_manipulator.setTextAlpha(a.opacity_control.getValue()/100),a.text_manipulator.drawBackground()}function m(e){a.text_manipulator.setFont(e),a.text_manipulator.drawBackground()}function g(e){a.text_manipulator.setTextAlign(e),a.text_manipulator.drawBackground()}function y(){if(Canvas.getImageWidth()>a.max_image_size||Canvas.getImageHeight()>a.max_image_size){var e,t;Canvas.getImageWidth()>Canvas.getImageHeight()?(e=a.max_image_size,t=a.max_image_size*Canvas.getImageHeight()/Canvas.getImageWidth()):(t=a.max_image_size,e=a.max_image_size*Canvas.getImageWidth()/Canvas.getImageHeight()),WebGL.resize(e,t),Canvas.saveCurrentImage(),a.resizedImage=Canvas.getCurrentImage(),a.resizedWidth=Canvas.getImageWidth(),a.resizedHeight=Canvas.getImageHeight(),a.imageResized=!0}}function b(){a.font_menu_buttons=[];for(var n in d){e("#font_menu").append(e("<div id='font_"+n+"_button'></div>"));var r=new t(e("#font_"+n+"_button"),n,"/fonts/"+n+".png");a.font_menu_buttons.push(r),r.click(function(){w(),console.log(e(this).data("id")),a.current_font=e(this).data("id"),a.font_button.setImage("/fonts/"+a.current_font+".png"),a.font_button.setId(a.current_font),m(d[a.current_font])})}}function w(){if(e("#font_menu").css("display")=="none"){var t=0,n=0;for(var r=a.font_menu_buttons.length-1;r>=0;r--){var i=a.font_menu_buttons[r];i.getId()==a.current_font?i.setEnabled(!1):i.isEnabled()||i.setEnabled(!0),r%2==0?(i.setPos(280,-1*(t+1)*45),t++):(i.setPos(520,-1*(n+1)*45),n++),i.show()}e("#font_menu").show()}else e("#font_menu").hide()}this.__defineGetter__("type",function(){return"text"}),this.el=e(u),e("#menu").append(this.el),this.panel_label=new p(e("#panel_label"),"Text","/images/text_icon.png","medium",!1),this.panel_label.setEnabled(!1),this.panel_label.setPos(0,0),this.text_input=new s(e("#text_input"),"",170,!0),this.text_input.setPos(90,0),this.current_font="architects_daughter",this.text_input.input_el.css("width","150"),this.text_input.input_el.css("height","72"),this.opacity_control=new n(e("#opacity_control")),this.opacity_control.setPos(400,45),this.align_left_button=new i(e("#align_left_button"),null,"/images/align_left_icon.png",40,undefined,25,25,!1),this.align_left_button.setPos(265,45),this.align_center_button=new i(e("#align_center_button"),null,"/images/align_center_icon.png",40,undefined,25,25,!1),this.align_center_button.setPos(310,45),this.align_right_button=new i(e("#align_right_button"),null,"/images/align_right_icon.png",40,undefined,25,25,!1),this.align_right_button.setPos(355,45),this.color_selector=new o(e("#color_selector"),"Color",130),this.color_selector.setPos(265,0);var a=this;this.color_selector.change(function(){a.text_manipulator.setTextColor(a.color_selector.getValue()),a.text_manipulator.drawBackground()}),this.alignButtonGroup=new r([this.align_left_button,this.align_center_button,this.align_right_button],this.align_center_button,f),this.cancel_button=new i(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(640,45),this.accept_button=new i(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(640,0),this.font_button=new t(e("#font_button"),a.current_font,"/fonts/"+a.current_font+".png"),this.font_button.setPos(400,0),this.font_button.click(function(){w()}),this.textTexture=null,this.text_manipulator=null,this.textvalue="",WebGL.scaleToFit(),this.historyImage=Canvas.getCurrentImage(),this.lastWidth=Canvas.getImageWidth(),this.lastHeight=Canvas.getImageHeight(),this.resizedImage=null,this.resizedWidth=0,this.resizedHeight=0,this.max_image_size=2048,this.imageResized=!1,setTimeout(function(){gl.disable(gl.DEPTH_TEST),gl.enable(gl.BLEND),y(),WebGL.drawScene(),b(),a.cancel_button.click(function(){c(),AnalyticsTracker.sendEvent("adjustment_text_cancel")}),a.accept_button.click(function(){a.accept(),AnalyticsTracker.sendEvent("adjustment_text_apply",a.current_font)}),AnalyticsTracker.sendEvent("adjustment_text_select"),a.text_input.input_el.keyup(function(e){var t=a.text_input.input_el.val();a.text_manipulator.setText(t),a.text_manipulator.drawBackground()});var t=v();a.text_manipulator=new l(a,Math.round(t.x),Math.round(t.y),Math.round(Canvas.getImageWidth()*Canvas.getScale()),Math.round(Canvas.getImageHeight()*Canvas.getScale())),a.text_manipulator&&(a.text_manipulator.setTextColor(TEXT_PANEL_COLOR),a.text_manipulator.draw(),TopMenu.setTextManipulator(a.text_manipulator)),Canvas.getImageHeight()>2e3||Canvas.getImageWidth()>2e3?TopMenu.setMaximumScale(1):Canvas.getImageHeight()>800||Canvas.getImageWidth()>800?TopMenu.setMaximumScale(2):TopMenu.setMaximumScale(3),a.opacity_control.change(h),e(window).resize(a.onResize);var n=[];for(var r in d)n.push(d[r]);WebFont.load({custom:{families:n,urls:["../css/font.css"]}})},10),this.onResize=function(){console.log("onResize"),a.text_manipulator.draw()}}var d={aaargh:"Aaargh",alpha_echo:"Alpha Echo",amaranth:"Amaranth",architects_daughter:"Architects Daughter",artifika:"Artifika",bebas:"Bebas",bitsteam_vera:"Bitstream Vera Sans",black_casper:"Black Casper",bpdots:"BPDots",cabin_sketch:"Cabin Sketch",candal:"Candal",comic_zine_ot:"Comic Zine OT",crimson:"Crimson",deftone_stylus:"Deftone Stylus",district:"District",flavors:"Flavors",harabara_hand:"Harabara Hand",idolwild:"Idolwild",jenna_sue:"Jenna Sue",mountains_of_christmas:"Mountains of Christmas"};return m.prototype.accept=function(){this.imageResized==1?History.commit("text",this.resizedImage,this.resizedWidth,this.resizedHeight):History.commit("text",this.historyImage,this.lastWidth,this.lastHeight);var e=this.text_manipulator.getTextTexture();if(e!=null){this.textTexture=new a;var t=this;this.textTexture.fromText(e,function(e){t.textTexture!=null&&t.textTexture.destroy(),t.textTexture=e,t.textTexture.setCanvas(Canvas.getImageWidth(),Canvas.getImageHeight()),WebGL.setTextTexture(t.textTexture),WebGL.setTextOffset(0,0),WebGL.render(),t.exitPanel(),Canvas.saveCurrentImage(!1)})}else this.exitPanel(),Canvas.saveCurrentImage(!1)},m.prototype.exitPanel=function(t){e(window).off("resize",this.onResize),gl.enable(gl.DEPTH_TEST),gl.disable(gl.BLEND),t&&this.imageResized==1&&(Canvas.setImageWidth(this.lastWidth),Canvas.setImageHeight(this.lastHeight),WebGL.reset(),this.imageResized=!1),WebGL.setTextTexture(null),WebGLShaders.setProgram("passthru"),WebGL.drawScene(),this.text_manipulator&&(TopMenu.setTextManipulator(null),this.text_manipulator.remove()),TopMenu.setMaximumScale(8),this.el.remove(),MainMenu.show()},m.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},m.prototype.getWidth=function(){return this.el.width()},m.prototype.hide=function(){this.el.hide()},m.prototype.show=function(){this.el.show()},m}),define("text!ui/panels/test_panel.html",[],function(){return'<div class="panel" id="color_panel" style="\n	position:absolute;\n	width:550px;\n">\n\n<div id="param1_slider"></div>\n<div id="param2_slider"></div>\n\n<div id="accept_button"></div>\n<div id="cancel_button"></div>\n\n</div>'}),define("app/panels/TestPanel",["jquery","slider","app/controls/SliderBox","app/controls/Button","text!ui/panels/test_panel.html"],function(e,t,n,r,i){function s(){function s(){NaClTouchUp.doClarity(t.param1_slider.getValue(),t.param2_slider.getValue())}function o(){Canvas.loadCurrentImage(),WebGL.drawScene(),t.exitPanel()}this.__defineGetter__("type",function(){return"test"}),this.el=e(i),e("#controls").append(this.el),this.param1_slider=new n(e("#param1_slider"),"Alpha",-2,2,1,.01),this.param1_slider.setPos(0,0),this.param2_slider=new n(e("#param2_slider"),"Beta",-2,2,1,.01),this.param2_slider.setPos(225,0),this.cancel_button=new r(e("#cancel_button"),"Cancel","/images/cancel_icon.png",100,"#c60c0c"),this.cancel_button.setPos(450,45),this.accept_button=new r(e("#accept_button"),"Accept","/images/confirm_icon.png",100),this.accept_button.setPos(450,0);var t=this;setTimeout(function(){t.lastWidth=Canvas.getImageWidth(),t.lastHeight=Canvas.getImageHeight(),NaClTouchUp.loadImage("clarity_filter"),t.param1_slider.mouseup(s),t.param2_slider.mouseup(s),t.cancel_button.click(function(){o()}),t.accept_button.click(function(){t.accept()}),s()},10)}return s.prototype.accept=function(){History.commit("test",Canvas.getCurrentImage(),this.lastWidth,this.lastHeight),this.exitPanel(),Canvas.saveCurrentImage()},s.prototype.exitPanel=function(){NaClTouchUp.unloadImage(),this.el.remove(),MainMenu.show()},s.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},s.prototype.getWidth=function(){return this.el.width()},s.prototype.hide=function(){this.el.hide()},s.prototype.show=function(){this.el.show()},s}),define("app/Panels",["app/panels/ContrastPanel","app/panels/ColorPanel","app/panels/AutoFixPanel","app/panels/FocalBlurPanel","app/panels/CropPanel","app/panels/ResizePanel","app/panels/RotatePanel","app/panels/TouchUpPanel","app/panels/ClonePanel","app/panels/EffectsPanel","app/panels/BlurPanel","app/panels/OverlayPanel","app/panels/SharpenPanel","app/panels/AirbrushPanel","app/panels/DenoisePanel","app/panels/LiquifyPanel","app/panels/TextPanel","app/panels/TestPanel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){return{ContrastPanel:e,ColorPanel:t,AutoFixPanel:n,FocalBlurPanel:r,CropPanel:i,ResizePanel:s,RotatePanel:o,TouchUpPanel:u,ClonePanel:a,EffectsPanel:f,BlurPanel:l,OverlayPanel:c,SharpenPanel:h,AirbrushPanel:p,DenoisePanel:d,LiquifyPanel:v,TextPanel:m,TestPanel:g}}),define("app/MainMenu",["jquery","app/AnimatedMenu","text!ui/main_menu.html","app/controls/IconButton","app/Panels"],function(e,t,n,r,i){function d(){e("body").append(n),s=new r(e("#button_adjustments"),"Adjust","/images/adjustments_icon.png","medium",!0),c.push(s),o=new r(e("#button_effects"),"Effects","/images/effects_icon.png","medium"),c.push(o),u=new r(e("#button_overlays"),"Overlays","/images/overlays_icon.png","medium"),c.push(u),f=new r(e("#button_text"),"Type","/images/text_icon.png","medium"),c.push(f),e("#main_menu").css("width",c.length*90-5),m(),v(),e(window).resize(g),g()}function v(){var n=[],i;i=new r(e("<div></div>"),"Crop","/images/crop_icon.png","small"),i.click(function(){y("crop")}),n.push(i),i=new r(e("<div></div>"),"Resize","/images/resize_icon.png","small"),i.click(function(){y("resize")}),n.push(i),i=new r(e("<div></div>"),"Rotate","/images/rotate_icon.png","small"),i.click(function(){y("rotate")}),n.push(i),i=new r(e("<div></div>"),"Contrast","/images/contrast_icon.png","small"),i.click(function(){y("contrast")}),n.push(i),i=new r(e("<div></div>"),"Color","/images/color_icon.png","small"),i.click(function(){y("color")}),n.push(i),i=new r(e("<div></div>"),"Auto Fix","/images/auto_fix_icon.png","small"),i.click(function(){y("auto_fix")}),n.push(i),i=new r(e("<div></div>"),"Focal Blur","/images/focal_blur_icon.png","small"),i.click(function(){y("focal_blur")}),n.push(i),NACL_IS_SUPPORTED&&(i=new r(e("<div></div>"),"Touch&nbsp;Up","/images/touch_up_icon.png","small"),i.click(function(){y("touch_up")}),n.push(i)),i=new r(e("<div></div>"),"Clone","/images/clone_icon.png","small"),i.click(function(){y("clone")}),n.push(i),i=new r(e("<div></div>"),"Sharpen","/images/sharpen_icon.png","small"),i.click(function(){y("sharpen")}),n.push(i),i=new r(e("<div></div>"),"Blur","/images/blur_icon.png","small"),i.click(function(){y("blur")}),n.push(i),i=new r(e("<div></div>"),"Airbrush","/images/airbrush_icon.png","small"),i.click(function(){y("airbrush")}),n.push(i),i=new r(e("<div></div>"),"Smooth","/images/denoise_icon.png","small"),i.click(function(){y("denoise")}),n.push(i),i=new r(e("<div></div>"),"Liquify","/images/liquify_icon.png","small"),i.click(function(){y("liquify")}),n.push(i),p=new t("adjust_menu","#menu",n,s.getPos().x+s.getWidth()/2,95)}function m(){s.click(function(){var e=s.getPos().x;e+=42.5,p.isOpen()?(p.animateClosed(),s.setHighlight(!1)):(p.animateOpen(),s.setHighlight(!0))}),o.click(function(){p.isOpen()&&(e("#adjust_menu").hide(),p.close(),s.setHighlight(!1,!1)),h=new i.EffectsPanel,e("#main_menu").hide(),History.setEnabled(!1);var t=h.getWidth(),n=e(window).innerWidth()/2-t/2;h.setPos(n,0)}),u.click(function(){p.isOpen()&&(e("#adjust_menu").hide(),p.close(),s.setHighlight(!1,!1)),h=new i.OverlayPanel,e("#main_menu").hide(),History.setEnabled(!1);var t=h.getWidth(),n=e(window).innerWidth()/2-t/2;h.setPos(n,0)}),f.click(function(){p.isOpen()&&(e("#adjust_menu").hide(),p.close(),s.setHighlight(!1,!1)),h=new i.TextPanel,e("#main_menu").hide(),History.setEnabled(!1);var t=h.getWidth(),n=e(window).innerWidth()/2-t/2;h.setPos(n,0)})}function g(){e("#menu").css("width",e(window).innerWidth()+"px");var t=e(window).innerWidth()/2-e("#main_menu").width()/2;for(var n=0;n<c.length;n++){var r=c[n];r.setPos(t+n*90,0)}p.setInitialX(s.getPos().x+s.getWidth()/2),p.onResize();if(h){var i=h.getWidth(),o=e(window).innerWidth()/2-i/2;h.setPos(o,0)}}function y(t){console.log("showpanel for "+t),History.setEnabled(!1),e("#main_menu").hide(),e("#adjust_menu").hide();switch(t){case"contrast":h=new i.ContrastPanel;break;case"color":h=new i.ColorPanel;break;case"auto_fix":h=new i.AutoFixPanel;break;case"focal_blur":h=new i.FocalBlurPanel;break;case"crop":h=new i.CropPanel;break;case"resize":h=new i.ResizePanel;break;case"rotate":h=new i.RotatePanel;break;case"clone":h=new i.ClonePanel;break;case"touch_up":h=new i.TouchUpPanel;break;case"sharpen":h=new i.SharpenPanel;break;case"blur":h=new i.BlurPanel;break;case"airbrush":h=new i.AirbrushPanel;break;case"denoise":h=new i.DenoisePanel;break;case"liquify":h=new i.LiquifyPanel}g()}function b(){h=null,e("#main_menu").show(),p.isOpen()&&e("#adjust_menu").show(),g(),History.setEnabled(!0)}function w(t){e("#main_menu").css("display",t?"block":"none"),p.isOpen()&&(t?e("#adjust_menu").show():e("#adjust_menu").hide())}function E(){c=[],e("#main_menu").remove(),e("#adjust_menu").remove()}function S(){return h}var s,o,u,a,f,l,c=[],h=null,p=null;return{init:d,hide:E,show:b,setVisible:w,getPanel:S}}),define("text!ui/top_menu.html",[],function(){return'<div id="top_menu" style="\n	position:absolute;\n	width:100%;\n	height:50px;\n	top:35px;\n	z-index:10;\n	pointer-events:none;\n">\n<style>\n#top_menu div {\n	pointer-events: auto;\n}\n</style>\n\n<div id="button_save"></div>\n<div id="button_close"></div>\n\n\n\n<div id="button_undo"></div>\n<div id="button_redo"></div>\n\n<div id="zoom_control"></div>\n<div id="button_zoom_fit"></div>\n<div id="button_zoom_actual"></div>\n<div id="preview_box"></div>\n\n</div>'}),define("text!ui/zoom_control.html",[],function(){return'<div id="zoom_control" style="\n	position:absolute;\n	border-radius:5px;\n	color:#ffffff;\n	background-color:#444444;\n	width:220px;\n	height:35px;\n">\n\n<input type="text" id="input" size="4" maxlength="3" style="\n	position:absolute;\n	top:5px;\n	right:60px;\n	color:#ffffff;\n	border:0;\n	background-color:transparent;\n	font-size:13px;\n	pointer-events:none;\n	width:46px;\n"/>\n\n<div id="slider" style="\n	position:absolute;\n	top:4px;\n	left:7px;\n	width:100px;\n"></div>\n\n\n\n</div>'}),define("app/controls/ZoomControl",["jquery","text!ui/zoom_control.html","slider"],function(e,t,n){function r(r){this.el=r,this.update_canvas=!0,this.maximum_scale=8,this.minimum_scale=.3;var i=e(t);this.slider=new n(i.find("#slider")[0],i.find("#input")[0],"horizontal"),this.slider.displayFilter(function(e){var t;return e<=100?t=s.minimum_scale+e/100*(1-s.minimum_scale):t=(e-100)/100*(s.maximum_scale-1)+1,Math.round(t*100)+"%"}),this.slider.setMinimum(0),this.slider.setMaximum(200),this.el.replaceWith(i),this.el=i;var s=this;console.log("zoom control init"),this.slider.onchange=function(){if(s.update_canvas){var e=s.slider.getValue(),t;e<=100?t=s.minimum_scale+e/100*(1-s.minimum_scale):t=(e-100)/100*(s.maximum_scale-1)+1,console.log("zoom slider updating canvas: "+t),Canvas.setScale(t,!1),TopMenu.getTextManipulator()!=null&&TopMenu.getTextManipulator().draw()}TopMenu.updatePreview(s.update_canvas)}}return r.prototype.setMinimumScale=function(e){this.minimum_scale=e,this.update_canvas=!1,this.update_canvas=!0},r.prototype.getMinimumScale=function(){return this.minimum_scale},r.prototype.getMaximumScale=function(){return this.maximum_scale},r.prototype.setMaximumScale=function(e){this.maximum_scale=e},r.prototype.setEnabled=function(t){t?(e("#zoom_control").css("pointer-events","auto"),e("#zoom_control #slider").css("pointer-events","auto"),e("#zoom_control #slider .line").css("pointer-events","auto"),e("#zoom_control #slider .handle").css("pointer-events","auto")):(e("#zoom_control").css("pointer-events","none"),e("#zoom_control #slider").css("pointer-events","none"),e("#zoom_control #slider .line").css("pointer-events","none"),e("#zoom_control #slider .handle").css("pointer-events","none"))},r.prototype.mousedown=function(e){this.slider.mousedown(e)},r.prototype.mouseup=function(e){this.slider.mouseup(e)},r.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},r.prototype.getValue=function(){return this.slider.getValue()},r.prototype.setScale=function(e){console.log("ZoomControl set scale = "+e);var t;e<=1?t=parseInt((e-this.minimum_scale)/(1-this.minimum_scale)*100):t=parseInt((e-1)/(this.maximum_scale-1)*100)+100,this.update_canvas=!1,this.slider.setValue(t),this.update_canvas=!0},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r}),define("text!ui/preview_box.html",[],function(){return'<div style="\n	position:absolute;\n	border: solid 1px #404040;\n	height:70px;\n">\n\n<canvas id="preview" height="70" width="0" style="\n	position:absolute"></canvas>\n\n<div id="marker" style="\n	position:absolute;\n	width:1px;\n	height:1px;\n	border:solid 1px red;\n"></div>\n\n</div>'}),define("app/controls/PreviewBox",["jquery","text!ui/preview_box.html","slider"],function(e,t,n){function r(n){this.el=n;var r=e(t);this.el.replaceWith(r),this.el=r,this.canvas_el=r.find("#preview")[0],this.marker_el=r.find("#marker"),this.canvas_el.height=70*window.devicePixelRatio;var i,s,o,u,a=!1,f=this;this.marker_el.mousedown(function(t){i=t.pageX,s=t.pageY,o=parseInt(e(this).css("left")),u=parseInt(e(this).css("top")),a=!0}),e(window).mousemove(function(e){if(a){console.log(e.pageX-i+","+(e.pageY-s));var t=Math.max(0,o+e.pageX-i);t=Math.min(f.getWidth()-f.getMarkerWidth()-2,t);var n=Math.max(0,u+e.pageY-s);n=Math.min(f.getHeight()-f.getMarkerHeight()-2,n),f.marker_el.css("left",t),f.marker_el.css("top",n),f.panCanvasToMarkerPos(t,n)}}),e(window).mouseup(function(e){a&&(a=!1)}),this.panCanvasToMarkerPos=function(e,t){var n=Canvas.getOffset(),r=Canvas.getScale(),i=Canvas.getImageWidth(),s=Canvas.getImageHeight(),o=Canvas.getImageWidth()*r,u=Canvas.getImageHeight()*r;console.log("x span = "+(this.getWidth()-this.getMarkerWidth())),console.log("y span = "+(this.getHeight()-this.getMarkerHeight()));var a=this.getWidth()-this.getMarkerWidth()-2,f=this.getHeight()-this.getMarkerHeight()-2,l=a<=0?0:-2*(e/a-.5)*(1-Canvas.getWidth()/i/r),c=f<=0?0:2*(t/f-.5)*(1-Canvas.getHeight()/s/r);console.log("marker pos: "+e+","+t),console.log("new offset: "+l+","+c),Canvas.setOffset(l,c)}}return r.prototype.setPixels=function(e,t,n){var r=this.canvas_el.getContext("2d"),i=r.createImageData(e,t);for(var s=0;s<t;s++)for(var o=0;o<e;o++){var u=4*(s*e+o);i.data[u]=n[u],i.data[u+1]=n[u+1],i.data[u+2]=n[u+2],i.data[u+3]=255}r.putImageData(i,0,0)},r.prototype.setWidth=function(e){this.el.css("width",e+"px"),this.canvas_el.width=e*window.devicePixelRatio,this.el.find("#preview").css("width",e)},r.prototype.getWidth=function(){return this.canvas_el.width/window.devicePixelRatio},r.prototype.getHeight=function(){return this.canvas_el.height/window.devicePixelRatio},r.prototype.setMarkerPos=function(e,t){this.marker_el.css("left",e),this.marker_el.css("top",t)},r.prototype.getMarkerWidth=function(){return parseInt(this.marker_el.css("width"))},r.prototype.getMarkerHeight=function(){return parseInt(this.marker_el.css("height"))},r.prototype.setMarkerSize=function(e,t){this.marker_el.css("width",e+"px"),this.marker_el.css("height",t+"px")},r.prototype.update=function(e){var t=Canvas.getScale(),n=Canvas.getWidth(),r=Canvas.getHeight(),i=Canvas.getImageWidth(),s=Canvas.getImageHeight(),o=i*t,u=s*t;if(i*t<n&&s*t<r)this.hide(),(Canvas.getOffset().x!=0||Canvas.getOffset().y!=0)&&Canvas.setOffset(0,0);else{this.show();var a=Math.min(1,n/o),f=Math.min(1,r/u);this.setMarkerSize((this.getWidth()-2)*a,(this.getHeight()-2)*f);var l=!1,c=Canvas.getOffset(),h=this.getWidth()-this.getMarkerWidth()-2,p=this.getHeight()-this.getMarkerHeight()-2,d=(c.x/-2/(1-n/i/t)+.5)*h,v=(c.y/2/(1-r/s/t)+.5)*p;(d<0||v<0||d>h||v>p)&&this.panCanvasToMarkerPos(Math.min(h,Math.max(0,d)),Math.min(p,Math.max(0,v))),d=Math.min(h,Math.max(0,d)),v=Math.min(p,Math.max(0,v));var m=Math.max(0,-d/o),g=Math.max(0,-v/u);this.setMarkerPos(d,v)}},r.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},r.prototype.isVisible=function(){return console.log("isvis: "+this.el.css("display")),this.el.css("display")!="none"},r.prototype.hide=function(){this.el.hide()},r.prototype.show=function(){this.el.show()},r}),define("app/HistoryStep",[],function(){return function(e,t,n,r){return{bitmap:t,width:n,height:r,info:e}}}),define("app/History",["jquery","app/HistoryStep"],function(e,t){function n(e,t,n){this.size=e,this.undobutton=t,this.redobutton=n,this.undo=[],this.redo=[],this.steps=[]}return n.prototype.setEnabled=function(e){if(e){var n=this;this.undobutton.click(function(){console.log("undo clicked: "+n.undo.length);if(n.undo.length>0){var e=n.undo.pop(),r=Canvas.getCurrentImage();n.redo.push(new t(e.info,r,Canvas.getImageWidth(),Canvas.getImageHeight()));if(e.width!=Canvas.getImageWidth()||e.height!=Canvas.getImageHeight())Canvas.setImageWidth(e.width),Canvas.setImageHeight(e.height),WebGL.reset();WebGL.loadImageData(e.bitmap,!1),WebGL.drawScene(),Canvas.setCurrentImage(e.bitmap),n.undo.length==0&&n.undobutton.setEnabled(!1),n.redobutton.setEnabled(!0),AnalyticsTracker.sendEvent("undo")}}),this.redobutton.click(function(){console.log("redo clicked: "+n.redo.length);if(n.redo.length>0){var e=n.redo.pop(),r=Canvas.getCurrentImage();n.undo.push(new t(e.info,r,Canvas.getImageWidth(),Canvas.getImageHeight()));if(e.width!=Canvas.getImageWidth()||e.height!=Canvas.getImageHeight())Canvas.setImageWidth(e.width),Canvas.setImageHeight(e.height),WebGL.reset();WebGL.loadImageData(e.bitmap,!1),WebGL.drawScene(),Canvas.setCurrentImage(e.bitmap),n.redo.length==0&&n.redobutton.setEnabled(!1),n.undobutton.setEnabled(!0),AnalyticsTracker.sendEvent("redo")}}),this.redo.length>0?this.redobutton.setEnabled(!0):this.redobutton.setEnabled(!1),this.undo.length>0?this.undobutton.setEnabled(!0):this.undobutton.setEnabled(!1)}else this.redobutton.click(null),this.undobutton.click(null),this.redobutton.setEnabled(!1),this.undobutton.setEnabled(!1)},n.prototype.clear=function(e){this.undobutton.off("click"),this.redobutton.off("click"),this.undo=[],this.redo=[],this.steps=[]},n.prototype.getUndoButton=function(){return this.undobutton},n.prototype.getRedoButton=function(){return this.redobutton},n.prototype.hasUndoSteps=function(){return this.undo.length>0},n.prototype.commit=function(e,n,r,i){if(n!=null){Canvas.setHasUnsavedChanges(!0),this.undo.length==0&&this.undobutton.setEnabled(!0),this.redobutton.setEnabled(!1);var s=new t(e,n,r,i);this.undo.push(s);while(this.undo.length>this.size){console.log("shifting undo");var o=this.undo.shift();o.bitmap=null,this.steps.push(o)}while(this.redo.length>0)this.redo.shift()}},n}),define("text!ui/view_save.html",[],function(){return'<div id="view_modal" style="\n	position:absolute;\n	background-color:#606060;\n	opacity:0.0;\n"></div>\n\n<div id="view_save" style="\n	position:absolute;\n	width:220px;\n	height:325px;\n">\n\n<div id="filename_input"></div>\n<div id="quality_slider"></div>\n\n<div id="label_file_size" style="\n	position:absolute;\n	top:166px;\n	left:30px;\n	width:160px;\n	color:white;\n	font-size:12px;\n"></div>\n\n<div id="button_save_computer"></div>\n<div id="button_save_gdrive"></div>\n<div id="button_cancel"></div>\n\n</div>\n\n'}),function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=n&&e.Uint8Array&&function(){try{return(new Blob([new Uint8Array(100)])).size===100}catch(e){return!1}}(),i=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,s=(n||i)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,s,o,u,a,f;console.log(e),e.split(",")[0].indexOf("base64")>=0?t=atob(e.split(",")[1]):t=decodeURIComponent(e.split(",")[1]),s=new ArrayBuffer(t.length),o=new Uint8Array(s);for(u=0;u<t.length;u+=1)o[u]=t.charCodeAt(u);return a=e.split(",")[0].split(":")[1].split(";")[0],n?new Blob([r?o:s],{type:a}):(f=new i,f.append(s),f.getBlob(a))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,n,r){r&&t.toDataURL&&s?e(s(this.toDataURL(n,r))):e(this.mozGetAsFile("blob",n))}:t.toDataURL&&s&&(t.toBlob=function(e,t,n){e(s(this.toDataURL(t,n)))})),typeof define=="function"&&define.amd?define("canvas-to-blob",[],function(){return s}):e.dataURLtoBlob=s}(this),define("jpeg_encoder_basic",[],function(){function D(e){var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var u=0;u<64;u++){var a=n((t[u]*e+50)/100);a<1?a=1:a>255&&(a=255),r[T[u]]=a}var f=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var l=0;l<64;l++){var c=n((f[l]*e+50)/100);c<1?c=1:c>255&&(c=255),i[T[l]]=c}var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0;for(var d=0;d<8;d++)for(var v=0;v<8;v++)s[p]=1/(r[T[p]]*h[d]*h[v]*8),o[p]=1/(i[T[p]]*h[d]*h[v]*8),p++}function P(e,t){var n=0,r=0,i=new Array;for(var s=1;s<=16;s++){for(var o=1;o<=e[s];o++)i[t[r]]=[],i[t[r]][0]=n,i[t[r]][1]=s,r++,n++;n*=2}return i}function H(){u=P(N,C),a=P(A,O),f=P(k,L),l=P(M,_)}function B(){var e=1,t=2;for(var n=1;n<=15;n++){for(var r=e;r<t;r++)h[32767+r]=n,c[32767+r]=[],c[32767+r][1]=n,c[32767+r][0]=r;for(var i=-(t-1);i<=-e;i++)h[32767+i]=n,c[32767+i]=[],c[32767+i][1]=n,c[32767+i][0]=t-1+i;e<<=1,t<<=1}}function j(){for(var e=0;e<256;e++)S[e]=19595*e,S[e+256>>0]=38470*e,S[e+512>>0]=7471*e+32768,S[e+768>>0]=-11059*e,S[e+1024>>0]=-21709*e,S[e+1280>>0]=32768*e+8421375,S[e+1536>>0]=-27439*e,S[e+1792>>0]=-5329*e}function F(e){var t=e[0],n=e[1]-1;while(n>=0)t&1<<n&&(m|=1<<g),n--,g--,g<0&&(m==255?(I(255),I(0)):I(m),g=7,m=0)}function I(e){v.push(E[e])}function q(e){I(e>>8&255),I(e&255)}function R(e,t){var n,r,i,s,o,u,a,f,l=0,c;const h=8,d=64;for(c=0;c<h;++c){n=e[l],r=e[l+1],i=e[l+2],s=e[l+3],o=e[l+4],u=e[l+5],a=e[l+6],f=e[l+7];var v=n+f,m=n-f,g=r+a,y=r-a,b=i+u,w=i-u,E=s+o,S=s-o,x=v+E,T=v-E,N=g+b,C=g-b;e[l]=x+N,e[l+4]=x-N;var k=(C+T)*.707106781;e[l+2]=T+k,e[l+6]=T-k,x=S+w,N=w+y,C=y+m;var L=(x-C)*.382683433,A=.5411961*x+L,O=1.306562965*C+L,M=N*.707106781,_=m+M,D=m-M;e[l+5]=D+A,e[l+3]=D-A,e[l+1]=_+O,e[l+7]=_-O,l+=8}l=0;for(c=0;c<h;++c){n=e[l],r=e[l+8],i=e[l+16],s=e[l+24],o=e[l+32],u=e[l+40],a=e[l+48],f=e[l+56];var P=n+f,H=n-f,B=r+a,j=r-a,F=i+u,I=i-u,q=s+o,R=s-o,U=P+q,z=P-q,W=B+F,X=B-F;e[l]=U+W,e[l+32]=U-W;var V=(X+z)*.707106781;e[l+16]=z+V,e[l+48]=z-V,U=R+I,W=I+j,X=j+H;var $=(U-X)*.382683433,J=.5411961*U+$,K=1.306562965*X+$,Q=W*.707106781,G=H+Q,Y=H-Q;e[l+40]=Y+J,e[l+24]=Y-J,e[l+8]=G+K,e[l+56]=G-K,l++}var Z;for(c=0;c<d;++c)Z=e[c]*t[c],p[c]=Z>0?Z+.5|0:Z-.5|0;return p}function U(){q(65504),q(16),I(74),I(70),I(73),I(70),I(0),I(1),I(1),I(0),q(1),q(1),I(0),I(0)}function z(e,t){q(65472),q(17),I(8),q(t),q(e),I(3),I(1),I(17),I(0),I(2),I(17),I(1),I(3),I(17),I(1)}function W(){q(65499),q(132),I(0);for(var e=0;e<64;e++)I(r[e]);I(1);for(var t=0;t<64;t++)I(i[t])}function X(){q(65476),q(418),I(0);for(var e=0;e<16;e++)I(N[e+1]);for(var t=0;t<=11;t++)I(C[t]);I(16);for(var n=0;n<16;n++)I(k[n+1]);for(var r=0;r<=161;r++)I(L[r]);I(1);for(var i=0;i<16;i++)I(A[i+1]);for(var s=0;s<=11;s++)I(O[s]);I(17);for(var o=0;o<16;o++)I(M[o+1]);for(var u=0;u<=161;u++)I(_[u])}function V(){q(65498),q(12),I(3),I(1),I(0),I(2),I(17),I(3),I(17),I(0),I(63),I(0)}function $(e,t,n,r,i){var s=i[0],o=i[240],u;const a=16,f=63,l=64;var p=R(e,t);for(var v=0;v<l;++v)d[T[v]]=p[v];var m=d[0]-n;n=d[0],m==0?F(r[0]):(u=32767+m,F(r[h[u]]),F(c[u]));var g=63;for(;g>0&&d[g]==0;g--);if(g==0)return F(s),n;var y=1,b;while(y<=g){var w=y;for(;d[y]==0&&y<=g;++y);var E=y-w;if(E>=a){b=E>>4;for(var S=1;S<=b;++S)F(o);E&=15}u=32767+d[y],F(i[(E<<4)+h[u]]),F(c[u]),y++}return g!=f&&F(s),n}function J(){var e=String.fromCharCode;for(var t=0;t<256;t++)E[t]=e(t)}function K(e,t,n,r){var i=(new Date).getTime();r&&Q(r),v=new Array,m=0,g=7,q(65496),U(),W(),z(t,n),X(),V();var c=0,h=0,p=0;m=0,g=7,this.encode.displayName="_encode_";var d=e,E=t,x=n,T=E*4,N=E*3,C,k=0,L,A,O,M,_,D,P,H;while(k<x){C=0;while(C<T){M=T*k+C,_=M,D=-1,P=0;for(H=0;H<64;H++)P=H>>3,D=(H&7)*4,_=M+P*T+D,k+P>=x&&(_-=T*(k+1+P-x)),C+D>=T&&(_-=C+D-T+4),L=d[_++],A=d[_++],O=d[_++],y[H]=(S[L]+S[A+256>>0]+S[O+512>>0]>>16)-128,b[H]=(S[L+768>>0]+S[A+1024>>0]+S[O+1280>>0]>>16)-128,w[H]=(S[L+1280>>0]+S[A+1536>>0]+S[O+1792>>0]>>16)-128;c=$(y,s,c,u,f),h=$(b,o,h,a,l),p=$(w,o,p,a,l),C+=32}k+=8}if(g>=0){var B=[];B[1]=g+1,B[0]=(1<<g+1)-1,F(B)}q(65497);var j=v.length,I="data:image/jpeg;base64,"+btoa(v.join(""));v=[];var R=(new Date).getTime()-i;return console.log("Encoding time: "+R+"ms"),{dataUri:I,file_size:j}}function Q(e){e<=0&&(e=1),e>100&&(e=100);if(x==e)return;var t=0;e<50?t=Math.floor(5e3/e):t=Math.floor(200-e*2),D(t),x=e,console.log("Quality set to: "+e+"%")}function G(){var t=(new Date).getTime();e||(e=50),J(),H(),B(),j(),Q(e);var n=(new Date).getTime()-t;console.log("Initialization "+n+"ms")}function Y(e){var t=typeof e=="string"?document.getElementById(e):e,n=document.createElement("canvas");n.width=t.width,n.height=t.height;var r=n.getContext("2d");return r.drawImage(t,0,0),r.getImageData(0,0,n.width,n.height)}var e,t=Math.round,n=Math.floor,r=new Array(64),i=new Array(64),s=new Array(64),o=new Array(64),u,a,f,l,c=new Array(65535),h=new Array(65535),p=new Array(64),d=new Array(64),v=[],m=0,g=7,y=new Array(64),b=new Array(64),w=new Array(64),E=new Array(256),S=new Array(2048),x,T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],N=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],k=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],_=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];return G(),{init:G,encode:K}});var RetryHandler=function(){this.interval=1e3,this.maxInterval=6e4};RetryHandler.prototype.retry=function(e){setTimeout(e,this.interval),this.interval=this.nextInterval_()},RetryHandler.prototype.reset=function(){this.interval=1e3},RetryHandler.prototype.nextInterval_=function(){var e=this.interval*2+this.getRandomInt_(0,1e3);return Math.min(e,this.maxInterval)},RetryHandler.prototype.getRandomInt_=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};var MediaUploader=function(e){var t=function(){};this.file=e.file,this.contentType=e.contentType||this.file.type||"application/octet-stream",this.metadata=e.metadata||{title:this.file.name,mimeType:this.contentType},this.token=e.token,this.onComplete=e.onComplete||t,this.onError=e.onError||t,this.offset=e.offset||0,this.chunkSize=e.chunkSize||0,this.retryHandler=new RetryHandler,this.progressBar=e.progressBar||0,this.url=e.url;if(!this.url){var n=e.params||{};n.uploadType="resumable",this.url=this.buildUrl_(e.fileId,n)}this.httpMethod=this.fileId?"PUT":"POST"};MediaUploader.prototype.upload=function(){var e=this,t=new XMLHttpRequest;t.open(this.httpMethod,this.url,!0),t.setRequestHeader("Authorization","Bearer "+this.token),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-Upload-Content-Length",this.file.size),t.setRequestHeader("X-Upload-Content-Type",this.contentType),t.onload=function(e){var t=e.target.getResponseHeader("Location");this.url=t,this.sendFile_()}.bind(this),t.onerror=this.onUploadError_.bind(this),t.send(JSON.stringify(this.metadata))},MediaUploader.prototype.sendFile_=function(){var e=this.file,t=this.file.size;if(this.offset||this.chunkSize)this.chunkSize&&(t=Math.min(this.offset+this.chunkSize,this.file.size)),e=e.slice(this.offset,t);var n=new XMLHttpRequest,r=this;n.upload.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log(t),r.progressBar&&r.progressBar.setValue(t)}},n.open("PUT",this.url,!0),n.setRequestHeader("Content-Type",this.contentType),n.setRequestHeader("Content-Range","bytes "+this.offset+"-"+(t-1)+"/"+this.file.size),n.setRequestHeader("X-Upload-Content-Type",this.file.type),n.onload=this.onContentUploadSuccess_.bind(this),n.onerror=this.onContentUploadError_.bind(this),n.send(e)},MediaUploader.prototype.resume_=function(){var e=new XMLHttpRequest;e.open("PUT",this.url,!0),e.setRequestHeader("Content-Range","bytes */"+this.file.size),e.setRequestHeader("X-Upload-Content-Type",this.file.type),e.onload=this.onContentUploadSuccess_.bind(this),e.onerror=this.onContentUploadError_.bind(this),e.send()},MediaUploader.prototype.extractRange_=function(e){var t=e.getResponseHeader("Range");t&&(this.offset=parseInt(t.match(/\d+/g).pop(),10)+1)},MediaUploader.prototype.onContentUploadSuccess_=function(e){e.target.status==200||e.target.status==201?this.onComplete(e.target.response):e.target.status==308&&(this.extractRange_(e.target),this.retryHandler.reset(),this.sendFile_())},MediaUploader.prototype.onContentUploadError_=function(e){e.target.status&&e.target.status<500?this.onError(e.target.response):this.retryHandler.retry(this.resume_.bind(this))},MediaUploader.prototype.onUploadError_=function(e){this.onError(e.target.response)},MediaUploader.prototype.buildQuery_=function(e){return e=e||{},Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},MediaUploader.prototype.buildUrl_=function(e,t){var n="https://www.googleapis.com/upload/drive/v2/files/";e&&(n+=e);var r=this.buildQuery_(t);return r&&(n+="?"+r),n},define("upload",function(){}),define("gdocs",["upload"],function(e){function t(e){var t="https://docs.google.com/feeds/";this.lastResponse=null,this.__defineGetter__("SCOPE",function(){return t}),this.__defineGetter__("DOCLIST_FEED",function(){return t+"default/private/full/"}),this.__defineGetter__("CREATE_SESSION_URI",function(){return"https://docs.google.com/feeds/upload/create-session/default/private/full?convert=false&alt=json"}),this.__defineGetter__("DEFAULT_CHUNK_SIZE",function(){return 5242880})}return t.prototype.auth=function(e,t){console.log("auth with chrome.identity");try{chrome.identity.getAuthToken({interactive:e},function(e){e?(this.accessToken=e,t&&t()):console.log("no token")}.bind(this))}catch(n){console.log(n)}},t.prototype.removeCachedAuthToken=function(e){if(this.accessToken){var t=this.accessToken;this.accessToken=null,chrome.identity.removeCachedAuthToken({token:t},function(){e&&e()})}else e&&e()},t.prototype.revokeAuthToken=function(e){if(this.accessToken){console.log("revoke auth token");var t=new XMLHttpRequest;t.open("GET","https://accounts.google.com/o/oauth2/revoke?token="+this.accessToken),t.send(),this.removeCachedAuthToken(e)}},t.prototype.makeRequest=function(e,t,n,r,i){var s=r||null,o=i||{},u=new XMLHttpRequest;u.open(e,t,!0),u.setRequestHeader("Authorization","Bearer "+this.accessToken);for(var a in o)u.setRequestHeader(a,o[a]);u.onload=function(e){this.lastResponse=this.response,n(this.lastResponse,this)}.bind(this),u.onerror=function(e){console.log(this,this.status,this.response,this.getAllResponseHeaders())},u.send(s)},t.prototype.getLink=function(e,t){for(var n=0,r;r=e[n];++n)if(r.rel===t)return r;return null},t.prototype.getDocumentList=function(e,t){var n=e||this.DOCLIST_FEED+"?alt=json";t?this.makeRequest("GET",n,t.bind(this)):this.makeRequest("GET",n,this.render.bind(this))},t.prototype.upload=function(e,t,n,r){var i=function(e){var n=JSON.parse(e).entry;t()}.bind(this),s=function(r){if(!n)throw new Error("Error: "+r);this.removeCachedAuthToken(this.auth.bind(this,!0,this.upload.bind(this,e,t,!1)))}.bind(this),o=new MediaUploader({token:this.accessToken,file:e,progressBar:r,onComplete:i,onError:s});o.upload()},t.prototype.render=function(e,t){var n=JSON.parse(e),r=document.createDocumentFragment();for(var i=0,s;s=n.feed.entry[i];++i){var o=document.createElement("li"),u=this.getLink(s.link,"http://schemas.google.com/docs/2007#icon").href,a=this.getLink(s.link,"alternate").href,f=['<img src="',u,'"> <a href="',a,'" target="_blank">',s.title.$t,"</a>"];s.docs$size&&f.push(" ("+s.docs$size.$t+" bytes)"),f.push(" ",Util.formatDate(s.updated.$t)),o.innerHTML=f.join(""),r.appendChild(o)}this.renderTarget.appendChild(r)},t}),define("text!ui/text_input_box.html",[],function(){return'<div style="\n	position:absolute;\n	background: #444444;\n	border-radius: 5px;\n	height:85px;\n">\n	<div style="padding:10px">\n	<div id="title" style="font-size:14px;color:white;padding:8px 17px 10px 17px;"></div>\n	<input id="input" type="text" style="\n		background-color:#222222;\n		font-size:14px;\n		color:white;\n		width:183px;\n		border:solid 1px #bbbbbb;\n		padding:0px 3px;\n		margin-left:5px;\n		"></input>\n	</div>\n	\n</div>'}),define("app/controls/TextInputBox",["jquery","text!ui/text_input_box.html"],function(e,t){function n(n,r,i){this.el=n,this.title=r,this.changeCallback=null;var s=e(t);s.attr("id",e(this.el).attr("id")),s.find("#title").html(this.title),s.css("width",i),this.el.replaceWith(s),this.el=s,this.input_el=s.find("#input")}return n.prototype.setValue=function(e){this.input_el.val(e)},n.prototype.getValue=function(){return this.input_el.val()},n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.change=function(e){this.changeCallback=e,this.input_el.keyup(e)},n}),define("text!ui/progress_dialog.html",[],function(){return'\n<div id="view_progress" style="\n	position:absolute;\n	width:220px;\n	z-index:10;\n	height:85px;\n	border-radius:5px;\n	background-color:#404040;\n">\n\n<div id="label_message" style="\n	\n	position:absolute;\n	top:0;\n	left:0;\n	padding:15px;\n	text-align:center;\n	width:190px;\n	color:white;\n	font-size:13px;\n"></div>\n\n<div style="padding:17px;padding-left:60px;padding-top:50px;" id="loading">\n		<div id="progress_bar" style="position:absolute;border-radius:2px;width:50px;height:6px;border:solid 1px #fff;background-color:#fff;margin-top:5px;"></div>\n		<div style="position:absolute;border-radius:2px;width:100px;height:6px;border:solid 1px #fff;margin-top:5px;"></div>\n		<span style="padding-left:110px;color:white;display:none" id="progress">100%</span>\n	</div>\n\n</div>\n\n'}),define("app/controls/ProgressDialog",["jquery","text!ui/progress_dialog.html"],function(e,t){function n(n){function i(){r.hide()}function s(){var t=e(window).height()/2-e("#view_progress #label_message").outerHeight()/2,n=e(window).width()/2-e("#view_progress #label_message").outerWidth()/2;e("#view_progress").css("left",n),e("#view_progress").css("top",t)}this.message=n,e("body").append(t),e("#view_progress #label_message").text(n);var r=this;this.setValue(0),e(window).resize(s),s()}return n.prototype.setValue=function(t){e("#view_progress #loading #progress").text(t.toFixed(1)+"%"),e("#view_progress #loading #progress_bar").css("width",Math.round(t)+"px")},n.prototype.hide=function(){e("#view_progress").remove()},n}),define("app/SaveView",["jquery","text!ui/view_save.html","app/controls/SliderBox","app/controls/Button","canvas-to-blob","jpeg_encoder_basic","gdocs","app/controls/TextInputBox","app/controls/ProgressDialog"],function(e,t,n,r,i,s,o,u,a){function f(f,l){function h(){c.hide(),TopMenu.setVisible(!0),MainMenu.setVisible(!0),PaintCanvas.setVisible(!0),WebGL.loadImageToTexture(c.pixels,!0),WebGL.drawScene()}function p(){v(),setTimeout(function(){var e=s.encode(c.pixels,Canvas.getImageWidth(),Canvas.getImageHeight(),c.quality_slider.getValue());c.imageDataURL=e.dataUri;var t=new Image;t.src=e.dataUri,WebGL.loadImageToTexture(t,!0),WebGL.drawScene(),m(e.file_size)},0)}function d(e){var t=["bytes","KB","MB"],n=0;while(e>=1024)n++,e/=1024;return n==2?e.toFixed(1)+" "+t[n]:Math.round(e)+" "+t[n]}function v(){e("#view_save #label_file_size").css("text-align","center"),e("#view_save #label_file_size").css("color","#acacac"),e("#view_save #label_file_size").html("Working, please wait..."),c.button_save.setEnabled(!1),c.button_save_gdrive.setEnabled(!1)}function m(t){e("#view_save #label_file_size").css("text-align","right"),e("#view_save #label_file_size").css("color","#ffffff"),e("#view_save #label_file_size").html(d(t)),c.button_save.setEnabled(!0),c.button_save_gdrive.setEnabled(!0)}function g(e){var t=Canvas.getImageWidth()*Canvas.getImageHeight()*4;chrome.fileSystem.chooseEntry({type:"saveFile",suggestedName:c.filename_input.getValue().replace(/\.[^/.]+$/,"")+".jpg"},function(t){if(chrome.runtime.lastError){console.log(chrome.runtime.lastError.message);return}i?(blob=i(c.imageDataURL),y(t,blob),e()):console.log("no window.dataURLtoBlob")})}function y(e,t){e.createWriter(function(e){e.onwriteend=function(e){this.error?console.log("Error during write: "+this.error.toString()):console.log("File saved successfully.")},e.write(t)})}function b(){var t=e(window).height()/2-e("#view_save").height()/2,n=e(window).width()/2-e("#view_save").width()/2;e("#view_save").css("left",n),e("#view_save").css("top",t),e("#view_modal").css("width",e(window).width()),e("#view_modal").css("height",e(window).height())}this.closeAfterSave=f,this.closeCallback=typeof l!="undefined"?l:null,console.log("close after save: "+f),console.log(this.closeCallback),e("body").append(t),this.quality_slider=new n(e("#view_save #quality_slider"),"Quality",1,100,85,1),this.quality_slider.setPos(0,90),this.button_cancel=new r(e("#view_save #button_cancel"),"Cancel","/images/cancel_icon.png",220,"#c60c0c"),this.button_cancel.setPos(0,285),this.button_save=new r(e("#view_save #button_save_computer"),"Save to My Computer","/images/confirm_icon.png",220),this.button_save.setPos(0,195),this.button_save_gdrive=new r(e("#view_save #button_save_gdrive"),"Save to Google Drive","/images/confirm_icon.png",220),this.button_save_gdrive.setPos(0,240),this.gdocs=new o,this.filename_input=new u(e("#view_save #filename_input"),"Name ",220),this.filename_input.setPos(0,0),this.filename_input.setValue(Canvas.getFilename().replace(/\.[^/.]+$/,"")),e("#view_save #quality_slider").css("height","100px");var c=this;setTimeout(function(){c.pixels=WebGL.getPixelArray(!0),c.quality_slider.mouseup(p),p()},10),e(window).resize(b),b(),AnalyticsTracker.sendAppView("SaveView"),this.button_cancel.click(function(){h()}),this.button_save_gdrive.click(function(){blob=i(c.imageDataURL),c.gdocs.auth(!0,function(){console.log("gdocs auth: "+c.gdocs.accessToken),blob.name=c.filename_input.getValue().replace(/\.[^/.]+$/,"")+".jpg",c.progress_bar=new a("Saving to Google Drive..."),c.setVisible(!1),c.gdocs.upload(blob,function(){console.log("uploaded"),c.progress_bar.hide(),c.closeAfterSave||App.notify("Image saved"),Canvas.setHasUnsavedChanges(!1),h(),c.closeAfterSave&&c.closeCallback(),AnalyticsTracker.sendEvent("save_gdrive")},!0,c.progress_bar)})}),this.button_save.click(function(){g(function(){c.closeAfterSave||App.notify("Image saved"),Canvas.setHasUnsavedChanges(!1),h(),c.closeAfterSave&&c.closeCallback(),AnalyticsTracker.sendEvent("save_local")})})}return f.prototype.setVisible=function(t){t?e("#view_save").css("visibility","visible"):e("#view_save").css("visibility","hidden")},f.prototype.hide=function(){e("#view_save").remove(),e("#view_modal").remove()},f}),define("text!ui/close_confirm_dialog.html",[],function(){return'<div id="view_modal" style="\n	position:absolute;\n	background-color:#606060;\n	opacity:0.5;\n	z-index:10;\n"></div>\n\n<div id="view_alert" style="\n	position:absolute;\n	width:260px;\n	z-index:10;\n	\n">\n\n<div id="label_message" style="\n	border-radius:5px;\n	background-color:#404040;\n	position:absolute;\n	top:0;\n	left:0;\n	padding:25px;\n	width:260px;\n	color:white;\n	font-size:13px;\n	text-align:center;\n"></div>\n\n<div id="button_dont_save"></div>\n<div id="button_cancel"></div>\n<div id="button_save"></div>\n\n</div>\n\n'}),define("app/controls/CloseConfirmDialog",["jquery","text!ui/close_confirm_dialog.html","app/controls/Button"],function(e,t,n){function r(r,i){function o(){s.hide()}function u(){var t=e(window).height()/2-e("#view_alert #label_message").outerHeight()/2,n=e(window).width()/2-e("#view_alert #label_message").outerWidth()/2;e("#view_alert").css("left",n),e("#view_alert").css("top",t),s.button_dont_save.setPos(10,e("#view_alert #label_message").outerHeight()+5),s.button_cancel.setPos(130,e("#view_alert #label_message").outerHeight()+5),s.button_save.setPos(220,e("#view_alert #label_message").outerHeight()+5),e("#view_modal").css("width",e(window).width()),e("#view_modal").css("height",e(window).height())}e("body").append(t),this.button_dont_save=new n(e("#view_alert #button_dont_save"),"Don't Save",null,100,"#c60c0c"),this.button_cancel=new n(e("#view_alert #button_cancel"),"Cancel",null,80,"#c60c0c"),this.button_save=new n(e("#view_alert #button_save"),"Save",null,80),e("#view_alert #label_message").text("Save changes before closing?");var s=this;e(window).resize(u),u(),this.button_cancel.click(function(){o()}),this.button_dont_save.click(function(){s.hide(),r()}),this.button_save.click(function(){s.hide(),i(!0,r)})}return r.prototype.hide=function(){e("#view_alert").remove(),e("#view_modal").remove()},r}),define("app/TopMenu",["jquery","text!ui/top_menu.html","app/controls/Button","app/controls/ZoomControl","app/controls/PreviewBox","app/History","app/SaveView","app/controls/CloseConfirmDialog"],function(e,t,n,r,i,s,o,u){function g(){function y(e,t){console.log("do save");if(NaClTouchUp.isProcessing())return;MainMenu.getPanel()&&MainMenu.getPanel().accept(),w(!1),MainMenu.setVisible(!1),PaintCanvas.setVisible(!1),new o(e,t)}function S(){console.log("do close!");if(NaClTouchUp.isProcessing())return;MainMenu.getPanel()&&MainMenu.getPanel().exitPanel(!1),E(),NACL_IS_SUPPORTED&&aM.disable(),WebGL.clear(),MainMenu.hide(),OpenView.show(),AnalyticsTracker.sendEvent("close")}e("body").append(t),a=new n(e("#button_close"),"Close","/images/cancel_icon.png",120,"#c60c0c"),a.setPos(175,0),f=new n(e("#button_save"),"Save","/images/save_icon.png",120),f.setPos(50,0),h=new n(e("#button_undo"),"Undo","/images/undo_icon.png",107,undefined,15,15,!0),p=new n(e("#button_redo"),"Redo","/images/redo_icon.png",107,undefined,15,15,!0),d=new n(e("#button_zoom_fit"),null,"/images/fitscreen_icon.png",35,null,19,19,!0),v=new n(e("#button_zoom_actual"),null,"/images/show_all_icon.png",35,null,19,19,!0),h.setEnabled(!1),p.setEnabled(!1),l=new r(e("#zoom_control")),c=new i(e("#preview_box")),c.hide(),History&&History.clear();var g=Math.floor(MAX_HISTORY_SIZE_MB*1024*1024/(Canvas.getImageWidth()*Canvas.getImageHeight()*4));g=Math.min(g,MAX_HISTORY_STEPS),console.log("initializing history with max steps = "+g),History=new s(g,h,p),e(window).resize(b),b(),a.click(function(){console.log("close!"),Canvas.hasUnsavedChanges()?new u(S,y):S()}),f.click(function(){console.log("save!"),y(!1,S)}),v.click(function(){Canvas.setScale(1),m!=null&&m.draw()}),d.click(function(){WebGL.scaleToFit(),m!=null&&m.draw()})}function y(e){e?(d.setEnabled(!0),v.setEnabled(!0),l.setEnabled(!0)):(d.setEnabled(!1),v.setEnabled(!1),l.setEnabled(!1))}function b(){l.setPos(e(window).innerWidth()-270,40),c.setPos(e(window).innerWidth()-270-c.getWidth()-8,1),h.setPos(e(window).innerWidth()-270,0),p.setPos(e(window).innerWidth()-157,0),d.setPos(e(window).innerWidth()-120,40),v.setPos(e(window).innerWidth()-90,40)}function w(t){e("#top_menu").css("display",t?"block":"none"),console.log(f)}function E(){e("#top_menu").remove()}function S(e){l&&l.setScale(e)}function x(e){l&&l.setMinimumScale(e)}function T(e){l&&l.setMaximumScale(e)}function N(){return l.getMinimumScale()}function C(){return l.getMaximumScale()}function k(e){c&&(c.setWidth(e),b())}function L(e,t,n){c&&(c.setPixels(e,t,n),m!=null&&m.draw())}function A(e){c&&(c.update(e),m!=null&&m.draw())}function O(){return c?c.isVisible():!1}function M(e){m=e}function _(){return m}var a,f,l=null,c=null,h,p,d,v,m=null;return{init:g,hide:E,setVisible:w,setScale:S,setMinimumScale:x,setMaximumScale:T,getMinimumScale:N,getMaximumScale:C,setPreviewWidth:k,setPreview:L,updatePreview:A,isPreviewVisible:O,setScaleEnabled:y,getTextManipulator:_,setTextManipulator:M}}),function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define("spin",t):e.Spinner=t()}(this,function(){function r(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function o(e,r,i,o){var u=["opacity",r,~~(e*100),i,o].join("-"),a=.01+i/o*100,f=Math.max(1-(1-e)/r*(100-a),e),l=n.substring(0,n.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return t[u]||(s.insertRule("@"+c+"keyframes "+u+"{"+"0%{opacity:"+f+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+r)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",s.cssRules.length),t[u]=1),u}function u(t,n){var r=t.style,i,s;if(r[n]!==undefined)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(s=0;s<e.length;s++){i=e[s]+n;if(r[i]!==undefined)return i}}function a(e,t){for(var n in t)e.style[u(e,n)||n]=t[n];return e}function f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]===undefined&&(e[r]=n[r])}return e}function l(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function c(e,t){return typeof e=="string"?e:e[t%e.length]}function p(e){if(typeof this=="undefined")return new p(e);this.opts=f(e||{},p.defaults,h)}function d(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}s.addRule(".spin-vml","behavior:url(#default#VML)"),p.prototype.lines=function(t,n){function o(){return a(e("group",{coordsize:s+" "+s,coordorigin:-r+" "+ -r}),{width:s,height:s})}function h(t,s,u){i(f,i(a(o(),{rotation:360/n.lines*t+"deg",left:~~s}),i(a(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:u}),e("fill",{color:c(n.color,t),opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.length+n.width,s=2*r,u=-(n.width+n.length)*2+"px",f=a(o(),{position:"absolute",top:u,left:u}),l;if(n.shadow)for(l=1;l<=n.lines;l++)h(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)h(l);return i(t,f)},p.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var e=["webkit","Moz","ms","O"],t={},n,s=function(){var e=r("style",{type:"text/css"});return i(document.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};p.defaults={},f(p.prototype,{spin:function(e){this.stop();var t=this,i=t.opts,s=t.el=a(r(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),o=i.radius+i.length+i.width,u,f;e&&(e.insertBefore(s,e.firstChild||null),f=l(e),u=l(s),a(s,{left:(i.left=="auto"?f.x-u.x+(e.offsetWidth>>1):parseInt(i.left,10)+o)+"px",top:(i.top=="auto"?f.y-u.y+(e.offsetHeight>>1):parseInt(i.top,10)+o)+"px"})),s.setAttribute("role","progressbar"),t.lines(s,t.opts);if(!n){var c=0,h=(i.lines-1)*(1-i.direction)/2,p,d=i.fps,v=d/i.speed,m=(1-i.opacity)/(v*i.trail/100),g=v/i.lines;(function y(){c++;for(var e=0;e<i.lines;e++)p=Math.max(1-(c+(i.lines-e)*g)%v*m,i.opacity),t.opacity(s,e*i.direction+h,p,i);t.timeout=t.el&&setTimeout(y,~~(1e3/d))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=undefined),this},lines:function(e,t){function l(e,n){return a(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*s+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}var s=0,u=(t.lines-1)*(1-t.direction)/2,f;for(;s<t.lines;s++)f=a(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&o(t.opacity,t.trail,u+s*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(f,a(l("#000","0 0 4px #000"),{top:"2px"})),i(e,i(f,l(c(t.color,s),"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var v=a(r("group"),{behavior:"url(#default#VML)"});return!u(v,"transform")&&v.adj?d():n=u(v,"animation"),p}),define("app/NaClTouchUp",["jquery","spin"],function(e,t){function m(e,t,n){var r=document.createElement("canvas");r.width=t,r.height=n;var i=r.getContext("2d"),s=i.createImageData(t,n);for(var o=0;o<e.length;o++)s.data[o]=e[o];i.putImageData(s,0,0);var u=r.toDataURL(),a=new Image;a.src=u;var f=window.open("","jswin","width="+t+",height="+n);f.document.body.appendChild(a)}function g(){var e=function(t){console.log("image unloaded: "+t.header.status),aM.removeEventListener("image_unload",e)};aM.addEventListener("image_unload",e),aM.sendMessage("image_unload")}function y(){s=null,i=null}function b(){i=WebGL.getPixelArray(!0),s=new Uint8Array(i)}function w(e){var t=Canvas.getImageWidth(),n=Canvas.getImageHeight(),r=[];i=WebGL.getPixelArray(!0),console.log("first pixel: "+i[0]+" "+i[1]+" "+i[2]+" "+i[3]);var s=i.length;console.log("sending "+s+" bytes"),r.push(i.buffer),console.log("sending image to NaCl: "+Canvas.getImageWidth()+"x"+Canvas.getImageHeight()),aM.sendMessage("image",{tool:a[e],num_frames:r.length,width:Canvas.getImageWidth(),height:Canvas.getImageHeight(),channels:4,byte_length:s},r)}function E(e,t,n,r,o){var u=Canvas.getImageWidth(),a=Canvas.getImageHeight();for(var f=0;f<o;f++)for(var l=0;l<r;l++){var c=(f*r+l)*4,h=((o-1-f+n)*u+t+l)*4;for(var p=0;p<4;p++)i[h+p]=e[c+p],s[h+p]=e[c+p]}}function S(){var e=Canvas.getImageWidth(),t=Canvas.getImageHeight(),n=new Uint8Array(o.width*o.height*4);for(var r=0;r<o.height;r++)for(var u=0;u<o.width;u++){var a=((r+o.y)*e+o.x+u)*4;for(var f=0;f<4;f++)n[((o.height-1-r)*o.width+u)*4+f]=i[a+f],i[a+f]=s[a+f]}var l=MainMenu.getPanel().getHistory();l.commit(n,o.x,o.y,o.width,o.height),console.log("copying stroke_dirty_rect"),console.log(o),o=null,AnalyticsTracker.sendEvent("adjustment_clone_stroke")}function x(e,t,n,r,i,s,o,u,a){console.log("Do seamless RENDER"),console.log("NUM POINTS = "+u.length/2),console.log("clone_x = "+e+" clone_y = "+t),console.log("target_x = "+n+" target_y = "+r),console.log("target_h = "+s+" target_w = "+i);var f=new Int32Array(u),l=f.length/2;console.log("NUM POINTS XXXX = "+l);var c=[o.buffer,f.buffer];for(var h=0;h<l;h++)console.log("point: "+f[2*h]+" "+f[2*h+1]);var p=function(e){var t=new Uint8Array(e.frames[0]);console.log("seamless brush result - received "+e.header.byte_length+" bytes"),Canvas.loadImageDataRect(t,e.header.dirty_rect_origin_x,e.header.dirty_rect_origin_y,e.header.dirty_rect_width,e.header.dirty_rect_height),aM.removeEventListener("seamless_brush",p)};aM.addEventListener("seamless_brush",p),aM.sendMessage("seamless_brush",{clone_x:e,clone_y:t,brush_size:a,brush_hardness:1,mask_width:i,mask_height:s,target_x:n,target_y:r,interactive_mode:1,num_stroke_points:l},c)}function T(){var e=function(t){console.log("seamless brush save current: "+t.header.status),aM.removeEventListener("seamless_brush_save_current",e)};aM.addEventListener("seamless_brush_save_current",e),aM.sendMessage("seamless_brush_save_current")}function N(e,t,n,r,u){var a=parseInt(e-n),f=parseInt(t-r),l=parseInt(n+a-u/2),c=parseInt(r+f-u/2),h=parseInt(n-u/2),p=parseInt(r-u/2),d=u,v=u;h<0&&(d+=h,h=0),p<0&&(v+=p,p=0),h+d>=Canvas.getImageWidth()&&(d-=h+d-Canvas.getImageWidth()),p+v>=Canvas.getImageHeight()&&(v-=p+v-Canvas.getImageHeight());if(!o)o={x:h,y:p,width:d,height:v};else{var m=o.x,g=o.y;h<o.x&&(o.width+=o.x-h,o.x=h),p<o.y&&(o.height+=o.y-p,o.y=p),h+d>=m+o.width&&(o.width+=h+d-m-o.width),p+v>=g+o.height&&(o.height+=p+v-g-o.height)}console.log(o);var y=new Uint8Array(d*v*4);for(var b=0;b<u;b++)for(var w=0;w<u;w++){var E=parseInt(w+n-u/2),S=parseInt(b+r-u/2);if(c+b<0||c+b>=Canvas.getImageHeight()||l+w<0||l+w>=Canvas.getImageWidth())continue;if(E<0||E>=Canvas.getImageWidth()||S<0||S>=Canvas.getImageHeight())continue;var x=Math.sqrt(Math.pow(w-u/2,2)+Math.pow(b-u/2,2)),T=Math.max(0,(u/2-x)/(u/2)),N=((c+b)*Canvas.getImageWidth()+l+w)*4,C=(S*Canvas.getImageWidth()+E)*4;s[C+0]=(1-T)*s[C+0]+T*i[N+0],s[C+1]=(1-T)*s[C+1]+T*i[N+1],s[C+2]=(1-T)*s[C+2]+T*i[N+2],s[C+3]=i[N+3]}for(var b=0;b<v;b++)for(var w=0;w<d;w++){var k=(b*d+w)*4,L=((b+p)*Canvas.getImageWidth()+h+w)*4;for(var A=0;A<4;A++)y[k+A]=s[L+A]}WebGL.loadImageDataRect(y,h,p,d,v);return;var O}function C(){L(!0)}function k(){L(!1)}function L(e){var t=function(e){console.log("got: "+e.header.region_x+" "+e.header.region_y+" "+e.header.region_width+" "+e.header.region_height);var n=new Uint8Array(e.frames[0]);WebGL.loadImageDataRect(n,e.header.region_x,e.header.region_y,e.header.region_width,e.header.region_height),MainMenu.getPanel().type=="touchup"&&MainMenu.getPanel().setUndoRedoState(e.header.history_has_undo,e.header.history_has_redo),aM.removeEventListener("history",t)};aM.addEventListener("history",t),aM.sendMessage("history",{is_undo:e})}function A(){console.log("cancelTouchUp"),aM.sendMessage("touchup",{cancel:!0}),_(),MainMenu.getPanel().accept(),v=!0,AnalyticsTracker.sendEvent("adjustment_touch_up_detail_cancel")}function O(e,t,n,r,i,s,o){var u=5,a=1,f=0,l=new Int32Array(s),c=s.length/2,h=[i.buffer,l.buffer];console.log("TOUCH UP A: "+c),console.log("TOUCH UP B: "+l.length/2),console.log("TOUCH UP C: "+s.length/2);var p=function(e){aM.removeEventListener("touchup",p);if(v){v=!1;return}_();var t=e.header.touchup_ok;if(t){var n=new Uint8Array(e.frames[0]);WebGL.loadImageDataRect(n,e.header.dirty_rect_origin_x,e.header.dirty_rect_origin_y,e.header.dirty_rect_width,e.header.dirty_rect_height),MainMenu.getPanel().type=="touchup"&&MainMenu.getPanel().setUndoRedoState(e.header.history_has_undo,e.header.history_has_redo)}};aM.addEventListener("touchup",p),aM.sendMessage("touchup",{cancel:!1,mask_x:e,mask_y:t,mask_width:n,mask_height:r,brush_size:o,brush_hardness:f,num_stroke_points:c,use_slow_method:MainMenu.getPanel().isPreserveDetail(),slow_method:a,fast_method:u},h),MainMenu.getPanel().isPreserveDetail()?(M(),AnalyticsTracker.sendEvent("adjustment_touch_up_detail_stroke")):AnalyticsTracker.sendEvent("adjustment_touch_up_fast_stroke")}function M(){var n={lines:10,length:0,width:3,radius:6,corners:1,rotate:0,direction:1,color:"#fff",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9};h=(new t(n)).spin(),p=e("<a style='cursor:pointer;color:#888888;margin-top:8px;pointer-events:auto'>cancel</a>"),e("#progress_indicator").append(h.el),e("#progress_indicator_background").html("Applying Stroke&nbsp;&nbsp;&nbsp;&nbsp;"),e("#progress_indicator_background").append(p),e("#progress_indicator_background").css("width",150),e("#progress_indicator_background").css("height",30),e("#progress_indicator_background").css("padding-top",12),e("#progress_indicator_background").css("padding-left",40),e("#progress_indicator_background").show();var r=e("#progress_indicator_background").width(),i=e("#progress_indicator_background").height();p.click(function(){A()}),e("#progress_indicator").css("left","calc(50% - "+r/2+"px)"),e("#progress_indicator").css("top","calc(50% - "+i/2+"px)"),d=!0}function _(){h&&(h.stop(),e("#progress_indicator_background").hide(),e("#progress_indicator_background").html(""),e("#progress_indicator_background").css("width",40),e("#progress_indicator_background").css("height",40),e("#progress_indicator_background").css("padding-top",0),e("#progress_indicator_background").css("padding-left",0),e("#progress_indicator").css("left","50%"),e("#progress_indicator").css("top","50%"),h=null,d=!1)}function D(e,t){var n=function(e){var t=new Uint8Array(e.frames[0]);Canvas.loadImageData(t),Canvas.drawScene(),aM.removeEventListener("clarity_filter",n)};aM.addEventListener("clarity_filter",n),aM.sendMessage("clarity_filter",{alpha:e,beta:t})}var n=1,r=100,i,s,o=null,u=[],a={touch_up:0,seamless_clone:1,clarity_filter:2},f=null,l=null,c=null,h=null,p=null,d=!1,v=!1;return{loadImage:w,unloadImage:g,cloneLoadImage:b,cloneUnloadImage:y,cloneUpdateSource:E,doClarity:D,doTouchUp:O,cancelTouchUp:A,undo:C,redo:k,doSeamless:x,doSeamlessSaveCurrent:T,doClone:N,doCloneSaveCurrent:S,popupImage:m,getSampleScale:function(){return n},CLONE_WAIT_DURATION:r,isProcessing:function(){return d},didCancelTouchUp:function(){return v},doneProcessing:_}}),define("text!ui/view_open.html",[],function(){return'<div id="view_open" style="width:100%;height:100%;position:absolute;left:0;top:0;">\n<!--<a href="http://pixlr.com/" target="_blank"><img src="/images/logo.png" style="position:absolute;top:0;left:43px;border:0;" /></a>-->\n\n<div id="label_open_a_photo" style="\n	position:absolute;\n	font-size:20px;\n	text-align:center;\n	width:210px;\n	color:#eeeeee;\n">Open a photo</div>\n<div id="button_open_computer"></div>\n<div id="button_open_gdrive"></div>\n\n<div id="progress" style="position:absolute;width:200px;top:300px;left:700px;"></div>\n\n<input type="file" id="open_from_computer" style="display:none"/>\n\n<div id="version" style="position:absolute;width:500px;bottom:12px;left:15px;color:#aaa">v1.5.0 &#183; <a href="http://support.pixlr.com/" target="_blank">Support</a> &#183; <a href="mailto:info@pixlr.com?Subject=Pixlr%20Touch%20Up%20Feedback" target="_blank">Feedback</a> &#183; <a href="http://www.autodesk.com/privacy" target="_blank">Privacy</a> &#183; <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=17752585" target="_blank">Terms of Service</a> &#183; <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=10235425" target="_blank">Software License Agreement</a></div>\n<a href="http://www.autodesk.com/" target="_blank"><img src="/images/autodesk_logo.png" style="position:absolute;width:150px;height:25px;right:10px;bottom:10px;"></a>\n\n</div>'}),function(){function e(){return function(){}}function n(e,n){var r=e.split("."),i=t;!(r[0]in i)&&i.execScript&&i.execScript("var "+r[0]);for(var s;r.length&&(s=r.shift());)!r.length&&void 0!==n?i[s]=n:i=i[s]?i[s]:i[s]={}}function r(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e}function s(){}function u(){}function a(){}function l(){}function c(){this.channel=[]}function h(){}function p(){}function d(e,t){this.input=i?new Uint8Array(e):e,this.ip=t|0}function v(e){return(e.input[e.ip++]<<24|e.input[e.ip++]<<16|e.input[e.ip++]<<8|e.input[e.ip++])>>>0}function m(e){return e.input[e.ip++]<<24|e.input[e.ip++]<<16|e.input[e.ip++]<<8|e.input[e.ip++]}function g(e){return e.input[e.ip++]<<8|e.input[e.ip++]}function y(e){return(e.input[e.ip++]<<8|e.input[e.ip++])<<16>>16}function b(e){return e.input[e.ip++]}function _(e,t){return i?e.input.subarray(e.ip,e.ip+=t):e.input.slice(e.ip,e.ip+=t)}function D(e,t){var n=e.input,r=e.ip,i=[],s;for(s=0;s<t;++s)i[s]=String.fromCharCode(n[r++]);return e.ip=r,i.join("")}function P(e,t){var n=e.input,r=e.ip,i=[],s;for(s=0;s<t;++s)i[s]=String.fromCharCode(n[r++]<<8|n[r++]);return e.ip=r,i.join("")}function H(e,t){var n,r,i,s=[],o=0;for(n=e.ip+t;e.ip<n;)if(r=e.input[e.ip++]<<24>>24,0>r){r=1-r;for(i=b(e);0<r--;)s[o++]=i}else for(r=1+r;0<r--;)s[o++]=b(e);return s}function B(){}function j(){}function F(e,t,n){this.header=e,this.colorModeData=t,this.channel=n,this.parsed=!1}function I(){}function q(){}function R(){}function U(){}function z(){}function W(){}function X(){this.info=[]}function V(){}function $(){}function J(){}function K(){this.layerRecord=[],this.channelImageData=[]}function Q(){}function G(e,t){t||(t={}),this.stream=new d(e,t.inputPosition|0)}var t=this,i=void 0!==t.Uint8Array&&void 0!==t.Uint16Array&&void 0!==t.Uint32Array;s.prototype.parse=function(e,n){var r;this.offset=e.ip,this.signature=D(e,4),this.key=D(e,4),r=v(e),this.length=r+12,"function"==typeof s[this.key]?(this.info=new s[this.key],this.info.parse(e,r,n)):t.console.warn("additional layer information: not implemented",this.key),e.seek(this.offset+this.length,0)};var o={};o.bevl={},o.bevl=e(),o.bevl.prototype.parse=function(e){this.offset=e.ip,this.size=v(e),this.version=v(e),this.angle=m(e),this.strength=m(e),this.blur=m(e),this.highlightBlendModeSignature=D(e,4),this.highlightBlendModeKey=D(e,4),this.shadowBlendModeSignature=D(e,4),this.shadowBlendModeKey=D(e,4),e.seek(2),this.highlightColor=[v(e),v(e)],e.seek(2),this.shadowColor=[v(e),v(e)],this.bevelStyle=b(e),this.highlightOpacity=b(e),this.shadowOpacity=b(e),this.enabled=!!b(e),this.use=!!b(e),this.up=!!b(e),2===this.version&&(e.seek(2),this.readHighlightColor=[v(e),v(e)],e.seek(2),this.readShadowColor=[v(e),v(e)]),this.length=e.ip-this.offset},o.cmnS={},o.cmnS=e(),o.cmnS.prototype.parse=function(e){this.offset=e.ip,this.size=v(e),this.version=v(e),this.visible=!!b(e),e.seek(2),this.length=e.ip-this.offset},o.dsdw={},o.dsdw=e(),o.dsdw.prototype.parse=function(e){this.offset=e.ip,this.size=v(e),this.version=v(e),this.blur=m(e),this.intensity=m(e),this.angle=m(e),this.distance=m(e),e.seek(2),this.color=[v(e),v(e)],this.signature=D(e,4),this.blend=D(e,4),this.enabled=!!b(e),this.use=!!b(e),this.opacity=b(e),e.seek(2),this.nativeColor=[v(e),v(e)],this.length=e.ip-this.offset},o.iglw={},o.iglw=e(),o.iglw.prototype.parse=function(e){this.offset=e.ip,this.size=v(e),this.version=v(e),this.blur=m(e),this.intensity=m(e),e.seek(2),this.color=[v(e),v(e)],this.signature=D(e,4),this.blend=D(e,4),this.enabled=!!b(e),this.opacity=b(e),2===this.version&&(this.invert=!!b(e),e.seek(2),this.nativeColor=[v(e),v(e)]),this.length=e.ip-this.offset},o.isdw={},o.isdw=o.dsdw,o.oglw={},o.oglw=e(),o.oglw.prototype.parse=function(e){this.offset=e.ip,this.size=v(e),this.version=v(e),this.blur=m(e),this.intensity=m(e),e.seek(2),this.color=[v(e),v(e)],this.signature=D(e,4),this.blend=D(e,4),this.enabled=!!b(e),this.opacity=b(e),2===this.version&&(e.seek(2),this.nativeColor=[v(e),v(e)]),this.length=e.ip-this.offset},o.sofi={},o.sofi=e(),o.sofi.prototype.parse=function(e){var t;this.offset=e.ip,this.size=v(e),this.version=v(e),t=D(e,4);if("8BIM"!==t)throw Error("invalid signature:",t);this.blend=D(e,4),e.seek(2),this.color=[g(e)>>8,g(e)>>8,g(e)>>8,g(e)>>8],this.opacity=b(e),this.enabled=!!b(e),e.seek(2),this.nativeColor=[y(e)>>8,y(e)>>8,y(e)>>8,y(e)>>8],this.length=e.ip-this.offset},s.Patt=e(),s.Patt.prototype.parse=function(e,t,n){t=e.ip+t;for(this.offset=e.ip;e.ip<t;)v(e),v(e),m(e),y(e),y(e),P(e,v(e)),D(e,e.input[e.ip++]),n.colorMode===f&&_(e,768),_(e,t-this.offset);this.length=e.ip-this.offset},s.PlLd=e(),s.PlLd.prototype.parse=function(e){this.offset=e.ip,this.type=D(e,4);if("plcL"!==this.type)throw Error("invalid type:",this.type);this.version=v(e),this.id=D(e,e.input[e.ip++]),this.page=m(e),this.totalPage=m(e),this.antiAlias=m(e),this.placedLayerType=m(e),this.transform=[e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64()],this.warpVersion=m(e),this.warpDescriptorVersion=m(e),this.descriptor=new a,this.descriptor.parse(e),this.length=e.ip-this.offset},s.SoLd=e(),s.SoLd.prototype.parse=function(e){this.offset=e.ip,this.identifier=D(e,4);if("soLD"!==this.identifier)throw Error("invalid identifier:",this.identifier);this.version=v(e),this.descriptorVersion=m(e),this.descriptor=new a,this.descriptor.parse(e),this.length=e.ip-this.offset},s.TySh=e(),s.TySh.prototype.parse=function(e){this.offset=e.ip,this.version=y(e),this.transform=[e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64(),e.readFloat64()],this.textVersion=y(e),this.textDescriptorVersion=m(e),this.textData=new a,this.textData.parse(e),this.textData.items!==this.textData.item.length?t.console.error("Descriptor parsing failed"):(this.warpVersion=y(e),this.warpDescriptorVersion=m(e),this.warpData=new a,this.warpData.parse(e),t.console.log("TySh implementation is incomplete"),this.left=m(e),this.top=m(e),this.right=m(e),this.bottom=m(e),this.length=e.ip-this.offset)},s.clbl=e(),s.clbl.prototype.parse=function(e){this.offset=e.ip,this.blendClippedElements=!!b(e),e.seek(3),this.length=e.ip-this.offset},s.fxrp=e(),s.fxrp.prototype.parse=function(e){this.offset=e.ip,this.referencePoint=[e.readFloat64(),e.readFloat64()],this.length=e.ip-this.offset},s.iOpa=e(),s.iOpa.prototype.parse=function(e){this.offset=e.ip,this.opacity=b(e),e.seek(3),this.length=e.ip-this.offset},s.infx=e(),s.infx.prototype.parse=function(e){this.offset=e.ip,this.blendInteriorElements=!!b(e),e.seek(3),this.length=e.ip-this.offset},s.knko=e(),s.knko.prototype.parse=function(e){this.offset=e.ip,this.knockout=!!b(e),e.seek(3),this.length=e.ip-this.offset},s.lclr=e(),s.lclr.prototype.parse=function(e){this.offset=e.ip,this.color=[v(e),v(e)],this.length=e.ip-this.offset},s.lfx2=e(),s.lfx2.prototype.parse=function(e){this.offset=e.ip,this.version=v(e),this.descriptorVersion=v(e),this.descriptor=new a,this.descriptor.parse(e),this.length=e.ip-this.offset},s.lnsr=e(),s.lnsr.prototype.parse=function(e){this.offset=e.ip,this.id=D(e,4),this.length=e.ip-this.offset},s.lrFX=e(),s.lrFX.prototype.parse=function(e){var n,r,i;this.offset=e.ip,this.version=g(e),this.count=g(e),this.effect=[];for(i=0;i<this.count;++i){n=D(e,4);if("8BIM"!==n){t.console.warn("invalid signature:",n);break}this.key=n=D(e,4);if("function"!=typeof o[this.key]){t.console.warn("detect unknown key:",n);break}r=new o[this.key],r.parse(e),this.effect[i]={key:n,effect:r}}this.length=e.ip-this.offset},s.lsct=e(),s.lsct.prototype.parse=function(e,t){var n;this.offset=e.ip,this.type=v(e);if(12===t){n=D(e,4);if("8BIM"!==n)throw Error("invalid section divider setting signature:",n);this.key=D(e,4)}this.length=e.ip-this.offset},s.lspf=e(),s.lspf.prototype.parse=function(e){this.offset=e.ip,this.flags=v(e),this.length=e.ip-this.offset},s.luni=e(),s.luni.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.layerName=P(e,t),1===(t&1)&&e.seek(2),this.length=e.ip-this.offset},s.lyid=e(),s.lyid.prototype.parse=function(e){this.offset=e.ip,this.layerId=v(e),this.length=e.ip-this.offset},s.lyvr=e(),s.lyvr.prototype.parse=function(e){this.offset=e.ip,this.version=v(e),this.length=e.ip-this.offset},s.shmd=e(),s.shmd.prototype.parse=function(e){var t,n,r,i,s=this.metadata=[],o,u;this.offset=e.ip,this.items=v(e),o=0;for(u=this.items;o<u;++o)t=D(e,4),n=D(e,4),r=b(e),e.seek(3),i=v(e),i=_(e,i),s[o]={signature:t,key:n,copy:r,data:i};this.length=e.ip-this.offset},s.vmsk=e(),s.vmsk.prototype.parse=function(e,t){var n=e.ip+t;this.offset=e.ip,this.version=v(e);for(this.flags=v(e);e.ip+26<=n;)this.path=new p,this.path.parse(e);this.length=e.ip-this.offset},a.prototype.parse=function(e){var n,r,i,s;this.offset=e.ip,n=v(e),this.name=P(e,n),n=v(e)||4,this.classId=D(e,n),this.items=v(e),this.item=[],i=0;for(s=this.items;i<s;++i){n=v(e)||4,n=D(e,n),r=D(e,4);if("function"!=typeof a[r]){t.console.warn("OSType Key not implemented:",r);break}r=new a[r],r.parse(e),this.item.push({key:n,data:r})}this.length=e.ip-this.offset},s.GdFl=e(),s.GdFl.prototype.parse=function(e){this.offset=e.ip,this.version=v(e),this.descriptor=new a,this.descriptor.parse(e),this.length=e.ip-this.offset},s.SoCo=e(),s.SoCo.prototype.parse=function(e){this.offset=e.ip,this.version=v(e),this.descriptor=new a,this.descriptor.parse(e),this.length=e.ip-this.offset},a.ObAr=e(),a.ObAr.prototype.parse=function(e){this.offset=e.ip,t.console.warn("OSType key not implemented (undocumented): ObAr(ObjectArray?)"),this.length=e.ip-this.offset},a.Objc=e(),a.Objc.prototype.parse=function(e){this.offset=e.ip,this.value=new a,this.value.parse(e),this.length=e.ip-this.offset},a.GlbO=a.Objc,a.TEXT=e(),a.TEXT.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.string=P(e,t),this.length=e.ip-this.offset},a.UnFl=e(),a.UnFl.prototype.parse=function(e){var t=this.value=[],n,r;this.offset=e.ip,this.key=D(e,4),n=v(e);for(r=0;r<n;++r)t[r]=e.readFloat64();this.length=e.ip-this.offset},a.UntF=e(),a.UntF.prototype.parse=function(e){this.offset=e.ip,this.units=D(e,4),this.value=e.readFloat64(),this.length=e.ip-this.offset},a.VlLs=e(),a.VlLs.prototype.parse=function(e){var n,r,i,s;this.offset=e.ip,this.item=[],n=v(e);for(r=0;r<n;++r){i=D(e,4);if("function"!=typeof a[i]){t.console.error("OSType Key not implemented:",i);return}s=new a[i],s.parse(e),this.item.push({type:i,data:s})}this.length=e.ip-this.offset},a.alis=e(),a.alis.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.value=_(e,t),this.length=e.ip-this.offset},a.bool=e(),a.bool.prototype.parse=function(e){this.offset=e.ip,this.value=!!b(e),this.length=e.ip-this.offset},a.doub=e(),a.doub.prototype.parse=function(e){this.offset=e.ip,this.value=e.readFloat64(),this.length=e.ip-this.offset},a["enum"]=e(),a["enum"].prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),0===t&&(t=4),this.type=D(e,t),t=v(e),0===t&&(t=4),this.enum=D(e,t),this.length=e.ip-this.offset},a["long"]=e(),a["long"].prototype.parse=function(e){this.offset=e.ip,this.value=m(e),this.length=e.ip-this.offset},a["obj "]=e(),a["obj "].prototype.parse=function(e){var n,r,i,s;this.offset=e.ip,this.item=[],n=this.items=v(e);for(s=0;s<n;++s){r=D(e,4),i=a["obj "].Table[r];if("function"!=typeof a[i]){t.console.error("OSType Key not implemented:",i);return}i=new a[i],i.parse(e),this.item.push({key:r,data:i})}this.length=e.ip-this.offset},a["obj "].Table={prop:"prop",Clss:"type",Enmr:"enum",rele:"rele",Idnt:"long",indx:"long",name:"TEXT"},a.prop=e(),a.prop.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.name=P(e,t),t=v(e)||4,this.classId=D(e,t),t=v(e)||4,this.keyId=D(e,t),this.length=e.ip-this.offset},a.rele=e(),a.rele.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.name=P(e,t),t=v(e)||4,this.classId=D(e,t),this.value=v(e),this.length=e.ip-this.offset},a.tdta=e(),a.tdta.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.data=_(e,t),this.length=e.ip-this.offset},a.type=e(),a.type.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.name=P(e,t),t=v(e)||4,this.classId=D(e,t),this.length=e.ip-this.offset},a.GlbC=a.type;var f=2;c.prototype.parse=function(e){var t;this.offset=e.ip,this.length=v(e)+4;if(4===this.length)window.console.log("skip: layer blending ranges(empty body)");else{t=this.offset+this.length,this.black=g(e),this.white=g(e);for(this.destRange=v(e);e.ip<t;)this.channel.push([v(e),v(e)])}},h.prototype.parse=function(e){var t;this.offset=e.ip,t=v(e),this.length=t+4,0===t?window.console.log("skip: layer mask data (empty body)"):(this.top=m(e),this.left=m(e),this.bottom=m(e),this.right=m(e),this.defaultColor=b(e),this.flags=b(e),20===t?this.padding=g(e):(this.realFlags=b(e),this.realBackground=b(e),this.top2=m(e),this.left2=m(e),this.bottom2=m(e),this.right2=m(e)))},p.prototype.parse=function(e){this.offset=e.ip,this.type=y(e),e.seek(26,this.offset),this.length=e.ip-this.offset};var w=d.prototype;if(i)var E=new ArrayBuffer(8),S=new Uint8Array(E),x=new Float64Array(E);else var T=Math.pow(2,48),N=Math.pow(2,40),C=Math.pow(2,32),k=Math.pow(2,24),L=Math.pow(2,16),A=Math.pow(2,8),O=Math.pow(2,-1022),M=Math.pow(2,-52);w.readFloat64=function(){var e;if(i){e=this.input;for(var t=this.ip,n=8;--n;)S[n]=e[t++];e=x[0]}else{var n=this.input,r=this.ip;e=0===(n[r]&128),t=(n[r++]&127)<<4|(n[r]&240)>>4,n=(n[r++]&15)*T+n[r++]*N+n[r++]*C+n[r++]*k+n[r++]*L+n[r++]*A+n[r++],e=0===t?0===n?0:(e?1:-1)*O*n*M:2047===t?n?NaN:e?Infinity:-Infinity:(e?1:-1)*(Math.pow(2,t-1023)+n*Math.pow(2,t-1075))}return this.ip+=8,e},d.prototype.slice=function(e,t){return this.ip=t,i?this.input.subarray(e,t):this.input.slice(e,t)},d.prototype.fetch=function(e,t){return i?this.input.subarray(e,t):this.input.slice(e,t)},d.prototype.seek=function(e,t){"number"!=typeof t&&(t=this.ip),this.ip=t+e},B.prototype.parse=function(e){this.offset=e.ip,this.length=v(e)+4,this.overlayColorSpace=g(e),this.colorComponents=[g(e),g(e),g(e),g(e)],this.opacity=g(e),this.kind=b(e),this.filter=_(e,this.offset+this.length-e.ip),e.seek(this.offset+this.length,0)},j.prototype.parse=function(e){this.offset=e.ip,this.signature=D(e,4);if("8BPS"!==this.signature)throw Error("invalid signature");this.version=g(e),this.reserved=_(e,6),this.channels=g(e),this.rows=v(e),this.columns=v(e),this.depth=g(e),this.colorMode=g(e),this.length=e.ip-this.offset},F.prototype.parse=function(){switch(this.header.colorMode){case 0:window.console.error("bitmap color mode not supported");break;case 8:window.console.warn("duotone color mode implementation is incomplete");case 1:var e=this.channel[0],t,n=e.length,r=this.redChannel=new(i?Uint8Array:Array)(n),s=this.greenChannel=new(i?Uint8Array:Array)(n),o=this.blueChannel=new(i?Uint8Array:Array)(n),u=this.header.depth/8,a;for(t=a=0;t<n;++a,t+=u)r[a]=s[a]=o[a]=e[t];break;case f:e=this.channel[0],n=e.length,s=this.redChannel=new(i?Uint8Array:Array)(n),o=this.greenChannel=new(i?Uint8Array:Array)(n),u=this.blueChannel=new(i?Uint8Array:Array)(n),a=this.colorModeData.data;var l=a.length/3;for(t=r=0;t<n;++r,t+=1)s[r]=a[e[t]],o[r]=a[e[t]+l],u[r]=a[e[t]+2*l];break;case 7:window.console.warn("multichannel color mode implementation is incomplete");case 3:e=this.redChannel=this.channel[0],t=this.greenChannel=this.channel[1],n=this.blueChannel=this.channel[2],s=this.header.depth/8;if(1!==s){if(4===this.channel.length){r=this.alphaChannel=this.channel[3],o=a=0;for(u=e.length;o<u;++a,o+=s)e[a]=e[o],t[a]=t[o],n[a]=n[o],r[a]=r[o]}else{o=a=0;for(u=e.length;o<u;++a,o+=s)e[a]=e[o],t[a]=t[o],n[a]=n[o]}i?(this.redChannel=e.subarray(0,a),this.greenChannel=t.subarray(0,a),this.blueChannel=n.subarray(0,a)):e.length=t.length=n.length=a,4===this.channel.length&&(i?this.alphaChannel=r.subarray(0,a):r.length=a)}break;case 4:e=this.channel[0],t=this.channel[1],n=this.channel[2],r=this.channel[3],o=e.length,u=this.redChannel=new(i?Uint8Array:Array)(o),a=this.greenChannel=new(i?Uint8Array:Array)(o);for(var l=this.blueChannel=new(i?Uint8Array:Array)(o),c,h,p,d,v=this.header.depth/8,m,s=m=0;s<o;++m,s+=v)c=255-e[s],h=255-t[s],p=255-n[s],d=255-r[s],u[m]=65535-(c*(255-d)+(d<<8))>>8,a[m]=65535-(h*(255-d)+(d<<8))>>8,l[m]=65535-(p*(255-d)+(d<<8))>>8;break;case 9:e=this.channel[0],t=this.channel[1],n=this.channel[2],s=e.length,o=this.redChannel=new(i?Uint8Array:Array)(s),u=this.greenChannel=new(i?Uint8Array:Array)(s),a=this.blueChannel=new(i?Uint8Array:Array)(s),l=6/29,h=this.header.depth/8;for(r=c=0;r<s;++c,r+=h)v=((100*e[r]>>8)+16)/116,p=v+(t[r]-128)/500,d=v-(n[r]-128)/200,p=p>l?.950456*Math.pow(p,3):3*(p-16/116)*Math.pow(l,2),v=v>l?1*Math.pow(v,3):3*(v-16/116)*Math.pow(l,2),d=d>l?1.088754*Math.pow(d,3):3*(d-16/116)*Math.pow(l,2),o[c]=255*Math.pow(2.041588*p-.565007*v-.344731*d,1/2.2),u[c]=255*Math.pow(-0.969244*p+1.875968*v+.041555*d,1/2.2),a[c]=255*Math.pow(.013444*p-.118362*v+1.015175*d,1/2.2)}this.parsed=!0},I.prototype.parse=function(e,t){var n;this.offset=e.ip,n=v(e),this.length=n+4;if(t.colorMode===f&&768!==n)throw Error("invalid color mode data");this.data=_(e,n)},r(q,l),q.prototype.parse=function(e,t){var n=this.channel=[],r,i=t.channels,s=t.columns*t.rows*(t.depth/8);for(r=0;r<i;++r)n[r]=_(e,s)},r(R,l),R.prototype.parse=function(e,t){var n,r=this.channel=[],s=this.lineLength=[],o,u,a=t.rows,f=t.channels,l;for(n=0;n<a*f;++n)s[n]=g(e);for(o=0;o<f;++o){u=[];for(n=l=0;n<a;++n)u[n]=H(e,s[o*a+n]*(t.depth/8)),l+=u[n].length;if(i){r[o]=new Uint8Array(l),l=n=0;for(a=u.length;n<a;++n)r[o].set(u[n],l),l+=u[n].length}else r[o]=Array.prototype.concat.apply([],u)}},U.prototype.parse=function(e,t){this.offset=e.ip,this.compressionMethod=g(e);switch(this.compressionMethod){case 0:this.image=new q;break;case 1:this.image=new R;break;default:throw Error("unknown compression method")}this.image.parse(e,t),this.length=e.ip-this.offset},U.prototype.createCanvas=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=n.width=e.columns,s=n.height=e.rows,o,u,a,f,l,c;o=new F(e,t,this.image.channel),o.parsed||o.parse(),c=[o.redChannel,o.greenChannel,o.blueChannel];if(0>=i||0>=s)return null;o=r.createImageData(i,s),u=o.data;for(f=0;f<s;++f)for(a=0;a<i;++a)l=f*i+a,u[4*l]=c[0][l],u[4*l+1]=c[1][l],u[4*l+2]=c[2][l],u[4*l+3]=255;return r.putImageData(o,0,0),n},z.prototype.parse=function(e){this.offset=e.ip;if("8BIM"!==D(e,4))throw Error("invalid signature");this.identifier=g(e),this.name=D(e,e.input[e.ip++]),this.dataSize=v(e),this.data=_(e,this.dataSize),this.length=e.ip-this.offset},W.prototype.parse=function(e){this.offset=e.ip,this.length=v(e)+4,this.imageResource=new z,this.imageResource.parse(e),e.seek(this.offset+this.length,0)},X.prototype.parse=function(e,t){var n,r;this.offset=e.ip,this.top=m(e),this.left=m(e),this.bottom=m(e),this.right=m(e),this.channels=g(e),n=0;for(r=this.channels;n<r;++n)this.info[n]={id:y(e),length:v(e)};if("8BIM"!==D(e,4))throw Error("invalid blend mode signature");this.blendMode=D(e,4),this.opacity=b(e),this.clipping=b(e),this.flags=b(e),this.filter=b(e),this.extraLength=v(e),n=e.ip+this.extraLength,this.layerMaskData=new h,this.layerMaskData.parse(e),this.blendingRanges=new c,this.blendingRanges.parse(e),r=b(e),this.name=D(e,r),e.seek((4-(1+r)%4)%4);for(this.additionalLayerInfo=[];e.ip<n;)r=new s,r.parse(e,t),this.additionalLayerInfo.push(r);this.length=e.ip-this.offset},r(V,u),V.prototype.parse=function(e,t,n){this.channel=_(e,n)},r($,u),$.prototype.parse=function(e,t,n){var r=this.lineLength=[],s=[];t=t.bottom-t.top;var o=e.ip+n,u=0;for(n=0;n<t;++n)r[n]=g(e);for(n=0;n<t&&!(s[n]=H(e,r[n]),u+=s[n].length,e.ip>=o);++n);if(i){this.channel=new Uint8Array(u),e=n=0;for(t=s.length;n<t;++n)this.channel.set(s[n],e),e+=s[n].length}else this.channel=Array.prototype.concat.apply([],s)},J.prototype.parse=function(e,t){var n=this.channel=[],r,i,s,o,u;this.offset=e.ip,i=0;for(s=t.channels;i<s;++i)if(o=e.ip,u=t.info[i],r=g(e),2!==u.length){switch(r){case 0:r=new V;break;case 1:r=new $;break;default:throw Error("unknown compression method: "+r)}r.parse(e,t,u.length-2),n[i]=r,e.seek(u.length+o,0)}this.length=e.ip-this.offset},J.prototype.createCanvas=function(e,t,n){var r=document.createElement("canvas"),i=r.getContext("2d"),s=r.width=n.right-n.left,o=r.height=n.bottom-n.top,u,a,f=this.channel,l=[],c,h,p,d;if(0===s||0===o)return null;u=i.createImageData(s,o),a=u.data,c=0;for(h=f.length;c<h;++c)switch(n.info[c].id){case 0:case 1:case 2:case 3:l[n.info[c].id]=f[c].channel;break;case-1:p=f[c].channel;break;case-2:d=f[c].channel;break;default:window.console.warn("not supported channel id",n.info[c].id)}p&&l.push(p),e=new F(e,t,l),e.parsed||e.parse(),f=[e.redChannel,e.greenChannel,e.blueChannel,e.alphaChannel];for(t=0;t<o;++t)for(e=0;e<s;++e)n=t*s+e,a[4*n+0]=f[0][n],a[4*n+1]=f[1][n],a[4*n+2]=f[2][n],a[4*n+3]=d?d[n]/255*(f[3]?f[3][n]:255):f[3]?f[3][n]:255;return i.putImageData(u,0,0),r},K.prototype.parse=function(e,t){var n,r,i;this.offset=e.ip,this.length=v(e)+4,this.layerCount=Math.abs(y(e)),n=0;for(r=this.layerCount;n<r;++n)i=new X,i.parse(e,t),this.layerRecord[n]=i;n=0;for(r=this.layerCount;n<r;++n)i=new J,i.parse(e,this.layerRecord[n]),this.channelImageData[n]=i;e.seek(this.offset+this.length,0)},Q.prototype.parse=function(e,t){var n;this.offset=e.ip,n=v(e),this.length=n+4,0===n&&window.console.log("skip: layer and mask information (empty body)"),n=e.ip+n,this.layerInfo=new K,this.globalLayerMaskInfo=new B,this.additionalLayerInfo=new s,this.layerInfo.parse(e,t),this.globalLayerMaskInfo.parse(e,t),this.additionalLayerInfo.parse(e,t),e.seek(n,0)},G.prototype.parse=function(){var e=this.stream;this.header=new j,this.colorModeData=new I,this.imageResources=new W,this.layerAndMaskInformation=new Q,this.imageData=new U,this.header.parse(e),this.colorModeData.parse(e,this.header),this.imageResources.parse(e),this.layerAndMaskInformation.parse(e,this.header),this.imageData.parse(e,this.header)},n("PSD.Parser",G),n("PSD.Parser.prototype.parse",G.prototype.parse)}.call(this),define("psd.parser.min",function(){}),define("picker",[],function(){var e=function(e,t,n){console.log("New picker proxy"),this.options_=n||{},this.url_=e,this.callback_=t,this.background_=null,this.webview_=null,this.listener_=null,this.width_=n.width||800,this.height_=n.height||500,this.token_=n.token,this.key_=n.key};return e.prototype.onResize=function(e,t){this.webview_.contentWindow.postMessage({action:"onResize",width:e,height:t},this.url_)},e.prototype.showPicker=function(e){this.listener_=function(e){console.log("received message",e);if(e.source!=this.webview_.contentWindow)return;e.data.action=="pickerloaded"&&this.display();if(e.data.action=="picked"||e.data.action=="cancel")this.callback_&&this.callback_(e.data),this.dismiss()}.bind(this),window.addEventListener("message",this.listener_,!1),this.createBackground_(),this.createWebview_()},e.prototype.display=function(){this.webview_.style.opacity="1"},e.prototype.dismiss=function(){window.removeEventListener("message",this.listener_,!1),this.background_=this.removeElement_(this.background_),this.webview_=this.removeElement_(this.webview_)},e.prototype.createBackground_=function(){var e=document.createElement("div");e.id="g-picker-background",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.zIndex=99,this.background_=e,document.body.appendChild(e)},e.prototype.createWebview_=function(){var e=document.createElement("webview");e.src=this.url_,e.id="g-picker-frame",e.style.width=this.width_+"px",e.style.height=this.height_+"px",e.style.position="absolute",e.style.top="auto",e.style.left="auto",e.style.zIndex="100",e.style.opacity="0.01",this.webview_=e,e.addEventListener("loadstop",function(e){e.target.executeScript({code:"document.body.bgColor = '#606060'"}),e.target.contentWindow.postMessage({action:"showPicker",token:this.token_,key:this.key_,width:this.width_-20,height:this.height_-20},this.url_)}.bind(this)),e.addEventListener("loadabort",function(e){this.dismiss()}.bind(this)),document.body.appendChild(e)},e.prototype.removeElement_=function(e){return e&&e.parentNode.removeChild(e),null},e}),define("base64",function(){}),define("app/OpenView",["jquery","text!ui/view_open.html","app/controls/IconButton","gdocs","spin","psd.parser.min","picker","base64","app/controls/ProgressDialog"],function(e,t,n,r,i,s,o,u,a){function b(){e("body").append(t),PaintCanvas.setVisible(!1),f=new n(e("#button_open_computer"),"My&nbsp;Computer","/images/button_open_computer.png"),w(),E(),l=new n(e("#button_open_gdrive"),"Google&nbsp;Drive","/images/button_open_gdrive.png"),c||(c=new r),S(),e(window).resize(M),M(),AnalyticsTracker.sendAppView("OpenView")}function w(){e("#button_open_computer").click(function(){e("#open_from_computer").trigger("click")}),e("#open_from_computer").on("change",C)}function E(){var t=e("#view_open")[0];t.ondragover=function(){return!1},t.ondragend=function(){return!1},t.ondrop=function(e){console.log("DROP!"),e.preventDefault();var t=e.dataTransfer.files[0],n=new FileReader;n.onload=function(e){k(e.target.result),AnalyticsTracker.sendEvent("open_local_drag_drop")},n.readAsDataURL(t),Canvas.setFilename(t.name)}}function S(){e("#button_open_gdrive").click(function(){if(y)return;y=!0,chrome.identity.getAuthToken({interactive:!0},function(t){y=!1;if(!t)return;d=t,v=new o(GOOGLE_PICKER_HOSTED_URL,T.bind(this),{token:t,key:GOOGLE_PICKER_API_KEY,width:e(window).width()-150,height:e(window).height()-150}),v.showPicker(),g=App.notify("Loading Google Drive..."),e("#label_open_a_photo").hide(),e("#button_open_computer").hide(),e("#button_open_gdrive").hide(),M()})})}function x(e,t,n){if(e){var r=new XMLHttpRequest;r.open("GET",e),r.setRequestHeader("Authorization","Bearer "+d),t&&(r.responseType="arraybuffer"),r.onload=function(e){n(e.currentTarget.response)},r.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log(t),m&&m.setValue(t)}},r.onerror=function(){n(null)},r.send()}else n(null)}function T(t){console.log("PICKED",t),g.hide();if(t.action=="cancel"){e("#label_open_a_photo").show(),e("#button_open_computer").show(),e("#button_open_gdrive").show();return}m=new a("Opening from Google Drive..."),e("#label_open_a_photo").hide(),e("#button_open_computer").hide(),e("#button_open_gdrive").hide(),x(GOOGLE_DRIVE_FILES_URL+t.docs[0].id,!1,function(t){if(!t){App.alert("There was a problem loading the file from Google Drive. Please try again."),e("#label_open_a_photo").show(),e("#button_open_computer").show(),e("#button_open_gdrive").show();return}var n=e.parseJSON(t),r=n.title,i=n.mimeType;x(n.downloadUrl,!0,function(t){if(!t){App.alert("There was a problem loading the file from Google Drive. Please try again."),e("#label_open_a_photo").show(),e("#button_open_computer").show(),e("#button_open_gdrive").show();return}m.hide(),m=null;var n="data:"+i+";base64,"+base64ArrayBuffer(t);Canvas.setFilename(r),k(n)})})}function N(e){if(e.type==""){var t=e.name.substr(e.name.length-3,3);if(t=="psd")return!0}else if(e.type=="image/vnd.adobe.photoshop"||e.type=="image/x-photoshop")return!0;return!1}function C(e){var t=N(e.target.files[0]),n=new FileReader;n.onload=function(e){if(t){var n=new Uint8Array(e.target.result),r=new PSD.Parser(n);r.parse(),k(r.imageData.createCanvas(r.header).toDataURL())}else k(e.target.result);AnalyticsTracker.sendEvent("open_local")},console.log("type: "+e.target.files[0].type),SUPPORTED_FILE_TYPES.indexOf(e.target.files[0].type)!=-1||t?(t?(n.readAsArrayBuffer(e.target.files[0]),AnalyticsTracker.sendEvent("open_file_type","image/vnd.adobe.photoshop")):(n.readAsDataURL(e.target.files[0]),AnalyticsTracker.sendEvent("open_file_type",e.target.files[0].type)),Canvas.setFilename(e.target.files[0].name),e.target.files[0].size>1e6&&L()):App.alert("Sorry, this application currently supports only JPEG, PNG, GIF, BMP and PSD files.")}function k(t){console.log("loadImageURL"),Canvas.loadImage(t,function(){O(),NACL_IS_SUPPORTED&&aM.enable(),MainMenu.init(),TopMenu.init(),PaintCanvas.setVisible(!0),p&&(p.stop(),e("#progress_indicator_background").hide())},function(){A()})}function L(){e("#label_open_a_photo").hide(),e("#button_open_computer").hide(),e("#button_open_gdrive").hide();var t={lines:10,length:0,width:3,radius:6,corners:1,rotate:0,direction:1,color:"#fff",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9};p=(new i(t)).spin(),e("#progress_indicator").append(p.el),e("#progress_indicator_background").show()}function A(){p&&(p.stop(),e("#progress_indicator_background").hide(),e("#label_open_a_photo").show(),e("#button_open_computer").show(),e("#button_open_gdrive").show())}function O(){e("#view_open").remove()}function M(){var t=e(window).height()/2-50,n=e(window).width()/2-105;f.setPos(n,t),l.setPos(n+100+10,t),e("#label_open_a_photo").css("left",n),e("#label_open_a_photo").css("top",t-50);var r=e(window).height()/2-e("#g-picker-frame").outerHeight()/2,i=e(window).width()/2-e("#g-picker-frame").outerWidth()/2;e("#g-picker-frame").css("left",i),e("#g-picker-frame").css("top",r)}var f,l,c=null,h,p,d=null,v=null,m=null,g=null,y=!1;return{show:b}}),define("text!ui/title_bar.html",[],function(){return'<div id="title_bar" style="\n	position:absolute;\n	width:100%;\n	height:30px;\n	top:0px;\n	border-bottom:solid 1px #777;\n	z-index:100;\n	background-color:#606060;\n">\n\n<div style="\n	position:absolute;\n	width:calc(100% - 90px);\n	height:30px;\n	top:0px;\n	-webkit-app-region: drag;\n	z-index:100;\n"></div>\n\n<center><div style="color:#ddd;font-size:14px;padding-top:7px;">Pixlr Touch Up</div></center>\n\n<div id="button_app_close"></div>\n<div id="button_app_maximize"></div>\n<div id="button_app_minimize"></div>\n\n</div>'}),define("text!ui/rollover_button.html",[],function(){return'<div style="\n	position:absolute;\n	cursor:arrow;\n">\n	<img id="button_image" width="13" height="13" style="position:absolute;left:5px;top:5px;"/>\n</div>'}),define("app/controls/RolloverButton",["jquery","text!ui/rollover_button.html"],function(e,t){function n(n,s,o,u){this.el=n,this.img=s,this.clickCallback=null,this.img_width=o,this.img_height=u;var a=e(t);a.attr("id",e(this.el).attr("id")),a.find("#button_image").attr("src",this.img),a.find("#button_image").attr("width",o),a.find("#button_image").attr("height",u),a.find("#button_image").css("opacity",.5),this.el.replaceWith(a),this.el=a;var f=this;this.el.mouseover(function(){r(f)}),this.el.mouseout(function(){i(f)})}function r(e){e.el.find("#button_image").css("opacity",1)}function i(e){e.el.find("#button_image").css("opacity",.5)}return n.prototype.setPos=function(e,t){this.el.css("left",e),this.el.css("top",t)},n.prototype.hide=function(){this.el.hide()},n.prototype.show=function(){this.el.show()},n.prototype.click=function(e){this.clickCallback=e,this.el.click(e)},n.prototype.off=function(e){this.el.off(e)},n}),define("app/TitleBar",["jquery","text!ui/title_bar.html","app/controls/RolloverButton","app/SaveView","app/controls/CloseConfirmDialog"],function(e,t,n,r,i){function a(){function a(e,t){console.log("do save");if(NaClTouchUp.isProcessing())return;MainMenu.getPanel()&&MainMenu.getPanel().accept(),TopMenu.setVisible(!1),MainMenu.setVisible(!1),PaintCanvas.setVisible(!1),new r(e,t)}function l(){window.close()}e("body").append(t),o=new n(e("#button_app_maximize"),"/images/maximize.svg",20,20),e("#button_app_maximize").css("top","0px"),e("#button_app_maximize").css("right","60px"),u=new n(e("#button_app_minimize"),"/images/minimize.svg",20,20),e("#button_app_minimize").css("top","0px"),e("#button_app_minimize").css("right","90px"),s=new n(e("#button_app_close"),"/images/close.svg",20,20),e("#button_app_close").css("top","0px"),e("#button_app_close").css("right","30px"),s.click(function(){console.log("close!"),Canvas.isImageLoaded()&&Canvas.hasUnsavedChanges()?new i(l,a):l()}),o.click(function(){chrome.app.window.current().isMaximized()?chrome.app.window.current().restore():chrome.app.window.current().maximize()}),u.click(function(){window.chrome.app.window.current().minimize()}),e(window).resize(f),f()}function f(){}var s,o,u;return{init:a}});var g,aa=aa||{},l=this,ba=function(e){e=e.split(".");for(var t=l,n;n=e.shift();){if(null==t[n])return null;t=t[n]}return t},ca=function(){},da=function(e){e.Sa=function(){return e.bb?e.bb:e.bb=new e}},m=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},n=function(e){return"array"==m(e)},ea=function(e){var t=m(e);return"array"==t||"object"==t&&"number"==typeof e.length},p=function(e){return"string"==typeof e},fa=function(e){return"number"==typeof e},ga=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},s="closure_uid_"+(1e9*Math.random()>>>0),ha=0,ia=function(e,t,n){return e.call.apply(e.bind,arguments)},ja=function(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},t=function(e,n,r){return t=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja,t.apply(null,arguments)},ka=function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=Array.prototype.slice.call(arguments);return t.unshift.apply(t,n),e.apply(this,t)}},la=Date.now||function(){return+(new Date)},u=function(e,t){var n=e.split("."),r=l;n[0]in r||!r.execScript||r.execScript("var "+n[0]);for(var i;n.length&&(i=n.shift());)n.length||void 0===t?r=r[i]?r[i]:r[i]={}:r[i]=t},w=function(e,t){function n(){}n.prototype=t.prototype,e.K=t.prototype,e.prototype=new n};Function.prototype.bind=Function.prototype.bind||function(e,n){if(1<arguments.length){var r=Array.prototype.slice.call(arguments,1);return r.unshift(this,e),t.apply(null,r)}return t(this,e)};var x=function(e){Error.captureStackTrace?Error.captureStackTrace(this,x):this.stack=Error().stack||"",e&&(this.message=String(e))};w(x,Error),x.prototype.name="CustomError";var ma=function(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")},sa=function(e){return na.test(e)?(-1!=e.indexOf("&")&&(e=e.replace(oa,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(pa,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(qa,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(ra,"&quot;")),e):e},oa=/&/g,pa=/</g,qa=/>/g,ra=/\"/g,na=/[&<>\"]/,ta=function(e,t){t.unshift(e),x.call(this,ma.apply(null,t)),t.shift()};w(ta,x),ta.prototype.name="AssertionError";var y=function(e,t,n){if(!e){var r=Array.prototype.slice.call(arguments,2),i="Assertion failed";if(t)var i=i+(": "+t),s=r;throw new ta(""+i,s||[])}},ua=function(e,t){throw new ta("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))},z=Array.prototype,va=z.indexOf?function(e,t,n){return y(null!=e.length),z.indexOf.call(e,t,n)}:function(e,t,n){n=null==n?0:0>n?Math.max(0,e.length+n):n;if(p(e))return p(t)&&1==t.length?e.indexOf(t,n):-1;for(;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},wa=z.forEach?function(e,t,n){y(null!=e.length),z.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=p(e)?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)},xa=z.some?function(e,t,n){return y(null!=e.length),z.some.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=p(e)?e.split(""):e,s=0;s<r;s++)if(s in i&&t.call(n,i[s],s,e))return!0;return!1},za=function(e){var t;e:{t=ya;for(var n=e.length,r=p(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:p(e)?e.charAt(t):e[t]},Aa=function(e,t){var n=va(e,t),r;if(r=0<=n)y(null!=e.length),z.splice.call(e,n,1);return r},Ba=function(e){return z.concat.apply(z,arguments)},Ca=function(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]},Da=function(e,t){this.width=e,this.height=t};Da.prototype.v=function(){return new Da(this.width,this.height)},Da.prototype.toString=function(){return"("+this.width+" x "+this.height+")"},Da.prototype.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this};var Ea=function(e,t,n){for(var r in e)t.call(n,e[r],r,e)},Fa=function(e){var t=[],n=0,r;for(r in e)t[n++]=e[r];return t},Ga=function(e){var t=[],n=0,r;for(r in e)t[n++]=r;return t},Ha=function(e,t){var n;e:{for(n in e)if(t.call(void 0,e[n],n,e))break e;n=void 0}return n&&e[n]},Ia="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ja=function(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var s=0;s<Ia.length;s++)n=Ia[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}},A,Ka,La,Ma,Na=function(){return l.navigator?l.navigator.userAgent:null};Ma=La=Ka=A=!1;var Oa;if(Oa=Na()){var Pa=l.navigator;A=0==Oa.lastIndexOf("Opera",0),Ka=!A&&(-1!=Oa.indexOf("MSIE")||-1!=Oa.indexOf("Trident")),La=!A&&-1!=Oa.indexOf("WebKit"),Ma=!A&&!La&&!Ka&&"Gecko"==Pa.product}var Qa=A,B=Ka,C=Ma,D=La,Ra=l.navigator,Sa=-1!=(Ra&&Ra.platform||"").indexOf("Mac"),Ta=function(){var e=l.document;return e?e.documentMode:void 0},Ua;e:{var Va="",Xa;if(Qa&&l.opera)var Ya=l.opera.version,Va="function"==typeof Ya?Ya():Ya;else if(C?Xa=/rv\:([^\);]+)(\)|;)/:B?Xa=/\b(?:MSIE|rv)\s+([^\);]+)(\)|;)/:D&&(Xa=/WebKit\/(\S+)/),Xa)var Za=Xa.exec(Na()),Va=Za?Za[1]:"";if(B){var $a=Ta();if($a>parseFloat(Va)){Ua=String($a);break e}}Ua=Va}var ab=Ua,bb={},E=function(e){var t;if(!(t=bb[e])){t=0;for(var n=String(ab).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),r=String(e).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),i=Math.max(n.length,r.length),s=0;0==t&&s<i;s++){var o=n[s]||"",u=r[s]||"",a=RegExp("(\\d*)(\\D*)","g"),f=RegExp("(\\d*)(\\D*)","g");do{var l=a.exec(o)||["","",""],c=f.exec(u)||["","",""];if(0==l[0].length&&0==c[0].length)break;t=((0==l[1].length?0:parseInt(l[1],10))<(0==c[1].length?0:parseInt(c[1],10))?-1:(0==l[1].length?0:parseInt(l[1],10))>(0==c[1].length?0:parseInt(c[1],10))?1:0)||((0==l[2].length)<(0==c[2].length)?-1:(0==l[2].length)>(0==c[2].length)?1:0)||(l[2]<c[2]?-1:l[2]>c[2]?1:0)}while(0==t)}t=bb[e]=0<=t}return t},cb=l.document,db=cb&&B?Ta()||("CSS1Compat"==cb.compatMode?parseInt(ab,10):5):void 0;!C&&!B||B&&B&&9<=db||C&&E("1.9.1"),B&&E("9");var eb="StopIteration"in l?l.StopIteration:Error("StopIteration"),fb=function(){};fb.prototype.next=function(){throw eb},fb.prototype.Hb=function(){return this};var G=function(e,t){this.r={},this.b=[];var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else e&&this.za(e)};g=G.prototype,g.g=0,g.ia=0,g.q=function(){gb(this);for(var e=[],t=0;t<this.b.length;t++)e.push(this.r[this.b[t]]);return e},g.w=function(){return gb(this),this.b.concat()},g.S=function(e){return H(this.r,e)},g.remove=function(e){return H(this.r,e)?(delete this.r[e],this.g--,this.ia++,this.b.length>2*this.g&&gb(this),!0):!1};var gb=function(e){if(e.g!=e.b.length){for(var t=0,n=0;t<e.b.length;){var r=e.b[t];H(e.r,r)&&(e.b[n++]=r),t++}e.b.length=n}if(e.g!=e.b.length){for(var i={},n=t=0;t<e.b.length;)r=e.b[t],H(i,r)||(e.b[n++]=r,i[r]=1),t++;e.b.length=n}};g=G.prototype,g.get=function(e,t){return H(this.r,e)?this.r[e]:t},g.set=function(e,t){H(this.r,e)||(this.g++,this.b.push(e),this.ia++),this.r[e]=t},g.za=function(e){var t;e instanceof G?(t=e.w(),e=e.q()):(t=Ga(e),e=Fa(e));for(var n=0;n<t.length;n++)this.set(t[n],e[n])},g.v=function(){return new G(this)},g.Hb=function(e){gb(this);var t=0,n=this.b,r=this.r,i=this.ia,s=this,o=new fb;return o.next=function(){for(;;){if(i!=s.ia)throw Error("The map has changed since the iterator was created");if(t>=n.length)throw eb;var o=n[t++];return e?o:r[o]}},o};var H=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},hb,ib={id:"hitType",name:"t",valueType:"text",maxLength:void 0,defaultValue:void 0},jb={id:"description",name:"cd",valueType:"text",maxLength:2048,defaultValue:void 0},kb={sc:ib,Tb:{id:"anonymizeIp",name:"aip",valueType:"boolean",maxLength:void 0,defaultValue:void 0},Ec:{id:"queueTime",name:"qt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Zb:{id:"cacheBuster",name:"z",valueType:"text",maxLength:void 0,defaultValue:void 0},Jc:{id:"sessionControl",name:"sc",valueType:"text",maxLength:void 0,defaultValue:void 0},Bc:{id:"nonInteraction",name:"ni",valueType:"boolean",maxLength:void 0,defaultValue:void 0},ic:jb,Sc:{id:"title",name:"dt",valueType:"text",maxLength:1500,defaultValue:void 0},jc:{id:"dimension",name:"cd[1-9][0-9]*",valueType:"text",maxLength:150,defaultValue:void 0},Ac:{id:"metric",name:"cm[1-9][0-9]*",valueType:"integer",maxLength:void 0,defaultValue:void 0},Vb:{id:"appId",name:"aid",valueType:"text",maxLength:150,defaultValue:void 0},Wb:{id:"appInstallerId",name:"aiid",valueType:"text",maxLength:150,defaultValue:void 0},mc:{id:"eventCategory",name:"ec",valueType:"text",maxLength:150,defaultValue:void 0},lc:{id:"eventAction",name:"ea",valueType:"text",maxLength:500,defaultValue:void 0},nc:{id:"eventLabel",name:"el",valueType:"text",maxLength:500,defaultValue:void 0},oc:{id:"eventValue",name:"ev",valueType:"integer",maxLength:void 0,defaultValue:void 0},Lc:{id:"socialNetwork",name:"sn",valueType:"text",maxLength:50,defaultValue:void 0},Kc:{id:"socialAction",name:"sa",valueType:"text",maxLength:50,defaultValue:void 0},Mc:{id:"socialTarget",name:"st",valueType:"text",maxLength:2048,defaultValue:void 0},Vc:{id:"transactionId",name:"ti",valueType:"text",maxLength:500,defaultValue:void 0},Uc:{id:"transactionAffiliation",name:"ta",valueType:"text",maxLength:500,defaultValue:void 0},Wc:{id:"transactionRevenue",name:"tr",valueType:"currency",maxLength:void 0,defaultValue:void 0},Xc:{id:"transactionShipping",name:"ts",valueType:"currency",maxLength:void 0,defaultValue:void 0},Yc:{id:"transactionTax",name:"tt",valueType:"currency",maxLength:void 0,defaultValue:void 0},gc:{id:"currencyCode",name:"cu",valueType:"text",maxLength:10,defaultValue:void 0},wc:{id:"itemPrice",name:"ip",valueType:"currency",maxLength:void 0,defaultValue:void 0},xc:{id:"itemQuantity",name:"iq",valueType:"integer",maxLength:void 0,defaultValue:void 0},uc:{id:"itemCode",name:"ic",valueType:"text",maxLength:500,defaultValue:void 0},vc:{id:"itemName",name:"in",valueType:"text",maxLength:500,defaultValue:void 0},tc:{id:"itemCategory",name:"iv",valueType:"text",maxLength:500,defaultValue:void 0},ec:{id:"campaignSource",name:"cs",valueType:"text",maxLength:100,defaultValue:void 0},cc:{id:"campaignMedium",name:"cm",valueType:"text",maxLength:50,defaultValue:void 0},dc:{id:"campaignName",name:"cn",valueType:"text",maxLength:100,defaultValue:void 0},bc:{id:"campaignKeyword",name:"ck",valueType:"text",maxLength:500,defaultValue:void 0},$b:{id:"campaignContent",name:"cc",valueType:"text",maxLength:500,defaultValue:void 0},ac:{id:"campaignId",name:"ci",valueType:"text",maxLength:100,defaultValue:void 0},rc:{id:"gclid",name:"gclid",valueType:"text",maxLength:void 0,defaultValue:void 0},hc:{id:"dclid",name:"dclid",valueType:"text",maxLength:void 0,defaultValue:void 0},Dc:{id:"pageLoadTime",name:"plt",valueType:"integer",maxLength:void 0,defaultValue:void 0},kc:{id:"dnsTime",name:"dns",valueType:"integer",maxLength:void 0,defaultValue:void 0},Nc:{id:"tcpConnectTime",name:"tcp",valueType:"integer",maxLength:void 0,defaultValue:void 0},Ic:{id:"serverResponseTime",name:"srt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Cc:{id:"pageDownloadTime",name:"pdt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Fc:{id:"redirectResponseTime",name:"rrt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Oc:{id:"timingCategory",name:"utc",valueType:"text",maxLength:150,defaultValue:void 0},Rc:{id:"timingVar",name:"utv",valueType:"text",maxLength:500,defaultValue:void 0},Qc:{id:"timingValue",name:"utt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Pc:{id:"timingLabel",name:"utl",valueType:"text",maxLength:500,defaultValue:void 0},pc:{id:"exDescription",name:"exd",valueType:"text",maxLength:150,defaultValue:void 0},qc:{id:"exFatal",name:"exf",valueType:"boolean",maxLength:void 0,defaultValue:"1"}},lb=function(e){return function(){throw e}},I=function(e,t){this.ga=[],this.hb=t||null,this.Ca=null;if(Error.captureStackTrace){var n={stack:""};Error.captureStackTrace(n,I),"string"==typeof n.stack&&(this.Ca=n.stack.replace(/^[^\n]*\n/,""))}};g=I.prototype,g.m=!1,g.T=!1,g.sa=!1,g.Ja=!1,g.$a=!1,g.lb=0,g.Ka=function(e,t){this.sa=!1,mb(this,e,t)};var mb=function(e,t,n){e.m=!0,e.ra=n,e.T=!t,nb(e)},pb=function(e){if(e.m){if(!e.$a)throw new ob;e.$a=!1}};I.prototype.D=function(e){pb(this),qb(e),mb(this,!0,e)},I.prototype.G=function(e){pb(this),qb(e),rb(this,e),mb(this,!1,e)};var rb=function(e,t){e.Ca&&ga(t)&&t.stack&&/^[^\n]+(\n   [^\n]+)+/.test(t.stack)&&(t.stack=t.stack+"\nDEFERRED OPERATION:\n"+e.Ca)},qb=function(e){y(!(e instanceof I),"An execution sequence may not be initiated with a blocking Deferred.")};I.prototype.Ib=function(e,t){return J(this,e,null,t)};var sb=function(e,t,n){J(e,t,t,n)},J=function(e,t,n,r){return y(!e.Ja,"Blocking Deferreds can not be re-used"),e.ga.push([t,n,r]),e.m&&nb(e),e},tb=function(e){var t=new I;return J(e,t.D,t.G,t),t},ub=function(e){return xa(e.ga,function(e){return"function"==m(e[1])})},nb=function(e){e.ta&&e.m&&ub(e)&&(l.clearTimeout(e.ta),delete e.ta),e.F&&(e.F.lb--,delete e.F);for(var n=e.ra,r=!1,i=!1;e.ga.length&&!e.sa;){var s=e.ga.shift(),o=s[0],u=s[1],s=s[2];if(o=e.T?u:o)try{var a=o.call(s||e.hb,n);void 0!==a&&(e.T=e.T&&(a==n||a instanceof Error),e.ra=n=a),n instanceof I&&(i=!0,e.sa=!0)}catch(f){n=f,e.T=!0,rb(e,n),ub(e)||(r=!0)}}e.ra=n,i&&(J(n,t(e.Ka,e,!0),t(e.Ka,e,!1)),n.Ja=!0),r&&(e.ta=l.setTimeout(lb(n),0))},vb=function(e){var t=new I;return t.D(e),t},xb=function(){var e=wb,t=new I;return t.G(e),t},ob=function(){x.call(this)};w(ob,x),ob.prototype.message="Deferred has already fired",ob.prototype.name="AlreadyCalledError";var yb=function(e,t){var n=Array.prototype.slice.call(arguments),r=n.shift();if("undefined"==typeof r)throw Error("[goog.string.format] Template required");return r.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(e,t,r,i,s,o,u,a){if("%"==o)return"%";var f=n.shift();if("undefined"==typeof f)throw Error("[goog.string.format] Not enough arguments");return arguments[0]=f,K[o].apply(null,arguments)})},K={s:function(e,t,n){return isNaN(n)||""==n||e.length>=n?e:e=-1<t.indexOf("-",0)?e+Array(n-e.length+1).join(" "):Array(n-e.length+1).join(" ")+e},f:function(e,t,n,r,i){r=e.toString(),isNaN(i)||""==i||(r=e.toFixed(i));var s;return s=0>e?"-":0<=t.indexOf("+")?"+":0<=t.indexOf(" ")?" ":"",0<=e&&(r=s+r),isNaN(n)||r.length>=n?r:(r=isNaN(i)?Math.abs(e).toString():Math.abs(e).toFixed(i),e=n-r.length-s.length,r=0<=t.indexOf("-",0)?s+r+Array(e+1).join(" "):s+Array(e+1).join(0<=t.indexOf("0",0)?"0":" ")+r)},d:function(e,t,n,r,i,s,o,u){return K.f(parseInt(e,10),t,n,r,0,s,o,u)}};K.i=K.d,K.u=K.d;var zb=function(e){if("function"==typeof e.q)return e.q();if(p(e))return e.split("");if(ea(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}return Fa(e)},Ab=function(e,t,n){if("function"==typeof e.forEach)e.forEach(t,n);else if(ea(e)||p(e))wa(e,t,n);else{var r;if("function"==typeof e.w)r=e.w();else if("function"!=typeof e.q)if(ea(e)||p(e)){r=[];for(var i=e.length,s=0;s<i;s++)r.push(s)}else r=Ga(e);else r=void 0;for(var i=zb(e),s=i.length,o=0;o<s;o++)t.call(n,i[o],r&&r[o],e)}},L=function(e){this.O=new G,y(!(arguments.length%2),"Uneven number of arguments."),this.za(arguments)};L.prototype.set=function(e,t){this.O.set(e.name,{key:e,value:t})},L.prototype.remove=function(e){this.O.remove(e.name)},L.prototype.get=function(e){return e=this.O.get(e.name,null),null===e?null:e.value},L.prototype.za=function(e){for(var t=0;t<e.length;t+=2)this.set(e[t],e[t+1])};var Bb=function(e,t){wa(e.O.q(),function(e){t(e.key,e.value)})};L.prototype.v=function(){var e=new L;return e.O=this.O.v(),e},L.prototype.toString=function(){var e=[];return Bb(this,function(t,n){e.push([t.name,n].join("="))}),yb("{%s}",e.join(", "))};var Cb=function(e){this.Fb=e};Cb.prototype.send=function(e,t){return this.Fb.push({pb:e,qb:t}),vb()};var Db={id:"apiVersion",name:"v",valueType:"text",maxLength:void 0,defaultValue:void 0},Eb={id:"appName",name:"an",valueType:"text",maxLength:100,defaultValue:void 0},Fb={id:"appVersion",name:"av",valueType:"text",maxLength:100,defaultValue:void 0},Gb={id:"clientId",name:"cid",valueType:"text",maxLength:void 0,defaultValue:void 0},Hb={id:"language",name:"ul",valueType:"text",maxLength:20,defaultValue:void 0},Ib={id:"libVersion",name:"_v",valueType:"text",maxLength:void 0,defaultValue:void 0},Jb={id:"screenColors",name:"sd",valueType:"text",maxLength:20,defaultValue:void 0},Kb={id:"screenResolution",name:"sr",valueType:"text",maxLength:20,defaultValue:void 0},Lb={id:"trackingId",name:"tid",valueType:"text",maxLength:void 0,defaultValue:void 0},Mb={id:"viewportSize",name:"vp",valueType:"text",maxLength:20,defaultValue:void 0},Nb={Ub:Db,Xb:Eb,Yb:Fb,fc:Gb,yc:Hb,zc:Ib,Gc:Jb,Hc:Kb,Tc:Lb,Zc:Mb},Pb=function(e){if(!p(e))return e;var t=Ob(e,kb);if(ga(t))return t;t=Ob(e,Nb);if(ga(t))return t;t=/^dimension(\d+)$/.exec(e);if(null!==t)return{id:e,name:"cd"+t[1],valueType:"text",maxLength:150,defaultValue:void 0};t=/^metric(\d+)$/.exec(e);if(null!==t)return{id:e,name:"cm"+t[1],valueType:"integer",maxLength:void 0,defaultValue:void 0};throw Error(e+" is not a valid parameter name.")},Ob=function(e,t){var n=Ha(t,function(t){return t.id==e&&"metric"!=e&&"dimension"!=e});return ga(n)?n:null},M=function(e){this.R=e,this.Za=new L};g=M.prototype,g.set=function(e,t){var n=Pb(e);this.Za.set(n,t)},g.send=function(e,t){var n=this.Za.v();return t&&Ea(t,function(e,t){null!=e&&n.set(Pb(t),e)},this),this.R.send(e,n)},g.Lb=function(e){var t={description:e};return this.set(jb,e),this.send("appview",t)},g.Mb=function(e,t,n,r){return fa(r)&&y(0<=r),this.send("event",{eventCategory:e,eventAction:t,eventLabel:n,eventValue:r})},g.Ob=function(e,t,n){return this.send("social",{socialNetwork:e,socialAction:t,socialTarget:n})},g.Nb=function(e,t){return this.send("exception",{exDescription:e,exFatal:t})};var N=function(e,t,n,r,i,s){this.kb=e,this.ib=t,this.jb=n,this.n=r,this.M=[],this.L={enabled:new Cb(this.M),disabled:s},this.R=this.L.enabled,J(tb(this.n.l),ka(this.nb,i),this.mb,this)};da(N),g=N.prototype,g.nb=function(e,n){y(null!==this.M,"Channel setup already completed."),y(n==this.n),this.L.enabled=e(this.n),Qb(this),wa(this.M,function(e){this.send(e.pb,e.qb)},this),this.M=null,Rb(this.n,t(this.tb,this))},g.mb=function(){y(null!==this.M,"Channel setup already completed."),this.L.enabled=Sb.Sa(),this.R=this.L.disabled,this.M=null},g.send=function(e,t){return this.R.send(e,t)},g.Kb=function(e){var t=new M(this);return t.set(Ib,this.kb),t.set(Db,1),t.set(Eb,this.ib),t.set(Fb,this.jb),t.set(Lb,e),e=window.navigator.language,t.set(Hb,e),e=screen.colorDepth+"-bit",t.set(Jb,e),e=[screen.width,screen.height].join("x"),t.set(Kb,e),e=window.document,e="CSS1Compat"==e.compatMode?e.documentElement:e.body,e=new Da(e.clientWidth,e.clientHeight),e=[e.width,e.height].join("x"),t.set(Mb,e),t},g.Jb=function(){return tb(this.n.l)};var Qb=function(e){e.R=e.n.Ta()?e.L.enabled:e.L.disabled};N.prototype.tb=function(e){switch(e){case"analytics.tracking-permitted":Qb(this)}};var O=function(e){this.B=e,this.Ia=100,this.ua=ca,this.l=new I,this.ea=this.qa=null,Tb(this)},Tb=function(e){J(e.B.get("analytics.tracking-permitted"),function(e){this.ea=void 0!==e?e:!0,this.Xa()},e.Ya,e),J(Ub(e),e.Xa,e.Ya,e)};O.prototype.Ya=function(e){this.l.G(e)},O.prototype.Xa=function(){null===this.ea||null===this.qa||this.l.D(this)};var Rb=function(e,t){y(e.l.m),y(e.ua==ca),e.ua=t};O.prototype.Qb=function(e){y(this.l.m),sb(this.B.set("analytics.tracking-permitted",e),function(){this.ea=e,this.ua("analytics.tracking-permitted")},this)},O.prototype.Ta=function(){y(this.l.m);var e;if(e=this.ea)e=l._gaUserPrefs,e=!(e&&e.ioo&&e.ioo());return e},O.prototype.Pb=function(e){y(this.l.m),this.Ia=e};var Vb=function(e){return y(e.l.m),y(null!==e.Rb),e.qa},Ub=function(e){var t=new I;return J(e.B.get("analytics.user-id"),function(e){if(!e){e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("");for(var n=0,r=e.length;n<r;n++)switch(e[n]){case"x":e[n]=Math.floor(16*Math.random()).toString(16);break;case"y":e[n]=(Math.floor(4*Math.random())+8).toString(16)}e=e.join(""),this.B.set("analytics.user-id",e)}this.qa=e,t.D()},function(){t.G()},e),t},Wb=function(e,t){this.n=e,this.C=t};Wb.prototype.send=function(e,t){return t.set(Gb,Vb(this.n)),this.C.send(e,t)};var Xb=function(e,t){this.B=e,this.Qa=t||""};Xb.prototype.get=function(e){var t=new I,n=this.Qa+"."+e;return this.B.get(n,function(e){var r=chrome.runtime.lastError;r?t.G(r):t.D(e[n])}),t},Xb.prototype.set=function(e,t){var n=new I,r={};return r[this.Qa+"."+e]=t,this.B.set(r,function(){var e=chrome.runtime.lastError;e?n.G(e):n.D()}),n};var Sb=function(){};da(Sb),Sb.prototype.send=function(){return vb()};var Yb=function(e){this.C=e};Yb.prototype.send=function(e,t){return Zb(t),$b(t),this.C.send(e,t)};var Zb=function(e){Bb(e,function(t,n){void 0!==t.maxLength&&"text"==t.valueType&&0<t.maxLength&&n.length>t.maxLength&&e.set(t,n.substring(0,t.maxLength))})},$b=function(e){Bb(e,function(t,n){void 0!==t.defaultValue&&n==t.defaultValue&&e.remove(t)})},wb={status:"device-offline",na:void 0},ac={status:"rate-limited",na:void 0},bc={status:"sampled-out",na:void 0},cc={status:"sent",na:void 0},dc=function(e,t){this.ub=e,this.C=t};dc.prototype.send=function(e,t){var n;n=this.ub;var r=n.Pa(),i=Math.floor((r-n.Oa)*n.rb);return 0<i&&(n.X=Math.min(n.X+i,n.sb),n.Oa=r),1>n.X?n=!1:(n.X-=1,n=!0),n||"item"==e||"transaction"==e?this.C.send(e,t):vb(ac)};var ec=function(){y(!0),y(!0),y(!0),this.X=60,this.sb=500,this.rb=5e-4,this.Pa=function(){return(new Date).getTime()},this.Oa=this.Pa()},fc=function(e,t){this.n=e,this.C=t};fc.prototype.send=function(e,t){var n=t.get(Gb),n=parseInt(n.split("-")[1],16),r=this.n;return y(r.l.m),n<655.36*r.Ia?this.C.send(e,t):vb(bc)};var gc="closure_listenable_"+(1e6*Math.random()|0),hc=function(e){return!!e&&!!e[gc]},ic=0,jc=function(){};jc.prototype.Aa=!1,jc.prototype.ka=function(){this.Aa||(this.Aa=!0,this.j())},jc.prototype.j=function(){if(this.fb)for(;this.fb.length;)this.fb.shift()()};var P=function(e,t){this.type=e,this.currentTarget=this.target=t};g=P.prototype,g.j=function(){},g.ka=function(){},g.I=!1,g.defaultPrevented=!1,g.La=!0,g.preventDefault=function(){this.defaultPrevented=!0,this.La=!1};var kc=function(e){return kc[" "](e),e};kc[" "]=ca;var lc=!B||B&&9<=db,mc=B&&!E("9"),nc=!D||E("528"),oc=C&&E("1.9b")||B&&E("8")||Qa&&E("9.5")||D&&E("528"),pc=C&&!E("8")||B&&!E("9"),qc=function(e,t){if(e){var n=this.type=e.type;P.call(this,n),this.target=e.target||e.srcElement,this.currentTarget=t;var r=e.relatedTarget;if(r){if(C){var i;e:{try{kc(r.nodeName),i=!0;break e}catch(s){}i=!1}i||(r=null)}}else"mouseover"==n?r=e.fromElement:"mouseout"==n&&(r=e.toElement);this.relatedTarget=r,this.offsetX=D||void 0!==e.offsetX?e.offsetX:e.layerX,this.offsetY=D||void 0!==e.offsetY?e.offsetY:e.layerY,this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0,this.button=e.button,this.keyCode=e.keyCode||0,this.charCode=e.charCode||("keypress"==n?e.keyCode:0),this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.Cb=Sa?e.metaKey:e.ctrlKey,this.state=e.state,this.Wa=e,e.defaultPrevented&&this.preventDefault(),delete this.I}};w(qc,P),g=qc.prototype,g.target=null,g.relatedTarget=null,g.offsetX=0,g.offsetY=0,g.clientX=0,g.clientY=0,g.screenX=0,g.screenY=0,g.button=0,g.keyCode=0,g.charCode=0,g.ctrlKey=!1,g.altKey=!1,g.shiftKey=!1,g.metaKey=!1,g.Cb=!1,g.Wa=null,g.preventDefault=function(){qc.K.preventDefault.call(this);var e=this.Wa;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,mc)try{if(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)e.keyCode=-1}catch(t){}},g.j=function(){};var rc=function(e,t,n,r,i){this.H=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ja=i,this.key=++ic,this.removed=this.ha=!1},sc=function(e){e.removed=!0,e.H=null,e.proxy=null,e.src=null,e.ja=null},Q=function(e){this.src=e,this.h={},this.W=0};Q.prototype.add=function(e,t,n,r,i){var s=this.h[e];s||(s=this.h[e]=[],this.W++);var o=tc(s,t,r,i);return-1<o?(e=s[o],n||(e.ha=!1)):(e=new rc(t,this.src,e,!!r,i),e.ha=n,s.push(e)),e},Q.prototype.remove=function(e,t,n,r){if(e in this.h){var i=this.h[e];return t=tc(i,t,n,r),-1<t?(sc(i[t]),y(null!=i.length),z.splice.call(i,t,1),0==i.length&&(delete this.h[e],this.W--),!0):!1}return!1};var uc=function(e,t){var n=t.type;if(n in e.h){var r=Aa(e.h[n],t);return r&&(sc(t),0==e.h[n].length&&(delete e.h[n],e.W--)),r}return!1};Q.prototype.removeAll=function(e){var t=0,n;for(n in this.h)if(!e||n==e){for(var r=this.h[n],i=0;i<r.length;i++)++t,sc(r[i]);delete this.h[n],this.W--}return t},Q.prototype.U=function(e,t,n,r){e=this.h[e];var i=-1;return e&&(i=tc(e,t,n,r)),-1<i?e[i]:null};var tc=function(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.removed&&s.H==t&&s.capture==!!n&&s.ja==r)return i}return-1},vc={},wc={},R={},xc=function(e,t,r,i,s){if(n(t)){for(var o=0;o<t.length;o++)xc(e,t[o],r,i,s);return null}return r=yc(r),hc(e)?e.V(t,r,i,s):zc(e,t,r,!1,i,s)},zc=function(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var u=!!i,a=e[s]||(e[s]=++ha),f=wc[a];return f||(wc[a]=f=new Q(e)),n=f.add(t,n,r,i,o),n.proxy?n:(r=Ac(),n.proxy=r,r.src=e,r.H=n,e.addEventListener?e.addEventListener(t,r,u):e.attachEvent(t in R?R[t]:R[t]="on"+t,r),vc[n.key]=n)},Ac=function(){var e=Bc,t=lc?function(n){return e.call(t.src,t.H,n)}:function(n){n=e.call(t.src,t.H,n);if(!n)return n};return t},Cc=function(e,t,r,i,s){if(n(t)){for(var o=0;o<t.length;o++)Cc(e,t[o],r,i,s);return null}return r=yc(r),hc(e)?e.ma(t,r,i,s):zc(e,t,r,!0,i,s)},Dc=function(e,t,r,i,s){if(n(t))for(var o=0;o<t.length;o++)Dc(e,t[o],r,i,s);else r=yc(r),hc(e)?e.Ba(t,r,i,s):e&&(i=!!i,(e=Ec(e))&&(t=e.U(t,r,i,s))&&Fc(t))},Fc=function(e){if(fa(e)||!e||e.removed)return!1;var t=e.src;if(hc(t))return uc(t.p,e);var n=e.type,r=e.proxy;return t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent&&t.detachEvent(n in R?R[n]:R[n]="on"+n,r),(n=Ec(t))?(uc(n,e),0==n.W&&(n.src=null,delete wc[t[s]||(t[s]=++ha)])):sc(e),delete vc[e.key],!0},Hc=function(e,t,n,r){var i=1;if(e=Ec(e))if(t=e.h[t])for(t=Ca(t),e=0;e<t.length;e++){var s=t[e];s&&s.capture==n&&!s.removed&&(i&=!1!==Gc(s,r))}return Boolean(i)},Gc=function(e,t){var n=e.H,r=e.ja||e.src;return e.ha&&Fc(e),n.call(r,t)},Bc=function(e,t){if(e.removed)return!0;if(!lc){var n=t||ba("window.event"),r=new qc(n,this),i=!0;if(!(0>n.keyCode||void 0!=n.returnValue)){e:{var s=!1;if(0==n.keyCode)try{n.keyCode=-1;break e}catch(o){s=!0}if(s||void 0==n.returnValue)n.returnValue=!0}n=[];for(s=r.currentTarget;s;s=s.parentNode)n.push(s);for(var s=e.type,u=n.length-1;!r.I&&0<=u;u--)r.currentTarget=n[u],i&=Hc(n[u],s,!0,r);for(u=0;!r.I&&u<n.length;u++)r.currentTarget=n[u],i&=Hc(n[u],s,!1,r)}return i}return Gc(e,new qc(t,this))},Ec=function(e){return e[s]?wc[e[s]||(e[s]=++ha)]||null:null},Ic="__closure_events_fn_"+(1e9*Math.random()>>>0),yc=function(e){return y(e,"Listener can not be null."),"function"==m(e)?e:(y(e.handleEvent,"An object listener must have handleEvent method."),e[Ic]||(e[Ic]=function(t){return e.handleEvent(t)}))},S=function(){this.p=new Q(this),this.wb=this};w(S,jc),S.prototype[gc]=!0,g=S.prototype,g.xa=null,g.addEventListener=function(e,t,n,r){xc(this,e,t,n,r)},g.removeEventListener=function(e,t,n,r){Dc(this,e,t,n,r)},g.dispatchEvent=function(e){Jc(this);var t,n=this.xa;if(n){t=[];for(var r=1;n;n=n.xa)t.push(n),y(1e3>++r,"infinite loop")}n=this.wb,r=e.type||e;if(p(e))e=new P(e,n);else if(e instanceof P)e.target=e.target||n;else{var i=e;e=new P(r,n),Ja(e,i)}var i=!0,s;if(t)for(var o=t.length-1;!e.I&&0<=o;o--)s=e.currentTarget=t[o],i=Kc(s,r,!0,e)&&i;e.I||(s=e.currentTarget=n,i=Kc(s,r,!0,e)&&i,e.I||(i=Kc(s,r,!1,e)&&i));if(t)for(o=0;!e.I&&o<t.length;o++)s=e.currentTarget=t[o],i=Kc(s,r,!1,e)&&i;return i},g.j=function(){S.K.j.call(this),this.p&&this.p.removeAll(void 0),this.xa=null},g.V=function(e,t,n,r){return Jc(this),this.p.add(e,t,!1,n,r)},g.ma=function(e,t,n,r){return this.p.add(e,t,!0,n,r)},g.Ba=function(e,t,n,r){return this.p.remove(e,t,n,r)};var Kc=function(e,t,n,r){t=e.p.h[t];if(!t)return!0;t=Ca(t);for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.removed&&o.capture==n){var u=o.H,a=o.ja||o.src;o.ha&&uc(e.p,o),i=!1!==u.call(a,r)&&i}}return i&&0!=r.La};S.prototype.U=function(e,t,n,r){return this.p.U(e,t,n,r)};var Jc=function(e){y(e.p,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},Mc=function(e){return Lc(e||arguments.callee.caller,[])},Lc=function(e,t){var n=[];if(0<=va(t,e))n.push("[...circular reference...]");else if(e&&50>t.length){n.push(Nc(e)+"(");for(var r=e.arguments,i=0;i<r.length;i++){0<i&&n.push(", ");var s;s=r[i];switch(typeof s){case"object":s=s?"object":"null";break;case"string":break;case"number":s=String(s);break;case"boolean":s=s?"true":"false";break;case"function":s=(s=Nc(s))?s:"[fn]";break;default:s=typeof s}40<s.length&&(s=s.substr(0,40)+"..."),n.push(s)}t.push(e),n.push(")\n");try{n.push(Lc(e.caller,t))}catch(o){n.push("[exception trying to get caller]\n")}}else e?n.push("[...long stack...]"):n.push("[end]");return n.join("")},Nc=function(e){if(Oc[e])return Oc[e];e=String(e);if(!Oc[e]){var t=/function ([^\(]+)/.exec(e);Oc[e]=t?t[1]:"[Anonymous]"}return Oc[e]},Oc={},T=function(e,t,n,r,i){this.reset(e,t,n,r,i)};T.prototype.Ab=0,T.prototype.Va=null,T.prototype.Ua=null;var Pc=0;T.prototype.reset=function(e,t,n,r,i){this.Ab="number"==typeof i?i:Pc++,r||la(),this.Y=e,this.zb=t,delete this.Va,delete this.Ua},T.prototype.ab=function(e){this.Y=e},T.prototype.getMessage=function(){return this.zb};var U=function(e){this.Eb=e};U.prototype.F=null,U.prototype.Y=null,U.prototype.Da=null,U.prototype.cb=null;var Qc=function(e,t){this.name=e,this.value=t};Qc.prototype.toString=function(){return this.name};var Rc=new Qc("SEVERE",1e3),Sc=new Qc("WARNING",900),Tc=new Qc("CONFIG",700),Uc=new Qc("FINE",500);U.prototype.getParent=function(){return this.F},U.prototype.getChildren=function(){return this.Da||(this.Da={}),this.Da},U.prototype.ab=function(e){this.Y=e};var Vc=function(e){return e.Y?e.Y:e.F?Vc(e.F):(ua("Root logger has no level set."),null)};U.prototype.log=function(e,t,n){if(e.value>=Vc(this).value)for(e=this.Gb(e,t,n),t="log:"+e.getMessage(),l.console&&(l.console.timeStamp?l.console.timeStamp(t):l.console.markTimeline&&l.console.markTimeline(t)),l.msWriteProfilerMark&&l.msWriteProfilerMark(t),t=this;t;){n=t;var r=e;if(n.cb)for(var i=0,s=void 0;s=n.cb[i];i++)s(r);t=t.getParent()}},U.prototype.Gb=function(e,t,n){var r=new T(e,String(t),this.Eb);if(n){r.Va=n;var i,s=arguments.callee.caller;try{var o,u=ba("window.location.href");if(p(n))o={message:n,name:"Unknown error",lineNumber:"Not available",fileName:u,stack:"Not available"};else{var a,f,c=!1;try{a=n.lineNumber||n.Sb||"Not available"}catch(h){a="Not available",c=!0}try{f=n.fileName||n.filename||n.sourceURL||l.$googDebugFname||u}catch(d){f="Not available",c=!0}o=!c&&n.lineNumber&&n.fileName&&n.stack&&n.message&&n.name?n:{message:n.message||"Not available",name:n.name||"UnknownError",lineNumber:a,fileName:f,stack:n.stack||"Not available"}}i="Message: "+sa(o.message)+'\nUrl: <a href="view-source:'+o.fileName+'" target="_new">'+o.fileName+"</a>\nLine: "+o.lineNumber+"\n\nBrowser stack:\n"+sa(o.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+sa(Mc(s)+"-> ")}catch(v){i="Exception trying to expose exception! You win, we lose. "+v}r.Ua=i}return r};var Wc={},Xc=null,Yc=function(e){Xc||(Xc=new U(""),Wc[""]=Xc,Xc.ab(Tc));var t;if(!(t=Wc[e])){t=new U(e);var n=e.lastIndexOf("."),r=e.substr(n+1),n=Yc(e.substr(0,n));n.getChildren()[r]=t,t.F=n,Wc[e]=t}return t},V=function(e,t){e&&e.log(Uc,t,void 0)},Zc=function(e,n){S.call(this),this.la=e||1,this.N=n||l,this.va=t(this.yb,this),this.wa=la()};w(Zc,S),g=Zc.prototype,g.enabled=!1,g.e=null,g.yb=function(){if(this.enabled){var e=la()-this.wa;0<e&&e<.8*this.la?this.e=this.N.setTimeout(this.va,this.la-e):(this.e&&(this.N.clearTimeout(this.e),this.e=null),this.dispatchEvent("tick"),this.enabled&&(this.e=this.N.setTimeout(this.va,this.la),this.wa=la()))}},g.start=function(){this.enabled=!0,this.e||(this.e=this.N.setTimeout(this.va,this.la),this.wa=la())},g.stop=function(){this.enabled=!1,this.e&&(this.N.clearTimeout(this.e),this.e=null)},g.j=function(){Zc.K.j.call(this),this.stop(),delete this.N};var $c=function(e,n,r){if("function"==m(e))r&&(e=t(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=t(e.handleEvent,e)}return 2147483647<n?-1:l.setTimeout(e,n||0)},ad=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),bd=D,cd=function(e,t){if(bd){bd=!1;var n=l.location;if(n){var r=n.href;if(r&&(r=(r=cd(3,r))&&decodeURIComponent(r))&&r!=n.hostname)throw bd=!0,Error()}}return t.match(ad)[e]||null},dd=function(){};dd.prototype.da=null;var ed,fd=function(){};w(fd,dd);var hd=function(e){return(e=gd(e))?new ActiveXObject(e):new XMLHttpRequest},id=function(e){var t={};return gd(e)&&(t[0]=!0,t[1]=!0),t},gd=function(e){if(!e.eb&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.eb=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.eb};ed=new fd;var W=function(e){S.call(this),this.headers=new G,this.J=e||null,this.t=!1,this.$=this.a=null,this.P=this.Ea=this.aa="",this.A=this.oa=this.Z=this.pa=!1,this.Q=0,this.ba=null,this.Fa="",this.ca=this.gb=!1};w(W,S);var jd=W.prototype,kd=Yc("goog.net.XhrIo");jd.k=kd;var ld=/^https?$/i,md=["POST","PUT"],nd=[],od=function(e,t,n){var r=new W;nd.push(r),t&&r.V("complete",t),r.ma("ready",r.Bb),r.send(e,"POST",n,void 0)};W.prototype.Bb=function(){this.ka(),Aa(nd,this)},W.prototype.send=function(e,n,r,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.aa+"; newUri="+e);n=n?n.toUpperCase():"GET",this.aa=e,this.P="",this.Ea=n,this.pa=!1,this.t=!0,this.a=this.J?hd(this.J):hd(ed),this.$=this.J?this.J.da||(this.J.da=id(this.J)):ed.da||(ed.da=id(ed)),this.a.onreadystatechange=t(this.Ga,this);try{V(this.k,X(this,"Opening Xhr")),this.oa=!0,this.a.open(n,e,!0),this.oa=!1}catch(s){V(this.k,X(this,"Error opening Xhr: "+s.message)),pd(this,s);return}e=r||"";var o=this.headers.v();i&&Ab(i,function(e,t){o.set(t,e)}),i=za(o.w()),r=l.FormData&&e instanceof l.FormData,!(0<=va(md,n))||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),Ab(o,function(e,t){this.a.setRequestHeader(t,e)},this),this.Fa&&(this.a.responseType=this.Fa),"withCredentials"in this.a&&(this.a.withCredentials=this.gb);try{qd(this),0<this.Q&&(this.ca=B&&E(9)&&fa(this.a.timeout)&&void 0!==this.a.ontimeout,V(this.k,X(this,"Will abort after "+this.Q+"ms if incomplete, xhr2 "+this.ca)),this.ca?(this.a.timeout=this.Q,this.a.ontimeout=t(this.Ha,this)):this.ba=$c(this.Ha,this.Q,this)),V(this.k,X(this,"Sending request")),this.Z=!0,this.a.send(e),this.Z=!1}catch(u){V(this.k,X(this,"Send error: "+u.message)),pd(this,u)}};var ya=function(e){return"content-type"==e.toLowerCase()};W.prototype.Ha=function(){"undefined"!=typeof aa&&this.a&&(this.P="Timed out after "+this.Q+"ms, aborting",V(this.k,X(this,this.P)),this.dispatchEvent("timeout"),this.abort(8))};var pd=function(e,t){e.t=!1,e.a&&(e.A=!0,e.a.abort(),e.A=!1),e.P=t,rd(e),sd(e)},rd=function(e){e.pa||(e.pa=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))};W.prototype.abort=function(){this.a&&this.t&&(V(this.k,X(this,"Aborting")),this.t=!1,this.A=!0,this.a.abort(),this.A=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),sd(this))},W.prototype.j=function(){this.a&&(this.t&&(this.t=!1,this.A=!0,this.a.abort(),this.A=!1),sd(this,!0)),W.K.j.call(this)},W.prototype.Ga=function(){this.Aa||(this.oa||this.Z||this.A?td(this):this.xb())},W.prototype.xb=function(){td(this)};var td=function(e){if(e.t&&"undefined"!=typeof aa)if(e.$[1]&&4==ud(e)&&2==wd(e))V(e.k,X(e,"Local request error detected and ignored"));else if(e.Z&&4==ud(e))$c(e.Ga,0,e);else if(e.dispatchEvent("readystatechange"),4==ud(e)){V(e.k,X(e,"Request complete")),e.t=!1;try{var t=wd(e),n,r;e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:r=!0;break e;default:r=!1}if(!(n=r)){var i;if(i=0===t){var s=cd(1,String(e.aa));if(!s&&self.location)var o=self.location.protocol,s=o.substr(0,o.length-1);i=!ld.test(s?s.toLowerCase():"")}n=i}if(n)e.dispatchEvent("complete"),e.dispatchEvent("success");else{var u;try{u=2<ud(e)?e.a.statusText:""}catch(a){V(e.k,"Can not get status: "+a.message),u=""}e.P=u+" ["+wd(e)+"]",rd(e)}}finally{sd(e)}}},sd=function(e,t){if(e.a){qd(e);var n=e.a,r=e.$[0]?ca:null;e.a=null,e.$=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(n=e.k)&&n.log(Rc,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}},qd=function(e){e.a&&e.ca&&(e.a.ontimeout=null),fa(e.ba)&&(l.clearTimeout(e.ba),e.ba=null)},ud=function(e){return e.a?e.a.readyState:0},wd=function(e){try{return 2<ud(e)?e.a.status:-1}catch(t){return(e=e.k)&&e.log(Sc,"Can not get status: "+t.message,void 0),-1}},X=function(e,t){return t+" ["+e.Ea+" "+e.aa+" "+wd(e)+"]"},xd=function(e,t,n){this.o=e||null,this.Db=!!n},Z=function(e){if(!e.c&&(e.c=new G,e.g=0,e.o))for(var t=e.o.split("&"),n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null,s=null;0<=r?(i=t[n].substring(0,r),s=t[n].substring(r+1)):i=t[n],i=decodeURIComponent(i.replace(/\+/g," ")),i=Y(e,i),e.add(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}};g=xd.prototype,g.c=null,g.g=null,g.add=function(e,t){Z(this),this.o=null,e=Y(this,e);var n=this.c.get(e);return n||this.c.set(e,n=[]),n.push(t),this.g++,this},g.remove=function(e){return Z(this),e=Y(this,e),this.c.S(e)?(this.o=null,this.g-=this.c.get(e).length,this.c.remove(e)):!1},g.S=function(e){return Z(this),e=Y(this,e),this.c.S(e)},g.w=function(){Z(this);for(var e=this.c.q(),t=this.c.w(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},g.q=function(e){Z(this);var t=[];if(e)this.S(e)&&(t=Ba(t,this.c.get(Y(this,e))));else{e=this.c.q();for(var n=0;n<e.length;n++)t=Ba(t,e[n])}return t},g.set=function(e,t){return Z(this),this.o=null,e=Y(this,e),this.S(e)&&(this.g-=this.c.get(e).length),this.c.set(e,[t]),this.g++,this},g.get=function(e,t){var n=e?this.q(e):[];return 0<n.length?String(n[0]):t},g.toString=function(){if(this.o)return this.o;if(!this.c)return"";for(var e=[],t=this.c.w(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.q(r),s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}return this.o=e.join("&")},g.v=function(){var e=new xd;return e.o=this.o,this.c&&(e.c=this.c.v(),e.g=this.g),e};var Y=function(e,t){var n=String(t);return e.Db&&(n=n.toLowerCase()),n},yd=function(e,t){this.vb=e,this.Ra=t};yd.prototype.send=function(e,t){if(nc&&!navigator.onLine)return xb();var n=new I,r=zd(e,t);return r.length>this.Ra?n.G({status:"payload-too-big",na:yb("Encoded hit length == %s, but should be <= %s.",r.length,this.Ra)}):od(this.vb,function(){n.D(cc)},r),n};var zd=function(e,t){var n=new xd;return n.add(ib.name,e),Bb(t,function(e,t){n.add(e.name,t.toString())}),n.toString()},Ad=function(e){this.ya=e,this.b={}};w(Ad,jc);var Bd=[];g=Ad.prototype,g.V=function(e,t,r,i,s){n(t)||(Bd[0]=t,t=Bd);for(var o=0;o<t.length;o++){var u=xc(e,t[o],r||this,i||!1,s||this.ya||this);if(!u)break;this.b[u.key]=u}return this},g.ma=function(e,t,r,i,s){if(n(t))for(var o=0;o<t.length;o++)this.ma(e,t[o],r,i,s);else e=Cc(e,t,r||this,i,s||this.ya||this),this.b[e.key]=e;return this},g.Ba=function(e,t,r,i,s){if(n(t))for(var o=0;o<t.length;o++)this.Ba(e,t[o],r,i,s);else s=s||this.ya||this,r=yc(r||this),i=!!i,t=hc(e)?e.U(t,r,i,s):e?(e=Ec(e))?e.U(t,r,i,s):null:null,t&&(Fc(t),delete this.b[t.key]);return this},g.removeAll=function(){Ea(this.b,Fc),this.b={}},g.j=function(){Ad.K.j.call(this),this.removeAll()},g.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $=function(){S.call(this),this.fa=new Ad(this),nc&&(oc?this.fa.V(pc?document.body:window,["online","offline"],this.Ma):(this.Na=nc?navigator.onLine:!0,this.e=new Zc(250),this.fa.V(this.e,"tick",this.ob),this.e.start()))};w($,S),$.prototype.ob=function(){var e=nc?navigator.onLine:!0;e!=this.Na&&(this.Na=e,this.Ma())},$.prototype.Ma=function(){this.dispatchEvent((nc?navigator.onLine:1)?"online":"offline")},$.prototype.j=function(){$.K.j.call(this),this.fa.ka(),this.fa=null,this.e&&(this.e.ka(),this.e=null)};var Cd=new G,Dd=function(e){if(!hb){new $;var t=new Yb(new yd("https://www.google-analytics.com/collect",8192)),n=new ec;hb=new Wb(e,new fc(e,new dc(n,t)))}return hb};u("goog.async.Deferred",I),u("goog.async.Deferred.prototype.addCallback",I.prototype.Ib),u("analytics.getService",function(e){var t=Cd.get(e,null);if(null===t){var t=chrome.runtime.getManifest().version,n;n=new Xb(chrome.storage.local,"google-analytics"),y(null!==n),n=new O(n),t=new N("ca1",e,t,n,Dd,Sb.Sa()),Cd.set(e,t)}return t}),u("analytics.internal.ServiceChannel",N),u("analytics.internal.ServiceChannel.prototype.getTracker",N.prototype.Kb),u("analytics.internal.ServiceChannel.prototype.getConfig",N.prototype.Jb),u("analytics.internal.ServiceSettings",O),u("analytics.internal.ServiceSettings.prototype.setTrackingPermitted",O.prototype.Qb),u("analytics.internal.ServiceSettings.prototype.isTrackingPermitted",O.prototype.Ta),u("analytics.internal.ServiceSettings.prototype.setSampleRate",O.prototype.Pb),u("analytics.internal.ServiceTracker",M),u("analytics.internal.ServiceTracker.prototype.send",M.prototype.send),u("analytics.internal.ServiceTracker.prototype.sendAppView",M.prototype.Lb),u("analytics.internal.ServiceTracker.prototype.sendEvent",M.prototype.Mb),u("analytics.internal.ServiceTracker.prototype.sendSocial",M.prototype.Ob),u("analytics.internal.ServiceTracker.prototype.sendException",M.prototype.Nb),u("analytics.HitTypes.APPVIEW","appview"),u("analytics.HitTypes.EVENT","event"),u("analytics.HitTypes.SOCIAL","social"),u("analytics.HitTypes.TRANSACTION","transaction"),u("analytics.HitTypes.ITEM","item"),u("analytics.HitTypes.TIMING","timing"),u("analytics.HitTypes.EXCEPTION","exception"),Ea(kb,function(e){var t=e.id.replace(/[A-Z]/,"_$&").toUpperCase();u("analytics.Parameters."+t,e)}),define("google-analytics-bundle",function(){}),define("text!ui/alert_dialog.html",[],function(){return'<div id="view_modal" style="\n	position:absolute;\n	background-color:#606060;\n	opacity:0.5;\n	z-index:10;\n"></div>\n\n<div id="view_alert" style="\n	position:absolute;\n	width:160px;\n	z-index:10;\n	\n">\n\n<div id="label_message" style="\n	border-radius:5px;\n	background-color:#404040;\n	position:absolute;\n	top:0;\n	left:0;\n	padding:25px;\n	width:160px;\n	color:white;\n	font-size:13px;\n"></div>\n\n<div id="button_ok"></div>\n<div id="button_restart"></div>\n\n</div>\n\n'}),define("app/controls/AlertDialog",["jquery","text!ui/alert_dialog.html","app/controls/Button"],function(e,t,n){function r(r,i){function o(){s.hide()}function u(){var t=e(window).height()/2-e("#view_alert #label_message").outerHeight()/2,n=e(window).width()/2-e("#view_alert #label_message").outerWidth()/2;e("#view_alert").css("left",n),e("#view_alert").css("top",t),s.show_restart?(s.button_ok.setPos(15,e("#view_alert #label_message").outerHeight()+5),s.button_restart.setPos(115,e("#view_alert #label_message").outerHeight()+5)):s.button_ok.setPos(65,e("#view_alert #label_message").outerHeight()+5),e("#view_modal").css("width",e(window).width()),e("#view_modal").css("height",e(window).height())}this.message=r,this.show_restart=typeof i!="undefined"?i:!1,e("body").append(t),this.button_ok=new n(e("#view_alert #button_ok"),"OK",null,80),this.show_restart&&(this.button_restart=new n(e("#view_alert #button_restart"),"Restart",null,80)),e("#view_alert #label_message").text(r);var s=this;e(window).resize(u),u(),this.button_ok.click(function(){o()}),this.show_restart&&this.button_restart.click(function(){chrome.runtime.reload()})}return r.prototype.hide=function(){e("#view_alert").remove(),e("#view_modal").remove()},r}),define("text!ui/notification_dialog.html",[],function(){return'\n<div id="view_notification" style="\n	position:absolute;\n	width:160px;\n	z-index:10;\n	\n">\n\n<div id="label_message" style="\n	border-radius:5px;\n	background-color:#404040;\n	position:absolute;\n	top:0;\n	left:0;\n	padding:15px;\n	text-align:center;\n	width:160px;\n	color:white;\n	font-size:13px;\n"></div>\n\n</div>\n\n'}),define("app/controls/NotificationDialog",["jquery","text!ui/notification_dialog.html"],function(e,t){function n(n,r){function s(){i.hide()}function o(){var t=e(window).height()/2-e("#view_notification #label_message").outerHeight()/2,n=e(window).width()/2-e("#view_notification #label_message").outerWidth()/2;e("#view_notification").css("left",n),e("#view_notification").css("top",t)}this.message=n,this.stayVisible=typeof r!="undefined"?r:!1,e("body").append(t),e("#view_notification #label_message").text(n),this.stayVisible||e("#view_notification").delay(1e3).fadeOut(200,function(){s()});var i=this;e(window).resize(o),o()}return n.prototype.hide=function(){e("#view_notification").remove()},n}),define("NaClAMMessage",[],function(){function e(){this.header={},this.frames=new Array}return e.prototype.reset=function(){this.header={},this.frames=new Array},e}),define("NaClAM",["NaClAMMessage"],function(e){function t(t){this.embedId=t,this.requestId=0,this.message=new e,this.state=0,this.framesLeft=0,this.listeners_=Object.create(null),this.handleMesssage_=this.handleMesssage_.bind(this)}return t.prototype.isLoaded=function(){return document.getElementById(this.embedId).readyState==4},t.prototype.enable=function(){window.addEventListener("message",this.handleMesssage_,!0)},t.prototype.disable=function(){window.removeEventListener("message",this.handleMesssage_,!0)},t.prototype.log_=function(e){console.log(e)},t.prototype.handleMesssage_=function(e){var t=0,n=1;if(this.state==t){var r=JSON.parse(String(e.data));if(r["cmd"]=="NaClAMPrint"){this.log_(r.print);return}if(typeof r["request"]!="number"){console.log("Header message requestId is not a number.");return}if(typeof r["frames"]!="number"){console.log("Header message frames is not a number.");return}this.framesLeft=r.frames,this.state=n,this.message.header=r}else this.state==n&&(this.framesLeft--,this.message.frames.push(e.data));this.state==n&&this.framesLeft==0&&(this.dispatchEvent(this.message),this.message.reset(),this.state=t)},t.prototype.messageHeaderIsValid_=function(e){return e["cmd"]==undefined?(console.log("NaClAM: Message header does not contain cmd."),!1):typeof e["cmd"]!="string"?(console.log("NaClAm: Message cmd is not a string."),!1):e["frames"]==undefined?(console.log("NaClAM: Message header does not contain frames."),!1):typeof e["frames"]!="number"?(console.log("NaClAm: Message frames is not a number."),!1):e["request"]==undefined?(console.log("NaClAM: Message header does not contain request."),!1):typeof e["request"]!="number"?(console.log("NaClAm: Message request is not a number."),!1):!0},t.prototype.framesIsValid_=function(e){var t;if(!e)return!0;if(Array.isArray(e)==0)return console.log("NaClAM: Frames must be an array."),!1;for(t=0;t<e.length;t++){var n=e[t];if(typeof n=="string")continue;if(n instanceof ArrayBuffer==0)return console.log("NaClAM: Frame is not a string or ArrayBuffer"),!1}return!0},t.prototype.framesLength_=function(e){return e?e.length:0},t.prototype.sendMessage=function(e,t,n){if(this.framesIsValid_(n)==0)return console.log("NaClAM: Not sending message because frames is invalid."),undefined;var r=this.framesLength_(n);this.requestId++;var i={cmd:e,frames:r,request:this.requestId,args:t};if(this.messageHeaderIsValid_(i)==0)return console.log("NaClAM: Not sending message because header is invalid."),undefined;var s=document.getElementById(this.embedId);if(!s)return console.log("NaClAM: Not sending message because Acceleration Module is not there."),undefined;console.log("AM sending message: "+JSON.stringify(i)),s.postMessage(JSON.stringify(i));var o;for(o=0;o<r;o++)s.postMessage(n[o]);return this.requestId},t.prototype.addEventListener=function(e,t){this.listeners_||(this.listeners_=Object.create(null));if(e in this.listeners_){var n=this.listeners_[e];n.indexOf(t)<0&&n.push(t)}else this.listeners_[e]=[t]},t.prototype.removeEventListener=function(e,t){if(!this.listeners_)return;if(e in this.listeners_){var n=this.listeners_[e],r=n.indexOf(t);r>=0&&(n.length==1?delete this.listeners_[e]:n.splice(r,1))}},t.prototype.dispatchEvent=function(e){if(!this.listeners_)return!0;var t=e.header.cmd;if(t in this.listeners_){var n=this.listeners_[t].concat();for(var r=0,i;i=n[r];r++)i.call(this,e)}},t}),define("app/App",["jquery","google-analytics-bundle","app/controls/AlertDialog","app/controls/NotificationDialog","NaClAM"],function(e,t,n,r,i){function s(e,t){return new n(e,t)}function o(e,t){return t=typeof t!="undefined"?t:!1,new r(e,t)}function u(){if(window.location.protocol!="http:"){var e=analytics.getService("pixlr_touch_up");AnalyticsTracker=e.getTracker("UA-1830856-11"),e.getConfig().addCallback(function(e){e.setTrackingPermitted(!0)})}}function a(){if(navigator.userAgent.toLowerCase().indexOf("windows nt 6.2")!=-1||navigator.userAgent.toLowerCase().indexOf("windows nt 6.3")!=-1){var t=parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10);console.log("CHROME VERSION: "+t),t<31&&(NACL_IS_SUPPORTED=!1)}NACL_IS_SUPPORTED&&(e("body").append('<embed name="nacl_module" id="NaClAM" width=1 height=1 src="PixlrTouchUp.nmf" type="application/x-nacl" />'),aM=new i("NaClAM"),f())}function f(){e("#NaClAM").on("crash",function(){console.log("NaCl crashed."),NACL_CRASHED=!0,new n('There was a problem with the brush engine. Click "OK" to return to your image or "Restart" to restart the application.',!0),Controls.getPanel().type=="touchup"&&Controls.getPanel().accept(),AnalyticsTracker.sendEvent("quality_native_client_crash"),NaClTouchUp.doneProcessing()})}function l(){e(document).on("dragstart","img",function(){return!1})}return{setupGoogleAnalytics:u,doMiscSetup:l,alert:s,notify:o,setupNativeClient:a}}),requirejs.config({baseUrl:"js/lib",paths:{app:"../app",ui:"../../ui",shaders:"../shaders",jquery:"jquery-2.0.2",moment:"moment.min",effects:"../../effects"}});var MAX_IMAGE_DIMENSION=4096,MAX_HISTORY_SIZE_MB=500,MAX_HISTORY_STEPS=10,SUPPORTED_FILE_TYPES=["image/jpeg","image/png","image/gif","image/bmp","image/vnd.adobe.photoshop","image/x-photoshop"],NACL_CRASHED=!1,GOOGLE_PICKER_API_KEY="AIzaSyCb8QjLQTwi_EsmMJ7NsuLE1SJmivEMK9A",GOOGLE_PICKER_HOSTED_URL="https://pixlr.com/touchup_gdrive.html",GOOGLE_DRIVE_FILES_URL="https://www.googleapis.com/drive/v2/files/",NACL_IS_SUPPORTED=!0,TEXT_PANEL_COLOR="#ffffff",gl,aM=null,WebGL,WebGLShaders,WebGLEffects,Canvas,PaintCanvas,MainMenu,NaClTouchUp,TopMenu,OpenView,TitleBar,History=null,App,AnalyticsTracker={sendAppView:function(){},sendEvent:function(){}};requirejs(["jquery","app/Canvas","app/WebGL","app/WebGLShaders","app/WebGLEffects","app/PaintCanvas","app/MainMenu","app/TopMenu","app/NaClTouchUp","app/OpenView","app/TitleBar","app/App"],function(e,t,n,r,i,s,o,u,a,f,l,c){Canvas=t,WebGL=n,WebGLShaders=r,WebGLEffects=i,PaintCanvas=s,MainMenu=o,TopMenu=u,NaClTouchUp=a,OpenView=f,TitleBar=l,App=c,App.setupGoogleAnalytics(),l.init(),s.init(),f.show(),t.init(),App.setupNativeClient(),App.doMiscSetup()}),define("../main",function(){});
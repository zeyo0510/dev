function resetGoogleDriveVideoItemsCache(){googleDriveVideoItemsMap=[]}googleDriveAccessToken=null;googleDriveInfo=null;googleDriveVideoItemsMap=[];authUrl=function(n){return googleDriveAccessToken?n+"&access_token="+googleDriveAccessToken:n};getGoogleDriveDownloadUrlFromID=function(n){if(n&&n!="")return"https://docs.google.com/uc?id="+n+"&export=download"};extractIdFromGoogleDriveUIUrl=function(n){var f="",r=".google.com/",u=n.toLowerCase().indexOf(r),e,i,t;if(u<0&&(r=".com/",u=n.toLowerCase().indexOf(r)),u>=0)for(e=n.substring(u+r.length),i=e.split(/\/|\?|&|=|\./g),t=0;t<Math.min(i.length,6);++t)if(i[t].length>=26&&i[t].length<=36){f=i[t];break}return f};requestGoogleDriveFileProperties=function(n,t,i){var r=new GDocs,u=function(){googleDriveAccessToken=r.accessToken;r.getItemProperties(n,function(n){try{var r=JSON.parse(n);t&&t(r)}catch(u){i&&i(u)}},i)};r.accessToken?u():r.auth(!0,u)};aboutGoogleDrive=function(n,t){var i=new GDocs,r=function(){googleDriveAccessToken=i.accessToken;i.about(function(i){try{var r=JSON.parse(i);r.error?t&&t(r.error):(googleDriveInfo=r,n&&n(r))}catch(u){t&&t()}},t)};i.accessToken?r():i.auth(!0,r)};getMediaFileSrc=function(n,t){requestGoogleDriveFileProperties(n,function(i){if(i.downloadUrl)t&&t(authUrl(i.downloadUrl));else{var r=getGoogleDriveDownloadUrlFromID(n);t&&t(authUrl(r))}},function(){var i=getGoogleDriveDownloadUrlFromID(n);t&&t(authUrl(i))})};queryGoogleDriveFiles=function(n,t,i){var u=new GDocs,r=[],e=100,f=function(o){googleDriveAccessToken=u.accessToken;u.queryItems(n,o,function(n){try{var u=JSON.parse(n);u.items&&u.items.length>0?(r=r.concat(u.items),u.nextPageToken&&r.length<1e3?f(u.nextPageToken):t&&t(r)):t&&t(r)}catch(e){i&&i()}},i,e)};u.accessToken?f():u.auth(!0,f)};getGoogleDriveVideoItems=function(n,t){var r=googleDriveVideoItemsMap[n],i;if(r){t(r);return}i="(mimeType = 'video/3gp' or mimeType = 'video/3gpp' or mimeType = 'video/avi' or mimeType = 'video/flv' or mimeType = 'video/m4v' or mimeType = 'video/mkv' or mimeType = 'video/mov' or mimeType = 'video/mp4' or mimeType = 'video/mpeg' or mimeType = 'video/mpeg4' or mimeType = 'video/ogg' or mimeType = 'video/ogv' or mimeType = 'video/webm' or mimeType = 'video/wmv') and trashed=false";n&&(i+=" and '"+n+"' in parents");queryGoogleDriveFiles(i,function(i){googleDriveVideoItemsMap[n]=i;t&&t(i)})}
function openCastWindow(n){var t=null;onInstallCast=function(){window.open("https://chrome.google.com/webstore/detail/google-cast/boadgeojelhgndaghljhdicfkmllpafd");sendEventStatistic("Chromecast","Install extension")};onNoChromecast=function(){t&&window.wizardDialog.closeDialog(t);n&&n();sendEventStatistic("Chromecast","Don't have")};onLaunched=function(){var n,i;t&&window.wizardDialog.closeDialog(t);n=document.getElementById("extension-help");n.style.visibility="visible";n.style.top="7px";i=document.getElementById("caption-wrapper");i&&(i.style.visibility="hidden");setTimeout(function(){n.style.top="-80px";setTimeout(function(){n.style.visibility="hidden";i&&(i.style.visibility="visible")},4e3)},5e3)};onError=function(){console.log("cast api init failure")};onRestartClick=function(){saveLastState(function(){chrome.runtime.sendMessage({message:"switch_tab"},function(n){n.farewell=="close"&&window.close()})})};launchCastWindow(onLaunched,onError)}function launchCastWindow(n,t){function e(){try{var n=new chrome.cast.SessionRequest(chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID),i=new chrome.cast.ApiConfig(n,s,h,chrome.cast.AutoJoinPolicy.PAGE_SCOPED,chrome.cast.DefaultActionPolicy.CAST_THIS_TAB);chrome.cast.initialize(i,o,t)}catch(r){t()}}function o(){console.log("init success")}function s(n){r=n;f()}function h(n){n==="available"?console.log("receiver found"):console.log("receiver list empty");i();i();i()}function i(){console.log("launching app...");chrome.cast.requestSession(c,l)}function c(n){console.log("session success: "+n.sessionId);r=n;f()}function l(){!u&&n&&n();u=!0}function f(){console.log("stopping");r.stop(a,onError)}function a(){console.log("app stopped")}var r=null,u=!1;chrome.cast&&chrome.cast.isAvailable?(i(),i(),i()):setTimeout(e,1e3)}activateChromecastBeta=function(){showActivateChromecastBetaDialog()};showActivateChromecastBetaDialog=function(){var n,r,u,i,t;modalElement=document.createElement("div");modalElement.id="activate-chromecast";modalElement.className="bbm-modal bbm-modal--beta";onActivate=function(){var i,t,n;modalElement&&(i=document.createElement("div"),i.className="spinner-center spinner",modalElement.appendChild(i));t=new Date;n=new Date;n.setMonth(t.getMonth()+3);chrome.storage.sync.set({betaProgramActivationDate:t.getTime(),betaProgramExpirationDate:n.getTime()},function(){console.log("betaProgramActivationDate ",t," betaProgramExpirationDate ",n);betaActivated=!0;chromecastMode=!0;a=1;window.gCastMode="desktop";updateCastButton();saveLastState(function(){var t=document.getElementById("notice-chromecast-callout"),i,r,u;t&&(t.style.display="block",setTimeout(function(){t.style.opacity=0},1e4));gAnalyticsConfig&&(i=gAnalyticsConfig.isTrackingPermitted(),i||gAnalyticsConfig.setTrackingPermitted(!0),r=n.getFullYear().toString(),u=(n.getMonth()+1).toString(),sendEventStatistic("Cast Beta","Activated until",r+"-"+u),i||gAnalyticsConfig.setTrackingPermitted(!1));setTimeout(function(){t&&(t.style.opacity=1);modalElement&&window.wizardDialog.closeDialog(modalElement)},1e3)})})};onCancel=function(){modalElement&&window.wizardDialog.closeDialog(modalElement);sendEventStatistic("Cast Beta","Declined")};window.wizardDialog.openDialog(modalElement,.7)&&(n=document.createElement("div"),n.className="bbm-views bbm-views-cast",modalElement.appendChild(n),r=document.createElement("div"),r.className="cast-image cast-image-beta1",n.appendChild(r),r=document.createElement("div"),r.className="cast-image cast-image-beta2",n.appendChild(r),t=document.createElement("h"),t.textContent=chrome.i18n.getMessage("activateChromecastBeta"),n.appendChild(t),t=document.createElement("h2"),t.textContent=chrome.i18n.getMessage("activateChromecastBetaDescription"),n.appendChild(t),i=document.createElement("div"),i.className="install-cast-wrapper",n.appendChild(i),u=document.createElement("button"),u.textContent="OK",u.onclick=onActivate,i.appendChild(u),i=document.createElement("div"),i.className="buttons-wrapper-cast",n.appendChild(i),t=document.createElement("div"),t.className="help-description",t.textContent=chrome.i18n.getMessage("activateChromecastBetaSupport"),n.appendChild(t),u.focus())}
var GravitDesigner=function(e){function t(a){if(o[a])return o[a].exports;var r=o[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1290)}({1290:function(e,t){PSColor=function(e){this.core=e,this.core.color=this,this.imageColorCache={},this.imageColorCacheHit=0,this.imageColorCacheFail=0},PSColor.BitsReader=function(e,t){if(t.isPSObject(e,"file"))for(this._dataSource=[];!e.isEOF();)this._dataSource.push(e.getUint8());else this._dataSource=e;this._dataIdx=0,this._dataBitsIdx=0},PSColor.BitsReader.prototype._dataSource=null,PSColor.BitsReader.prototype._dataIdx=0,PSColor.BitsReader.prototype._dataBitsIdx=0,PSColor.BitsReader.prototype.rewindData=function(){this._dataIdx=0,this._dataBitsIdx=0},PSColor.BitsReader.prototype.isEOF=function(){return this._dataIdx>=this._dataSource.length},PSColor.BitsReader.prototype.readData=function(e){var t=Math.ceil((e+this._dataBitsIdx)/8);if(this._dataIdx+t<=this._dataSource.length){var o=this._dataSource[this._dataIdx]&255>>this._dataBitsIdx;if(t>1)for(var a=1;a<t;++a)o<<=8,o>>>=0,o+=this._dataSource[this._dataIdx+a];var r=8*t-e-this._dataBitsIdx;return r>0?(o>>=r,this._dataIdx+=t-1,this._dataBitsIdx=8-r):(this._dataIdx+=t,this._dataBitsIdx=0),o}return this._dataIdx=this._dataSource.length,this._dataBitsIdx=0,null},PSColor.prototype.imageColorDecode=function(e,t,o){if(void 0===o)var o=8;if(!t)for(var t=[],a=0;a<e.length;a++)t[2*a]=0,t[2*a+1]=1;for(var r=[],n=Math.round(Math.pow(2,o)-1),a=0;a<e.length;a++)r[a]=t[2*a]+e[a]*(t[2*a+1]-t[2*a])/n;return r},PSColor.prototype.imageColorProcess=function(e,t,o,a,r,n){var i=null;if("CIEBasedABC"==a[0].value){var l=this.pixelHash(e);if(l in this.imageColorCache)return this.imageColorCacheHit++,3!=this.imageColorCache[l].length&&console.log("alyarma"),this.imageColorCache[l].slice();this.imageColorCacheFail++;e[0],e[1],e[2];"[object Array]"===Object.prototype.toString.call(n)&&6==n.length||(n=[0,1,0,1,0,1]),e=this.imageColorDecode(e,n,t),i=this.CIEBasedABCToRGB(e[0],e[1],e[2],a[1].value),this.imageColorCache[l]=i,i=[this.round_clamp_byte(255*i[0]),this.round_clamp_byte(255*i[1]),this.round_clamp_byte(255*i[2])]}else if("DeviceGray"==a[0].value){e=this.imageColorDecode(e,n,t);var u=this.round_clamp_byte(255*e);i=[u,u,u]}else if("DeviceCMYK"==a[0].value)i=this.imageColorDecode(e,n,t),i=[this.round_clamp_byte(255*i[0]),this.round_clamp_byte(255*i[1]),this.round_clamp_byte(255*i[2]),this.round_clamp_byte(255*i[3])];else if("DeviceRGB"==a[0].value)i=this.imageColorDecode(e,n,t),i=[this.round_clamp_byte(255*i[0]),this.round_clamp_byte(255*i[1]),this.round_clamp_byte(255*i[2])];else if("Separation"==a[0].value||"DeviceN"==a[0].value){var s=this.imageColorDecode(e,n,t),c=this._getGColor(a,s);i=c.value}return i.slice()},PSColor.prototype.round_clamp_byte=function(e){return Math.min(255,Math.max(0,Math.round(e)))},PSColor.prototype.pixelHash=function(e){for(var t=0,o=0;o<e.length;o++)t=t<<8|e[o];return t},PSColor.prototype.PSColorSpaceChannels={DeviceGray:1,CIEBasedA:1,Separation:1,Pattern:1,DeviceRGB:3,CIEBasedABC:3,CIEBasedDEF:3,CIEBasedDEFG:4,DeviceCMYK:4,DeviceN:function(e){return e[1].value.length}},PSColor.prototype.getColorChannelsCount=function(e){var t=this.PSColorSpaceChannels[e[0].value];return"function"==typeof t?t(e):t},PSColor.prototype.CIEBasedABCToRGB=function(e,t,o,a){var r="object"==typeof a&&"RangeABC"in a?a.RangeABC.value:[0,1,0,1,0,1],n="object"==typeof a&&"RangeLMN"in a?a.RangeLMN.value:[0,1,0,1,0,1];"object"==typeof a&&"DecodeABC"in a&&(this.core.stack.push(e),a.DecodeABC.value[0].execute(this.core),e=this.core.stack.pop(),this.core.stack.push(t),a.DecodeABC.value[1].execute(this.core),t=this.core.stack.pop(),this.core.stack.push(o),a.DecodeABC.value[2].execute(this.core),o=this.core.stack.pop());var i=this.PSFunctionDomain([e,t,o],r);if(e=i[0],t=i[1],o=i[2],"object"==typeof a&&"MatrixABC"in a)var l=a.MatrixABC.value,u=e*l[0]+t*l[3]+o*l[6],s=e*l[1]+t*l[4]+o*l[7],c=e*l[2]+t*l[5]+o*l[8];else var u=e,s=t,c=o;"object"==typeof a&&"DecodeLMN"in a&&(this.core.stack.push(u),a.DecodeLMN.value[0].execute(this.core),u=this.core.stack.pop(),this.core.stack.push(s),a.DecodeLMN.value[1].execute(this.core),s=this.core.stack.pop(),this.core.stack.push(c),a.DecodeLMN.value[2].execute(this.core),c=this.core.stack.pop());var i=this.PSFunctionDomain([u,s,c],n);if(u=i[0],s=i[1],c=i[2],"object"==typeof a&&"MatrixLMN"in a)var h=a.MatrixLMN.value,p=u*h[0]+s*h[3]+c*h[6],v=u*h[1]+s*h[4]+c*h[7],f=u*h[2]+s*h[5]+c*h[8];else var p=u,v=s,f=c;return this.XYZToRGB(p,v,f)},PSColor.prototype.XYZToRGBMatrix=[3.241,-.9692,.0556,-1.5374,1.876,-.204,-.4986,.0416,1.057],PSColor.prototype.XYZToRGB=function(e,t,o){var a,r,n;return m=this.XYZToRGBMatrix,a=e*m[0]+t*m[3]+o*m[6],r=e*m[1]+t*m[4]+o*m[7],n=e*m[2]+t*m[5]+o*m[8],[a,r,n]},PSColor.prototype.PSFunctionDomain=function(e,t){var o=e.slice();if(t&&o.length==2*t.length)for(var a=0;a<o.length;a++)o[a]>t[2*a+1]&&(o[a]=t[2*a+1]),o[a]<t[2*a]&&(o[a]=t[2*a]);return o},PSColor.prototype.PSFunctionInterpolate=function(e,t,o,a,r){return Math.abs(o-t)<=1e-10?a:(e-t)*(r-a)/(o-t)+a},PSColor.prototype.PSFunction=function(e,t){if(!("FunctionType"in e.value))return gDevelopment&&(console.log("no FunctionType in dict"),console.log(e)),null;var o=e.value.Domain.value;switch(e.value.FunctionType){case 0:gDevelopment;var a=e.value.Range.value,r=a.length/2,n=e.value.DataSource.value,i="Order"in e.value?e.value.Order:1,l=e.value.BitsPerSample,u=e.value.Size.value,s=[],c=u[0];if(u.length>1)for(var h=1;h<u.length;++h)c*=u[h];c*=r;var p=c*l;if("string"==typeof n&&p>8*n.length)return null;for(var h=0;h<c;++h){var v=h*l,f=Math.floor(v/8),d=v%8,y=Math.ceil((l+d)/8),m=n[f].charCodeAt(0)&255>>d;if(y>1)for(var C=1;C<y;++C)m<<=8,m+=n[f+C].charCodeAt(0);if(l+d<8*y){m>>=8*y-l-d}s.push(m)}var g="Encode"in e.value?e.value.Encode.value:null,_="Decode"in e.value?e.value.Decode.value:null;return t?null:{type:"samples",domain:o,range:a,order:i,encode:g,decode:_,size:u,samples:s,bitsPerSample:l};case 2:var a=!1;"Range"in e.value&&(a=e.value.Range.value);var M=!1;"C0"in e.value&&(M=e.value.C0.value);var S=!1;"C1"in e.value&&(S=e.value.C1.value);var x=!1;if("N"in e.value&&(x=e.value.N),t){if(!M){M=[];for(var h=0;h<t.length;h++)M[h]=0}if(!S){S=[];for(var h=0;h<t.length;h++)S[h]=1}t=this.PSFunctionDomain(t,o);for(var b=[],h=0;h<t.length;++h)b[h]=M[h]+Math.pow(t,x)*(S[h]-M[h]);return{type:"exp",domain:o,range:a,result:a?this.PSFunctionDomain(b,a):b}}return{type:"exp",C0:M,C1:S,domain:o,range:a};case 3:for(var P=e.value.Functions.value,D=P.length,B=[],h=0;h<D;++h)B.push(this.PSFunction(P[h]));var T=e.value.Bounds.value,g=e.value.Encode.value;return{type:"stitch",domain:o,bounds:T,encode:g,stitches:B}}return null},PSColor.prototype._valueDecodeDomain=function(e,t,o,a){return a<=0?e:Math.abs(a-e)<=1e-6?o:Math.abs(e,0)<=1e-6?t:t+e*(o-t)/a},PSColor.prototype._getTenzorPoint=function(e,t,o){var a=1-e[0],r=a*a,n=1-e[1],i=n*n,l=e[0]*e[0],u=e[1]*e[1],s=r*a,c=3*e[0]*r,h=3*l*a,p=l*e[0],v=i*n,f=3*e[1]*i,d=3*u*n,y=u*e[1];o[0]=t[0]*s*v+t[2]*c*v+t[4]*h*v+t[6]*p*v+t[8]*p*f+t[10]*p*d+t[12]*p*y+t[14]*h*y+t[16]*c*y+t[18]*s*y+t[20]*s*d+t[22]*s*f+t[24]*c*f+t[26]*h*f+t[28]*h*d+t[30]*c*d,o[1]=t[1]*s*v+t[3]*c*v+t[5]*h*v+t[7]*p*v+t[9]*p*f+t[11]*p*d+t[13]*p*y+t[15]*h*y+t[17]*c*y+t[19]*s*y+t[21]*s*d+t[23]*s*f+t[25]*c*f+t[27]*h*f+t[29]*h*d+t[31]*c*d},PSColor.prototype._getCoonsPoint=function(e,t,o){var a=1-e[0],r=a*a,n=1-e[1],i=n*n,l=e[0]*e[0],u=e[1]*e[1],s=l*e[0],c=r*a,h=u*e[1],p=i*n,v=c*t[0]+3*r*e[0]*t[22]+3*a*l*t[20]+s*t[18],f=c*t[6]+3*r*e[0]*t[8]+3*a*l*t[10]+s*t[12],d=p*t[0]+3*i*e[1]*t[2]+3*n*u*t[4]+h*t[6],y=p*t[18]+3*i*e[1]*t[16]+3*n*u*t[14]+h*t[12],m=n*v+e[1]*f,C=a*d+e[0]*y,g=n*(a*t[0]+e[0]*t[18])+e[1]*(a*t[6]+e[0]*t[12]);o[0]=m+C-g;var _=c*t[1]+3*r*e[0]*t[23]+3*a*l*t[21]+s*t[19],M=c*t[7]+3*r*e[0]*t[9]+3*a*l*t[11]+s*t[13],S=p*t[1]+3*i*e[1]*t[3]+3*n*u*t[5]+h*t[7],x=p*t[19]+3*i*e[1]*t[17]+3*n*u*t[15]+h*t[13],b=n*_+e[1]*M,P=a*S+e[0]*x,D=n*(a*t[1]+e[0]*t[19])+e[1]*(a*t[7]+e[0]*t[13]);o[1]=b+P-D},PSColor.prototype._interpolateColorBilinearCoons=function(e,t){for(var o=[],a=0;a<t[0].length;++a){var r=t[0][a],n=t[3][a]-t[0][a],i=t[1][a]-t[0][a],l=t[0][a]-t[1][a]-t[3][a]+t[2][a];o.push(Math.max(Math.min(r+n*e[0]+i*e[1]+l*e[0]*e[1],1),0))}return o},PSColor.prototype._interpolateColorBilinearTenzor=function(e,t){for(var o=[],a=0;a<t[0].length;++a){var r=t[0][a],n=t[1][a]-t[0][a],i=t[3][a]-t[0][a],l=t[0][a]-t[1][a]-t[3][a]+t[2][a];o.push(Math.max(Math.min(r+n*e[0]+i*e[1]+l*e[0]*e[1],1),0))}return o},PSColor.prototype._interpolateColorLinear=function(e,t){for(var o=[],a=0;a<t[0].length;++a){var r=t[0][a],n=t[1][a]-t[0][a];o.push(Math.max(Math.min(r+n*e,1),0))}return o},PSColor.prototype._getTriangularPoint=function(e,t,o,a){var r=[];if(r=t[1]>t[3]||t[1]==t[3]&&t[0]>t[2]?[{x:t[2],y:t[3],col:a[1]},{x:t[0],y:t[1],col:a[0]}]:[{x:t[0],y:t[1],col:a[0]},{x:t[2],y:t[3],col:a[1]}],t[5]<r[0].y||t[5]==r[0].y&&t[4]<=r[0].x?r=[{x:t[4],y:t[5],col:a[2]}].concat(r):t[5]<r[1].y||t[5]==r[1].y&&t[4]<=r[1].x?r=[r[0],{x:t[4],y:t[5],col:a[2]},r[1]]:r.push({x:t[4],y:t[5],col:a[2]}),e[1]<=1e-10&&r[0].y<r[1].y)return o[0]=r[0].x,o[1]=r[0].y,r[0].col;if(Math.abs(1-e[1])<=1e-10&&r[2].y>r[1].y)return o[0]=r[2].x,o[1]=r[2].y,r[2].col;var n=r[0].y+e[1]*(r[2].y-r[0].y);o[1]=n;var i=r[0].x+e[1]*(r[2].x-r[0].x),l=this._interpolateColorLinear(e[1],[r[0].col,r[2].col]),u=null;if(n<=r[1].y)if(Math.abs(r[1].y-r[0].y)>1e-10){var s=(n-r[0].y)/(r[1].y-r[0].y),c=r[0].x+s*(r[1].x-r[0].x),h=this._interpolateColorLinear(s,[r[0].col,r[1].col]);i<=c?(o[0]=i+e[0]*(c-i),u=this._interpolateColorLinear(e[0],[l,h])):u=this._interpolateColorLinear(e[0],[h,l])}else o[0]=r[0].x<r[1].x?r[0].x+e[0]*(r[1].x-r[0].x):r[1].x+e[0]*(r[0].x-r[1].x),u=this._interpolateColorLinear(e[0],r[0].x<r[1].x?[r[0].col,r[1].col]:[r[1].col,r[0].col]);else if(Math.abs(r[2].y-r[1].y)>1e-10){var s=(n-r[1].y)/(r[2].y-r[1].y),c=r[1].x+s*(r[2].x-r[1].x),h=this._interpolateColorLinear(s,[r[1].col,r[2].col]);i<=c?(o[0]=i+e[0]*(c-i),u=this._interpolateColorLinear(e[0],[l,h])):u=this._interpolateColorLinear(e[0],[h,l])}else o[0]=r[1].x<r[2].x?r[1].x+e[0]*(r[2].x-r[1].x):r[2].x+e[0]*(r[1].x-r[2].x),u=this._interpolateColorLinear(e[0],r[1].x<r[2].x?[r[1].col,r[2].col]:[r[2].col,r[1].col]);return u},PSColor.prototype._apprColor=function(e,t,o,a,r,n){var i=o-t;if(i<=1)return n[a][r];var l,u;return e?(l=(r-t)/i,u=[n[a][t],n[a][o]]):(l=(a-t)/i,u=[n[t][r],n[o][r]]),this._interpolateColorLinear(l,u)},PSColor.prototype._getApproximatedColor=function(e,t,o,a){for(var r=null,n=null,i=null,l=null,u=o[e][t],s=e-1;s>=0;--s)if(a[s][t]){r=s;break}for(var s=e+1;s<a.length;++s)if(a[s][t]){n=s;break}for(var c=t-1;c>=0;--c)if(a[e][c]){i=c;break}for(var c=t+1;c<a[e].length;++c)if(a[e][c]){l=c;break}var h=null,p=null;return null==r||null==n?null==i||null==l?(null!=r?h=e-r:null!=n&&(h=n-e),null!=i?p=t-i:null!=l&&(p=l-t),null!=p&&null!=h?u=p<=h?null!=i?o[e][i]:o[e][l]:null!=r?o[r][t]:o[n][t]:null!=p?u=null!=i?o[e][i]:o[e][l]:null!=h&&(u=null!=r?o[r][t]:o[n][t])):(p=l-i,u=this._apprColor(!0,i,l,e,t,o)):(h=n-r,null!=i&&null!=l?(p=l-i,u=p<=h?this._apprColor(!0,i,l,e,t,o):this._apprColor(!1,r,n,e,t,o)):u=this._apprColor(!1,r,n,e,t,o)),u},PSColor.prototype._getSeparationColorVal=function(e,t,o){this.core.stack=this.core.stack.concat(o),this.core.execstack.push(t),t.execute(this.core),this.core.execstack.pop();var a=this.getColorChannelsCount(e),r=this.core.stack.slice(this.core.stack.length-a);return this.core.stack=this.core.stack.splice(0,this.core.stack.length-a),r},PSColor.prototype._getGColor=function(e,t){var o=this;if("DeviceGray"==e[0].value)return{type:"rgb",value:[this.round_clamp_byte(255*t[0]),this.round_clamp_byte(255*t[0]),this.round_clamp_byte(255*t[0])]};if("DeviceCMYK"==e[0].value)return{type:"cmyk",value:[this.round_clamp_byte(255*t[0]),this.round_clamp_byte(255*t[1]),this.round_clamp_byte(255*t[2]),this.round_clamp_byte(255*t[3])]};if("DeviceRGB"==e[0].value)return{type:"rgb",value:[this.round_clamp_byte(255*t[0]),this.round_clamp_byte(255*t[1]),this.round_clamp_byte(255*t[2])]};if("Pattern"==e[0].value){var a=!0;if("PatternType"in t.value&&2==t.value.PatternType&&"Shading"in t.value?a=t.value.Shading:"ShadingType"in t.value&&(a=t),a){var r=!1,n=a.value.ShadingType,i=!1,l=!1,u="string"==typeof a.value.ColorSpace.value?a.value.ColorSpace.value:a.value.ColorSpace.value[0].value;if("Function"in a.value){var s=a.value.Function;if(this.core.classes.isPSObject(s,"array")){if(i=this.PSFunction(s.value[0])){l=[i];for(var c=1;c<s.value.length;++c)l.push(this.PSFunction(s.value[c]))}if(!l||!("DeviceRGB"==u&&3==l.length||"DeviceCMYK"==u&&4==l.length||"DeviceGray"==u&&1==l.length))return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]};r=!0}else i=this.PSFunction(s)}var h=function(e){var t=null;if(3==e.length&&"DeviceRGB"==u)t={type:"rgb",value:[this.round_clamp_byte(255*e[0]),this.round_clamp_byte(255*e[1]),this.round_clamp_byte(255*e[2])]};else if(4==e.length&&"DeviceCMYK"==u)t={type:"cmyk",value:[this.round_clamp_byte(255*e[0]),this.round_clamp_byte(255*e[1]),this.round_clamp_byte(255*e[2]),this.round_clamp_byte(255*e[3])]};else if(1==e.length&&"DeviceGray"==u)t={type:"rgb",value:[this.round_clamp_byte(255*e[0]),this.round_clamp_byte(255*e[0]),this.round_clamp_byte(255*e[0])]};else if(("DeviceN"==u||"Separation"==u)&&4==a.value.ColorSpace.value.length){var o=a.value.ColorSpace.value,r="string"==typeof o[2].value?[o[2]]:o[2].value,n=o[3],i=this._getSeparationColorVal(r,n,e);return this._getGColor(r,i)}return t}.bind(this),p=function(e,t,o,a,r,n){for(var i=!1,l=0;l<t;++l){if(null===(Re=o.readData(a))){i=!0;break}var u=this._valueDecodeDomain(Re,r[Z+2*l],r[Z+2*l+1],n);e.push(u)}return i}.bind(this),v=function(e,t,a,n,i,l){var s=e.encode?e.encode:null,c=[];if("exp"==t.type){var p=null;if(null!=t.C0)p=r?t.C0:h(t.C0);else{var v=null!=t.C1?t.C1[0]:1,f=s?s[2*i]:0,d=f*v,y=o.PSFunctionDomain([d],t.range);p=r?y:h(y)}var m=Math.abs(e.domain[1]-e.domain[0])<=1e-10?i/l:(a-e.domain[0])/(e.domain[1]-e.domain[0]);if(c.push({opacity:1,color:p,position:m}),i==l-1){if(p=null,null!=t.C1)p=r?t.C1:h(t.C1);else{var C=null!=t.C0?t.C0[0]:0,f=s?s[2*i+1]:1,g=C+f*(1-C),y=o.PSFunctionDomain([g],t.range);p=r?y:h(y)}c.push({opacity:1,color:p,position:1})}}else if("samples"==t.type&&1==t.size.length){var _=t.range.length/2;if(r||"DeviceRGB"==u&&3==_||"DeviceCMYK"==u&&4==_||"DeviceGray"==u&&1==_){var M=t.samples,S=Math.floor(M.length/_),x=t.decode?t.decode:t.range,b=t.encode?t.encode:[0,S-1];if(x.length==2*_)if(S>1){var P=[],D=Math.abs(e.domain[1]-e.domain[0])<=1e-10?i/l:(a-e.domain[0])/(e.domain[1]-e.domain[0]),B=Math.abs(e.domain[1]-e.domain[0])<=1e-10?(i+1)/l:(n-e.domain[0])/(e.domain[1]-e.domain[0]),T=Math.min(D,B),F=Math.max(D,B);if(s)var k=Math.min(s[2*i],s[2*i+1]),G=Math.max(s[2*i],s[2*i+1]);for(var I=0;I<S-1;++I){s?(m=o.PSFunctionInterpolate(I,b[0],b[1],k,G),m=o.PSFunctionInterpolate(m,s[2*i],s[2*i+1],T,F)):m=o.PSFunctionInterpolate(I,b[0],b[1],T,F);for(var y=[],R=I*_,A=0;A<_;++A){var w=M[R+A];w=o.PSFunctionInterpolate(w,0,Math.pow(2,t.bitsPerSample)-1,x[2*A],x[2*A+1]),y.push(w)}y=o.PSFunctionDomain(y,t.range),p=r?y:h(y),P.push({color:p,position:m})}if(i==l-1){for(var R=(S-1)*_,y=[],A=0;A<_;++A){var w=M[R+A];w=o.PSFunctionInterpolate(w,0,Math.pow(2,t.bitsPerSample)-1,x[2*A],x[2*A+1]),y.push(w)}y=o.PSFunctionDomain(y,t.range),p=r?y:h(y),s?(m=o.PSFunctionInterpolate(S,b[0],b[1],k,G),m=o.PSFunctionInterpolate(m,s[2*i],s[2*i+1],T,F)):m=o.PSFunctionInterpolate(S,b[0],b[1],T,F),P.push({color:p,position:m})}if(r)c=P;else{P.length>2&&(P=o._optimizeStops(P));for(var A=0;A<P.length;++A)c.push({opacity:1,color:P[A].color,position:P[A].position})}}else if(1==S){for(var m=i==l-1?1:Math.abs(e.domain[1]-e.domain[0])<=1e-10?i/l:(a-e.domain[0])/(e.domain[1]-e.domain[0]),y=[],A=0;A<_;++A){var w=M[A];w=o.PSFunctionInterpolate(w,0,Math.pow(2,t.bitsPerSample)-1,x[2*A],x[2*A+1]),y.push(w)}y=o.PSFunctionDomain(y,t.range),p=r?y:h(y),c.push({opacity:1,color:p,position:m})}}}return c};if(2==n||3==n){var f=a.value.Coords,d={type:"rgb",value:[255,255,255]},y={type:"rgb",value:[0,0,0]},m=[{opacity:1,color:d,position:0},{opacity:1,color:y,position:1}];if(!i)return{type:2==n?"linear":"radial",value:f.value,stops:m,transform:t.value.gstate.CTM};if(i.C0&&i.C1)d=h(i.C0),y=h(i.C1),m=[{opacity:1,color:d,position:0},{opacity:1,color:y,position:1}];else if("samples"==i.type&&1==i.size.length||"exp"==i.type){var C=[];if(l){for(var g=[],_=0,M=!1,S=0;S<l.length&&!M;++S){var x=l[S],b=v(x,x,x.domain[0],x.domain[1],0,1);!_&&b&&b.length?_=b.length:b.length&&_==b.length||(M=!0),g.push(b)}if(M)return{type:2==n?"linear":"radial",value:f.value,stops:m,transform:t.value.gstate.CTM};for(var S=0;S<_;++S){for(var P=[],c=0;c<g.length;++c)P.push(g[c][S].color);var D=g[0][S].position,B=h(P);C.push({opacity:1,color:B,position:D})}C.length>2&&(C=this._optimizeStops(C))}else C=v(i,i,i.domain[0],i.domain[1],0,1);C.length&&(m=C)}else if("stitch"==i.type&&i.stitches.length==(i.bounds?i.bounds.length+1:1)&&2*i.stitches.length==i.encode.length){for(var T,C=[],F=i.domain[0],k=0;k<i.stitches.length;++k){T=F,F=i.bounds&&k<i.bounds.length?i.bounds[k]:i.domain[1];var G=v(i,i.stitches[k],T,F,k,i.stitches.length);if(G&&G.length)for(var S=0;S<G.length;++S)C.push(G[S])}C.length&&(m=C)}return{type:2==n?"linear":"radial",value:f.value,stops:m,transform:t.value.gstate.CTM}}if(4==n||5==n){gDevelopment&&console.log("shadingType = "+n);var I;"DeviceRGB"==u?I=3:"DeviceCMYK"==u?I=4:"DeviceGray"==u&&(I=1);for(var R,A,w=new PSColor.BitsReader(a.value.DataSource,this.core.classes),L=-1,E=null,N=null,Y=null,j=null,O=t.value.BitsPerComponent,z=Math.pow(2,O)-1,K=t.value.BitsPerCoordinate,H=t.value.BitsPerFlag,V=t.value.Decode.value.slice(),X=Math.pow(2,K)-1,M=(t.value.Function,!1),Z=4,U=[],q=[],J=5==n?t.value.VerticesPerRow:null,Q=(function(){var e=w.readData(K);if(null===e)return!1;E.push(this._valueDecodeDomain(e,V[0],V[1],X));var o=w.readData(K);if(null===o)return!1;if(E.push(this._valueDecodeDomain(o,V[2],V[3],X)),"Function"in t.value);else{var a=[];if(M=p(a,I,w,O,V,z))return!1;Y.push(a)}return!0});!w.isEOF()&&!M;)if(4==n){if(null===(L=w.readData(H)))break;switch(L&=3){case 0:R=6,A=3;break;case 1:case 2:R=2,A=1;break;default:return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]}}if(!(0==L||E&&Y)){M=!0;break}if(N=0==L?null:E,E=[],j=0==L?null:Y,Y=[],M=!Q())break;if(A>1)for(var k=1;k<A&&!M;++k){if(null===(L=w.readData(H))){M=!0;break}L&=3,M=0!=L||!Q()}if(M)break;1==L?(E=N.slice(2,6).concat(E),Y=j.slice(1,3).concat(Y)):2==L&&(E=N.slice(4,6).concat(N.slice(0,2)).concat(E),Y=[j[2],j[0]].concat(Y)),U.push({coords:E,colors:Y}),q.push([Math.min(E[0],E[2],E[4]),Math.min(E[1],E[3],E[5]),Math.max(E[0],E[2],E[4]),Math.max(E[1],E[3],E[5])])}else{if(E)N=E,E=[],j=Y,Y=[];else{E=[],Y=[];for(var k=0;k<J&&!M;++k)M=!Q();if(M)break}N=E,E=[],j=Y,Y=[];for(var k=0;k<J&&!M;++k)M=!Q();if(M)break;for(var k=0;k<J-1;++k){var W=N.slice(2*k,2*(k+2)).concat(E.slice(2*k,2*(k+1))),$=j.slice(k,k+2).concat([Y[k]]);U.push({coords:W,colors:$}),q.push([Math.min(W[0],W[2],W[4]),Math.min(W[1],W[3],W[5]),Math.max(W[0],W[2],W[4]),Math.max(W[1],W[3],W[5])]),W=N.slice(2*(k+1),2*(k+2)).concat(E.slice(2*k,2*(k+2))),$=[j[k+1]].concat(Y.slice(k,k+2)),U.push({coords:W,colors:$}),q.push([Math.min(W[0],W[2],W[4]),Math.min(W[1],W[3],W[5]),Math.max(W[0],W[2],W[4]),Math.max(W[1],W[3],W[5])])}}var ee=[],te=[],oe=t.value.gstate.CTM?t.value.gstate.CTM:null,ae=null,re=null,ne=null,ie=null;if(oe){var le=[];le.push(PSCTM.prototype.transform(V[0],V[2],oe)),le.push(PSCTM.prototype.transform(V[1],V[2],oe)),le.push(PSCTM.prototype.transform(V[0],V[3],oe)),le.push(PSCTM.prototype.transform(V[1],V[3],oe)),ae=le[0].x,re=ae,ne=le[0].y,ie=ne;for(var S=1;S<le.length;++S){var ue=le[S].x,se=le[S].y;ue<ae&&(ae=ue),ue>re&&(re=ue),se<ne&&(ne=se),se>ie&&(ie=se)}}else V[0]<V[1]?(ae=V[0],re=V[1]):(ae=V[1],re=V[0]),V[3]>V[2]?(ne=V[2],ie=V[3]):(ne=V[3],ie=V[2]);var ce=Math.round(re-ae),he=Math.round(ie-ne);if(!ce||!he)return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]};for(var pe=[],c=0;c<I;++c)pe.push(1);for(var ve=0;ve<he;++ve){ee[ve]=[],te[ve]=[];for(var k=0;k<ce;++k)ee[ve][k]=pe.slice(),te[ve][k]=0}for(var c=0;c<q.length;++c){var fe=q[c],f=U[c].coords,Y=U[c].colors,de=fe[0],ye=fe[2],me=fe[1],Ce=fe[3];if(oe){var le=[];le.push(PSCTM.prototype.transform(fe[0],fe[1],oe)),le.push(PSCTM.prototype.transform(fe[0],fe[3],oe)),le.push(PSCTM.prototype.transform(fe[2],fe[1],oe)),le.push(PSCTM.prototype.transform(fe[2],fe[3],oe)),de=le[0].x,ye=de,me=le[0].y,Ce=me;for(var S=1;S<le.length;++S){var ue=le[S].x,se=le[S].y;ue<de&&(de=ue),ue>ye&&(ye=ue),se<me&&(me=se),se>Ce&&(Ce=se)}}var ge=Math.round(ye-de),_e=Math.round(Ce-me);if(ge&&_e)for(var Me,Se,xe,be,Pe=Math.max(ge,_e),De=1/Pe,Be=[0,0],D=[0,0],ve=0;ve<=Pe;++ve)for(var k=0;k<=Pe;++k){Be[0]=k*De,Be[1]=ve*De;var Te=this._getTriangularPoint(Be,f,D,Y);oe?(xe=(D[0]-V[0])/(V[1]-V[0])*ce-.5,be=(D[1]-V[2])/(V[3]-V[2])*he-.5):(be=D[1]-V[2]-.5,xe=D[0]-V[0]-.5),Me=Math.max(Math.min(Math.round(be),he-1),0),Se=Math.max(Math.min(Math.round(xe),ce-1),0),ee[Me][Se]=Te,te[Me][Se]=1}}for(var Fe,ke=[],ve=0;ve<he;++ve)for(var k=0;k<ce;++k){Fe=te[ve][k]?ee[ve][k]:this._getApproximatedColor(ve,k,ee,te),Ae=h(Fe);for(var c=0;c<I;++c)ke.push(Ae.value[c])}return{type:"imageData",value:ke,colorSpace:u,meshType:n,width:ce,height:he,transform:PSCTM.prototype.multiply([(V[1]-V[0])/ce,0,0,(V[3]-V[2])/he,V[0],V[2]],t.value.gstate.CTM)}}if(6==n||7==n){gDevelopment&&console.log("shadingType = "+n);var I;"DeviceRGB"==u?I=3:"DeviceCMYK"==u?I=4:"DeviceGray"==u&&(I=1);for(var R,w=new PSColor.BitsReader(a.value.DataSource,this.core.classes),L=-1,E=null,N=null,Y=null,j=null,O=t.value.BitsPerComponent,z=Math.pow(2,O)-1,K=t.value.BitsPerCoordinate,H=t.value.BitsPerFlag,V=t.value.Decode.value.slice(),X=Math.pow(2,K)-1,M=(t.value.Function,!1),Z=4,U=[],q=[];!w.isEOF()&&!M&&null!==(L=w.readData(H));){switch(L&=3){case 0:R=6==n?24:32;break;case 1:case 2:case 3:R=6==n?16:24;break;default:return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]}}if(!(0==L||E&&Y)){M=!0;break}N=0==L?null:E,E=[];for(var Ge,Ie,k=0;k<R;++k){var Re=w.readData(K);if(null===Re){M=!0;break}k%2==0?(Ge=V[0],Ie=V[1]):(Ge=V[2],Ie=V[3]),E.push(this._valueDecodeDomain(Re,Ge,Ie,X))}if(M)break;if(j=0==L?null:Y,Y=[],"Function"in t.value);else for(var A=0==L?4:2,k=0;k<A;++k){for(var Ae=[],ve=0;ve<I;++ve){if(null===(Re=w.readData(O))){M=!0;break}var we=this._valueDecodeDomain(Re,V[Z+2*ve],V[Z+2*ve+1],z);Ae.push(we)}Y.push(Ae)}if(M)break;1==L?(E=N.slice(6,14).concat(E),Y=j.slice(1,3).concat(Y)):2==L?(E=N.slice(12,20).concat(E),Y=j.slice(2,4).concat(Y)):3==L&&(E=N.slice(18,24).concat(N.slice(0,2)).concat(E),Y=[j[3],j[0]].concat(Y)),U.push({flag:L,coords:E,colors:Y}),q.push([Math.min(E[0],E[6],E[18],E[12]),Math.min(E[1],E[19],E[7],E[13]),Math.max(E[0],E[6],E[18],E[12]),Math.max(E[1],E[19],E[7],E[13])])}var ee=[],te=[],oe=t.value.gstate.CTM?t.value.gstate.CTM:null,ae=null,re=null,ne=null,ie=null;if(oe){var le=[];le.push(PSCTM.prototype.transform(V[0],V[2],oe)),le.push(PSCTM.prototype.transform(V[1],V[2],oe)),le.push(PSCTM.prototype.transform(V[0],V[3],oe)),le.push(PSCTM.prototype.transform(V[1],V[3],oe)),ae=le[0].x,re=ae,ne=le[0].y,ie=ne;for(var S=1;S<le.length;++S){var ue=le[S].x,se=le[S].y;ue<ae&&(ae=ue),ue>re&&(re=ue),se<ne&&(ne=se),se>ie&&(ie=se)}}else V[0]<V[1]?(ae=V[0],re=V[1]):(ae=V[1],re=V[0]),V[3]>V[2]?(ne=V[2],ie=V[3]):(ne=V[3],ie=V[2]);var ce=Math.round(re-ae),he=Math.round(ie-ne);if(!ce||!he)return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]};for(var pe=[],c=0;c<I;++c)pe.push(1);for(var ve=0;ve<he;++ve){ee[ve]=[],te[ve]=[];for(var k=0;k<ce;++k)ee[ve][k]=pe.slice(),te[ve][k]=0}for(var c=0;c<q.length;++c){var fe=q[c],f=U[c].coords,Y=U[c].colors,de=fe[0],ye=fe[2],me=fe[1],Ce=fe[3];if(oe){var le=[];le.push(PSCTM.prototype.transform(fe[0],fe[1],oe)),le.push(PSCTM.prototype.transform(fe[0],fe[3],oe)),le.push(PSCTM.prototype.transform(fe[2],fe[1],oe)),le.push(PSCTM.prototype.transform(fe[2],fe[3],oe)),de=le[0].x,ye=de,me=le[0].y,Ce=me;for(var S=1;S<le.length;++S){var ue=le[S].x,se=le[S].y;ue<de&&(de=ue),ue>ye&&(ye=ue),se<me&&(me=se),se>Ce&&(Ce=se)}}var ge=Math.round(ye-de),_e=Math.round(Ce-me);if(ge&&_e)for(var Me,Se,xe,be,Pe=Math.max(ge,_e),De=1/Pe,Be=[0,0],D=[0,0],ve=0;ve<=Pe;++ve)for(var k=0;k<=Pe;++k)Be[0]=k*De,Be[1]=ve*De,6==n?this._getCoonsPoint(Be,f,D):this._getTenzorPoint(Be,f,D),oe?(xe=(D[0]-V[0])/(V[1]-V[0])*ce-.5,be=(D[1]-V[2])/(V[3]-V[2])*he-.5):(be=D[1]-V[2]-.5,xe=D[0]-V[0]-.5),Me=Math.max(Math.min(Math.round(be),he-1),0),Se=Math.max(Math.min(Math.round(xe),ce-1),0),ee[Me][Se]=6==n?this._interpolateColorBilinearCoons(Be,Y):this._interpolateColorBilinearTenzor(Be,Y),te[Me][Se]=1}for(var Fe,ke=[],ve=0;ve<he;++ve)for(var k=0;k<ce;++k){Fe=te[ve][k]?ee[ve][k]:this._getApproximatedColor(ve,k,ee,te),Ae=h(Fe);for(var c=0;c<I;++c)ke.push(Ae.value[c])}return{type:"imageData",value:ke,colorSpace:u,meshType:n,width:ce,height:he,transform:PSCTM.prototype.multiply([(V[1]-V[0])/ce,0,0,(V[3]-V[2])/he,V[0],V[2]],t.value.gstate.CTM)}}return console.log("shadingType = "+n),this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]}}return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]}}if("CIEBasedABC"==e[0].value){var Le=this.CIEBasedABCToRGB(t[0],t[1],t[2],e[1].value);return gDevelopment&&console.log(Math.round(255*Le[0])+" "+Math.round(255*Le[1])+" "+Math.round(255*Le[2])),{type:"rgb",value:[Math.round(255*Le[0]),Math.round(255*Le[1]),Math.round(255*Le[2])]}}if("DeviceN"==e[0].value||"Separation"==e[0].value){var Ee="string"==typeof e[2].value?[e[2]]:e[2].value,Ne=e[3],Ye=this._getSeparationColorVal(Ee,Ne,t);return this._getGColor(Ee,Ye)}return this.core.toGravit("error",["01"]),{type:"rgb",value:[0,0,255]}},PSColor.prototype._optimizeStops=function(e){if(e.length>2){for(var t=[],o=0;o<e[0].color.value.length;++o)for(var a=e[0].color.value[o],r=a,n=1;n<e.length;++n){var i=e[n].color.value[o];i<a&&(a=i),i>r&&(r=i),t.push(Math.min(Math.max(Math.abs(r-a)/5,4),12))}return this._interpolate(e,0,t)}return e},PSColor.prototype._interpolate=function(e,t,o){if(e.length<=2||t>62)return e;var a,r,n=e[0],i=e[e.length-1],l=n.position,u=i.position;if(Math.abs(u-l)<=1e-4)return[n,i];for(var s=e.length-1,c=0;c<n.color.value.length;++c){a=n.color.value[c],r=i.color.value[c];for(var h=(r-a)/(u-l),p=a-h*l,v=o[c],f=1;f<e.length-1;++f){var d=Math.abs(p+h*e[f].position-e[f].color.value[c]);(d>v||d==v&&f<s)&&(s=f,v=d)}}if(s<e.length-1){var y=this._interpolate(e.slice(0,s+1),t+1,o),m=this._interpolate(e.slice(s),t+1,o);return y.slice(0,y.length-1).concat(m)}return[n,i]},PSColor.prototype.hsvToRGB=function(e){var t,o=e[2]*e[1],a=e[0]/60,r=o*(1-Math.abs(a%2-1)),n=e[2]-o;return t=a<1?[o,r,0]:a<2?[r,o,0]:a<3?[0,o,r]:a<4?[0,r,o]:a<5?[r,0,o]:a<=6?[o,0,r]:[0,0,0],[this.round_clamp_byte(255*(t[0]+n)),this.round_clamp_byte(255*(t[1]+n)),this.round_clamp_byte(255*(t[2]+n))]},PSColor.prototype.CMYKToRGB=function(e){var t=e[3],o=1-Math.min(1,e[0]+t),a=1-Math.min(1,e[1]+t),r=1-Math.min(1,e[2]+t);return r=r>.1?r-.1:r,[o,a,r]}}});
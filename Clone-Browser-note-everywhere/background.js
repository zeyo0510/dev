(()=>{"use strict";var e={2725:e=>{e.exports=function e(t,o){if(t===o)return!0;if(t&&o&&"object"==typeof t&&"object"==typeof o){if(t.constructor!==o.constructor)return!1;var s,n,a;if(Array.isArray(t)){if((s=t.length)!=o.length)return!1;for(n=s;0!=n--;)if(!e(t[n],o[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if((s=(a=Object.keys(t)).length)!==Object.keys(o).length)return!1;for(n=s;0!=n--;)if(!Object.prototype.hasOwnProperty.call(o,a[n]))return!1;for(n=s;0!=n--;){var i=a[n];if(!e(t[i],o[i]))return!1}return!0}return t!=t&&o!=o}},7457:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setBadgeUnavailable=t.setBadgeText=t.getSetting=t.setDefaultColor=t.getDefaultColor=t.setIsVisibleNote=t.getIsVisibleNote=t.scrollTo=t.updatePageInfo=t.fetchAllPageInfo=t.deleteNote=t.updateNote=t.createNote=t.fetchAllNotesByPageUrl=t.fetchAllNotesAndPageInfo=t.fetchAllNotes=void 0;const n=o(7706),a=o(7510),i=o(9728),r=o(4998);t.fetchAllNotes=()=>s(void 0,void 0,void 0,(function*(){return yield(0,n.getAllNotes)()})),t.fetchAllNotesAndPageInfo=()=>s(void 0,void 0,void 0,(function*(){const e=yield(0,n.getAllNotes)(),t=(yield(0,r.getAllPageInfos)()).filter((t=>e.some((e=>e.page_info_id===t.id))));return{notes:e,pageInfos:t}})),t.fetchAllNotesByPageUrl=e=>s(void 0,void 0,void 0,(function*(){const t=yield(0,r.getPageInfoByUrl)(e);return t&&t.id?yield(0,n.getAllNotesByPageId)(t.id):[]})),t.createNote=e=>s(void 0,void 0,void 0,(function*(){const t=yield(0,r.getOrCreatePageInfoByUrl)(e),{note:o,allNotes:s}=yield(0,n.createNote)(t.id);return(0,r.setUpdatedAtPageInfo)(t.id),s})),t.updateNote=e=>s(void 0,void 0,void 0,(function*(){if(!e.page_info_id)return[];const{allNotes:t}=yield(0,n.updateNote)(e.page_info_id,e);return(0,r.setUpdatedAtPageInfo)(e.page_info_id),t})),t.deleteNote=e=>s(void 0,void 0,void 0,(function*(){if(!e.page_info_id)return[];const{allNotes:t}=yield(0,n.deleteNote)(e.page_info_id,e.id);return t})),t.fetchAllPageInfo=()=>s(void 0,void 0,void 0,(function*(){return yield(0,r.getAllPageInfos)()})),t.updatePageInfo=e=>s(void 0,void 0,void 0,(function*(){if(!e.id)return[];const{allPageInfos:t}=yield(0,r.updatePageInfo)(e);return t})),t.scrollTo=(e,t)=>s(void 0,void 0,void 0,(function*(){return yield chrome.scripting.executeScript({target:{tabId:e},func:(e,t)=>window.scrollTo(null!=e?e:0,null!=t?t:0),args:[t.position_x,t.position_y]})})),t.getIsVisibleNote=()=>s(void 0,void 0,void 0,(function*(){return yield(0,a.getIsVisibleNote)()})),t.setIsVisibleNote=e=>s(void 0,void 0,void 0,(function*(){return yield(0,a.setIsVisibleNote)(e),e})),t.getDefaultColor=()=>s(void 0,void 0,void 0,(function*(){return yield(0,i.getDefaultColor)()})),t.setDefaultColor=e=>s(void 0,void 0,void 0,(function*(){return yield(0,i.setDefaultColor)(e),yield(0,t.getSetting)()})),t.getSetting=()=>s(void 0,void 0,void 0,(function*(){return{is_visible:yield(0,a.getIsVisibleNote)(),default_color:yield(0,i.getDefaultColor)()}})),t.setBadgeText=(e,t)=>{chrome.action.setBadgeText({tabId:e,text:`${null!=t?t:""}`}),chrome.action.setBadgeBackgroundColor({tabId:e,color:"#000"})},t.setBadgeUnavailable=e=>{chrome.action.setBadgeText({tabId:e,text:"x"}),chrome.action.setBadgeBackgroundColor({tabId:e,color:"red"})}},211:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cache=void 0;const o={badge:{}};t.cache=o,Object.freeze(o)},9836:function(e,t,o){var s=this&&this.__createBinding||(Object.create?function(e,t,o,s){void 0===s&&(s=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,s,n)}:function(e,t,o,s){void 0===s&&(s=o),e[s]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&s(t,e,o);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_DOM_ID=void 0;const i=o(7384),r=o(9206),l=a(o(7457)),d=o(7706),g=o(4998),c=o(8593),_=o(211);t.ROOT_DOM_ID="react-container-for-note-extension",chrome.runtime.onInstalled.addListener((e=>{const t=e.previousVersion||"x.x.x";"0.3.1"===t&&l.setDefaultColor("#FFF7CC"),e.reason===chrome.runtime.OnInstalledReason.INSTALL&&"x.x.x"===t&&chrome.tabs.create({url:`${chrome.runtime.getURL("setting.html")}#init`}),console.log("previousVersion",t)})),chrome.contextMenus.create({id:"note-extension-context-menu-create",title:(0,c.msg)("add_note_msg",!0),contexts:["page","frame","editable","image","video","audio","link","selection"]}),chrome.contextMenus.onClicked.addListener((e=>{const{pageUrl:t}=e;chrome.tabs.query({active:!0,currentWindow:!0}).then((([e])=>{(null==e?void 0:e.id)&&(0,i.isScriptAllowedPage)(e.id).then((o=>{o&&(0,g.getOrCreatePageInfoByUrl)(t).then((o=>{o.id&&(0,d.createNote)(o.id).then((({allNotes:o})=>{_.cache.badge[e.id]=o.length,l.getSetting().then((s=>{(null==e?void 0:e.id)&&(0,i.injectContentScript)(e.id).then((()=>(0,r.setupPage)(e.id,t,o,s).catch((()=>{}))))}))}))}))})).catch((e=>{var t,o;null===(o=(t=chrome.runtime).openOptionsPage)||void 0===o||o.call(t)}))}))}));let u="";chrome.tabs.onUpdated.addListener(((e,t,o)=>{const{status:s}=t;if("loading"!==s)return;const{url:n}=o;void 0!==n&&u!==n&&(u=n,(0,c.isSystemLink)(n)||(0,i.isScriptAllowedPage)(e).then((t=>{t&&l.fetchAllNotesByPageUrl(n).then((t=>{l.getSetting().then((o=>{if(u="",0===t.length)return(0,i.hasContentScript)(e).then((t=>{t&&(0,r.setupPage)(e,n,[],o).catch((e=>{}))})).catch((e=>{})),l.setBadgeText(e,0);(0,i.injectContentScript)(e).then((()=>(0,r.setupPage)(e,n,t,o).catch((e=>{}))))}))})).catch((e=>{console.log("error chrome.tabs.onUpdated.addListener",e)}))})))})),chrome.tabs.onActivated.addListener((e=>{void 0!==_.cache.badge[e.tabId]?l.setBadgeText(e.tabId,_.cache.badge[e.tabId]):l.setBadgeText(e.tabId,"")})),chrome.tabs.onRemoved.addListener((e=>{delete _.cache.badge[e]})),chrome.runtime.onMessage.addListener(i.handleMessages)},7364:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OPTIONS=t.BACKGROUND=t.CONTENT_SCRIPT=t.POPUP=t.SET_NOTE_VISIBLE=t.SETUP_PAGE=t.UPDATE_NOTE_VISIBLE=t.OPEN_OPTION_PAGE=t.SCROLL_TO_TARGET_NOTE=t.UPDATE_DEFAULT_COLOR=t.GET_SETTING=t.UPDATE_NOTE_INFO=t.GET_NOTE_VISIBLE=t.GET_ALL_NOTES_AND_PAGE_INFO=t.DELETE_NOTE=t.UPDATE_NOTE=t.CREATE_NOTE=t.GET_NOTES_BY_PAGE_ID=t.GET_ALL_NOTES=void 0,t.GET_ALL_NOTES="GET_ALL_NOTES",t.GET_NOTES_BY_PAGE_ID="GET_NOTES_BY_PAGE_ID",t.CREATE_NOTE="CREATE_NOTE",t.UPDATE_NOTE="UPDATE_NOTE",t.DELETE_NOTE="DELETE_NOTE",t.GET_ALL_NOTES_AND_PAGE_INFO="GET_ALL_NOTES_AND_PAGE_INFO",t.GET_NOTE_VISIBLE="GET_NOTE_VISIBLE",t.UPDATE_NOTE_INFO="UPDATE_NOTE_INFO",t.GET_SETTING="GET_SETTING",t.UPDATE_DEFAULT_COLOR="UPDATE_DEFAULT_COLOR",t.SCROLL_TO_TARGET_NOTE="SCROLL_TO_TARGET_NOTE",t.OPEN_OPTION_PAGE="OPEN_OPTION_PAGE",t.UPDATE_NOTE_VISIBLE="UPDATE_NOTE_VISIBLE",t.SETUP_PAGE="SETUP_PAGE",t.SET_NOTE_VISIBLE="SET_NOTE_VISIBLE",t.POPUP="POPUP",t.CONTENT_SCRIPT="CONTENT_SCRIPT",t.BACKGROUND="BACKGROUND",t.OPTIONS="OPTIONS"},7384:function(e,t,o){var s=this&&this.__createBinding||(Object.create?function(e,t,o,s){void 0===s&&(s=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,s,n)}:function(e,t,o,s){void 0===s&&(s=o),e[s]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&s(t,e,o);return n(t,e),t},i=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.handleMessages=t.injectContentScript=t.hasContentScript=t.isScriptAllowedPage=t.ROOT_DOM_ID=void 0;const r=o(7364),l=a(o(7457)),d=o(8593),g=o(9206);t.ROOT_DOM_ID="react-container-for-note-extension",t.isScriptAllowedPage=e=>i(void 0,void 0,void 0,(function*(){return yield chrome.scripting.executeScript({target:{tabId:e},func:()=>{}}),!chrome.runtime.lastError})),t.hasContentScript=e=>i(void 0,void 0,void 0,(function*(){const[t]=yield chrome.scripting.executeScript({target:{tabId:e},func:()=>!!document.getElementById("react-container-for-note-extension")});return t.result})),t.injectContentScript=e=>i(void 0,void 0,void 0,(function*(){return!(yield(0,t.hasContentScript)(e))&&(yield chrome.scripting.executeScript({target:{tabId:e},files:["contentScript.js"]}))})),t.handleMessages=(e,o,s)=>{const{method:n,senderType:a,payload:i}=e;switch(console.log("==== handleMessage ====",e,i),a){case r.CONTENT_SCRIPT:return((e,t,o)=>{const{url:s="",note:n}=o;switch(e){case r.GET_ALL_NOTES:return l.fetchAllNotesByPageUrl(s).then((e=>t({data:{notes:e}}))).catch((e=>{console.log("error GET_ALL_NOTES:",e),t({error:e})})),!0;case r.CREATE_NOTE:return l.createNote(s).then((e=>(chrome.tabs.query({url:s,currentWindow:!0}).then((t=>{t.forEach((t=>{var o;t.id&&l.setBadgeText(t.id,null!==(o=e.length)&&void 0!==o?o:0)}))})),t({data:{notes:e}})))).catch((e=>{console.log("error CREATE_NOTE:",e),t({error:e})})),!0;case r.UPDATE_NOTE:return l.updateNote(n).then((e=>t({data:{notes:e}}))).catch((e=>{console.log("error UPDATE_NOTE:",e),t({error:e})})),!0;case r.DELETE_NOTE:return l.deleteNote(n).then((e=>(chrome.tabs.query({url:s,currentWindow:!0}).then((t=>{t.forEach((t=>{var o;t.id&&l.setBadgeText(t.id,null!==(o=e.length)&&void 0!==o?o:0)}))})),t({data:{notes:e}})))).catch((e=>{console.log("error DELETE_NOTE:",e),t({error:e})})),!0;case r.OPEN_OPTION_PAGE:break;case r.GET_NOTE_VISIBLE:l.getIsVisibleNote().then((e=>t({data:{isVisible:e}}))).catch((e=>{console.log("error GET_NOTE_VISIBLE:",e),t({error:e})}))}return!1})(n,s,null!=i?i:{});case r.POPUP:return((e,o,s)=>{const{tab:n,note:a,isVisible:i}=s,c=null==n?void 0:n.id,_=null==n?void 0:n.url;if(!c||!_)return o({data:{notes:[]},error:new Error("このページでは使用できません")}),!0;if((0,d.isSystemLink)(_))return o({data:{notes:[]},error:new Error("このページでは使用できません")}),!0;const u=e=>{l.getSetting().then((s=>{o({data:{notes:e}}),(0,t.injectContentScript)(c).then((()=>(0,g.setupPage)(c,_,e,s).catch((e=>{}))))}))};return(0,t.isScriptAllowedPage)(c).then((s=>{switch(s||o({data:{notes:[]},error:new Error("このページでは使用できません")}),e){case r.GET_ALL_NOTES:return l.fetchAllNotesByPageUrl(_).then((e=>{l.getIsVisibleNote().then((t=>{o({data:{notes:e,isVisible:t}})}))})).catch((e=>console.log("error GET_ALL_NOTES:",e))),!0;case r.CREATE_NOTE:return l.createNote(_).then((e=>{var t;c&&l.setBadgeText(c,null!==(t=e.length)&&void 0!==t?t:0),u(e)})).catch((e=>console.log("error CREATE_NOTE:",e))),!0;case r.SCROLL_TO_TARGET_NOTE:return l.scrollTo(c,a).then((()=>o())),!0;case r.UPDATE_NOTE:return l.updateNote(a).then(u).catch((e=>{console.log("error UPDATE_NOTE:",e)})),!0;case r.DELETE_NOTE:return l.deleteNote(a).then((e=>{var t;c&&l.setBadgeText(c,null!==(t=e.length)&&void 0!==t?t:0),u(e)})).catch((e=>{console.log("error DELETE_NOTE:",e)})),!0;case r.GET_NOTE_VISIBLE:return l.getIsVisibleNote().then((e=>{o({data:{isVisible:e}}),(0,t.injectContentScript)(c).then((()=>(0,g.setupIsVisible)(c,_,e)))})),!0;case r.UPDATE_NOTE_VISIBLE:return l.setIsVisibleNote(!!i).then((e=>{o({data:{isVisible:e}}),(0,t.injectContentScript)(c).then((()=>(0,g.setupIsVisible)(c,_,e)))})),!0}})),!0})(n,s,null!=i?i:{});case r.OPTIONS:return((e,t,o)=>{const{tab:s,note:n,pageInfo:a}=o;switch(e){case r.GET_ALL_NOTES:return l.fetchAllNotes().then((e=>t({data:{notes:e}}))).catch((e=>console.log("error GET_ALL_NOTES:",e))),!0;case r.GET_ALL_NOTES_AND_PAGE_INFO:return l.fetchAllNotesAndPageInfo().then((({notes:e,pageInfos:o})=>t({data:{notes:e,pageInfos:o}}))).catch((e=>console.log("error GET_ALL_NOTES:",e))),!0;case r.UPDATE_NOTE:return l.updateNote(n).then((()=>{l.fetchAllNotesAndPageInfo().then((({notes:e,pageInfos:o})=>t({data:{notes:e,pageInfos:o}})))})).catch((e=>{console.log("error UPDATE_NOTE:",e),t({error:e})})),!0;case r.DELETE_NOTE:return l.deleteNote(n).then((()=>{l.fetchAllNotesAndPageInfo().then((({notes:e,pageInfos:o})=>{var n;(null==s?void 0:s.id)&&l.setBadgeText(s.id,null!==(n=e.length)&&void 0!==n?n:0),t({data:{notes:e,pageInfos:o}})}))})).catch((e=>console.log("error DELETE_NOTE:",e))),!0;case r.UPDATE_NOTE_INFO:return l.updatePageInfo(a).then((e=>{t({data:{pageInfos:e}})})).catch((e=>console.log("error UPDATE_NOTE_INFO:",e))),!0;case r.GET_SETTING:return l.getSetting().then((e=>{t({data:{setting:e}})})).catch((e=>console.log("error GET_SETTING:",e))),!0;case r.UPDATE_DEFAULT_COLOR:return l.setDefaultColor(o.defaultColor).then((e=>{t({data:{setting:e}})})).catch((e=>console.log("error UPDATE_DEFAULT_COLOR:",e))),!0;default:return t({data:{notes:[],pageInfos:[]},error:new Error("無効なアクションです")}),!0}})(n,s,null!=i?i:{});default:return s({error:new Error("無効なアクションです")}),!0}}},9206:function(e,t,o){var s=this&&this.__createBinding||(Object.create?function(e,t,o,s){void 0===s&&(s=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,s,n)}:function(e,t,o,s){void 0===s&&(s=o),e[s]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&s(t,e,o);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupIsVisible=t.setupPage=void 0;const i=o(7364),r=o(7755),l=a(o(7457)),d=o(211);t.setupPage=(e,t,o,s)=>{var n,a;return d.cache.badge[e]=null!==(n=o.length)&&void 0!==n?n:0,l.setBadgeText(e,null!==(a=o.length)&&void 0!==a?a:0),(0,r.sendActionToTab)(e,i.SETUP_PAGE,i.BACKGROUND,{url:t,notes:o,isVisible:null==s?void 0:s.is_visible,defaultColor:null==s?void 0:s.default_color})},t.setupIsVisible=(e,t,o)=>(0,r.sendActionToTab)(e,i.SET_NOTE_VISIBLE,i.BACKGROUND,{url:t,isVisible:o})},7755:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendActionToTab=t.sendAction=void 0,t.sendAction=function(e,t,o){return new Promise(((s,n)=>{chrome.runtime.sendMessage({method:e,senderType:t,payload:o},(e=>{const{data:t,error:o}=null!=e?e:{};chrome.runtime.lastError?n(chrome.runtime.lastError.message):o?n(o.message):s(null!=t?t:{})}))}))},t.sendActionToTab=function(e,t,o,s){return new Promise(((n,a)=>{chrome.tabs.sendMessage(e,{method:t,senderType:o,payload:s},(e=>{const{data:t,error:o}=null!=e?e:{};chrome.runtime.lastError?a(chrome.runtime.lastError.message):o?a(o.message):n(null!=t?t:{})}))}))}},130:function(e,t){var o=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getNewId=t.removeStorage=t.setStorage=t.getStorage=t.getAllStorage=void 0,t.getAllStorage=()=>o(void 0,void 0,void 0,(function*(){return yield chrome.storage.local.get(null)})),t.getStorage=e=>o(void 0,void 0,void 0,(function*(){return yield chrome.storage.local.get(e)})),t.setStorage=(e,t)=>o(void 0,void 0,void 0,(function*(){return yield chrome.storage.local.set({[e]:t}),!chrome.runtime.lastError})),t.removeStorage=e=>o(void 0,void 0,void 0,(function*(){return yield chrome.storage.local.remove(e),!chrome.runtime.lastError})),t.getNewId=e=>{let t=Math.floor(1e6*Math.random());for(;e.some((e=>e.id===t));)t=Math.floor(1e6*Math.random());return t}},9728:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setDefaultColor=t.getDefaultColor=void 0;const n=o(130),a="default_color";t.getDefaultColor=()=>s(void 0,void 0,void 0,(function*(){return(yield(0,n.getStorage)(a))[a]||""})),t.setDefaultColor=e=>s(void 0,void 0,void 0,(function*(){return yield(0,n.setStorage)(a,e)}))},7706:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteNote=t.getNotesByPageId=t.getAllNotes=t.getAllNotesByPageId=t.updateNote=t.createNote=void 0;const n=o(4020),a=o(130),i=o(4998),r="notes",l=e=>`${r}_${e}`,d=(e,t)=>s(void 0,void 0,void 0,(function*(){const o=l(e);return yield(0,a.setStorage)(o,t)}));t.createNote=e=>s(void 0,void 0,void 0,(function*(){var o;const s=yield(0,t.getAllNotesByPageId)(e),i={id:(0,a.getNewId)(s),page_info_id:e,width:n.DEAULT_NOTE_WIDTH,height:n.DEAULT_NOTE_HEIGHT,is_fixed:!0,is_open:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},r=[...s,i];if(yield d(e,r))return{note:i,allNotes:r};throw new Error("createNote failed: "+(null===(o=chrome.runtime.lastError)||void 0===o?void 0:o.message))})),t.updateNote=(e,o)=>s(void 0,void 0,void 0,(function*(){var s;if(!o.id)return new Promise(((e,t)=>t("id is required")));const n=(yield(0,t.getAllNotesByPageId)(e)).map((e=>e.id===o.id?Object.assign(Object.assign({},o),{updated_at:(new Date).toISOString()}):e));if(yield d(e,n))return{note:o,allNotes:n};throw new Error("updateNote failed: "+(null===(s=chrome.runtime.lastError)||void 0===s?void 0:s.message))})),t.getAllNotesByPageId=e=>s(void 0,void 0,void 0,(function*(){return yield(t=l(e),s(void 0,void 0,void 0,(function*(){return(yield(0,a.getStorage)(t))[t]||[]})));var t})),t.getAllNotes=()=>s(void 0,void 0,void 0,(function*(){const e=yield(0,a.getAllStorage)();return Object.keys(e).filter((e=>e.match(new RegExp(`^${r}_`,"g")))).map((t=>e[t])).flat()})),t.getNotesByPageId=e=>s(void 0,void 0,void 0,(function*(){return new Promise(((e,t)=>t("getAllNotes is not implemented")))})),t.deleteNote=(e,o)=>s(void 0,void 0,void 0,(function*(){var n;if(!o)throw new Error("id is required");const r=yield(0,t.getAllNotesByPageId)(e),g=r.find((e=>e.id===o)),c=r.filter((e=>e.id!==o));if(yield d(e,c))return 0===c.length&&(yield(0,i.deletePageInfo)(e),yield(e=>s(void 0,void 0,void 0,(function*(){return yield(0,a.removeStorage)(l(e))})))(e)),{note:g,allNotes:c};throw new Error("deleteNote failed: "+(null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message))}))},7510:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setIsVisibleNote=t.getIsVisibleNote=void 0;const n=o(130),a="visible_notes";t.getIsVisibleNote=()=>s(void 0,void 0,void 0,(function*(){return(yield(0,n.getStorage)(a))[a]||!1})),t.setIsVisibleNote=e=>s(void 0,void 0,void 0,(function*(){return yield(0,n.setStorage)(a,e)}))},4998:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deletePageInfo=t.getOrCreatePageInfoByUrl=t.getPageInfoByUrl=t.getPageInfoById=t.getAllPageInfos=t.setUpdatedAtPageInfo=t.updatePageInfo=t.createPageInfo=void 0;const n=o(8593),a=o(130),i="page_info",r=e=>s(void 0,void 0,void 0,(function*(){return yield(0,a.setStorage)(i,e)}));t.createPageInfo=e=>s(void 0,void 0,void 0,(function*(){var o;const s=yield(0,t.getAllPageInfos)(),i=(0,n.formURL)(e),l=(0,a.getNewId)(s),[d]=yield chrome.tabs.query({url:(0,n.formURL)(e)});if(!d)throw new Error(`tab is not found: ${e}`);const g={id:l,page_url:i,page_title:d.title,fav_icon_url:d.favIconUrl,created_at:(new Date).toISOString()},c=[...s,g];if(yield r(c))return{pageInfo:g,allPageInfos:c};throw new Error("createPageInfo failed: "+(null===(o=chrome.runtime.lastError)||void 0===o?void 0:o.message))})),t.updatePageInfo=e=>s(void 0,void 0,void 0,(function*(){var o;if(!e.id)return new Promise(((e,t)=>t("id is required")));const s=(yield(0,t.getAllPageInfos)()).map((t=>t.id===e.id?Object.assign(Object.assign({},e),{updated_at:(new Date).toISOString()}):t));if(yield r(s))return{pageInfo:e,allPageInfos:s};throw new Error("updatePageInfo failed: "+(null===(o=chrome.runtime.lastError)||void 0===o?void 0:o.message))})),t.setUpdatedAtPageInfo=e=>s(void 0,void 0,void 0,(function*(){var o;const s=(yield(0,t.getAllPageInfos)()).map((t=>t.id===e?Object.assign(Object.assign({},t),{updated_at:(new Date).toISOString()}):t));if(yield r(s))return{allPageInfos:s};throw new Error("updatePageInfo failed: "+(null===(o=chrome.runtime.lastError)||void 0===o?void 0:o.message))})),t.getAllPageInfos=()=>s(void 0,void 0,void 0,(function*(){return yield s(void 0,void 0,void 0,(function*(){return(yield(0,a.getStorage)(i))[i]||[]}))})),t.getPageInfoById=e=>s(void 0,void 0,void 0,(function*(){return new Promise(((e,t)=>t("getPageInfoById is not implemented")))})),t.getPageInfoByUrl=e=>s(void 0,void 0,void 0,(function*(){const o=(0,n.formURL)(e);return(yield(0,t.getAllPageInfos)()).find((e=>e.page_url===o))})),t.getOrCreatePageInfoByUrl=e=>s(void 0,void 0,void 0,(function*(){const o=yield(0,t.getPageInfoByUrl)(e);if(o)return o;const{pageInfo:s}=yield(0,t.createPageInfo)(e);return s})),t.deletePageInfo=e=>s(void 0,void 0,void 0,(function*(){var o;if(!e)return new Promise(((e,t)=>t("id is required")));const s=yield(0,t.getAllPageInfos)(),n=s.find((t=>t.id===e)),a=s.filter((t=>t.id!==e));if(yield r(a))return{pageInfo:n,allPageInfos:a};throw new Error("deletePageInfo failed: "+(null===(o=chrome.runtime.lastError)||void 0===o?void 0:o.message))}))},4020:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEAULT_NOTE_HEIGHT=t.DEAULT_NOTE_WIDTH=void 0,t.DEAULT_NOTE_WIDTH=300,t.DEAULT_NOTE_HEIGHT=180},8593:function(e,t,o){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isEqualsObject=t.isSystemLink=t.formatDate=t.formURL=t.decodeURL=t.encodeFormURL=t.msg=void 0;const n=s(o(2725)),a=s(o(6249)),i=s(o(8324)),r={ja:a.default,en:i.default};t.msg=(e,t)=>{var o,s,n;if(t){const t=navigator.language.slice(0,2);return null!==(n=r[t]?null===(o=r[t][e])||void 0===o?void 0:o.message:null===(s=i.default[e])||void 0===s?void 0:s.message)&&void 0!==n?n:""}return chrome.i18n.getMessage(e)},t.encodeFormURL=e=>encodeURIComponent((0,t.formURL)(e)),t.decodeURL=e=>decodeURIComponent(e),t.formURL=e=>{const t=new URL(e);return`${t.protocol}//${t.hostname}${t.pathname}${t.search||""}`},t.formatDate=e=>isNaN(e.getTime())?"":`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()} ${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}`,t.isSystemLink=e=>e.startsWith("chrome://")||e.startsWith("chrome-extension://")||e.startsWith("chrome-search://"),t.isEqualsObject=(e,t)=>e===t||(0,n.default)(e,t)},8324:e=>{e.exports=JSON.parse('{"appName":{"message":"Note Everywhere","description":"The name of the application"},"appShortName":{"message":"Note Everywhere","description":"The short_name (maximum of 12 characters recommended) is a short version of the app\'s name."},"appDescription":{"message":"This is intuitive note application.","description":"The description of the application"},"browserActionTitle":{"message":"Note Everywhere","description":"The title of the browser action button"},"app_name":{"message":"Note Everywhere"},"welcome_msg":{"message":"Welcome to Note Everywhere!"},"no_note_msg":{"message":"There is no note."},"add_note_msg":{"message":"add note"},"confirm_remove_note_msg":{"message":"Are you sure you want to delete?"},"confirm_remove_next_note_msg":{"message":"Are you sure you want to delete?"},"make_note_button_msg":{"message":"make note"},"setting_button_msg":{"message":"settings"},"menu_button_msg":{"message":"note list page"},"cannot_show_note_msg":{"message":"Memos can not be shown on this page."},"no_note_created_msg":{"message":"add note"},"no_note_created_option_msg":{"message":"or right click and \\"add note\\""},"note_unavailable_msg":{"message":"Note cannot be created on this page."},"how_to_use_page_link_msg":{"message":"How to Use"},"note_header_msg":{"message":"Memos"},"settings_header_msg":{"message":"Setting"},"how_to_use_header_msg":{"message":"Usage"},"show_all_note_msg":{"message":"All Notes"},"search_query_msg":{"message":"search"},"this_page_note_list_msg":{"message":"Memo list of this page"},"setting_about_this_app":{"message":"About Note Everywhere"},"setting_about_this_app_created_by":{"message":"Created by"},"usage01":{"message":"Fixing Pop-ups is recommended."},"usage02":{"message":"Open the pop-up and click the \\"+\\" button to create a Note."},"usage02_2":{"message":"You can also create a Note from the right-click menu on the screen."},"usage03":{"message":"Double click to edit title and details."},"usage04":{"message":"Move by mouse drag. You can also resize."},"usage05":{"message":"From the popup, you can view the notes created on the open page."},"usage06":{"message":"Memos page"},"usage06_2":{"message":" shows notes you made up to now."},"usage07":{"message":"The note has various functions."},"note":{"message":"Note"},"updated_at_msg":{"message":"Update"},"created_at_msg":{"message":"Created"},"save_msg":{"message":"Save"},"cancel_msg":{"message":"Cancel"},"close_msg":{"message":"Close"},"save_error_msg":{"message":"Failed to save."},"save_error_msg_2":{"message":"Please try again."},"save_error_word_maximum_msg":{"message":"Please reduce the number of characters and try again."},"discard_close_msg":{"message":"Discard changes and Close"},"updated_at_sort_option":{"message":"Update"},"created_at_sort_option":{"message":"Created"},"title_sort_option":{"message":"Title"},"go_to_this_page":{"message":"Go to this page"},"input_description_placeholder":{"message":"Enter a Note"},"copied_msg":{"message":"Copied"},"switch_pin_msg":{"message":"Switch Pin"},"minimize_msg":{"message":"Minimize"},"maximize_msg":{"message":"Maximize"},"pin_msg":{"message":"Pin"},"pin_select_option_unfixed_msg":{"message":"on"},"pin_select_option_fixed_msg":{"message":"off"},"color_msg":{"message":"Color"},"open_msg":{"message":"Minimize"},"open_select_option_yes_msg":{"message":"on"},"open_select_option_no_msg":{"message":"off"},"position_msg":{"message":"Position"},"reset_position_msg":{"message":"reset position"},"size_msg":{"message":"Size"},"size_height_msg":{"message":"height"},"size_width_msg":{"message":"width"},"pinned_msg":{"message":"Pin"},"remove_pinned_msg":{"message":"remove pin"},"detail_msg":{"message":"Details"},"edit_msg":{"message":"Edit"},"do_copy_msg":{"message":"Copy to Clipboard"},"copy_msg":{"message":"Copy"},"delete_msg":{"message":"Delete"},"export_msg":{"message":"Export"},"csv_download_msg":{"message":"CSV Download"},"text_download_msg":{"message":"txt Download"},"please_reload_msg":{"message":"Reload the page."},"maker_msg":{"message":"Developer"},"pin_explain_msg":{"message":"Pinning a Note will follow scrolling."},"edit_explain_msg":{"message":"Switch a Note to edit mode. (or double-click to edit)."},"copy_explain_msg":{"message":"Copies a Note text to the clipboard."},"color_explain_msg":{"message":"Edits the color of the Note."},"delete_explain_msg":{"message":"Deletes a Note."},"open_explain_msg":{"message":"Minimize a Note."},"new_note_title_msg":{"message":"New Note"},"default_color_msg":{"message":"Default Color"},"failed_load_page_msg":{"message":"This page failed to load."},"link_edit_note_msg":{"message":"If the link is not correct, Notes may not display properly."},"new_note_description_msg":{"message":"Double-click to edit"}}')},6249:e=>{e.exports=JSON.parse('{"appName":{"message":"どこでもメモ","description":"The name of the application"},"appShortName":{"message":"どこでもメモ","description":"The short_name (maximum of 12 characters recommended) is a short version of the app\'s name."},"appDescription":{"message":"直感的なメモのアプリです。","description":"The description of the application"},"browserActionTitle":{"message":"どこでもメモ","description":"The title of the browser action button"},"app_name":{"message":"どこでもメモ"},"welcome_msg":{"message":"ようこそ、どこでもメモへ！"},"no_note_msg":{"message":"メモがありません。"},"add_note_msg":{"message":"メモを追加する"},"confirm_remove_note_msg":{"message":"削除してよろしいですか？"},"confirm_remove_next_note_msg":{"message":"を削除してよろしいですか？"},"make_note_button_msg":{"message":"メモを作成する"},"setting_button_msg":{"message":"設定"},"menu_button_msg":{"message":"メモ一覧ページ"},"cannot_show_note_msg":{"message":"このページではメモを表示できません。"},"no_note_created_msg":{"message":"メモを作成する。"},"no_note_created_option_msg":{"message":"もしくは、右クリック「メモを追加する」から作成できます。"},"note_unavailable_msg":{"message":"この画面ではメモの作成はできません"},"how_to_use_page_link_msg":{"message":"使い方"},"note_header_msg":{"message":"メモ一覧"},"settings_header_msg":{"message":"設定"},"how_to_use_header_msg":{"message":"使い方"},"show_all_note_msg":{"message":"すべてのメモ"},"search_query_msg":{"message":"検索"},"this_page_note_list_msg":{"message":"このページのメモ一覧"},"setting_about_this_app":{"message":"どこでもメモについて"},"setting_about_this_app_created_by":{"message":"制作者"},"usage01":{"message":"ポップアップを固定することをおすすめします。"},"usage02":{"message":"ポップアップを開き、「+」ボタンをクリックしてメモを作成できます。"},"usage02_2":{"message":"もしくは画面上で右クリックのメニューから作成できます。"},"usage03":{"message":"ダブルクリックでタイトルと詳細を編集できます。"},"usage04":{"message":"マウスドラッグで移動可能です。リサイズをすることもできます。"},"usage05":{"message":"ポップアップから、今開いているページで作成したメモを閲覧することができます。"},"usage06":{"message":"メモ一覧ページ"},"usage06_2":{"message":"で今まで作ったメモを一覧できます。"},"usage07":{"message":"メモには、様々な機能があります。"},"note":{"message":"メモ"},"updated_at_msg":{"message":"更新"},"created_at_msg":{"message":"作成"},"save_msg":{"message":"保存"},"cancel_msg":{"message":"キャンセル"},"close_msg":{"message":"閉じる"},"save_error_msg":{"message":"保存に失敗しました。"},"save_error_msg_2":{"message":"再度お試しください。"},"save_error_word_maximum_msg":{"message":"文字数を減らして、再度お試しください。"},"discard_close_msg":{"message":"変更を破棄して閉じる"},"updated_at_sort_option":{"message":"更新日"},"created_at_sort_option":{"message":"作成日"},"title_sort_option":{"message":"タイトル"},"go_to_this_page":{"message":"このページに移動する"},"input_description_placeholder":{"message":"メモを入力"},"do_copy_msg":{"message":"クリップボードにコピーする"},"copied_msg":{"message":"コピーしました"},"pin_msg":{"message":"ピン"},"pin_select_option_unfixed_msg":{"message":"あり"},"pin_select_option_fixed_msg":{"message":"なし"},"color_msg":{"message":"カラー"},"open_msg":{"message":"縮小"},"open_select_option_yes_msg":{"message":"縮小する"},"open_select_option_no_msg":{"message":"縮小しない"},"size_msg":{"message":"サイズ"},"size_height_msg":{"message":"高さ"},"size_width_msg":{"message":"幅"},"position_msg":{"message":"位置"},"reset_position_msg":{"message":"位置をリセット"},"switch_pin_msg":{"message":"ピンを切り替える"},"minimize_msg":{"message":"最小化する"},"maximize_msg":{"message":"最大化"},"pinned_msg":{"message":"画面に固定する"},"remove_pinned_msg":{"message":"ページに固定する"},"detail_msg":{"message":"詳細"},"edit_msg":{"message":"編集"},"copy_msg":{"message":"コピー"},"delete_msg":{"message":"削除する"},"export_msg":{"message":"書き出し"},"csv_download_msg":{"message":"CSVダウンロード"},"text_download_msg":{"message":"txtダウンロード"},"please_reload_msg":{"message":"ページをリロードしてください。"},"maker_msg":{"message":"製作者"},"pin_explain_msg":{"message":"メモをピン留めすると、スクロールに追従します。"},"edit_explain_msg":{"message":"メモを編集モードに切り替えます。（もしくはダブルクリックで編集できます）"},"copy_explain_msg":{"message":"メモのテキストをクリップボードにコピーします。"},"color_explain_msg":{"message":"メモのカラーを編集します。"},"delete_explain_msg":{"message":"メモを削除します。"},"open_explain_msg":{"message":"メモを最小化します。"},"default_color_msg":{"message":"メモの初期カラー"},"new_note_title_msg":{"message":"新しいメモ"},"failed_load_page_msg":{"message":"ページの読み込みに失敗しました。"},"link_edit_note_msg":{"message":"リンクが正しくないと、正常にメモが表示されない場合があります。"},"new_note_description_msg":{"message":"ダブルクリックで編集"}}')}},t={};!function o(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,o),a.exports}(9836)})();
/*! (c) Philipp Koenig under MS-RSL */
(()=>{"use strict";if(window.jsu)return!1;const e=[],t=document,a=new WeakMap,s=new WeakMap,n=Symbol(),i={delay:(e=0)=>new Promise((t=>{setTimeout(t,e)})),ua:()=>{let e="Other",t="Other";try{e=navigator.userAgentData.platform}catch(e){}try{let e=navigator.userAgentData.brands.filter((e=>!/^[^a-z]*NOT[^a-z]/i.test(e.brand)));e=e.filter((t=>"CHROMIUM"!==t.brand.toUpperCase()||1===e.length)),e.length>0&&(t=e[0].brand+" "+(e[0].version||""))}catch(e){}return{os:e.trim(),browser:t.trim()}},xhr:(t,a={})=>new Promise(((s,n)=>{const i=new XMLHttpRequest,r=e.push({url:t,xhr:i})-1;a.mimeType&&i.overrideMimeType(a.mimeType),i.open(a.method||"GET",t,!0),["load","error","timeout","abort"].forEach((t=>{i.addEventListener(t,(()=>{e[r]=null,"load"===t&&i.status<400?s(i):n(i)}))}));let l=null;a.data&&(l=new FormData,Object.entries(a.data).forEach((([e,t])=>{"object"==typeof t&&(t=JSON.stringify(t)),l.append(e,t)}))),a.files&&(null===l&&(l=new FormData),a.files.forEach((e=>{e.files.forEach((t=>{l.append(e.name+"[]",t)}))}))),a.header&&Object.entries(a.header).forEach((([e,t])=>{i.setRequestHeader(e,t)})),Object.entries(a).forEach((([e,t])=>{"method"!==e&&"data"!==e&&"header"!==e&&(i[e]=t)})),i.send(l)})),cancelXhr:(t=null)=>{e.forEach((e=>{e&&e.xhr&&e.xhr.readyState&&e.xhr.abort&&(null===t||e.url===t)&&(e.xhr.abort(),e=null)}))}};class r{constructor(e,a=!0){let s=e;if("string"==typeof e&&(!1===a||e.indexOf("<")>-1)){const a=t.createElement("div");a.innerHTML=e,s=a.childNodes}this._fillNodeList(s)}static _isDefined(e){return null!=e}static _forEach(e,t,a=!1){const s=e.length;if(a){for(let n=s-1;n>=0;n--)if(r._isDefined(e[n].forEach))r._forEach(e[n],t,a);else if(!1===t(e[n],n))break}else for(let n=0;n<s;n++)if(r._isDefined(e[n].forEach))r._forEach(e[n],t,a);else if(!1===t(e[n],n))break}_fillNodeList(e){if(r._isDefined(e))if(e instanceof r)this[n]=e.get();else if("string"==typeof e)this[n]=t.querySelectorAll(e);else if(e instanceof Node||e instanceof HTMLDocument||e instanceof Window)this[n]=[e];else if(e instanceof NodeList||e instanceof HTMLCollection)this[n]=e;else{if("object"!=typeof e)throw new DOMException("invalid parameter for jsu");this[n]=[],r._isDefined(e.forEach)||(e=[e]),e.forEach((e=>{if(null!==e){const t=e=>{-1===this[n].indexOf(e)&&this[n].push(e)};e instanceof r?e.forEach(t):Array.isArray(e)||e instanceof NodeList||e instanceof HTMLCollection||/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e.toString())?r._forEach(e,t):this[n].push(e)}}))}else this[n]=[];this.forEach(((e,t)=>{this[t]=e}))}forEach(e,t=!1){return r._forEach(this[n],e,t),this}css(e,t){let a=!1;const s=r._isDefined(e),i=r._isDefined(t),l=[];return this.forEach((n=>{s&&i&&"string"==typeof e?(n.style[e]=t,a=!0):s&&("string"==typeof e?l.push(window.getComputedStyle(n)[e]):"object"==typeof e&&(a=!0,Object.keys(e).forEach((t=>{"string"==typeof t&&(n.style[t]=e[t])}))))})),a?this:this[n].length>1?l:l[0]}attr(e,t){let a=!1;const s=r._isDefined(e),i=r._isDefined(t),l=[];return this.forEach((n=>{const o=(e,t)=>{a=!0,r._isDefined(n[e])?n[e]=t:n.setAttribute(e,t)};var c;s&&i&&"string"==typeof e?o(e,t):s&&("string"==typeof e?l.push((c=e,r._isDefined(n[c])?n[c]:n.getAttribute(c))):"object"==typeof e&&Object.keys(e).forEach((t=>{"string"==typeof t&&o(t,e[t])})))})),a?this:this[n].length>1?l:l[0]}removeAttr(e){return this.forEach((t=>{t.removeAttribute(e)})),this}static _addEventListener(e,t){let s=a.get(e);r._isDefined(s)||(s={},a.set(e,s)),s[t.event]||(s[t.event]=[]),s[t.event].push({fn:t.fn,name:t.name||t.event+"_"+ +new Date+Math.random().toString(36).substring(2,14),opts:t.opts,wantsUntrusted:t.wantsUntrusted}),e.addEventListener(t.event,t.fn,t.opts,t.wantsUntrusted)}static _cloneEventListener(e,t){const s=a.get(e);r._isDefined(s)&&Object.keys(s).forEach((e=>{s[e].forEach((a=>{r._addEventListener(t,{event:e,fn:a.fn,opts:a.opts,wantsUntrusted:a.wantsUntrusted})}))})),t.children&&r._forEach(t.children,((t,a)=>{r._cloneEventListener(e.children[a],t)}))}static _addData(e,t,a){let n=s.get(e);r._isDefined(n)||(n={},s.set(e,n)),n[t]=a}static _cloneData(e,t){const a=s.get(e);r._isDefined(a)&&Object.keys(a).forEach((e=>{r._addData(t,e,a[e])})),t.children&&r._forEach(t.children,((t,a)=>{r._cloneData(e.children[a],t)}))}static _cloneElement(e){const t=[];return e.forEach((e=>{const a=e.cloneNode(!0);r._cloneEventListener(e,a),r._cloneData(e,a),t.push(a)})),new r(t)}clone(){return r._cloneElement(this)}data(e,t){let a=!1;const i=r._isDefined(e),l=r._isDefined(t),o=[];return this.forEach((n=>{const c=s.get(n),d=r._isDefined(c);i&&l?(a=!0,r._addData(n,e,t)):i?"string"==typeof e?o.push(d?c[e]:void 0):"object"==typeof e&&(a=!0,Object.keys(e).forEach((t=>{"string"==typeof t&&r._addData(n,t,e[t])}))):o.push(d?c:{})})),a?this:this[n].length>1?o:o[0]}removeData(e){const t=!r._isDefined(e);return this.forEach((a=>{const n=s.get(a);r._isDefined(n)&&(t?s.delete(a):r._isDefined(n[e])&&delete n[e])})),this}on(e,t,a,s,n){const i=(e,t)=>{Object.keys(t).forEach((a=>{try{Object.defineProperty(e,a,{value:t[a]})}catch(e){}}))};let l=a;"function"==typeof a?l=s:n=s,void 0===l&&(l=null),void 0===n&&(n=null);const o="string"==typeof t;return this.forEach((s=>{e.split(/\s+/g).forEach((e=>{const c=e.split(/\./);r._addEventListener(s,{event:c[0],name:c[1],fn:e=>{if(i(e,{type:c[0]}),o){const n={preventDefault:()=>{e.preventDefault()},stopPropagation:()=>{e.stopPropagation()}};r._forEach(s.querySelectorAll(":scope "+t),(t=>{let r=e.target;for(;r&&r!==s;){if(r===t){const t=c[0].startsWith("key")?new KeyboardEvent(c[0],e):new MouseEvent(c[0],e);i(t,{preventDefault:n.preventDefault,stopPropagation:n.stopPropagation,currentTarget:r,target:e.target}),a(t)}r=r.parentNode}}))}else"function"==typeof t&&t(e)},opts:l,wantsUntrusted:n})}))}),!0),this}off(e){return this.forEach((t=>{const s=a.get(t);if(r._isDefined(s)){e.split(/\s+/g).forEach((e=>{const a=e.split(/\./);"*"===a[0]?Object.entries(s).forEach((([e,n])=>{r._forEach(n,((n,i)=>{void 0!==a[1]&&a[1]!==n.name||(t.removeEventListener(e,n.fn),s[e].splice(i,1))}),!0)})):s[a[0]]&&r._forEach(s[a[0]],((e,n)=>{void 0!==a[1]&&a[1]!==e.name||(t.removeEventListener(a[0],e.fn),s[a[0]].splice(n,1))}),!0)}))}})),this}trigger(e,t){return e.split(/\s+/g).forEach((e=>{const a=e.split(/\./),s=new CustomEvent(a[0],t);this.forEach((e=>{e.dispatchEvent(s)}))})),this}addClass(e){return"object"!=typeof e&&(e=[e]),this.forEach((t=>{e.forEach((e=>{t.classList.contains(e)||t.classList.add(e)}))})),this}removeClass(e){return"object"!=typeof e&&(e=[e]),this.forEach((t=>{e.forEach((e=>{t.classList.contains(e)&&t.classList.remove(e)}))})),this}toggleClass(e){return this.forEach((t=>{t.classList.toggle(e)})),this}hasClass(e){const t=[];return this.forEach((a=>{t.push(a.classList.contains(e))})),this[n].length>1?t:t[0]}_realDimension(e,t=!1){const a=[];let s="width",i=["left","right"];return"h"===e&&(s="height",i=["top","bottom"]),this.forEach((e=>{const n=e.getBoundingClientRect(),r=window.getComputedStyle(e);let l=parseFloat((n[s]+"").replace(/,/g,"."));t&&i.forEach((e=>{const t=r.getPropertyValue("margin-"+e);l+=parseFloat((t+"").replace(/,/g,"."))})),a.push(l)})),this[n].length>1?a:a[0]}realWidth(e=!1){return this._realDimension("w",e)}realHeight(e=!1){return this._realDimension("h",e)}find(e){const t=[];return this.forEach((a=>{a instanceof HTMLIFrameElement?t.push(a.contentDocument.querySelectorAll(":scope "+e)):t.push(a.querySelectorAll(":scope "+e))})),new r(t)}children(e){const t=[];return e||(e="*"),this.forEach((a=>{t.push(a.querySelectorAll(":scope > "+e))})),new r(t)}_htmlText(e,t){const a=r._isDefined(e);let s=a?this:"";return this.forEach((n=>{a?n[t]=e:s+=n[t]})),s}html(e){return this._htmlText(e,"innerHTML")}text(e){return this._htmlText(e,"innerText")}remove(){this.forEach((e=>{e&&e.parentElement&&(a.delete(e),s.delete(e),e.parentElement.removeChild(e))}))}_moveElement(e,t,a=!0){if(Array.isArray(e))e.forEach((e=>{this._moveElement(e,t,a)}));else{"string"==typeof e&&e.indexOf("<")>-1&&(a=!1);const s=new r(e,a);this.forEach((e=>{r._cloneElement(s).forEach((a=>{switch(t){case"append":e.appendChild(a);break;case"prepend":e.insertBefore(a,e.firstChild);break;case"before":e.parentNode.insertBefore(a,e);break;case"after":e.parentNode.insertBefore(a,e.nextSibling)}}))})),s.remove()}return this}_moveElementTo(e,t){const a=[];return new r(e).forEach((e=>{r._cloneElement(this).forEach((s=>{switch(t){case"append":e.appendChild(s);break;case"prepend":e.insertBefore(s,e.firstChild);break;case"before":e.parentNode.insertBefore(s,e);break;case"after":e.parentNode.insertBefore(s,e.nextSibling)}a.push(s)}))})),this.remove(),new r(a)}append(e,t){return this._moveElement(e,"append",t)}appendTo(e){return this._moveElementTo(e,"append")}prepend(e,t=!0){return this._moveElement(e,"prepend",t)}prependTo(e){return this._moveElementTo(e,"prepend")}before(e,t=!0){return this._moveElement(e,"before",t)}insertBefore(e){return this._moveElementTo(e,"before")}after(e,t=!0){return this._moveElement(e,"after",t)}insertAfter(e){return this._moveElementTo(e,"after")}_nextPrev(e,t){const a=r._isDefined(e),s=[];return this.forEach((n=>{const i="prev"===t?n.previousElementSibling:n.nextElementSibling;r._isDefined(i)&&(!a||r._isDefined(i.matches)&&i.matches(e))&&s.push(i)})),new r(s)}next(e){return this._nextPrev(e,"next")}prev(e){return this._nextPrev(e,"prev")}_siblings(e,t="siblings"){const a=r._isDefined(e),s=[];return this.forEach((n=>{let i=null;const l=[];for("siblings"===t&&n.parentNode.firstElementChild?(i=n.parentNode.firstElementChild,t="next"):"previous"!==t&&"next"!==t||(i=n[t+"ElementSibling"]);i&&i.matches;)i===n||a&&!i.matches(e)||l.push(i),i=i[t+"ElementSibling"];s.push(new r(l))})),this[n].length>1?new r(s):s[0]}siblings(e){return this._siblings(e)}nextAll(e){return this._siblings(e,"next")}prevAll(e){return this._siblings(e,"previous")}parent(e){const t=r._isDefined(e),a=[];return this.forEach((s=>{let n=s.parentNode;!t||r._isDefined(n.matches)&&n.matches(e)||(n=null),a.push(new r(n))})),this[n].length>1?new r(a):a[0]}parents(e){const t=r._isDefined(e),a=[];return this.forEach((s=>{const n=[];let i=s.parentNode;for(;i&&i.matches&&i!==this;)t&&!i.matches(e)||n.push(i),i=i.parentNode;a.push(new r(n))})),this[n].length>1?new r(a):a[0]}document(){const e=[];return this.forEach((t=>{e.push(new r(t.ownerDocument))})),this[n].length>1?new r(e):e[0]}eq(e){return e<0&&(e=this[n].length+e),new r(this[n][e])}get(e){return r._isDefined(e)?(e<0&&(e=this[n].length+e),this[n][e]):this[n]}length(){return this[n].length}}(()=>{const e=e=>new r(e);Object.entries(i).forEach((([t,a])=>{e[t]=a})),window.jsu=e})()})(),window.Colorpicker=(()=>{"use strict";const e={alpha:!1,classes:{picker:"color-picker",preview:"color-preview",pickingArea:"picking-area",pickingAreaThumb:"picker",hueSlider:"hue",hueSliderThumb:"slider-picker",alphaSlider:"alpha",alphaSliderThumb:"slider-picker",inputFieldPreview:"input-",visible:"visible"}};function t(){this.r=0,this.g=0,this.b=0,this.a=1,this.hue=0,this.saturation=0,this.value=0;const e=e=>"number"==typeof e&&!1===isNaN(e),t=(t,a,s,n)=>{e(t)&&e(a)&&e(s)&&(this.r=Math.max(0,Math.min(255,Math.trunc(t))),this.g=Math.max(0,Math.min(255,Math.trunc(a))),this.b=Math.max(0,Math.min(255,Math.trunc(s))),!0===e(n)&&(this.a=Math.max(0,Math.min(1,n))))},a=e=>{/(^#{0,1}[0-9A-F]{6}$)|(^#{0,1}[0-9A-F]{3}$)/i.test(e)&&("#"===e[0]&&(e=e.slice(1,e.length)),3===e.length&&(e=e.replace(/([0-9A-F])([0-9A-F])([0-9A-F])/i,"$1$1$2$2$3$3")),this.r=parseInt(e.substring(0,2),16),this.g=parseInt(e.substring(2,4),16),this.b=parseInt(e.substring(4,6),16),this.a=1,n())},s=()=>{const e=this.saturation/100,a=this.value/100;let s=e*a;const n=this.hue/60;let i=s*(1-Math.abs(n%2-1)),r=a-s;s=Math.trunc(255*(s+r)),i=Math.trunc(255*(i+r)),r=Math.trunc(255*r),n>=0&&n<1?t(s,i,r):n>=1&&n<2?t(i,s,r):n>=2&&n<3?t(r,s,i):n>=3&&n<4?t(r,i,s):n>=4&&n<5?t(i,r,s):n>=5&&n<6&&t(s,r,i)},n=()=>{const e=this.r/255,t=this.g/255,a=this.b/255,s=Math.max(e,t,a),n=s-Math.min(e,t,a);let i=0,r=0;n&&(s===e&&(i=(t-a)/n),s===t&&(i=2+(a-e)/n),s===a&&(i=4+(e-t)/n),s&&(r=n/s)),this.hue=Math.trunc(60*i),this.hue<0&&(this.hue+=360),this.saturation=Math.trunc(100*r),this.value=Math.trunc(100*s)};this.setFromRaw=e=>{"transparent"===(e=e.trim())?(this.r=0,this.g=0,this.b=0,this.a=0,n()):/(^#{0,1}[0-9A-F]{6}$)|(^#{0,1}[0-9A-F]{3}$)/i.test(e)?a(e):/^rgba?\([^)]+\)$/i.test(e)&&(e=>{const a=e.match(/(\d*\.\d*|\d+)/g);3===a.length&&a.push(1),4===a.length&&(t(...a.map((e=>+e))),n())})(e)},this.setByName=(t,a)=>{if(("r"===t||"g"===t||"b"===t||"a"===t)&&e(a)){let e=1;"a"!==t&&(a=Math.trunc(a),e=255),this[t]=Math.max(0,Math.min(e,a)),n()}},this.setHSV=(t,a,n)=>{e(t)&&e(a)&&e(n)&&(this.hue=Math.max(0,Math.min(360,t)),this.saturation=Math.max(0,Math.min(100,a)),this.value=Math.max(0,Math.min(100,n)),s())},this.setHue=t=>{e(t)&&(this.hue=Math.max(0,Math.min(360,t)),s())},this.getHex=()=>{let e=this.r.toString(16),t=this.g.toString(16),a=this.b.toString(16);this.r<16&&(e="0"+e),this.g<16&&(t="0"+t),this.b<16&&(a="0"+a);return("#"+e+t+a).toLowerCase()},this.getColor=()=>{if(1===Math.trunc(this.a))return this.getHex();const e="("+this.r+","+this.g+","+this.b;let t="",a="";const s=parseFloat(this.a);return 1!==s&&(t="a",a=","+s),"rgb"+t+e+a+")"}}return function(a,s){let n=null,i=null,r=null;const l=[],o={};this.color=new t;const c=t=>{const a=(e,t)=>{for(const s of Object.keys(t))t[s]instanceof Object&&Object.assign(t[s],a(e[s],t[s]));return Object.assign(e||{},t),e};return a(Object.assign({},e),t||{})},d=(e,t)=>{e.addEventListener("mousedown",(e=>{t(e),document.addEventListener("mousemove",t)})),document.addEventListener("mouseup",(()=>{document.removeEventListener("mousemove",t)}))},p=()=>{n=document.createElement("div"),n.className=s.classes.picker,document.body.appendChild(n),i=document.createElement("span"),i.className=s.classes.preview,a.parentNode.insertBefore(i,a.nextSibling),a.ownerDocument.defaultView.addEventListener("resize",(()=>{this.reposition()})),i.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),this.show()})),document.addEventListener("click",(e=>{e.target===n||n.contains(e.target)||this.close()}))},h=()=>{const e=document.createElement("div"),t=document.createElement("div");e.className=s.classes.pickingArea,t.className=s.classes.pickingAreaThumb,this.pickingArea=e,this.colorPicker=t,d(e,(e=>{const t=this.pickingArea.getBoundingClientRect(),a=this.pickingArea.clientWidth,s=[e.pageX-t.left,e.pageY-t.top];s.forEach(((e,t)=>{e>a&&(e=a),e<0&&(e=0),s[t]=e}));const n=Math.trunc(100*s[0]/a),i=100-Math.trunc(100*s[1]/a);this.color.setHSV(this.color.hue,n,i),this.colorPicker.style.left=s[0]-5+"px",this.colorPicker.style.top=s[1]-5+"px",w(),x(),_()})),e.appendChild(t),n.appendChild(e)},m=()=>{const e=document.createElement("div"),t=document.createElement("div");e.className=s.classes.hueSlider,t.className=s.classes.hueSliderThumb,this.hueArea=e,this.huePicker=t,d(e,(e=>{const t=this.hueArea.getBoundingClientRect();let a=Math.max(0,e.pageX-t.left);const s=this.hueArea.clientWidth;a>s&&(a=s),this.huePicker.style.left=Math.max(a-3,-2)+"px",this.color.setHue(Math.trunc(359*a/s)),f()})),e.appendChild(t),n.appendChild(e)},g=()=>{const e=document.createElement("div"),t=document.createElement("div"),a=document.createElement("div");e.className=s.classes.alphaSlider,a.className=s.classes.alphaSliderThumb,r={area:e,mask:t,picker:a},d(e,(e=>{const t=r.area.getBoundingClientRect();let a=e.pageX-t.left;const s=r.area.clientWidth;a<0&&(a=0),a>s&&(a=s),this.color.setByName("a",+(a/s).toFixed(2)),r.picker.style.left=Math.max(a-3,-2)+"px",x(),_()})),e.appendChild(t),t.appendChild(a),n.appendChild(e)},u=(e,t)=>{const a=document.createElement("div"),i=document.createElement("input"),r=document.createElement("span");a.className=s.classes.inputFieldPreview+e,r.textContent=e,i.setAttribute("type","text"),a.appendChild(r),a.appendChild(i),n.appendChild(a),i.addEventListener("change",t),l[e]=e=>{i.value=e}},f=()=>{_(),b(),k(),v(),y(),w(),x()},v=()=>{const e=this.pickingArea.clientWidth,t=this.color.value,a=Math.trunc(this.color.saturation*e/100),s=e-Math.trunc(t*e/100);this.colorPicker.style.left=a-5+"px",this.colorPicker.style.top=s-5+"px"},b=()=>{const e=this.hueArea.clientWidth,t=Math.trunc(this.color.hue*e/360);this.huePicker.style.left=t-1+"px"},y=()=>{if(r){const e=r.area.clientWidth,t=1,a=Math.trunc(this.color.a*e);r.picker.style.left=a-t+"px"}},k=()=>{const e=new t;e.setHSV(this.color.hue,100,100),this.pickingArea.style.backgroundColor=e.getHex()},w=()=>{r&&(r.mask.style.background="linear-gradient(to right, transparent 0%,"+this.color.getHex()+" 100%)")},x=()=>{a.value=this.color.getColor(),i.style.backgroundColor=this.color.getColor(),C("change")},C=e=>{void 0!==o[e]&&o[e].forEach((e=>{e({color:this.color.getColor(),colorObj:this.color,elm:this.getElements()})}))},_=()=>{E("r",this.color.r),E("g",this.color.g),E("b",this.color.b),E("a",this.color.a),E("color",this.color.getColor())},E=(e,t)=>{l[e]&&l[e](t)};this.setColor=e=>{this.color.setFromRaw(e),f()},this.getColorObj=()=>this.color,this.getElements=()=>({wrapper:n,preview:i,field:a}),this.reposition=()=>{if(n.classList.contains(s.classes.visible)){const e="rtl"===document.documentElement.getAttribute("dir"),t=i.getBoundingClientRect(),a={l:t.left,r:t.left-n.offsetWidth+i.offsetWidth},s=["bottom",e?"right":"left"];let r=t.top+i.offsetHeight,l=a[e?"r":"l"];n.offsetHeight+r>window.innerHeight&&(r=t.top-n.offsetHeight,s[0]="top"),n.offsetWidth+l>window.innerWidth&&(l=a.r,s[1]="right"),l<0&&(l=a.l,s[1]="left"),n.setAttribute("data-pos",s.join("-")),n.style.top=r+"px",n.style.left=l+"px"}},this.show=()=>{[].forEach.call(document.getElementsByClassName(s.classes.picker),(e=>{e.classList.remove(s.classes.visible)})),n.classList.add(s.classes.visible),this.reposition(),C("show"),f()},this.close=()=>{n.classList.contains(s.classes.visible)&&(C("hide"),n.classList.remove(s.classes.visible))},this.on=(e,t)=>{void 0===o[e]&&(o[e]=[]),o[e].push(t)},(()=>{s=c(s),p(),h(),m();const e=["r","g","b"];s.alpha&&(g(),e.push("a")),e.forEach((e=>{u(e,(t=>{let a=t.target.value;a="a"===e?+a.replace(/,/g,"."):parseInt(a),this.color.setByName(e,a),t.target.value=this.color[e],f()}))})),u("color",(e=>{const t=e.target.value;this.color.setFromRaw(t),f()})),f()})()}})(),(e=>{"use strict";e.api=chrome,e.opts={ids:{page:{iframe:"redeviation-bs-sidebar",overlay:"redeviation-bs-overlay",newtab:"redeviation-bs-newtab",indicator:"redeviation-bs-indicator"},sidebar:{sidebar:"sidebar",infoBox:"infoBox",bookmarkBox:{all:"bookmarkBox",search:"bookmarkBoxSearch"}},overlay:{urlCheckResult:"results"}},classes:{active:"active",visible:"visible",hidden:"hidden",disabled:"disabled",success:"success",selected:"selected",premium:"premium",error:"error",info:"info",add:"add",cancel:"cancel",close:"close",hover:"hover",loading:"loading",building:"building",initLoading:"initLoading",page:{dark:"dark",visible:"redeviation-bs-visible",hideMask:"redeviation-bs-hideMask",hover:"redeviation-bs-hover",noscroll:"redeviation-bs-noscroll",hasLeftsideBack:"redeviation-bs-has-lsb",style:"redeviation-bs-style",fullHeight:"redeviation-bs-fullHeight",noAnimations:"noAnimations",highContrast:"highContrast"},sidebar:{extLoaded:"loaded",selectionMode:"selectionMode",openedOnce:"openedOnce",sidepanel:"sidepanel",permanent:"permanent",cached:"cached",mark:"mark",hideRoot:"hideRoot",dirAnimated:"animated",dirOpened:"opened",dirArrow:"has-arrow",bookmarkDir:"dir",dirIcon:"icon",separator:"separator",bookmarkLink:"link",bookmarkLabel:"label",entryPinned:"pinned",menu:"menu",sort:"sort",fixed:"fixed",lockPinned:"lockPinned",lastHover:"lastHover",copied:"copied",filterBox:"filter",search:"search",searchBox:"searchBox",searchClose:"searchClose",searchVisible:"searchVisible",breadcrumb:"breadcrumb",removeSelected:"removeSelected",openSelected:"openSelected",removeMask:"removeMask",removed:"removed",restored:"restored"},tooltip:{wrapper:"tooltip"},contextmenu:{wrapper:"contextmenu",top:"top",list:"list",icons:"icons",right:"right",separator:"separator"},drag:{trigger:"drag",helper:"dragHelper",isDragged:"isDragged",cancel:"dragCancel",dragHover:"dragHover",snap:"snap",dragInitial:"dragInitial"},scrollBox:{wrapper:"scrollBox",hideScrollbar:"hideScrollbar",scrolled:"scrolled"},checkbox:{box:"checkbox",clicked:"clicked",focus:"focus"},overlay:{modal:"modal",preview:"preview",previewUrl:"previewUrl",action:"action",progressBar:"progressBar",buttonWrapper:"buttons",checkUrlProgressLabel:"progressLabel",urlCheckLoading:"urlCheckLoading",urlCheckCategories:"categories",urlCheckAction:"urlCheckAction",urlCheckHide:"urlCheckHide",urlCheckResults:"urlCheckResults"},newtab:{customBackground:"customBackground",smallContent:"small",suggestions:"suggestions",edit:"edit",link:"link",editLinkTooltip:"editLinkTooltip",permanentSidebar:"permanentSidebar",listening:"listening",remove:"remove",infoBar:"infoBar",upload:"upload",save:"save"},onboarding:{slide:"slide",skip:"skip",close:"close",settings:"settings",toggleArea:"toggleArea",appearance:"appearance",finished:"finished",highlightIcon:"highlightIcon",hideOpenTypeIcon:"hideOpenType",video:"video",large:"large",small:"small"},settings:{tabs:{content:"tab"},color:{field:"color",mask:"colorMask"},radio:{wrapper:"radioWrapper"},translation:{select:"languageSelect",category:"category",thanks:"thanks",edit:"edit",progress:"progress",mark:"mark",requiredInfo:"requiredInfo",amountInfo:"amountInfo",empty:"empty",back:"back",goto:"goto"},toggleArea:{fullHeight:"fullHeight",dragged:"dragged",dragging:"dragging"},appearance:{preview:{fullHeight:"redeviation-bs-fullHeight"}},support:{onlySuggestions:"onlySuggestions",answer:"answer",noHeight:"noHeight",absolute:"absolute"},hideable:"hideable",inactive:"inactive",revert:"revert",highlight:"highlight",lazyloaded:"lazyloaded",sub:"sub",desc:"desc",box:"box",dialog:"dialog",boxWrapper:"boxWrapper",contentBox:"contentBox",incomplete:"incomplete",suggestion:"suggestion"}},attr:{uid:"data-redeviation-bs-uid",src:"data-src",position:"data-pos",type:"data-type",name:"data-name",value:"data-value",theme:"data-theme",sort:"data-sort",direction:"data-direction",style:"data-style",id:"data-id",i18n:"data-i18n",i18nReplaces:"data-i18nReplaces",onboarding:{openType:"data-openType",surface:"data-surface"},settings:{appearance:"data-appearance",success:"data-successtext",hideOnFalse:"data-hideOnFalse",save:"data-save",restore:"data-restore",range:{min:"data-min",max:"data-max",step:"data-step",unit:"data-unit",infinity:"data-infinity"},color:{alpha:"data-alpha",suggestions:"data-suggestions"},field:{placeholder:"data-placeholder"},translation:{releaseStatus:"data-status",language:"data-lang"}}},events:{loaded:"redeviation-bs-loaded",elementsCreated:"redeviation-bs-created",openSidebar:"redeviation-bs-sidebar-open",sidebarOpened:"redeviation-bs-sidebar-opened",overlayClosed:"redeviation-bs-overlay-closed",systemColorChanged:"redeviation-bs-system-color-changed",checkboxChanged:"redeviation-bs-checkbox-changed",scrollBoxLastPart:"redeviation-bs-scrollbox-lastpart",premiumPurchased:"redeviation-bs-premiumPurchased",showFeedbackForm:"redeviation-bs-feedback",lsbLoaded:"redeviation-lsb-loaded",pageChanged:"redeviation-bs-pageChanged"},website:{info:{landing:"https://extensions.redeviation.com/",privacyPolicy:"https://extensions.redeviation.com/privacy/bs",changelog:"https://extensions.redeviation.com/changelog/bs",uninstall:"https://extensions.redeviation.com/uninstall/bs"},premium:{checkout:"https://extensions.redeviation.com/premium/bs/checkout",checkLicenseKey:"https://extensions.redeviation.com/ajax/premium/bs/check"},feedback:{form:"https://extensions.redeviation.com/ajax/feedback",suggestions:"https://extensions.redeviation.com/ajax/feedback/suggestions"},translation:{info:"https://extensions.redeviation.com/ajax/translation/bs/info",langvars:"https://extensions.redeviation.com/ajax/translation/bs/langvars",submit:"https://extensions.redeviation.com/ajax/translation/bs/submit"},api:{checkStatus:"https://extensions.redeviation.com/ajax/status/bs",evaluate:"https://extensions.redeviation.com/api/evaluate/log"}},urlAliases:{Edge:{"chrome://newtab/":"edge://newtab/","chrome://bookmarks":"edge://favorites","chrome://extensions/shortcuts":"edge://extensions/shortcuts","chrome://settings/syncSetup":"edge://settings/profiles/sync","https://extensions.redeviation.com/img/illustration/video_sidepanel.mp4":"https://extensions.redeviation.com/img/illustration/edge/video_sidepanel.mp4","https://extensions.redeviation.com/img/illustration/video_overlay.mp4":"https://extensions.redeviation.com/img/illustration/edge/video_overlay.mp4"},Opera:{"chrome://newtab/":"chrome://startpageshared/","chrome://bookmarks":"opera://bookmarks","chrome://extensions/shortcuts":"opera://settings/keyboardShortcuts"}},leftsideBackSelector:"div#redeviation-lsb-indicator.redeviation-lsb-visible",manifest:e.api.runtime.getManifest(),demoMode:!1},e.isDev="Dev"===e.opts.manifest.version_name||!("update_url"in e.opts.manifest),e.copyrightDate=2016,e.browserName="Chrome",/EDG\//i.test(navigator.userAgent)?e.browserName="Edge":/OPERA|OPR\//i.test(navigator.userAgent)?e.browserName="Opera":/FIREFOX\//i.test(navigator.userAgent)&&(e.api=browser,e.browserName="Firefox"),e.cl=e.opts.classes,e.attr=e.opts.attr,e.I18nHelper=function(t){let a=null,s={},n=null;this.init=async()=>{const e=await t.helper.model.call("langvars");a=e.language,s=e.vars,n=e.dir},this.getLanguage=()=>a,this.isRtl=()=>"rtl"===n,this.getUILanguage=()=>e.api.i18n.getUILanguage(),this.getDefaultLanguage=()=>e.opts.manifest.default_locale,this.getLocaleSortCollator=()=>new Intl.Collator([this.getUILanguage(),this.getDefaultLanguage()]),this.getLocaleDate=e=>("number"==typeof e&&(e=new Date(e)),e.toLocaleDateString([this.getUILanguage(),this.getDefaultLanguage()],{year:"numeric",month:"2-digit",day:"2-digit"})),this.parseHtml=t=>{e(t).find("["+e.attr.i18n+"]").forEach((t=>{let a=null;const s=e(t).attr(e.attr.i18n);if(s){let n=[];const i=e(t).attr(e.attr.i18nReplaces);i&&(n=i.split(",")),a=this.get(s,n)}a?(e(t).removeAttr(e.attr.i18n),e(t).html(a)):e(t).remove()}))},this.get=(t,a=[],n=!1)=>{let i="";const r=s[t];return r&&r.message&&(i=r.message,i=i.replace(/\{browserName\}/gi,e.browserName),a&&a.length>0&&a.forEach(((e,t)=>{i=i.replace(new RegExp("\\{"+(t+1)+"\\}"),e)})),i=i.replace(/\[b\](.*)\[\/b\]/,"<strong>$1</strong>"),i=i.replace(/\[a\](.*)\[\/a\]/,"<a href='#'>$1</a>"),i=i.replace(/\[em\](.*)\[\/em\]/,"<em>$1</em>")),n&&(i=i.replace(/'/g,"&#x27;")),i}},e.FontHelper=function(e){const t={general:{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:400,Bold:500,ExtraBold:500,Black:500},fa:{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:500,Bold:600,ExtraBold:600,Black:600},ar:{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:500,Bold:600,ExtraBold:600,Black:600},he:{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:500,Bold:600,ExtraBold:600,Black:600},ja:{Thin:100,ExtraLight:100,Light:100,Normal:200,Medium:300,SemiBold:400,Bold:500,ExtraBold:500,Black:500},zh_CN:{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:400,Bold:400,ExtraBold:500,Black:500},zh_TW:{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:400,Bold:400,ExtraBold:500,Black:500}};this.getFontWeights=()=>{const a=e.helper.i18n.getLanguage();let s={...t.general};t[a]&&(s={...t[a]});const n={};for(const e in s)n["fontWeight"+e]=s[e];return n}},e.StylesheetHelper=function(t){const a=["overlay","sidebar","content"],s=[];let n="",i="",r=!1;this.init=e=>{e&&e.defaultVal&&!0===e.defaultVal&&(r=!0),i=t.helper.model.getData("a/theme"),n=t.helper.model.getData("u/customCss");const a=t.helper.model.getData("a/surface");window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(async()=>{const e=this.getSystemSurface();if(t.helper.model.call("systemColorChanged",{surface:e}),t.helper.utility&&t.helper.utility.triggerEvent("systemColorChanged",e),"auto"===a)for(const e of s)await l(e.files,e.head,!0)}));const o=this.getSystemSurface();t.helper.model.call("systemColorChanged",{surface:o})},this.getSystemSurface=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",this.getStylesheetFilesWithThemes=e=>{const t=e;return i&&"default"!==i&&e.forEach((e=>{a.includes(e)&&t.push("themes/"+i+"/"+e)})),t},this.addStylesheets=async(a,s=null)=>{null===s?s=e(document):e.cl&&e.cl.page&&!1===t.helper.model.getData("b/animations")&&e.cl.page.noAnimations&&s.find("body").addClass(e.cl.page.noAnimations);let n=null;n=0===s.find("head").length()?s.find("body"):s.find("head"),await l(a,n)};const l=async(a,i,l=!1)=>{!1===l&&s.push({files:a,head:i});const o=t.helper.model.getData("a/styles",r),c=this.getStylesheetFilesWithThemes(a);for(const t of c){const a=await e.xhr(e.api.runtime.getURL("css/"+t+".css"),{mimeType:"text/css"});if(a.response){let s=a.response;s+=n,Object.keys(o).forEach((e=>{s=s.replace(new RegExp('"?%'+e+'"?',"g"),o[e])})),e.cl&&e.cl.page&&e.cl.page.style&&e.attr&&e.attr.name?(i.find("style."+e.cl.page.style+"["+e.attr.name+"='"+t+"']").remove(),i.append("<style class='"+e.cl.page.style+"' "+e.attr.name+"='"+t+"'>"+s+"</style>")):i.append("<style>"+s+"</style>")}}}},e.TemplateHelper=function(t){this.loading=()=>e('<svg class="loading" width="36px" height="36px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg"><circle fill="none" stroke-width="3" stroke-linecap="round" cx="18" cy="18" r="16"></circle></svg>'),this.overlay=(a,s)=>{const n={},i=t.helper.model.getData(["a/theme","b/animations","a/surface","a/highContrast"]);n.overlay=e("<iframe></iframe>").attr("id",e.opts.ids.page.overlay).addClass("notranslate").attr("aria-hidden","true").attr(e.attr.theme,i.theme).appendTo("body"),t.helper.stylesheet.addStylesheets(["overlay"],n.overlay);const r=n.overlay.find("body");r.attr(e.attr.theme,i.theme).attr("aria-hidden","true"),r.parent("html").attr("dir",t.helper.i18n.isRtl()?"rtl":"ltr"),n.modal=e("<div></div>").attr(e.attr.type,a).addClass(e.cl.overlay.modal).appendTo(r),!1===i.animations&&n.overlay.addClass(e.cl.page.noAnimations),"sidepanel"===t.helper.utility.getPageType()&&(n.modal.addClass(e.cl.sidebar.sidepanel),n.overlay.addClass(e.cl.sidebar.sidepanel)),"dark"===i.surface||"auto"===i.surface&&"dark"===t.helper.stylesheet.getSystemSurface()?r.addClass(e.cl.page.dark):i.highContrast&&r.addClass(e.cl.page.highContrast);const l=e("<header></header>").appendTo(n.modal);return e("<h1></h1>").text(s).appendTo(l),e("<a></a>").addClass(e.cl.close).appendTo(l),n.buttonWrapper=e("<menu></menu>").addClass(e.cl.overlay.buttonWrapper).appendTo(n.modal),e("<a></a>").addClass(e.cl.close).appendTo(n.buttonWrapper),n.overlay[0].focus(),e.delay(100).then((()=>{n.modal.addClass(e.cl.visible),n.overlay.addClass(e.cl.page.visible)})),n}},e.UtilityHelper=function(t){this.openUrl=async(e,a="default",s=!0)=>{if(t.helper.model.setData({"u/lastOpened":e.id}),"incognito"===a)await t.helper.model.call("openLink",{href:e.url,incognito:!0});else if("newWindow"===a)await t.helper.model.call("openLink",{id:e.id,href:e.url,newWindow:!0});else{const n="newTab"===a;e.url.startsWith("javascript:")&&!1===n?location.href=e.url:await t.helper.model.call("openLink",{parentId:e.parentId,id:e.id,href:e.url,newTab:"newTab"===a,position:t.helper.model.getData("b/newTabPosition"),active:s})}},this.openAllBookmarks=async e=>{const a=t.helper.model.getData("b/newTabPosition");"afterCurrent"!==a&&"beforeFirst"!==a||e.reverse();for(const t of e)await this.openUrl(t,"newTab",!1)},this.triggerEvent=(t,a={},s=null)=>{(s||document).dispatchEvent(new CustomEvent(e.opts.events[t],{detail:a,bubbles:!0,cancelable:!1}))},this.copyToClipboard=a=>{const s=e("<textarea></textarea>").text(a).appendTo(t.elm.iframeBody);s[0].select();let n=!1;try{n=t.elm.iframeDocument[0].execCommand("copy")}catch(e){}return s.remove(),n},this.isUrlOnBlacklist=e=>{if(!e||0===e.trim().length)return!0;let t=!1;return["about:","https?://192.168.","192.168.","https?://localhost","localhost","https?://127.0.0.","127.0.0.","javascript:","file://","chrome://","edge://","extension://","chrome-extension://"].some((a=>{if(0===e.search(new RegExp(a,"gi")))return t=!0,!0})),t},this.getSortList=()=>({custom:{dir:"ASC"},alphabetical:{dir:"ASC"},url:{dir:"ASC"},mostUsed:{dir:"DESC"},recentlyUsed:{dir:"DESC"},recentlyAdded:{dir:"DESC"}}),this.capitalizeFirstLetter=e=>e.charAt(0).toUpperCase()+e.slice(1),this.sortEntries=(e,a)=>{if(e.length>1){const s=t.helper.i18n.getLocaleSortCollator(),n=(t,s)=>{e.sort(((e,n)=>{const i=!!e.children,r=!!n.children;return"custom"!==a.name&&i!==r?i?-1:1:(t===a.dir?1:-1)*s(e,n)}))};switch(a.name){case"custom":n("ASC",((e,t)=>e.index-t.index));break;case"alphabetical":n("ASC",((e,t)=>s.compare(e.title,t.title)));break;case"url":n("ASC",((e,t)=>{if(!e.url||!t.url)return e.index-t.index;const a=e.url.replace(/^https?:\/\//,"").replace(/^www\./,""),n=t.url.replace(/^https?:\/\//,"").replace(/^www\./,"");return s.compare(a,n)}));break;case"recentlyAdded":n("DESC",((e,t)=>t.dateAdded-e.dateAdded));break;case"mostUsed":{const e=t.helper.model.getData("u/mostViewedPerMonth");n("DESC",((a,n)=>{const i=t.helper.entry.getDataById(a.id),r=t.helper.entry.getDataById(n.id),l=i?i.views[e?"perMonth":"total"]:0,o=r?r.views[e?"perMonth":"total"]:0;return l===o?s.compare(a.title,n.title):o-l}));break}case"recentlyUsed":n("DESC",((e,a)=>{const n=t.helper.entry.getDataById(e.id),i=t.helper.entry.getDataById(a.id),r=n?n.views.lastView:0,l=i?i.views.lastView:0;return r===l?s.compare(e.title,a.title):l-r}))}}},this.getIconImageData=async e=>{const a=await t.helper.model.call("iconImageData",{name:e.shape,color:e.color,padding:e.padding,background:e.background});if(a){const e=document.createElement("canvas");e.width=128,e.height=128;const t=e.getContext("2d"),s=t.createImageData(128,128);for(const e in s.data)s.data[e]=a.data[e];return t.putImageData(s,0,0),e.toDataURL("image/x-icon")}return""},this.isWindowed=()=>window.screenX>100||window.screenY>50||Math.abs(window.screen.availWidth-window.innerWidth)>50||window.navigator&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent&&window.navigator.userAgent.search(/[/\s-_]mobile[/\s-_]/i)>-1,this.isWebapp=()=>window.matchMedia("(display-mode: standalone)").matches,this.getPageType=()=>{const t=location.href;let a="other",s=!1;return Object.entries({newtab_default:["https?://www\\.google\\..+/_/chrome/newtab"],newtab_fallback:[e.api.runtime.getURL("html/newtab.html")+".*[?&]type=\\w+"],newtab_replacement:[e.api.runtime.getURL("html/newtab.html")],sidepanel:[e.api.runtime.getURL("html/sidepanel.html")],newtab_website:[".*[?&]bs_nt=1(&|#|$)"],website:["https?://"],onboarding:["chrome\\-extension://.*/intro.html","extension://.*/intro.html"],chrome:["chrome://","edge://"],extension:["chrome\\-extension://","extension://"],local:["file://"]}).some((([e,n])=>{if(n.some((n=>{if(0===t.search(new RegExp(n,"gi")))return a=e,s=!0,!0})),s)return!0})),a}},e.ModelHelper=function(t){const a={default:{textColor:{light:"#646464",dark:"#c8c8c8"},bookmarksDirColor:{light:"#646464",dark:"#c8c8c8"},sidebarMaskColor:{light:"rgba(255, 255, 255, 0.8)",dark:"rgba(0, 0, 0, 0.6)"},overlayMaskColor:{light:"rgba(0, 0, 0, 0.5)",dark:"rgba(0, 0, 0, 0.5)"},hoverColor:{light:"#f5f5f5",dark:"#555555"},colorScheme:{light:"#1b82f1",dark:"#1f4d80"},foregroundColor:{light:"#ffffff",dark:"#333333"},icon:{forLight:"#555555",forDark:"#ffffff"}},glass:{sidebarMaskColor:{light:"rgba(0, 0, 0, 0)",dark:"rgba(0, 0, 0, 0)"},overlayMaskColor:{light:"rgba(255, 255, 255, 0.5)",dark:"rgba(0, 0, 0, 0.3)"},textColor:{light:"#444444",dark:"#dfdfdf"},bookmarksDirColor:{light:"#444444",dark:"#dfdfdf"},hoverColor:{light:"rgba(0, 0, 0, 0.05)",dark:"rgba(255, 255, 255, 0.1)"}}},s=["textColor","hoverColor","sidebarMaskColor","bookmarksDirColor","overlayMaskColor"],n={u:{openStates:{},hiddenEntries:{},additionalInfo:{},scrollPos:0,separators:{},customCss:"",pinnedEntries:{},lockPinned:!0,translationHelp:!0,translationThanked:!1,entryAmounts:{},linkcheckerIgnored:{},lastOpened:null,sort:{name:"custom",dir:"ASC"},mostViewedPerMonth:!1,viewAsTree:!0},b:{overlayEnabled:!0,animations:!0,preventPageScroll:!1,toggleArea:{width:2,widthWindowed:20,height:100,top:0},blacklist:[],whitelist:[],sidebarPosition:"left",iconAction:"sidepanel",openAction:"mousedown",newTab:"foreground",newTabPosition:"afterCurrent",visibility:"always",linkAction:"current",dirAccordion:!1,preventWindowed:!1,preventWebapp:!1,rememberState:"openStatesAndPos",rememberOpenStatesSubDirectories:!0,newEntryPosition:"append",tooltipDelay:.5,tooltipContent:"all",tooltipAdditionalInfo:!0,dndCreationDialog:!1,closeOnTabChange:!0,openChildrenWarnLimit:10,dirOpenDuration:.4,scrollBarHide:1.5,openDelay:0,closeTimeout:1,dndOpenDirDelay:.5,refocusWebsite:!1},a:{theme:"default",showIndicator:!0,showIndicatorIcon:!0,surface:"light",highContrast:!1,directoryArrows:!1,showBookmarkIcons:!0,showDirectoryIcons:!0,devModeIconBadge:!0,styles:{colorScheme:a.default.colorScheme.light,foregroundColor:a.default.foregroundColor.light,textColor:null,hoverColor:null,indicatorWidth:"24px",indicatorIconSize:"24px",indicatorIconColor:"#ffffff",indicatorColor:"rgba(0,0,0,0.5)",iconShape:"bookmark",iconColor:"auto",sidebarWidth:"350px",sidebarHeaderHeight:"50px",sidebarMaskColor:null,bookmarksFontSize:"14px",directoriesIconSize:"16px",bookmarksIconSize:"16px",bookmarksLineHeight:"38px",bookmarksDirIcon:"dir-1",bookmarksDirColor:null,bookmarksDirIndentation:"25px",bookmarksHorizontalPadding:"16px",scrollBarWidth:"11px",tooltipFontSize:"9px",overlayMaskColor:null,overlayHeaderHeight:"50px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',backgroundTransparency:.8,backgroundBlur:"7px"}},n:{override:!1,faviconShape:"new-1",faviconColor:"#545454",faviconBackground:"transparent",faviconPadding:10,autoOpen:!0,focusOmnibox:!1,searchSuggestQueries:!0,searchSuggestBookmarks:!0,searchSuggestHistory:!0,searchField:"show",searchEngine:"google",searchEngineCustom:{title:"",homepage:"",queryUrl:""},gridType:"topPages",gridMaxCols:4,gridMaxRows:2,customGridLinks:[],topLinks:[],topLinksPosition:"right",website:"",searchSuggestionNextKeys:["ArrowDown","Tab"],searchSuggestionPrevKeys:["ArrowUp","Tab"]}};let i={},r=null;this.init=async()=>{await l()};const l=async()=>{if(!e.api.storage)return;const t=["utility","behaviour","appearance","newtab"],a={};for(const s of t){const t=await e.api.storage["utility"===s?"local":"sync"].get([s]);a[s]=t[s]||{}}if(i=a,null===r){const e=await this.call("userType");e&&e.userType&&(r=e.userType)}},o=e=>{switch(e){case"u":return"utility";case"b":return"behaviour";case"a":return"appearance";case"n":return"newtab"}return null};this.getUserType=()=>r,this.getAllData=()=>i,this.getSurfaceColorDependentStyles=()=>s,this.getDefaultData=()=>{const e={};return Object.entries(n).forEach((([t,a])=>{const s=o(t);s&&(e[s]=a)})),e},this.getDefaultColors=(e="default")=>Object.assign({},a.default,a[e]),this.getData=(e,r=!1)=>{let l=e;"string"==typeof l&&(l=[l]);let c={};if(l.forEach((e=>{const l=e.split("/")[0],d=e.split("/")[1];let p=null;const h=o(l);if(h&&i[h]&&(!0===r||void 0===i[h][d]?void 0!==n[l]&&void 0!==n[l][d]&&(p=n[l][d]):p=i[h][d]),"a/styles"===e){const e=this.getData("a/surface"),i="auto"===e?t.helper.stylesheet.getSystemSurface():e,r=this.getData("a/theme");p=Object.assign({},n.a.styles,p);for(const t of s)null!==p[t]&&"auto"!==e||(a[r]&&a[r][t]?p[t]=a[r][t][i]:p[t]=a.default[t][i]);"auto"!==e||p.colorScheme!==a.default.colorScheme.light&&p.colorScheme!==a.default.colorScheme.dark||(p.colorScheme=a.default.colorScheme[i]),t.helper.font&&Object.assign(p,t.helper.font.getFontWeights())}c[d]=p})),"string"==typeof e){const t=e.split("/")[1];c=c[t]}return c},this.setData=t=>new Promise((a=>{l().then((()=>{Object.keys(t).forEach((e=>{const a=e.split("/")[0],s=e.split("/")[1],n=t[e];switch(a){case"u":i.utility[s]=n;break;case"b":i.behaviour[s]=n;break;case"a":i.appearance[s]=n;break;case"n":i.newtab[s]=n}}));let s=0;const n=(e=1)=>{s+=e,s>=4&&a()};try{e.api.storage.local.set({utility:i.utility},(()=>{e.api.runtime.lastError,n()})),e.api.storage.sync.set({behaviour:i.behaviour,appearance:i.appearance,newtab:i.newtab},(()=>{e.api.runtime.lastError,n(3)}))}catch(e){a()}}))})),this.call=async(t,a={},s=0)=>{let n=!1;a.type=t;let i=await e.api.runtime.sendMessage(a).catch((e=>{e&&(""+e).includes("Could not establish connection")?n=!0:console.error(e)}));return n&&s<50&&(await e.delay(100),i=await this.call(t,a,s+1)),i}},e.CheckboxHelper=function(t){const a={};this.get=(t,a,s="checkbox",n="default")=>{const i=e("<div></div>").html("<input type='checkbox' />").data("uid",Math.random().toString(36).substring(2,14)).attr(e.attr.type,s).attr(e.attr.style,n).addClass(e.cl.checkbox.box);return a&&(i.children("input[type='checkbox']").attr(a),a[e.attr.name]&&i.attr(e.attr.name,a[e.attr.name])),this.isChecked(i)&&i.addClass(e.cl.active),this.initEvents(i,t),i},this.initEvents=(t,a)=>{t.on("mousedown",(t=>{t.preventDefault(),t.stopPropagation(),e(t.currentTarget).addClass(e.cl.checkbox.focus)})).on("click",(t=>{t.preventDefault(),t.stopPropagation(),n(e(t.currentTarget),a)})),a.on("click",(()=>{t.removeClass(e.cl.checkbox.focus)}))},this.isChecked=e=>e.find("input[type='checkbox']")[0].checked;const s=(a,s)=>{const n=a.children("input[type='checkbox']");n.trigger("change"),t.helper.utility&&t.helper.utility.triggerEvent("checkboxChanged",{container:a,checkbox:n,checked:a.hasClass(e.cl.active)},s.document()[0])},n=(t,i)=>{t.addClass(e.cl.checkbox.clicked),t.removeClass(e.cl.checkbox.focus),t.toggleClass(e.cl.active);const r=t.hasClass(e.cl.active),l=t.children("input[type='checkbox']");if("radio"===t.attr(e.attr.type)&&t.attr(e.attr.name))if(i){const a=t.attr(e.attr.name);t.addClass(e.cl.active),r&&(l.attr("checked",!0),s(t,i)),i.find("div."+e.cl.checkbox.box+"["+e.attr.type+"='radio']["+e.attr.name+"='"+a+"']").forEach((a=>{const s=e(a);a!==t[0]&&this.isChecked(s)&&n(s)}))}else l.attr("checked",!1);else l.attr("checked",r),s(t,i);const o=t.data("uid");a[o]&&clearTimeout(a[o]),a[o]=setTimeout((()=>{t.removeClass(e.cl.checkbox.clicked)}),300)}},e.AppearanceHelper=function(t){const a={sidebar:{template:"sidebar",styles:["sidebar"]},general:{template:"sidebar",styles:["sidebar"]},dialog:{template:"dialog",styles:["overlay"]},indicator:{template:"indicator",styles:["contentBase","content"]}},s={glass:{appearance:{styles:{sidebarHeaderHeight:"60px",overlayHeaderHeight:"60px"}}},focus:{behaviour:{dirOpenDuration:0},appearance:{styles:{sidebarWidth:"300px",sidebarHeaderHeight:"0px",bookmarksFontSize:"12px",directoriesIconSize:"14px",bookmarksIconSize:"14px",bookmarksLineHeight:"26px",bookmarksDirIndentation:"20px",bookmarksHorizontalPadding:"10px"}}}},n={default:{sidebarHeaderHeight:{xs:32,s:36,l:55},bookmarksFontSize:{xs:11,s:12,l:16},bookmarksLineHeight:{xs:20,s:26,l:45},sidebarWidth:{xs:250,s:300,l:400},bookmarksDirIndentation:{xs:20,s:22,l:30},bookmarksHorizontalPadding:{xs:6,s:10,l:18},bookmarksIconSize:{xs:12,s:14,l:18},directoriesIconSize:{xs:12,s:14,l:18},scrollBarWidth:{xs:10,s:11,l:12},tooltipFontSize:{xs:9,s:9,l:12}},glass:{sidebarHeaderHeight:{xs:32,s:40,m:60,l:80}},focus:{bookmarksDirIndentation:{xs:18,s:20,m:24,l:28}}};let i=null,r=null,l=null;this.init=async()=>{o(),l=t.helper.model.getData("a/theme"),await f(),await u(),e("["+e.attr.theme+"]").forEach((t=>{e(t).attr(e.attr.theme)!==l&&e(t).addClass(e.cl.hidden)})),["directoryArrows"].forEach((e=>{let a=!1;!0===t.helper.model.getData("a/"+e)&&(t.elm.checkbox[e].trigger("click"),a=!0),t.elm.checkbox[e].children("input").data("initial",a)}));const a=t.helper.model.getData("a/surface");if("auto"===a?t.elm.checkbox.surfaceColorAuto.trigger("click"):"dark"===a&&t.elm.checkbox.surface.trigger("click"),t.elm.checkbox.surfaceColorAuto.children("input").data("initial","auto"===a),t.elm.checkbox.surface.children("input").data("initial","dark"===a),"default"!==t.helper.model.getUserType()){const e=t.helper.model.getData("u/customCss");t.elm.textarea.customCss[0].value=e,t.elm.textarea.customCss.data("initial",e),t.elm.textarea.customCss.attr("placeholder","section#sidebar {\n   ...\n}"),t.elm.textarea.customCss.parent().append("<span>"+t.helper.i18n.get("settings_not_synced")+"</span>")}else t.elm.textarea.customCss.addClass(e.cl.settings.inactive),t.addNoPremiumText(t.elm.textarea.customCss.parent());const s=t.helper.model.getData("a/styles");Object.entries(s).forEach((([a,s])=>{t.elm.range[a]?(s=(""+s).replace("px",""),"sidebarWidth"===a&&+s>600&&t.elm.range[a].attr("max",s),t.elm.range[a][0].value=s,t.elm.range[a].data("initial",s),t.elm.range[a].trigger("change")):t.elm.color[a]?("iconColor"===a&&"auto"===s&&(s=t.elm.color[a].siblings("span."+e.cl.settings.suggestion).eq(0).attr(e.attr.value),t.elm.select.iconColorType[0].value="auto"),t.helper.form.changeColorValue(t.elm.color[a],s),t.elm.color[a].data("initial",t.elm.color[a][0].value)):t.elm.select[a]?("fontFamily"===a&&(s=s.replace(/(^'*)|('*$)/g,""),0===t.elm.select[a].children("option[value='"+s+"']").length()&&(s="default")),t.elm.select[a][0].value=s,t.elm.select[a].data("initial",s)):t.elm.radio[a]&&(t.elm.radio[a][0].value=s,t.elm.radio[a].trigger("change"),t.elm.radio[a].data("initial",s))})),b(),await e.delay(100),c(),v(),e(window).trigger("resize")},this.save=()=>new Promise((a=>{const s=g();e.api.storage.sync.get(["appearance"],(n=>{n.appearance=n.appearance||{},n.appearance.theme||"premium"!==t.helper.model.getUserType()||(n.appearance.theme="default"),Object.entries(s.appearance).forEach((([e,t])=>{n.appearance[e]=t})),e.api.storage.sync.set({appearance:n.appearance},(()=>{e.api.storage.local.get(["utility"],(t=>{const n=t.utility||{};n.customCss=s.utility.customCss,e.api.storage.local.set({utility:n},(()=>{a()}))}))}))}))}));const o=()=>{t.elm.appearance.iconShapeWrapper.find("ul > li").forEach((a=>{t.helper.utility.getIconImageData({shape:e(a).attr(e.attr.value),color:"#ffffff",background:"transparent",padding:0}).then((t=>{e(a).find("> span > span").css("background-image",`url(${t})`)}))}))},c=()=>{Object.keys(t.elm.preview).forEach((e=>{d(e)}))},d=s=>{const n=g();if(t.elm.preview[s]){t.elm.preview[s].find("body").attr(e.attr.theme,l),t.elm.preview[s].find("head > style").remove(),Object.assign(n.appearance.styles,t.helper.font.getFontWeights());let i=a[s].css;i+=n.utility.customCss,Object.keys(n.appearance.styles).forEach((e=>{let t=n.appearance.styles[e];"sidebarWidth"===e&&(t=t.replace("px",""),t=Math.min(+t,600),t+="px"),i=i.replace(new RegExp('"?%'+e+'"?',"g"),t)})),t.elm.preview[s].find("["+e.attr.style+"]").forEach((t=>{let a=e(t).attr(e.attr.style);Object.keys(n.appearance.styles).forEach((e=>{a=a.replace(new RegExp('"?%'+e+'"?',"g"),n.appearance.styles[e])})),t.style.cssText=a})),t.elm.preview[s].find("["+e.attr.settings.hideOnFalse+"]").forEach((t=>{const a=e(t).attr(e.attr.settings.hideOnFalse);void 0===n.appearance[a]||!1===n.appearance[a]?e(t).css("display","none"):e(t).css("display","block")})),t.elm.preview[s].find("head").append("<style>"+i+"</style>"),"dark"===n.appearance.surface||"auto"===n.appearance.surface&&"dark"===t.helper.stylesheet.getSystemSurface()?t.elm.preview[s].find("body").addClass(e.cl.page.dark):t.elm.preview[s].find("body").removeClass(e.cl.page.dark),n.appearance.directoryArrows?t.elm.preview[s].find("div#bookmarkBox a.dir").addClass(e.cl.sidebar.dirArrow):t.elm.preview[s].find("div#bookmarkBox a.dir").removeClass(e.cl.sidebar.dirArrow),m(t.elm.preview[s]),h(t.elm.preview[s]),p(t.elm.preview[s])}else"icon"===s&&t.helper.model.call("updateIcon",{name:n.appearance.styles.iconShape,color:"auto"===t.elm.select.iconColorType[0].value?"auto":n.appearance.styles.iconColor,onlyCurrentTab:!0})},p=a=>{const s=a.find("div#redeviation-bs-indicator");if(s.length()>0){const a=+t.elm.range.toggleArea_height[0].value,n=+t.elm.range.toggleArea_top[0].value;s.css({height:a+"%",top:n+"%"}),100===a?s.addClass(e.cl.settings.appearance.preview.fullHeight):s.removeClass(e.cl.settings.appearance.preview.fullHeight)}},h=t=>{const a=t.find("section#sidebar");if(a.length()>0){const t=a.find("> header");t.find("> h1").removeClass(e.cl.hidden),t.find("> h1 > span").removeClass(e.cl.hidden),["label","amount"].forEach((a=>{let s=null;t.children("a").forEach((n=>{if(null===s)s=n.offsetTop;else if(s!==n.offsetTop||0===t.find("> h1")[0].offsetTop)return"label"===a?t.find("> h1 > span").addClass(e.cl.hidden):"amount"===a&&t.find("> h1").addClass(e.cl.hidden),!1}))}))}},m=a=>{const s=a.find("div.tooltip"),n=a.find("li > a.hover");if(s.length()>0&&n.length()>0)if(+new Date-i<2e3){const a=n[0].getBoundingClientRect();s.addClass(e.cl.visible);let i=a.x-s[0].offsetWidth;t.helper.i18n.isRtl()&&(i=a.x+n[0].offsetWidth),s.css({top:a.y+n.realHeight()/2-s.realHeight()/2+"px",left:i+"px"})}else s.removeClass(e.cl.visible)},g=()=>{const a=t.helper.model.getData("a/styles");let s=t.helper.checkbox.isChecked(t.elm.checkbox.surface)?"dark":"light";t.helper.checkbox.isChecked(t.elm.checkbox.surfaceColorAuto)&&(s="auto");const n={utility:{customCss:"default"===t.helper.model.getUserType()?"":t.elm.textarea.customCss[0].value.replace(/[\u200B-\u200D\uFEFF]/g,"").trim()},appearance:{surface:s,directoryArrows:t.helper.checkbox.isChecked(t.elm.checkbox.directoryArrows),highContrast:!1,showIndicator:!0,showIndicatorIcon:!0,showBookmarkIcons:!0,showDirectoryIcons:!0,styles:{}}};return Object.keys(a).forEach((a=>{if(t.elm.range[a]){const s=t.elm.range[a].attr(e.attr.settings.range.unit)||"";n.appearance.styles[a]=t.elm.range[a][0].value+s}else if(t.elm.color[a]){const e=t.helper.form.getColorValue(a,t.elm.color[a][0].value);if(n.appearance.styles[a]=e.color,"colorScheme"===a){const a=t.helper.model.getDefaultColors(l),s=e.luminance?e.luminance:0;n.appearance.styles.foregroundColor=a.foregroundColor[s>170?"dark":"light"],s>215&&(n.appearance.highContrast=!0)}}else if(t.elm.select[a]){if(n.appearance.styles[a]=t.elm.select[a][0].value,"fontFamily"===a)if("default"===n.appearance.styles[a]){const e=t.helper.model.getDefaultData();n.appearance.styles[a]=e.appearance.styles.fontFamily}else n.appearance.styles[a]="'"+n.appearance.styles[a]+"'"}else t.elm.radio[a]&&(n.appearance.styles[a]=t.elm.radio[a][0].value)})),Object.entries({indicatorWidth:"showIndicator",indicatorIconSize:"showIndicatorIcon",bookmarksIconSize:"showBookmarkIcons",directoriesIconSize:"showDirectoryIcons"}).forEach((([e,t])=>{0===parseInt(n.appearance.styles[e])&&(n.appearance[t]=!1)})),"auto"===t.elm.select.iconColorType[0].value&&(n.appearance.styles.iconColor="auto"),n},u=()=>{const a="premium"===t.helper.model.getUserType();!1===a&&t.addNoPremiumText(t.elm.appearance.themeListWrapper.children("div")),t.elm.appearance.selectedTheme.children("span").text(t.helper.i18n.get("settings_theme_"+l)),t.elm.appearance.themeListWrapper.find("> ul > li").forEach((s=>{const n=e(s),i=n.children("div"),r=n.attr(e.attr.name);l===r?e("<span></span>").addClass(e.cl.active).text(t.helper.i18n.get("settings_installed_theme_info")).appendTo(i):a&&e("<a></a>").text(t.helper.i18n.get("settings_install_theme")).appendTo(i)})),a&&t.elm.appearance.themeListWrapper.find("> ul > li > div > a").on("click",(a=>{a.preventDefault();(a=>{e.api.storage.sync.get(["behaviour","appearance"],(n=>{n.behaviour=n.behaviour||{},n.appearance=n.appearance||{},n.appearance.styles=n.appearance.styles||{},n.appearance.theme=a,"auto"!==n.appearance.surface&&(n.appearance.surface="light"),delete n.behaviour.dirOpenDuration,Object.keys(n.appearance.styles).forEach((e=>{e.startsWith("indicator")||e.startsWith("icon")||delete n.appearance.styles[e]}));const i=t.helper.model.getDefaultColors(a);Object.entries(i).forEach((([e,t])=>{n.appearance.styles[e]=t.light})),s[a]&&Object.entries(s[a]).forEach((([e,t])=>{Object.entries(t).forEach((([t,a])=>{"object"==typeof a?Object.entries(a).forEach((([a,s])=>{n[e][t][a]=s})):n[e][t]=a}))})),e.api.storage.sync.set({appearance:n.appearance,behaviour:n.behaviour},(()=>{t.helper.model.call("reinitialize"),t.showSuccessMessage("theme_changed"),e.delay(1500).then((()=>{location.reload(!0)}))}))}))})(e(a.currentTarget).parents("li").eq(0).attr(e.attr.name))})),t.elm.appearance.themeListWrapper.css("display","none"),e([t.elm.appearance.showThemes,t.elm.appearance.selectedTheme]).on("click",(()=>{t.elm.appearance.themeListWrapper.hasClass(e.cl.visible)?(t.elm.appearance.themeListWrapper.removeClass(e.cl.visible),e.delay(300).then((()=>{t.elm.appearance.themeListWrapper.css("display","none")}))):(t.elm.appearance.themeListWrapper.css("display","block"),e.delay(0).then((()=>{t.elm.appearance.themeListWrapper.addClass(e.cl.visible)})))}))},f=()=>new Promise((s=>{const n=Object.keys(a).length,i={};let r=0;Object.entries(a).forEach((([e,a])=>{i[e]=t.helper.stylesheet.getStylesheetFilesWithThemes(a.styles),r+=i[e].length}));let l=0,o=0;const c=()=>{l===n&&o===n&&s()};Object.keys(a).forEach((s=>{a[s].css="",t.elm.preview[s]=e("<iframe></iframe>").attr(e.attr.settings.appearance,s).appendTo(t.elm.body),e.xhr(e.api.runtime.getURL("html/template/"+a[s].template+".html")).then((e=>{if(e&&e.responseText){let a=e.responseText;a=a.replace(/__DATE__CREATED__/g,t.helper.i18n.getLocaleDate(new Date("2016-11-25"))),a=a.replace(/__POSITION__/g,t.helper.i18n.isRtl()?"left":"right");const n=t.elm.preview[s].find("body");n.html(a),n.parent("html").attr("dir",t.helper.i18n.isRtl()?"rtl":"ltr"),t.helper.i18n.parseHtml(t.elm.preview[s]),l++,c()}})),i[s].forEach((t=>{e.xhr(e.api.runtime.getURL("css/"+t+".css")).then((e=>{e&&e.responseText&&(a[s].css+=e.responseText,o++,c())}))}))}))})),v=()=>{const a=t.helper.model.getSurfaceColorDependentStyles(),s=g(),n="auto"===s.appearance.surface,i=t.helper.stylesheet.getSystemSurface();n&&(t.helper.checkbox.isChecked(t.elm.checkbox.surface)&&"light"===i||!t.helper.checkbox.isChecked(t.elm.checkbox.surface)&&"dark"===i)&&t.elm.checkbox.surface.trigger("click"),t.elm.appearance.surfaceWrapper.attr(e.attr.type,s.appearance.surface);for(const s of a){const a=t.elm.color[s].parents("div."+e.cl.settings.box);n?a.addClass(e.cl.hidden):a.removeClass(e.cl.hidden)}},b=()=>{t.elm.appearance.presetWrapper.children("a").on("click",(a=>{const s=e(a.currentTarget).attr(e.attr.type),i=t.helper.model.getData("a/styles",!0),r=Object.assign({},n.default,n[l]);Object.entries(r).forEach((([e,a])=>{a[s]?t.elm.range[e][0].value=a[s]:t.elm.range[e][0].value=i[e].replace("px",""),t.elm.range[e].trigger("change")}))})),t.elm.select.iconColorType.on("change input",(a=>{"auto"===a.currentTarget.value?t.elm.appearance.iconColorWrapper.addClass(e.cl.hidden):t.elm.appearance.iconColorWrapper.removeClass(e.cl.hidden),d("icon")})).trigger("input"),t.elm.range.tooltipFontSize.on("change input",(()=>{i=+new Date,r&&clearTimeout(r),r=setTimeout((()=>{d("sidebar")}),2001)})),t.elm.appearance.content.find("input, textarea, select").on("change input",(a=>{const s=e(a.currentTarget),n=s.data("initial");let i=a.currentTarget.value;if(void 0!==n){"checkbox"===s.attr("type")&&(i=a.currentTarget.checked,e(s).parents("div."+e.cl.settings.box)[0]===t.elm.appearance.surfaceWrapper[0]&&(()=>{const e=g(),a="auto"===e.appearance.surface?t.helper.stylesheet.getSystemSurface():e.appearance.surface,s=t.helper.model.getDefaultColors(l);["textColor","bookmarksDirColor","sidebarMaskColor","colorScheme","hoverColor"].forEach((e=>{if("colorScheme"===e&&t.elm.color[e][0].value!==s[e].light&&t.elm.color[e][0].value!==s[e].dark)return;const n=s[e][a];t.helper.form.changeColorValue(t.elm.color[e],n)})),v()})());const r=e(a.currentTarget).parents("div."+e.cl.settings.box).eq(0);i!==n?0===r.children("a."+e.cl.settings.revert).length()&&e("<a href='#'></a>").addClass(e.cl.settings.revert).data("elm",r).appendTo(r):r.children("a."+e.cl.settings.revert).remove();const o=t.helper.menu.getPath();d(o[1])}})),t.elm.appearance.content.on("click","a."+e.cl.settings.revert,(a=>{a.preventDefault(),e(a.currentTarget).parent("div."+e.cl.settings.box).find("input, select").forEach((a=>{const s=e(a),n=s.data("initial");s.data("picker")?t.helper.form.changeColorValue(s,n):void 0!==n&&("checkbox"===s.attr("type")&&"boolean"==typeof n?a.checked!==n&&s.parent("div").trigger("click"):(a.value=n,s.trigger("change")))}))})),t.elm.buttons.toggleAreaGoto.on("click",(async e=>{e.preventDefault(),location.hash="sidebar_overlay"})),e(document).on(e.opts.events.pageChanged,(e=>{e.detail.path&&"appearance"===e.detail.path[0]&&d(e.detail.path[1])})),e(document).on(e.opts.events.systemColorChanged,(()=>{v(),c(),d("icon")}))}},e.DashboardHelper=function(t){this.init=async()=>{await a(),await l(),r()};const a=async()=>{const a="macOS"===e.ua().os?"cmd":"ctrl",r={sidepanel:{video:"https://extensions.redeviation.com/img/illustration/video_sidepanel.mp4"},synchronization:{img:"https://extensions.redeviation.com/img/tips-tricks/synchronization.png",action:{label:"settings_tips_tricks_synchronization_action",dest:"chrome://settings/syncSetup"}},activation_area:{img:"https://extensions.redeviation.com/img/tips-tricks/activation_area.png",action:{label:"settings_toggle_area",dest:"#sidebar_overlay"}},i18n:{img:"https://extensions.redeviation.com/img/tips-tricks/i18n.png",action:{label:"more_link",dest:"#language_translate"},i18nReplaces:[await i()]},separators:{img:"https://extensions.redeviation.com/img/tips-tricks/separators.png",i18nReplaces:["<i>about:blank</i>","<i>------</i>","<i>--- Example ---</i>","<span></span>"]},about:{img:"https://extensions.redeviation.com/img/tips-tricks/about.png",action:{label:"more_link",dest:"#infos_aboutme"}},right_click:{img:"https://extensions.redeviation.com/img/tips-tricks/right_click.png"},quick_bookmarking:{img:"https://extensions.redeviation.com/img/tips-tricks/quick_bookmarking.png",i18nReplaces:["<span></span>"]},hide_entries:{img:"https://extensions.redeviation.com/img/tips-tricks/hide_entries.png",i18nReplaces:["<span></span>"]},quick_url_copy:{img:"https://extensions.redeviation.com/img/tips-tricks/quick_url_copy.png",i18nReplaces:["<i>"+t.helper.i18n.get("keyboard_shortcuts_key_"+a)+"</i>+<i>c</i>"]},open_all_bookmarks:{img:"https://extensions.redeviation.com/img/tips-tricks/open_all_bookmarks.png",i18nReplaces:["<i>"+t.helper.i18n.get("keyboard_shortcuts_key_"+a)+"</i>"]},version:{img:"https://extensions.redeviation.com/img/tips-tricks/version.png",headline:"settings_tips_tricks_facts"},keyboard_shortcuts:{img:"https://extensions.redeviation.com/img/tips-tricks/keyboard_shortcuts.png",i18nReplaces:["<span></span>"]},expand_all_subfolders:{img:"https://extensions.redeviation.com/img/tips-tricks/expand_all_subfolders.png"},quick_search:{img:"https://extensions.redeviation.com/img/tips-tricks/quick_search.png"},share_data:{img:"https://extensions.redeviation.com/img/tips-tricks/share_data.png",action:{label:"more_link",dest:"#infos_permissions"}},multiselect:{img:"https://extensions.redeviation.com/img/tips-tricks/multiselect.png"},newtab:{img:"https://extensions.redeviation.com/img/tips-tricks/newtab.png",action:{label:"newtab_title",dest:e.api.runtime.getURL("html/newtab.html")},condition:t.helper.model.getData("n/override"),i18nReplaces:["<span></span>"]},privacy:{img:"https://extensions.redeviation.com/img/tips-tricks/privacy.png",action:{label:"more_link",dest:e.opts.website.info.privacyPolicy}}};let l=0;const o=n(r);await s(o[l],r[o[l]]),t.elm.dashboard.tipsTricks.children("button").on("click",(async e=>{e.preventDefault(),l=(l+1)%o.length;const t=o[l];await s(t,r[t])}))},s=async(a,s)=>{t.elm.dashboard.tipsTricks.addClass(e.cl.loading);const n=t.helper.template.loading().appendTo(t.elm.dashboard.tipsTricks);if(await e.delay(300),t.elm.dashboard.tipsTricks.children("div."+e.cl.info).remove(),t.elm.dashboard.tipsTricks.children("img").remove(),t.elm.dashboard.tipsTricks.children("video").remove(),s.img){const a=e("<img/>").prependTo(t.elm.dashboard.tipsTricks);await new Promise((e=>{a.on("load",e).on("error",e).attr("src",s.img)}))}else if(s.video){const a=e("<video/>").prependTo(t.elm.dashboard.tipsTricks),n=await t.helper.model.call("parsedUrl",{href:s.video});await new Promise((e=>{a.on("loadeddata",(()=>{a[0].loop=!0,a[0].autoplay=!0,a[0].muted=!0,a[0].controls=!1,a[0].play(),e()})).on("error",e).attr("src",n)}))}else await e.delay(50);const i=e("<div></div>").addClass(e.cl.info).prependTo(t.elm.dashboard.tipsTricks);let r=t.helper.i18n.get("settings_tips_tricks_facts");const l=t.helper.i18n.get("settings_tips_tricks_"+a);l&&(r+="&ensp;<span>... "+l+"</span>"),e("<h2></h2>").html(r).appendTo(i);const o=e("<p></p>").html(t.helper.i18n.get("settings_tips_tricks_"+a+"_desc",s.i18nReplaces||[])).appendTo(i);if(s.action&&s.action.label&&s.action.dest){e("<a></a>").text(t.helper.i18n.get(s.action.label)).insertAfter(o).on("click",(e=>{e.preventDefault(),s.action.dest.startsWith("#")?location.hash=s.action.dest.substring(1):t.helper.model.call("openLink",{href:s.action.dest,newTab:!0,active:!0})}))}await e.delay(100),t.elm.dashboard.tipsTricks.attr(e.attr.type,a).removeClass(e.cl.loading),n.remove()},n=e=>{const t=[];for(const a in e)void 0!==e[a].condition&&!0!==e[a].condition||t.push(a);for(let e=t.length-1;e>0;e--){const a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t},i=async()=>{const e=await t.helper.model.call("languageInfos");return e&&e.infos?Object.values(e.infos).filter((e=>e.available)).length:-1},r=()=>{e(t.elm.dashboard.links).on("click",(a=>{const s=e(a.currentTarget).attr(e.attr.src);s&&(a.preventDefault(),t.helper.model.call("openLink",{hrefName:s,newTab:!0,params:{lang:t.helper.i18n.getLanguage()}}))}))},l=async()=>{t.elm.dashboard.footerVersion.html(t.helper.i18n.get("extension_version")+" <span>"+e.opts.manifest.version_name+"</span>").on("click",(e=>{e.preventDefault(),t.helper.model.call("openLink",{hrefName:"changelog",newTab:!0,params:{lang:t.helper.i18n.getLanguage()}})}));const a=await t.helper.model.call("lastUpdateDate");t.elm.dashboard.footerLastUpdate.html(t.helper.i18n.get("extension_last_update",[t.helper.i18n.getLocaleDate(a)])),t.elm.dashboard.footerCopyright.html("&copy; "+e.copyrightDate+" - "+(new Date).getFullYear()+" <span>"+t.helper.i18n.get("extension_author")+"</span>")}},e.ExpertHelper=function(t){let a={},s={},n=null;const i="__visible";this.init=async()=>{"default"!==t.helper.model.getUserType()?(s=t.helper.model.getDefaultData(),delete s.utility,l(),this.updateRawConfigList()):(t.elm.expert.search.remove(),t.addNoPremiumText(t.elm.expert.content.children("div")))},this.updateRawConfigList=(n=!0)=>{n&&(a=JSON.parse(JSON.stringify(t.helper.model.getAllData())),delete a.utility);const i=t.elm.expert.template[0].content;t.elm.expert.content.children("div["+e.attr.type+"]").remove(),Object.entries(s).forEach((([s,n])=>{e(i).appendTo(t.elm.expert.content);const l=t.elm.expert.content.children("div["+e.attr.type+"]").eq(-1),o=l.children("ul");l.attr(e.attr.type,s),l.children("h2").text(s),d(o,n,a[s]||null),r(l)})),o()},this.save=()=>new Promise(((s,n)=>{"default"!==t.helper.model.getUserType()?t.elm.expert.content.find("input[type='text']."+e.cl.error).length()>0?(alert(t.helper.i18n.get("settings_expert_save_error")),n()):e.api.storage.sync.set({behaviour:a.behaviour||{},appearance:a.appearance||{},newtab:a.newtab||{}},s):s()}));const r=t=>{if(n){const a=t.children("ul");a.find("li").forEach((t=>{(-1!==e(t).attr(e.attr.name).toLowerCase().indexOf(n)||e(t).parents("."+i).length()>0)&&e(t).addClass(i)})),a.find("li:not(."+i+")").forEach((t=>{0===e(t).find("."+i).length()&&e(t).remove()})),e("li."+i).removeClass(i),0===a.children("li").length()&&t.remove()}},l=()=>{t.elm.expert.search.attr("placeholder",t.helper.i18n.get("settings_search_placeholder",null,!0)),t.elm.expert.search.on("keyup change input",(e=>{n=e.currentTarget.value.trim().toLowerCase(),0===n.length&&(n=null),this.updateRawConfigList(!1)}))},o=()=>{t.elm.expert.content.find("ul > li > input[type='text']").on("keyup change input",(a=>{t.highlightUnsavedChanges();const s=e(a.currentTarget),n=s.parent("li").data("path");if(s.removeClass(e.cl.error),n&&n.length>0)try{let t=a.currentTarget.value;"json"===s.attr(e.attr.type)&&(t=JSON.parse(t)),c(n,t)}catch(a){s.addClass(e.cl.error)}}))},c=(e,t)=>{"false"===t||"true"===t?t="true"===t:!isNaN(parseFloat(t))&&isFinite(t)&&(t=parseFloat(t));let s=0;e.reduce(((a,n)=>(s++,s===e.length?(a[n]=t,t):a[n])),a)},d=(s,n,i)=>{Object.entries(n).forEach((([n,r])=>{let l=JSON.parse(JSON.stringify(r));const o=e("<li></li>").attr(e.attr.name,n).append("<label>"+n+"</label>").appendTo(s),c=(t=>{const s=t.parents("div["+e.attr.type+"]").eq(0).attr(e.attr.type);if(s&&a[s]){const a=[s];return t.parents("li["+e.attr.name+"]").forEach((t=>{const s=e(t).attr(e.attr.name);a.push(s)}),!0),a.push(e(t).attr(e.attr.name)),a}return[]})(o);o.data("path",c);const p=(e=>{let a=null;const s=[e,[...e]];return s[1].shift(),s.some((e=>{let s="settings_"+e.join("_");s=s.replace(/([A-Z])/g,"_$1").toLowerCase(),s=s.replace(/_styles_/g,"_");const n=t.helper.i18n.get(s),i=t.helper.i18n.get(s+"_desc");if(i||n)return a=i||n,!0})),a})(c);p&&e("<div></div>").addClass(e.cl.info).html("<span>"+p+"</span>").appendTo(o.children("label")),i&&"object"==typeof i&&void 0!==i[n]&&(l=i[n]);const h=Array.isArray(l);if("object"==typeof l&&null!==l&&!1===h){const t=e("<ul></ul>").appendTo(o);d(t,r,i[n]||null)}else{const t=e("<input />").attr("type","text").appendTo(o);h&&(l=JSON.stringify(l),t.attr(e.attr.type,"json")),t[0].value=l}}))}},e.FormHelper=function(t){const a={};this.init=async()=>{s(),await n()},this.changeColorValue=(e,t)=>{const a=e.data("picker");a&&a.setColor(t)},this.getColorValue=(e,a)=>{let s=null;const n=t.elm.color[e].data("picker");if(n){const e=n.getColorObj();0===e.a&&(a="transparent"),s=.299*e.r+.587*e.g+.114*e.b}return{color:a,luminance:s}};const s=()=>{t.elm.content.on("scroll",(()=>{"appearance"===t.helper.menu.getPath()[0]&&Object.values(t.elm.color).forEach((e=>{e.data("picker").reposition()}))}))},n=async()=>{const s=t.elm.formElement.length();for(let n=0;n<=s;n++){const s=t.elm.formElement[n],i={elm:s,type:e(s).attr(e.attr.type),name:e(s).attr(e.attr.name),i18n:e(s).attr(e.attr.i18n)||""};i.label=e("<label></label>").attr(e.attr.i18n,i.i18n).insertAfter(s),e("<p></p>").addClass(e.cl.settings.desc).attr(e.attr.i18n,i.i18n+"_desc").insertAfter(i.label),a[i.type]&&await a[i.type](i),e(s).remove()}};a.color=async a=>{t.elm.color[a.name]=e("<input type='text' />").addClass(e.cl.settings.color.field).insertAfter(a.label);const s=new window.Colorpicker(t.elm.color[a.name][0],{alpha:!!e(a.elm).attr(e.attr.settings.color.alpha)}),n=e(a.elm).attr(e.attr.settings.color.suggestions);if(n){const t=JSON.parse(n),a=s.getElements().preview,i=[];t.forEach((t=>{i.push(e("<span></span>").addClass(e.cl.settings.suggestion).attr(e.attr.value,t).css("background-color",t).insertAfter(a))})),e(i).on("click",(t=>{t.stopPropagation();const a=e(t.currentTarget).attr(e.attr.value);s.setColor(a),s.show()}))}const i=n=>{let i=t.elm.body.children("div."+e.cl.settings.color.mask+"["+e.attr.name+"='"+a.name+"']");n&&s.visible&&-1!==a.name.search(/MaskColor$/)?(0===i.length()&&(i=e("<div></div>").addClass(e.cl.settings.color.mask).attr(e.attr.name,a.name).appendTo(t.elm.body)),i.css("background-color",n)):i.length()>0&&i.remove()};s.on("show",(e=>{s.visible=!0,i(e.color)})),s.on("hide",(()=>{s.visible=!1,i()})),s.on("change",(e=>{t.elm.color[a.name].trigger("change"),i(e.color)})),t.elm.color[a.name].data("picker",s)},a.font=async a=>{t.elm.select[a.name]=e("<select></select>").insertAfter(a.label),e.api.fontSettings.getFontList((s=>{s.unshift({fontId:"default",displayName:t.helper.i18n.get("settings_font_family_default")}),s.forEach((s=>{0===t.elm.select[a.name].children("option[value='"+s.fontId.replace(/\'/g,"\\27")+"']").length()&&e("<option></option>").attr("value",s.fontId).text(s.displayName).appendTo(t.elm.select[a.name])}))}))},a.language=async a=>{t.elm.select[a.name]=e("<select></select>").insertAfter(a.label),e("<option></option>").attr("value","default").text(t.helper.i18n.get("settings_language_default")).appendTo(t.elm.select[a.name]);const s=await t.helper.model.call("languageInfos");if(s&&s.infos){const n=Object.values(s.infos);n.sort(((e,t)=>e.label>t.label?1:-1)),n.forEach((s=>{s.available&&e("<option></option>").attr("value",s.name).text(s.label).appendTo(t.elm.select[a.name])}))}},a.textarea=async a=>{t.elm.textarea[a.name]=e("<textarea></textarea>").attr(e.attr.name,a.name).insertAfter(a.label)},a.text=a.email=async a=>{t.elm.field[a.name]=e("<input type='"+a.type+"' />").insertAfter(a.label),["placeholder"].forEach((s=>{const n=e(a.elm).attr(e.attr.settings.field[s]);n&&t.elm.field[a.name].attr(s,n)}))},a.radio=async a=>{t.elm.radio[a.name]=e("<select></select>").addClass(e.cl.hidden).insertAfter(a.label);const s=e("<ul></ul>").addClass(e.cl.settings.radio.wrapper).insertAfter(t.elm.radio[a.name]);e(a.elm).children("span").forEach((n=>{const i=e(n).attr(e.attr.value),r=e("<li></li>").attr(e.attr.value,i).appendTo(s);e(t.helper.checkbox.get(t.elm.body,{[e.attr.name]:a.name,[e.attr.value]:i},"radio")).appendTo(r),e(n).appendTo(r),e("<option></option>").attr("value",i).text(i).appendTo(t.elm.radio[a.name])})),t.elm.radio[a.name].on("change",(t=>{if(void 0===t.detail||"userAction"!==t.detail){const a=s.find("input[type='checkbox']["+e.attr.value+"='"+t.currentTarget.value+"']");a.length()>0&&a.parent("div").trigger("click")}})),s.find("input[type='checkbox']").on("change",(s=>{t.elm.radio[a.name][0].value=e(s.currentTarget).attr(e.attr.value),t.elm.radio[a.name].trigger("change",{detail:"userAction"})}))},a.range=async a=>{t.elm.range[a.name]=e("<input type='range' />").insertAfter(a.label),["min","max","step"].forEach((s=>{const n=e(a.elm).attr(e.attr.settings.range[s]);n&&t.elm.range[a.name].attr(s,n)})),t.elm.range[a.name].attr("value",e(a.elm).attr(e.attr.value)||"");const s=e("<span></span>").insertAfter(t.elm.range[a.name]),n=e(a.elm).attr(e.attr.settings.range.unit)||"";if(n&&t.elm.range[a.name].attr(e.attr.settings.range.unit,n),t.elm.range[a.name].on("input change",(i=>{const r=i.currentTarget,l=r.max||100,o=r.min||0,c=Math.round(100*(r.value-o)/(l-o)),d=t.elm.range[a.name].css("background-image");if(d&&0===d.indexOf("linear-gradient")){let s=e(r).data("backgroundTemplate");void 0===s&&(s=d.replace(/-1px/g,"{percent}"),e(r).data("backgroundTemplate",s)),t.elm.range[a.name].css("background-image",s.replace(/{percent}/g,c+"%"))}s.text(r.value+n)})),e.delay().then((()=>{t.elm.range[a.name].trigger("input")})),"1"===e(a.elm).attr(e.attr.settings.range.infinity)){const n=e("<div></div>").addClass(e.cl.settings.sub).insertAfter(s),i=t.helper.checkbox.get(t.elm.body).appendTo(n);e("<label></label>").attr(e.attr.i18n,a.i18n+"_infinity").appendTo(n),i.children("input[type='checkbox']").on("change",(s=>{s.currentTarget.checked?t.elm.range[a.name].addClass(e.cl.settings.inactive):t.elm.range[a.name].removeClass(e.cl.settings.inactive)})),t.elm.range[a.name].data("infinityCheckbox",i)}},a.select=async a=>{t.elm.select[a.name]=e("<select></select>").insertAfter(a.label),e(a.elm).children("span").forEach((s=>{const n=e(s).attr(e.attr.i18n),i=e("<option></option>").attr({value:e(s).attr(e.attr.value)}).html(e(s).html()).appendTo(t.elm.select[a.name]);n&&i.attr(e.attr.i18n,n)}))},a.checkbox=async a=>{const s=e(a.elm).attr(e.attr.style)||"default";t.elm.checkbox[a.name]=t.helper.checkbox.get(t.elm.body,{[e.attr.name]:a.name},"checkbox",s).insertAfter(a.label)}},e.ImportExportHelper=function(t){this.init=async()=>{"default"!==t.helper.model.getUserType()?(r(),n()):s()},this.getExportConfig=()=>{const e=Object.assign({},t.helper.model.getAllData());return"default"!==t.helper.model.getUserType()?e.utility={customCss:e.utility.customCss||"",newtabBackground:e.utility.newtabBackground||""}:delete e.utility,e};const a=()=>{window.alert(t.helper.i18n.get("settings_import_failed"))},s=()=>{t.addNoPremiumText(t.elm.importExport.content.find("div["+e.attr.value+"='exportSettings']")),["import","export"].forEach((a=>{t.elm.buttons[a].addClass(e.cl.settings.inactive)}))},n=async()=>{t.elm.buttons.import.children("input[type='file']").on("change",(e=>{e.preventDefault();const t=e.currentTarget;if(t.files&&t.files[0]&&t.files[0].name.search(/\.bookmark_sidebar$/)>-1){const e=new FileReader;e.onload=e=>{try{const t=JSON.parse(e.target.result);i(t)}catch(e){a()}},e.readAsText(t.files[0])}else a()}))},i=async s=>{if(s.behaviour&&s.appearance&&s.newtab){await e.api.storage.sync.set({behaviour:s.behaviour,appearance:s.appearance,newtab:s.newtab});const a=Object.assign({},t.helper.model.getAllData());a.utility=a.utility||{},["customCss","newtabBackground"].forEach((e=>{let t="";s.utility&&s.utility[e]&&(t=s.utility[e]),a.utility[e]=t})),await e.api.storage.local.set({utility:a.utility}),t.showSuccessMessage("import_saved"),await t.helper.model.call("reinitialize"),await e.delay(1500),t.helper.model.call("reloadIcon"),t.helper.model.call("reloadBrowserAction"),location.reload(!0)}else a()},r=async()=>{e(document).on(e.opts.events.pageChanged,(e=>{e.detail.path&&"export"===e.detail.path[0]&&l()})),l()},l=()=>{const e=JSON.stringify(this.getExportConfig(),null,2);console.log("LOAD"),t.elm.buttons.export.attr({href:"data:text/json;charset=utf-8,"+encodeURIComponent(e),download:o()})},o=()=>{const e=new Date;return"config_"+(e.getDate()+"-"+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"][e.getMonth()]+"-"+e.getFullYear())+".bookmark_sidebar"}},e.InfosHelper=function(t){this.init=async()=>new Promise((e=>{Promise.all([a(),s()]).then(e)}));const a=()=>new Promise((a=>{e.api.management.getPermissionWarningsByManifest(JSON.stringify(e.opts.manifest),(s=>{const n={};[n.contentscript,n.bookmarks]=s,Object.entries(n).forEach((([a,s])=>{t.elm.infos.permissionsWrapper.find("h3["+e.attr.name+"='"+a+"']").text(s)})),a()}))})),s=async()=>{e.api.storage.sync.get(["shareInfo"],(e=>{e.shareInfo&&(e.shareInfo.config&&t.elm.checkbox.shareConfig.trigger("click"),e.shareInfo.activity&&t.elm.checkbox.shareActivity.trigger("click")),t.elm.infos.shareInfoWrapper.find("input[type='checkbox']").on("change",(()=>{t.helper.model.call("updateShareInfo",{config:t.helper.checkbox.isChecked(t.elm.checkbox.shareConfig),activity:t.helper.checkbox.isChecked(t.elm.checkbox.shareActivity)}).then((()=>{t.showSuccessMessage("saved_share_userdata")}))}))}))}},e.MenuHelper=function(t){let a=!1,s=null,n=null,i=null;this.init=()=>new Promise((a=>{s=e("<ul></ul>").appendTo(t.elm.aside.children("nav"));let n=t.elm.content.children("div."+e.cl.settings.tabs.content).length();const i=()=>{n--,0===n&&r().then((()=>{a()}))};t.elm.content.children("div."+e.cl.settings.tabs.content).forEach((a=>{const n=e(a).attr(e.attr.name),r=e("<li></li>").attr(e.attr.name,n).html("<a href='#'>"+t.helper.i18n.get("settings_menu_"+n)+"</a>").appendTo(s),l=e(a).children("div["+e.attr.name+"]");if(l.length()>0){const a=e("<ul></ul>").appendTo(r);l.forEach((s=>{const i=e(s).attr(e.attr.name),r=e(s).attr(e.attr.src),l=e("<li></li>").attr(e.attr.name,i).html("<a href='#'>"+t.helper.i18n.get("settings_menu_"+n+"_"+i)+"</a>").appendTo(a);r&&l.attr(e.attr.src,r)})),e.delay(500).then((()=>{a.children("li").forEach((t=>{e(t).data("height",t.scrollHeight)})),i()}))}else i()})),l()})),this.getPath=()=>n,this.addBreadcrumb=a=>{t.elm.content[0].scrollTop=0,a.depth&&n.length>=a.depth?(n[a.depth-1]=a.alias,t.elm.headline.children("span").forEach(((t,s)=>{s>=a.depth-1&&e(t).remove()}))):n.push(a.alias),t.elm.headline.append("<span>"+a.label+"</span>")};const r=()=>new Promise((t=>{const a=location.hash?location.hash.substring(1):null;a?c(...a.split("_")):s.find("a").eq(0).trigger("click"),e.delay(300).then(t)})),l=()=>{s.find("a").on("click",(a=>{a.preventDefault();const s=e(a.currentTarget).parent("li"),n=s.attr(e.attr.name),i=s.attr(e.attr.src);if(i)t.helper.model.call("openLink",{hrefName:i,newTab:!0,params:{lang:t.helper.i18n.getLanguage()}});else if(s.parents("li").length()>0){const t=s.parent("ul").parent("li").attr(e.attr.name);c(t,n)}else c(n)})),t.elm.headline.on("click","span",(t=>{const a=e(t.currentTarget).prevAll().length();c(...n.slice(0,a+1))})),e(window).on("popstate",(()=>{r()}))},o=()=>{const a=this.getPath(),s=[t.elm.content.children("div."+e.cl.settings.tabs.content+"["+e.attr.name+"='"+a[0]+"']")];t.elm.header.attr(e.attr.type,a[0]),a[1]&&s.unshift(s[0].children("div["+e.attr.name+"='"+a[1]+"']")),["save","restore"].forEach((a=>{s.some((s=>{const n=s.attr(e.attr.settings[a]);if(t.elm.buttons[a].addClass(e.cl.hidden),n)return"false"!==n&&t.elm.buttons[a].html("true"===n?"":t.helper.i18n.get(n)).removeClass(e.cl.hidden),!0}))}))},c=async(...r)=>{if(a)return;a=!0;let l=r.length;const c=[];let d=s.children("li["+e.attr.name+"='"+r[0]+"']"),p=t.elm.content.children("div."+e.cl.settings.tabs.content+"["+e.attr.name+"='"+r[0]+"']");if(0===p.length())return void(location.href=location.protocol+"//"+location.host+location.pathname);p.find("img["+e.attr.src+"]").forEach((t=>{const a=e(t),s=a.attr(e.attr.src);a.removeAttr(e.attr.src),a.attr("src",s)})),1===l&&p.find("> div["+e.attr.name+"]").length()>0&&(d.hasClass(e.cl.settings.incomplete)&&"language"===r[0]?r.push(p.find("> div["+e.attr.name+"='translate']").eq(0).attr(e.attr.name)):r.push(p.find("> div["+e.attr.name+"]").eq(0).attr(e.attr.name)),l++),l>=2&&"sidebar"===r[0]&&"toggle"===r[1]&&"area"===r[2]&&t.elm.buttons.toggleAreaOpen.eq(0).trigger("click");const h=r.join("_");(()=>{s.find("li").removeClass(e.cl.active);const a=t.elm.content.children("div."+e.cl.settings.tabs.content);a.removeClass(e.cl.active),a.children("div["+e.attr.name+"]").removeClass(e.cl.active),s.find("ul").css("height","")})();for(let t=1;t<=l;t++){const a=d.parent("ul");if(a&&a.length()>0){d.addClass(e.cl.active),p.addClass(e.cl.active),c.push(d.children("a").html());let s=0;a.children("li:not(."+e.cl.hidden+")").forEach((t=>{s+=e(t).data("height")||0})),s>0&&a.css("height",s+"px"),t<l&&(d=d.find("> ul > li["+e.attr.name+"='"+r[t]+"']"),p=p.find("> div["+e.attr.name+"='"+r[t]+"']"))}}t.elm.headline.html("<span>"+c.join("</span><span>")+"</span>"),t.elm.body.attr(e.attr.type,h),location.hash=h,i=p,n=r,t.elm.content[0].scrollTop=0,o();const m="padding-"+(t.helper.i18n.isRtl()?"left":"right");t.elm.header.css(m,""),t.elm.content.css(m,""),document.dispatchEvent(new CustomEvent(e.opts.events.pageChanged,{detail:{path:r},bubbles:!0,cancelable:!1})),await e.delay(),a=!1}},e.NewtabHelper=function(t){let a=!1,s=!1;const n=[],i={regular:18,transparent:10},r={running:!1,awaitUpdate:!1};this.init=async()=>{o(),l(),["override","autoOpen","focusOmnibox"].forEach((s=>{!0===t.helper.model.getData("n/"+s)?"override"===s?e.api.permissions.contains({permissions:["tabs","topSites"]},(e=>{e&&t.elm.checkbox[s].trigger("click"),a=!0})):t.elm.checkbox[s].trigger("click"):"override"===s&&(a=!0),t.elm.checkbox[s].children("input").trigger("change")})),["faviconBackground","faviconColor"].forEach((e=>{const a=t.helper.model.getData("n/"+e);t.helper.form.changeColorValue(t.elm.color[e],a),n.push(t.elm.color[e][0])})),["faviconShape"].forEach((e=>{const a=t.helper.model.getData("n/"+e);t.elm.radio[e][0].value=a,t.elm.radio[e].trigger("change"),n.push(t.elm.radio[e][0])})),["website"].forEach((e=>{t.elm.field[e][0].value=t.helper.model.getData("n/"+e),s=t.elm.field[e][0].value.length>0}))},this.save=()=>new Promise((a=>{e.api.storage.sync.get(["newtab"],(s=>{const n=s.newtab||{};["override","autoOpen","focusOmnibox"].forEach((e=>{n[e]=t.helper.checkbox.isChecked(t.elm.checkbox[e])})),["faviconBackground","faviconColor"].forEach((e=>{const a=t.helper.form.getColorValue(e,t.elm.color[e][0].value);n[e]=a.color})),n.faviconPadding=i["transparent"===n.faviconBackground?"transparent":"regular"],["faviconShape"].forEach((e=>{n[e]=t.elm.radio[e][0].value})),["website"].forEach((e=>{n[e]=t.elm.field[e][0].value.trim()})),n.website&&n.website.length&&0!==n.website.search(/^[\w-]+:\/\//)&&(n.website="http://"+n.website),e.api.storage.sync.set({newtab:n},a)}))}));const l=()=>{t.elm.newtab.faviconShapeWrapper.find("ul > li").forEach((a=>{t.helper.utility.getIconImageData({shape:e(a).attr(e.attr.value),color:"#ffffff",background:"transparent",padding:0}).then((t=>{e(a).find("> span > span").css("background-image",`url(${t})`)}))}))},o=()=>{t.elm.checkbox.override.children("input[type='checkbox']").on("change",(()=>{let s=t.helper.checkbox.isChecked(t.elm.checkbox.override);const n=t.elm.newtab.content.find("div."+e.cl.settings.hideable);s?!0===a?e.api.permissions.request({permissions:["tabs","topSites","history"]},(a=>{a||(t.elm.checkbox.override.trigger("click"),s=!1),s?(n.removeClass(e.cl.hidden),c()):(n.addClass(e.cl.hidden),t.elm.newtab.buttons.addClass(e.cl.hidden))})):(n.removeClass(e.cl.hidden),c()):(n.addClass(e.cl.hidden),t.elm.newtab.buttons.addClass(e.cl.hidden))})),t.elm.newtab.content.find("input, select").on("change input",(async e=>{n.indexOf(e.currentTarget)>-1?await d():t.elm.field.website[0]===e.currentTarget&&(s=t.elm.field.website[0].value.length>0,await c())})),t.elm.newtab.buttons.children("a").on("click",(a=>{a.preventDefault(),t.helper.model.call("openLink",{href:e.api.runtime.getURL("html/newtab.html")+("styling"===e(a.currentTarget).attr(e.attr.name)?"#edit":""),newTab:!0,active:!0})}))},c=async()=>{s?t.elm.newtab.buttons.addClass(e.cl.hidden):(t.elm.newtab.buttons.removeClass(e.cl.hidden),await d())},d=async()=>{if(r.running)r.awaitUpdate=!0;else{r.awaitUpdate=!1,r.running=!0;const e=t.helper.form.getColorValue("faviconBackground",t.elm.color.faviconBackground[0].value).color,a=t.elm.newtab.faviconPreview[0].getContext("2d"),s=new Image;s.onload=async()=>{a.clearRect(0,0,t.elm.newtab.faviconPreview[0].width,t.elm.newtab.faviconPreview[0].height),a.drawImage(s,0,0),r.running=!1,r.awaitUpdate&&await d()},s.src=await t.helper.utility.getIconImageData({shape:t.elm.radio.faviconShape[0].value,color:t.helper.form.getColorValue("faviconColor",t.elm.color.faviconColor[0].value).color,background:e,padding:i["transparent"===e?"transparent":"regular"]})}}},e.PremiumHelper=function(t){const a={};this.init=async()=>{s().then((()=>{n()}))};const s=()=>new Promise((s=>{const n=t.elm.premium.wrapper.children("section["+e.attr.type+"='intro']");"premium"===t.helper.model.getUserType()?(e("<span></span>").attr(e.attr.type,"activated").text(t.helper.i18n.get("premium_already_activated")).appendTo(n),t.helper.model.call("licenseKey").then((i=>{if(i&&i.licenseKey){const s=e("<span></span>").attr(e.attr.type,"key").append("<strong>"+t.helper.i18n.get("premium_license_key")+":</strong>").append("<span>"+i.licenseKey+"</span>").appendTo(n);e.isDev&&(a.removePremium=e("<a></a>").appendTo(s))}s()}))):(t.elm.aside.find("li["+e.attr.name+"='premium']").addClass(e.cl.settings.inactive),a.linkPremium=e("<a></a>").attr(e.attr.type,"premium").text(t.helper.i18n.get("premium_get_now")).appendTo(n),a.showLicenseField=e("<a></a>").attr(e.attr.type,"activate").text(t.helper.i18n.get("premium_show_license_input")).appendTo(n),a.licenseField=e("<div></div>").attr(e.attr.type,"licenseKey").css("display","none").append("<strong>"+t.helper.i18n.get("premium_license_key")+"</strong>").append("<input type='text' />").append("<button type='submit'>"+t.helper.i18n.get("premium_activate")+"</button>").appendTo(n),s())})),n=()=>{a.linkPremium&&a.linkPremium.on("click",(a=>{a.preventDefault(),e.api.tabs.create({url:e.opts.website.premium.checkout+"?lang="+t.helper.i18n.getLanguage()})})),a.showLicenseField&&a.showLicenseField.on("click",(t=>{t.preventDefault(),a.licenseField.css("display","block"),e.delay(100).then((()=>{a.licenseField.addClass(e.cl.visible)}))})),a.removePremium&&a.removePremium.on("click",(e=>{e.preventDefault(),t.helper.model.call("deactivatePremium").then((()=>{location.reload(!0)}))})),a.licenseField&&a.licenseField.children("button").on("click",(s=>{s.preventDefault();const n=t.helper.template.loading().appendTo(t.elm.body);t.elm.body.addClass(e.cl.loading);let i=a.licenseField.children("input[type='text']")[0].value;i=i.replace(/\s/g,""),Promise.all([t.helper.model.call("activatePremium",{licenseKey:i}),e.delay(1e3)]).then((([a])=>{t.elm.body.removeClass(e.cl.loading),n.remove(),a&&a.success?(t.showSuccessMessage("premium_activated"),e.delay(1500).then((()=>{location.reload(!0)}))):e.delay(100).then((()=>{alert(a.message||t.helper.i18n.get("settings_premium_invalid_key"))}))}))}))}},e.SidebarHelper=function(t){this.init=async()=>{r(),n(),s(),a(),["overlayEnabled","dirAccordion","preventPageScroll","preventWindowed","tooltipAdditionalInfo","rememberOpenStatesSubDirectories"].forEach((e=>{!0===t.helper.model.getData("b/"+e)&&t.elm.checkbox[e].trigger("click"),t.elm.checkbox[e].children("input").trigger("change")})),t.elm.select.language[0].value=t.helper.i18n.getLanguage(),["visibility","iconAction","openAction","sidebarPosition","linkAction","rememberState","newTab","newTabPosition","tooltipContent"].forEach((e=>{t.elm.select[e][0].value=t.helper.model.getData("b/"+e),t.elm.select[e].trigger("change")})),["openDelay","scrollBarHide","closeTimeout","tooltipDelay"].forEach((e=>{const a=t.helper.model.getData("b/"+e);if(-1===a){const a=t.elm.range[e].data("infinityCheckbox");a&&a.length()>0&&a.trigger("click")}t.elm.range[e][0].value=a,t.elm.range[e].trigger("change")}));"sidebar"===t.helper.menu.getPath()[0]&&i()},this.save=async()=>{const a=await e.api.storage.sync.get(["behaviour","language"]);if(a.behaviour=a.behaviour||{},a.behaviour.toggleArea={},a.behaviour.blacklist=[],a.behaviour.whitelist=[],["width","height","top","widthWindowed"].forEach((e=>{a.behaviour.toggleArea[e]=t.elm.range["toggleArea_"+e][0].value})),["visibility","iconAction","openAction","sidebarPosition","linkAction","rememberState","newTab","newTabPosition","tooltipContent"].forEach((e=>{a.behaviour[e]=t.elm.select[e][0].value})),["openDelay","scrollBarHide","closeTimeout","tooltipDelay"].forEach((s=>{let n=-1;!1===t.elm.range[s].hasClass(e.cl.settings.inactive)&&(n=t.elm.range[s][0].value),a.behaviour[s]=n})),["overlayEnabled","dirAccordion","preventPageScroll","preventWindowed","tooltipAdditionalInfo","rememberOpenStatesSubDirectories"].forEach((e=>{a.behaviour[e]=t.helper.checkbox.isChecked(t.elm.checkbox[e])})),"blacklist"===a.behaviour.visibility||"whitelist"===a.behaviour.visibility){const e=t.elm.textarea.visibilityFilter[0].value;a.behaviour[a.behaviour.visibility]=e.split(/\n+/),""===a.behaviour[a.behaviour.visibility][0]&&(a.behaviour.visibility="always")}let s=t.elm.select.language[0].value;s===t.helper.i18n.getUILanguage()&&(s="default"),await e.api.storage.sync.set({behaviour:a.behaviour,language:s}),a&&a.language&&a.language===s||e.delay(2e3).then((()=>{location.reload(!0)}))};const a=()=>{t.elm.textarea.visibilityFilter.attr("placeholder","example.com/*\n*.example.com/*"),t.elm.sidebar.filterOptions.find("> div > ul > li").forEach((t=>{const a=e(t).text();e(t).html(a.replace(/(?<!\/)\*/g,"<em>*</em>"))})),t.elm.select.visibility.on("change",(a=>{const s=a.currentTarget.value;if("always"===s)t.elm.sidebar.filterOptions.addClass(e.cl.hidden);else if(("blacklist"===s||"whitelist"===s)&&(t.elm.sidebar.filterOptions.removeClass(e.cl.hidden),0===t.elm.textarea.visibilityFilter[0].value.length)){const e=t.helper.model.getData("b/"+s);t.elm.textarea.visibilityFilter[0].value=e.join("\n")}}))},s=()=>{const e=t.helper.model.getData("b/toggleArea");["width","height","top","widthWindowed"].forEach((a=>{t.elm.range["toggleArea_"+a][0].value=e[a],t.elm.range["toggleArea_"+a].trigger("change")}))},n=async()=>{const a=t.elm.sidebar.toggleArea.children("div["+e.attr.type+"='preview']"),s=a.children("div");e([t.elm.range.toggleArea_width,t.elm.range.toggleArea_height,t.elm.range.toggleArea_top]).on("change input",(n=>{const i=+t.elm.range.toggleArea_width[0].value,r=+t.elm.range.toggleArea_height[0].value,l=+t.elm.range.toggleArea_top[0].value;if(r+l>100){let e=null;n.currentTarget===t.elm.range.toggleArea_height[0]?e=l-(r+l-100):n.currentTarget===t.elm.range.toggleArea_top[0]&&(e=100-r),null!==e&&(t.elm.range.toggleArea_top[0].value=e,t.elm.range.toggleArea_top.trigger("change"))}else a.css("width",19+i+"px"),s.css({height:r+"%",top:l+"%"}),100===r?s.addClass(e.cl.settings.toggleArea.fullHeight):s.removeClass(e.cl.settings.toggleArea.fullHeight)})),s.on("mousedown",(t=>{s.addClass([e.cl.settings.toggleArea.dragged,e.cl.settings.toggleArea.dragging]),s.data("pos",{start:s[0].offsetTop,y:t.pageY})})),t.elm.body.on("mouseup",(async()=>{await e.delay(0),s.removeClass(e.cl.settings.toggleArea.dragging)})).on("mousemove",(n=>{if(s.hasClass(e.cl.settings.toggleArea.dragging)&&1===n.buttons){const e=s.data("pos");t.elm.range.toggleArea_top[0].value=(e.start+n.pageY-e.y)/a[0].offsetHeight*100,t.elm.range.toggleArea_top.trigger("change")}}),{passive:!0})},i=()=>{t.elm.sidebar.previewVideos.forEach((e=>{e.controls=!1,e.loop=!0,e.muted=!0,e.play()}))},r=async()=>{const a=t.elm.aside.find("li["+e.attr.name+"='indicator']");e(document).on(e.opts.events.pageChanged,(e=>{e.detail.path&&"sidebar"===e.detail.path[0]&&i()})),t.elm.sidebar.previewVideos.parent().on("click",(t=>{t.preventDefault();const a=e(t.currentTarget).attr(e.attr.type);a&&e(t.currentTarget).children("span").length()>0&&(location.hash="sidebar_"+a)})),t.elm.checkbox.overlayEnabled.children("input[type='checkbox']").on("change",(()=>{const s=t.elm.sidebar.overlayContent.find("div."+e.cl.settings.hideable);t.helper.checkbox.isChecked(t.elm.checkbox.overlayEnabled)?(a.removeClass(e.cl.hidden),s.removeClass(e.cl.hidden),t.elm.sidebar.previewVideoOverlay.removeClass(e.cl.disabled),t.elm.select.openAction.trigger("change")):(a.addClass(e.cl.hidden),s.addClass(e.cl.hidden),t.elm.sidebar.previewVideoOverlay.addClass(e.cl.disabled),t.elm.select.iconAction[0].value="sidepanel"),l()})),t.elm.select.sidebarPosition.on("change",(a=>{t.elm.sidebar.toggleArea.attr(e.attr.type,a.currentTarget.value)})),t.elm.select.openAction.on("change",(s=>{t.helper.checkbox.isChecked(t.elm.checkbox.overlayEnabled)&&("contextmenu"===s.currentTarget.value||"mousedown"===s.currentTarget.value?a.removeClass(e.cl.hidden):a.addClass(e.cl.hidden),"icon"===s.currentTarget.value?(t.elm.sidebar.toggleArea.addClass(e.cl.hidden),t.elm.select.iconAction[0].value="overlay"):t.elm.sidebar.toggleArea.removeClass(e.cl.hidden),l())})),t.elm.select.rememberState.on("change",(a=>{"nothing"===a.currentTarget.value?t.elm.sidebar.rememberOpenStatesSubDirectories.addClass(e.cl.hidden):t.elm.sidebar.rememberOpenStatesSubDirectories.removeClass(e.cl.hidden)})),t.elm.buttons.keyboardShortcut.on("click",(e=>{e.preventDefault(),t.helper.model.call("openLink",{href:"chrome://extensions/shortcuts",newTab:!0,active:!0})})),t.elm.buttons.sidepanelSettings.on("click",(e=>{e.preventDefault(),t.helper.model.call("openLink",{href:"chrome://settings/appearance#:~:text=Side%20panel",newTab:!0,active:!0})}))},l=()=>{const e=t.elm.select.openAction[0].value,a=t.helper.checkbox.isChecked(t.elm.checkbox.overlayEnabled);"icon"!==e&&a?t.elm.select.iconAction.removeAttr("disabled"):t.elm.select.iconAction.attr("disabled","disabled").trigger("change")}},e.SupportHelper=function(t){let a=null;const s={displayed:[],opened:[],closed:[]};this.init=async()=>{if(t.serviceAvailable){const a=t.helper.menu.getPath(),s=a.length>=2&&"support"===a[0]&&"error"===a[1]&&a[2];s&&t.elm.support.wrapper.addClass(e.cl.settings.support.onlySuggestions),t.elm.field.feedbackEmail.attr("placeholder","your@mail.com"),p(),await i(),s&&l(a[2]),"support"===a[0]&&d(),await e.delay(500)}else t.elm.support.form.addClass(e.cl.hidden),t.elm.support.faq.addClass(e.cl.hidden),e("<p></p>").addClass(e.cl.error).html(t.helper.i18n.get("status_feedback_unavailable_desc")+"<br />").append("<a href='mailto:feedback@redeviation.com'>feedback@redeviation.com</a>").insertAfter(t.elm.support.form)};const n=()=>{const e=t.elm.support.feedback[0].offsetHeight;t.elm.support.suggestions.css("max-height",e+"px")},i=async()=>{const t=await e.xhr(e.opts.website.feedback.suggestions);if(t&&t.responseText){const s=t.responseText.replace(/\{browserName\}/gi,e.browserName),n=JSON.parse(s);n&&n.suggestions&&n.controls&&(a=n)}const n="other_browser";r()&&a&&a.suggestions&&a.suggestions&&a.suggestions[n]&&(s.displayed.push(n),o(n,a.suggestions[n]))},r=()=>{try{return navigator.userAgentData.brands.map((e=>e.brand)).includes("Brave")}catch(e){}return/OPERA|OPR\//i.test(navigator.userAgent)},l=e=>{let t=[],n=!1;"general"===e?t=["not_working","webstore","system_pages"]:"filter"===e&&(t=["blacklisted_whitelisted"],n=!0),t.forEach((e=>{a&&a.suggestions&&a.suggestions[e]&&(s.displayed.push(e),o(e,a.suggestions[e],n))}))},o=(s,n,i=!1)=>{if(a&&a.controls){t.helper.model.call("track",{name:"action",value:{name:"suggestion_display",value:s},always:!0});const r=e("<div></div>").addClass([e.cl.settings.suggestion,e.cl.hidden,e.cl.settings.support.absolute]).attr(e.attr.type,s).append("<strong>"+n.question.message+"</strong>").append("<div class='"+e.cl.settings.support.answer+"'>"+n.answer.message+"</div>").appendTo(t.elm.support.suggestions);e("<p></p>").append("<a "+e.attr.value+"='1'>"+a.controls.yes.message+"</a>").append("<a "+e.attr.value+"='0'>"+a.controls.no.message+"</a>").appendTo(r),r.data("links",n.answer.links||[]);const l=r.children("div."+e.cl.settings.support.answer);e.delay().then((()=>(l.css("height",l[0].offsetHeight+"px"),l.addClass([e.cl.settings.support.noHeight,e.cl.hidden]),e.delay(300)))).then((()=>(r.css("height",r[0].offsetHeight+"px"),r.addClass(e.cl.settings.support.noHeight),e.delay(300)))).then((()=>(r.removeClass([e.cl.settings.support.absolute,e.cl.settings.support.noHeight]),e.delay(300)))).then((()=>{r.css("height","").removeClass(e.cl.hidden),t.elm.support.suggestions.addClass(e.cl.visible),i&&c(r)}))}},c=n=>{const i=n.attr(e.attr.type);s.opened.push(i),t.helper.model.call("track",{name:"action",value:{name:"suggestion_clicked",value:i},always:!0});const r=n.children("p").html("");r.attr(e.attr.type,"answer"),n.data("links").forEach((t=>{let a=t.target;e.opts.urlAliases[e.browserName]&&e.opts.urlAliases[e.browserName][a]&&(a=e.opts.urlAliases[e.browserName][a]),e("<a></a>").attr("href",a).text(t.message).appendTo(r)})),n.parent()[0]!==t.elm.support.faq[0]&&e("<a></a>").attr(e.attr.value,"0").text(a.controls.close.message).appendTo(r),n.children("div."+e.cl.settings.support.answer).removeClass(e.cl.settings.support.noHeight),e.delay(300).then((()=>{n.children("div."+e.cl.settings.support.answer).removeClass(e.cl.hidden)}))},d=()=>{t.elm.support.faq.children("div."+e.cl.settings.suggestion).length()>0||(a&&a.suggestions&&a.controls?(t.elm.support.faq.addClass(e.cl.loading),t.elm.support.feedback.addClass(e.cl.hidden),Object.entries(a.suggestions).some((([a,s])=>{if(s.question&&s.question.faq){const n=e("<div></div>").addClass(e.cl.settings.suggestion).attr(e.attr.type,a).append("<strong>"+s.question.faq+"</strong>").append("<div class='"+e.cl.settings.support.answer+"'>"+s.answer.message+"</div>").append("<p></p>").appendTo(t.elm.support.faq);n.data("links",s.answer.links||[]);const i=n.children("div."+e.cl.settings.support.answer);e.delay().then((()=>(i.css("height",i[0].offsetHeight+"px"),i.addClass([e.cl.settings.support.noHeight,e.cl.hidden]),t.elm.support.faq.removeClass(e.cl.hidden),e.delay(300)))).then((()=>(n.css("height","").removeClass(e.cl.hidden),t.elm.support.faq.removeClass(e.cl.loading),e.delay(120)))).then((()=>{t.elm.support.feedback.removeClass(e.cl.hidden)}))}}))):t.elm.support.faq.addClass(e.cl.hidden))},p=()=>{e(document).on(e.opts.events.pageChanged,(e=>{e.detail.path&&"support"===e.detail.path[0]&&d()})),e(window).on("resize",(()=>{n()}),{passive:!0}),t.elm.textarea.feedbackMsg.on("mouseup",(()=>{n()})).on("keyup",(e=>{var t;t=e.currentTarget.value,a&&a.suggestions&&Object.entries(a.suggestions).some((([e,a])=>{let n=!1;if(a.keywords.some((e=>{if(t.search(new RegExp(e,"i"))>-1)return n=!0,!0})),n&&-1===s.displayed.indexOf(e))return s.displayed.push(e),o(e,a),!0}))})),t.elm.support.showForm.on("click",(a=>{a.preventDefault(),t.elm.support.wrapper.removeClass(e.cl.settings.support.onlySuggestions);const s=t.elm.support.feedback[0].getBoundingClientRect();t.elm.content[0].scrollTop=s.y})),e([t.elm.support.suggestions,t.elm.support.faq]).on("click","a[href]:not([href^='#'])",(t=>{t.preventDefault(),e.api.tabs.create({url:e(t.currentTarget).attr("href"),active:!0})})),t.elm.support.suggestions.on("click","a["+e.attr.value+"]",(a=>{a.preventDefault();const n=+e(a.currentTarget).attr(e.attr.value),i=e(a.currentTarget).parents("div."+e.cl.settings.suggestion).eq(0);1===n?c(i):(a=>{s.closed.push(a.attr(e.attr.type)),a.css("height",a[0].offsetHeight+"px").addClass(e.cl.hidden),e.delay(200).then((()=>(a.addClass(e.cl.settings.support.noHeight),e.delay(300)))).then((()=>(a.remove(),e.delay()))).then((()=>{0===t.elm.support.suggestions.children("div."+e.cl.settings.suggestion).length()&&(t.elm.support.suggestions.removeClass(e.cl.visible),e.delay(300).then((()=>{t.elm.support.wrapper.removeClass(e.cl.settings.support.onlySuggestions)})))}))})(i)})),t.elm.support.faq.on("click","div."+e.cl.settings.suggestion+" > strong",(t=>{const a=e(t.currentTarget).parent().eq(0);c(a)})),t.elm.support.uploadField.on("change",(e=>{e.currentTarget.files&&h(e.currentTarget.files)})),t.elm.support.uploadedFiles.on("click","a."+e.cl.close,(t=>{t.preventDefault(),e(t.currentTarget).parent("li").remove()})),t.elm.support.send.on("click",(e=>{e.preventDefault(),m()}))},h=a=>{if(a.length+t.elm.support.uploadedFiles.children("li").length()>3)window.alert(t.helper.i18n.get("settings_support_feedback_screenshot_error_amount",[3]));else{for(const s of a){if(!s.type.match("image"))continue;const a=new FileReader;(s.size/1024).toFixed(4)>1024?window.alert(t.helper.i18n.get("settings_support_feedback_screenshot_error_filesize",[s.name])):(a.onload=a=>{try{e("<li></li>").append("<img src='"+a.target.result+"' />").append("<span>"+s.name+"</span>").append("<a class='"+e.cl.close+"'></a>").appendTo(t.elm.support.uploadedFiles)}catch(a){}},a.readAsDataURL(s))}t.elm.support.uploadField[0].value=""}},m=async()=>{const a=t.elm.textarea.feedbackMsg[0].value,n=t.elm.field.feedbackEmail[0].value,i=0===n.length||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n),r=a.length>0;if(i&&r){const i=+new Date,r=t.helper.template.loading().appendTo(t.elm.body);t.elm.body.addClass(e.cl.loading);let l=null;const o=[];t.elm.support.uploadedFiles.find("> li > img").forEach((t=>{o.push(e(t).attr("src"))}));const c=t.helper.importExport.getExportConfig();c.utility&&c.utility.newtabBackground&&delete c.utility.newtabBackground;try{const i=await e.xhr(e.opts.website.feedback.form,{method:"POST",timeout:3e4,data:{email:n,msg:a,version:e.opts.manifest.version_name,lastUpdate:await t.helper.model.call("lastUpdateDate"),ua:navigator.userAgent,browser:e.ua().browser,lang:t.helper.i18n.getLanguage(),userType:t.helper.model.getUserType(),screenshots:JSON.stringify(o),config:JSON.stringify(c,null,2),suggestions:s}});l=JSON.parse(i.responseText)}catch(e){console.error(e),l={success:!1}}await e.delay(Math.max(0,1e3-(+new Date-i))),t.elm.body.removeClass(e.cl.loading),r.remove(),l&&l.success&&!0===l.success?(t.helper.model.call("track",{name:"action",value:{name:"feedback",value:"true"},always:!0}),t.elm.textarea.feedbackMsg[0].value="",t.elm.field.feedbackEmail[0].value="",t.elm.support.uploadedFiles.html(""),t.showSuccessMessage("support_feedback_sent_message")):(await e.delay(),alert(t.helper.i18n.get("settings_support_feedback_send_failed")))}else i?r||t.elm.textarea.feedbackMsg.addClass(e.cl.error):t.elm.field.feedbackEmail.addClass(e.cl.error);await e.delay(700),e("."+e.cl.error).removeClass(e.cl.error)}},e.TranslationHelper=function(t){let a={},s=[];const n={},i={};this.init=async()=>{if(await l(),c(),t.serviceAvailable)try{await o(),d(),f();const e=t.helper.menu.getPath();e&&"translate"===e[1]&&p()}catch(e){console.error(e),h()}else h()},this.submit=()=>new Promise((a=>{const s=t.elm.translation.langvars.data("lang");if(s){const a=+new Date,n=t.helper.template.loading().appendTo(t.elm.body);t.elm.body.addClass(e.cl.loading);const i={};t.elm.translation.wrapper.find("div."+e.cl.settings.translation.category+"["+e.attr.settings.translation.language+"='"+s+"']").forEach((t=>{e(t).find("textarea").forEach((t=>{let a=t.value;if(a&&a.trim().length>0){const s=e(t).data("initial");if(a=a.trim(),a!==s){const s=e(t).data("name");i[s]=a}}}))}));let l=0;e.xhr(e.opts.website.translation.submit,{method:"POST",data:{lang:s,vars:i}}).then((()=>r(s,i))).then((t=>(l=t.translatedAmount,e.delay(Math.max(0,1e3-(+new Date-a)))))).then((()=>(n.remove(),t.showSuccessMessage("translation_submit_message"),e.delay(1500)))).then((()=>{t.elm.body.removeClass(e.cl.loading),"premium"!==t.helper.model.getUserType()&&l>=30&&!1===t.helper.model.getData("u/translationThanked")?w(s,l):x(s)}))}else a()}));const r=(t,a)=>new Promise((s=>{const n="translated_"+t;e.api.storage.local.get([n],(t=>{let i=[];t&&t[n]&&(i=t[n]),Object.keys(a).forEach((e=>{-1===i.indexOf(e)&&i.push(e)}));const r=i.length;r>0&&e.api.storage.local.set({[n]:i},(()=>{e.api.runtime.lastError,s({translatedAmount:r})}))}))})),l=()=>new Promise((n=>{e.api.storage.sync.get(["translationInfo"],(e=>{s=e.translationInfo||[],t.helper.model.call("languageInfos").then((e=>{a=e.infos,n()}))}))})),o=()=>new Promise(((s,n)=>{t.elm.translation.overview.children("div."+e.cl.settings.boxWrapper).html(""),e.xhr(e.opts.website.translation.info).then((n=>{const i=JSON.parse(n.responseText);if(i&&i.languages){const s=t.helper.i18n.getLanguage();i.languages.sort(((e,t)=>t.varsAmount!==e.varsAmount?t.varsAmount-e.varsAmount:a[e.name]&&a[t.name]?a[e.name].label>a[t.name].label?1:-1:1));const n=Object.assign({},a);i.languages.forEach((r=>{if(a[r.name]){const l=r.varsAmount/i.varsAmount*100;if(l>=15){delete n[r.name];let o="draft";const c=Math.floor(l);a[r.name].available&&(o=i.varsAmount>r.varsAmount?"incomplete":"released");const d=e("<div></div>").data("lang",r.name).addClass(e.cl.settings.box).attr(e.attr.settings.translation.releaseStatus,o).append("<a href='#' class='"+e.cl.settings.translation.edit+"'></a>").append("<strong>"+a[r.name].label+"</strong>").append("<div class="+e.cl.settings.translation.progress+" "+e.attr.value+"='"+c+"%'><div style='width:"+c+"%'></div></div>").append("<span title='"+t.helper.i18n.get("settings_translation_status_"+o)+"'></span>").appendTo(t.elm.translation.overview.children("div."+e.cl.settings.boxWrapper));s===r.name&&(m(r.categories,i.categories)&&(t.elm.aside.find("li["+e.attr.name+"='language']").addClass(e.cl.settings.incomplete),e("<span></span>").attr("title",t.helper.i18n.get("settings_translation_incomplete_info")).appendTo(t.elm.aside.find("li["+e.attr.name+"='language'] > a"))),d.addClass(e.cl.settings.translation.mark))}}})),g(n)}t.elm.translation.overview.addClass(e.cl.visible),s()}),(()=>{n()}))})),c=()=>{t.elm.translation.goto.on("click",(e=>{e.preventDefault(),location.hash="language_translate"})),t.elm.checkbox.translationInfo.children("input").on("change input",(a=>{if(t.elm.translation.langvars.hasClass(e.cl.loading))return;const n=a.currentTarget.checked,i=t.elm.translation.langvars.data("lang"),r=s.indexOf(i);n&&-1===r?s.push(i):!1===n&&-1!==r&&s.splice(r,1),e.api.storage.sync.set({translationInfo:s}),t.showSuccessMessage("saved_message")})),e(document).on(e.opts.events.pageChanged,(e=>{e.detail.path&&"translate"===e.detail.path[1]&&(e.detail.path[2]?x(e.detail.path[2]):t.serviceAvailable?p():h())}))},d=()=>{t.elm.translation.overview.find("select."+e.cl.settings.translation.select).on("change",(e=>{x(e.currentTarget.value)})),t.elm.translation.overview.find("div."+e.cl.settings.box).on("click",(t=>{t.preventDefault();const a=e(t.currentTarget).data("lang");a&&x(a)}))},p=()=>{t.elm.translation.wrapper.find("."+e.cl.visible).removeClass(e.cl.visible),t.elm.translation.overview.addClass(e.cl.visible),t.elm.buttons.save.addClass(e.cl.hidden)},h=()=>{t.elm.translation.unavailable.addClass(e.cl.visible),t.elm.translation.wrapper.hasClass(e.cl.active)&&t.elm.buttons.save.addClass(e.cl.hidden)},m=(e,t)=>{let a=!1;return Object.keys(e).some((s=>{if(!t[s]||t[s].total>e[s])return a=!0,!0})),a},g=s=>{const n=e("<div></div>").addClass(e.cl.settings.box).appendTo(t.elm.translation.overview.children("div."+e.cl.settings.boxWrapper)),i=e("<select class='"+e.cl.settings.translation.select+"'></select>").appendTo(n);e("<option value=''></option>").text(t.helper.i18n.get("settings_translation_add_language")).appendTo(i);const r=[];Object.keys(s).forEach((t=>{r.push({elm:e("<option value='"+t+"'></option>").text(a[t].label),label:a[t].label})})),r.sort(((e,t)=>e.label>t.label?1:-1)),r.forEach((e=>{e.elm.appendTo(i)}))},u=a=>new Promise((s=>{const i=e=>{e&&void 0===n[a]&&(n[a]=e),s(e)};n[a]?i(n[a]):e.xhr(e.opts.website.translation.langvars,{method:"POST",data:{lang:a}}).then((e=>{const s=JSON.parse(e.responseText);if(s&&Object.getOwnPropertyNames(s).length>0){const e=t.helper.i18n.getDefaultLanguage(),n={[a]:s};a!==e?u(e).then((t=>{n.default=t[e],i(n)})):i(n)}else i(null)}))})),f=()=>{t.elm.translation.wrapper.on("click","a."+e.cl.settings.translation.back,(t=>{t.preventDefault();const a=e(t.currentTarget).parents("div."+e.cl.settings.translation.category).eq(0).attr(e.attr.settings.translation.language);x(a)})),t.elm.translation.wrapper.on("click","a."+e.cl.settings.translation.goto,(t=>{t.preventDefault();const a=e(t.currentTarget).attr(e.attr.value),s=e(t.currentTarget).parent("header").next("ul");b(a,s)})),t.elm.translation.langvars.on("click","div."+e.cl.settings.box,(t=>{t.preventDefault();const a=e(t.currentTarget),s=a.data("lang"),n=a.children("strong").text(),i=a.data("info");v(s,n,i)})),t.elm.translation.thanks.on("click","a",(a=>{a.preventDefault();const s=t.elm.translation.thanks.data("lang");if(e(a.currentTarget).hasClass(e.cl.close))x(s);else{const n=t.elm.field.translationEmail[0].value,i=t.elm.translation.thanks.data("translatedAmount");e(a.currentTarget).addClass(e.cl.loading);const r=t.helper.template.loading().appendTo(a.currentTarget);Promise.all([e.xhr(e.opts.website.translation.submit,{method:"POST",data:{lang:s,email:n,translatedAmount:i}}),e.delay(500)]).then((()=>(r.remove(),e(a.currentTarget).removeClass(e.cl.loading),e.delay(500)))).then((()=>{x(s)}))}}))},v=(a,s,n)=>{let r=t.elm.translation.wrapper.find("div."+e.cl.settings.translation.category+"["+e.attr.name+"='"+s+"']["+e.attr.settings.translation.language+"='"+a+"']");if(0===r.length()){const l=a+"_"+s,o=t.helper.i18n.getDefaultLanguage();r=e("<div></div>").attr(e.attr.name,s).attr(e.attr.settings.translation.language,a).addClass(e.cl.settings.translation.category).appendTo(t.elm.translation.wrapper);const c=e("<header></header>").appendTo(r),d=e("<ul></ul>").appendTo(r);n.category.vars.forEach(((s,i)=>{if(!1===s.translatable&&a!==o)return;const r=e("<li></li>").append("<div></div>").append("<div></div>").appendTo(d);let l="";a===o?l=s.value||"":n.defaults&&n.defaults.vars&&n.defaults.vars[i]&&(l=n.defaults.vars[i].value||""),e("<span></span>").html(l).appendTo(r.children("div").eq(0));const c=e("<footer></footer>").addClass(e.cl.sidebar.breadcrumb).data("name",s.label).html("<label>"+t.helper.i18n.get("settings_translation_variable_name")+":</label><div></div>").appendTo(r.children("div").eq(0));s.label.split(" - ").forEach((t=>{e("<span></span>").text(t).appendTo(c.children("div"))}));const p=s.value||"";e("<textarea></textarea>").data({initial:p,name:s.name}).text(p).attr("dir",n.dir).appendTo(r.children("div").eq(1)),0===p.length&&r.addClass(e.cl.settings.translation.empty)})),k(r),e("<a></a>").text(t.helper.i18n.get("settings_translation_back_to_overview")).addClass(e.cl.settings.translation.back).appendTo(c),i[l].total!==i[l].filled&&(e("<a></a>").addClass(e.cl.settings.translation.goto).attr(e.attr.value,"down").appendTo(c),e("<a></a>").addClass(e.cl.settings.translation.goto).attr(e.attr.value,"up").appendTo(c)),e("<span></span>").addClass(e.cl.settings.translation.amountInfo).html("<span>"+i[l].filled+"</span>&thinsp;/&thinsp;"+i[l].total).appendTo(c),c.css("top","-35px")}t.elm.translation.langvars.removeClass(e.cl.visible),r.addClass(e.cl.visible),t.helper.menu.addBreadcrumb({label:s,alias:s,depth:4}),e.delay(0).then((()=>{const t=r.children("ul");r.find("a."+e.cl.settings.translation.goto).length()>0&&b("down",t),y(a,t)}))},b=(a,s)=>{let n=null;if(s.find("li."+e.cl.hover).length()>0?n="up"===a?s.find("li."+e.cl.hover).eq(0).prevAll("li."+e.cl.settings.translation.empty):s.find("li."+e.cl.hover).eq(0).nextAll("li."+e.cl.settings.translation.empty):"down"===a&&(n=s.find("li."+e.cl.settings.translation.empty)),n&&n.length()>0){const e=n.eq(0);t.elm.content[0].scrollTop=Math.max(0,e[0].offsetTop-80),e.find("textarea")[0].focus()}},y=(a,s)=>{if(a!==t.helper.i18n.getDefaultLanguage()&&t.helper.model.getData("u/translationHelp")){let a=null;a="TEXTAREA"===document.activeElement.tagName?e(document.activeElement).parents("li").eq(0):s.children("li").eq(0),a.addClass(e.cl.settings.translation.mark);const n=a.find("footer."+e.cl.sidebar.breadcrumb).data("name");e("<span></span>").addClass(e.cl.settings.desc).html(t.helper.i18n.get("settings_translation_help",["<strong>"+n+"</strong>"])).prependTo(a),t.helper.model.setData({"u/translationHelp":!1})}},k=t=>{t.find("textarea").on("change input",(a=>{const s=e(a.currentTarget),n=a.currentTarget.value,r=t.attr(e.attr.name),l=t.attr(e.attr.settings.translation.language);n?s.parents("li").eq(0).removeClass(e.cl.settings.translation.empty):s.parents("li").eq(0).addClass(e.cl.settings.translation.empty),s.css("height",""),s.css("height",Math.max(a.currentTarget.scrollHeight,70)+"px");let o=0;t.find("textarea").forEach((e=>{e.value&&e.value.trim().length>0&&o++})),i[l+"_"+r].filled=o,t.find("span."+e.cl.settings.translation.amountInfo+" > span").text(o)})).on("focus",(a=>{t.find("li").removeClass(e.cl.hover),e(a.currentTarget).parents("li").eq(0).addClass(e.cl.hover)})).on("blur",(t=>{const a=e(t.currentTarget).parents("li").eq(0);e.delay(200).then((()=>{a.removeClass(e.cl.hover)}))})),e.delay().then((()=>{t.find("textarea").trigger("change")}))},w=(a,s)=>{t.helper.model.setData({"u/translationThanked":!0}),t.elm.translation.wrapper.find("div."+e.cl.settings.translation.category).removeClass(e.cl.visible),t.elm.translation.langvars.removeClass(e.cl.visible),t.elm.buttons.save.removeClass(e.cl.hidden),t.elm.translation.thanks.addClass(e.cl.visible).data({lang:a,translatedAmount:s})},x=n=>{t.helper.menu.addBreadcrumb({label:a[n].label,alias:n,depth:3}),t.elm.translation.langvars.data("lang",n),t.elm.translation.langvars.find("div."+e.cl.settings.boxWrapper).html(""),t.elm.translation.wrapper.find("div."+e.cl.settings.translation.category).removeClass(e.cl.visible),t.elm.buttons.save.removeClass(e.cl.hidden),t.elm.translation.thanks.removeClass(e.cl.visible),t.elm.translation.overview.removeClass(e.cl.visible),t.elm.translation.langvars.addClass([e.cl.visible,e.cl.loading]);const r=t.helper.template.loading().appendTo(t.elm.translation.langvars),l=t.helper.i18n.getDefaultLanguage();t.helper.checkbox.isChecked(t.elm.checkbox.translationInfo)!==(-1!==s.indexOf(n))&&t.elm.checkbox.translationInfo.trigger("click"),Promise.all([u(n),t.helper.model.call("rtlLangs")]).then((([a,s])=>{if(a){const r=a[n];Object.keys(r).forEach((o=>{const c=e("<div></div>").addClass(e.cl.settings.box).data("lang",n).data("info",{dir:s.indexOf(n)>-1?"rtl":"ltr",category:r[o],defaults:a.default?a.default[o]:null}).append("<strong>"+o+"</strong>").appendTo(t.elm.translation.langvars.children("div."+e.cl.settings.boxWrapper)),d=n+"_"+o;void 0===i[d]&&(i[d]={total:r[o].vars.length,filled:0},n!==l&&(i[d].total-=r[o].nonTranslatable),r[o].vars.forEach((e=>{e.value&&i[d].filled++}))),r[o].required&&e("<span></span>").addClass(e.cl.settings.translation.requiredInfo).text("("+t.helper.i18n.get("settings_translation_required_category")+")").appendTo(c),e("<span></span>").addClass(e.cl.settings.translation.amountInfo).html("<span>"+i[d].filled+"</span>&thinsp;/&thinsp;"+i[d].total).appendTo(c),i[d].total>i[d].filled&&c.addClass(e.cl.settings.incomplete)}))}else p();t.elm.translation.langvars.removeClass(e.cl.loading),r.remove()}))}};(new function(){this.elm={body:e("body"),title:e("head > title"),aside:e("body > section#wrapper > aside"),content:e("body > section#wrapper > main"),header:e("body > header"),headline:e("body > header > h1"),videos:e("body video[data-src]"),advanced:{toggle:e("div.advanced > h3"),container:e("div.advanced > div")},buttons:{save:e("body > header > menu > li > button.save"),restore:e("body > header > menu > li > button.restore"),keyboardShortcut:e("div.tab[data-name='sidebar'] a.keyboardShortcut"),sidepanelSettings:e("div.tab[data-name='sidebar'] a.sidepanelSettings"),toggleAreaGoto:e("body a.gotoToggleArea"),import:e("body a.import"),export:e("body a.export")},dashboard:{tipsTricks:e("div.tab[data-name='dashboard'] div.tipsTricks"),links:e("div.tab[data-name='dashboard'] div.links > ul > li > a"),footerVersion:e("div.tab[data-name='dashboard'] footer a.version"),footerLastUpdate:e("div.tab[data-name='dashboard'] footer span.lastUpdate"),footerCopyright:e("div.tab[data-name='dashboard'] footer div.copyright")},sidebar:{previewVideos:e("div.tab[data-name='sidebar'] div.preview video"),previewVideoOverlay:e("div.tab[data-name='sidebar'] div.preview div.video[data-type='overlay']"),overlayContent:e("div.tab[data-name='sidebar'] > div[data-name='overlay']"),toggleArea:e("div.tab[data-name='sidebar'] div.toggleArea"),rememberOpenStatesSubDirectories:e("div.tab[data-name='sidebar'] div.rememberOpenStatesSubDirectories"),filterOptions:e("div.tab[data-name='sidebar'] div.filterOptions")},appearance:{content:e("div.tab[data-name='appearance']"),selectedTheme:e("div.tab[data-name='appearance'] div.selectedTheme"),showThemes:e("div.tab[data-name='appearance'] a.showThemes"),themeListWrapper:e("div.tab[data-name='appearance'] div.themeList"),surfaceWrapper:e("div.tab[data-name='appearance'] div.surface"),presetWrapper:e("div.tab[data-name='appearance'] div.presets"),iconShapeWrapper:e("div.tab[data-name='appearance'] div[data-name='icon'] div.iconShapeWrapper"),iconColorWrapper:e("div.tab[data-name='appearance'] div[data-name='icon'] div.iconColorWrapper")},newtab:{content:e("div.tab[data-name='newtab']"),buttons:e("div.tab[data-name='newtab'] p.buttons"),faviconShapeWrapper:e("div.faviconOptions div.iconShapeWrapper"),faviconPreview:e("div.faviconOptions > aside > canvas")},importExport:{content:e("div.tab[data-name='export']")},expert:{content:e("div.tab[data-name='expert']"),search:e("div.tab[data-name='expert'] input.search"),template:e("div.tab[data-name='expert'] > template")},premium:{wrapper:e("div.tab[data-name='premium']")},support:{wrapper:e("div.tab[data-name='support']"),faq:e("div.tab[data-name='support'] > div.faq"),form:e("section.form"),send:e("section.form button[type='submit']"),feedback:e("div.tab[data-name='support'] div.feedbackWrapper"),showForm:e("div.tab[data-name='support'] div.suggestedAnswers > a"),uploadField:e("div.upload > input[type='file']"),uploadedFiles:e("ul.uploadedFiles"),suggestions:e("div.tab[data-name='support'] div.suggestedAnswers")},translation:{wrapper:e("div.tab[data-name='language'] > div[data-name='translate']"),goto:e("div.tab[data-name='language'] > div[data-name='general'] a.button"),overview:e("div.tab[data-name='language'] > div[data-name='translate'] > div.overview"),langvars:e("div.tab[data-name='language'] > div[data-name='translate'] > div.langvars"),thanks:e("div.tab[data-name='language'] > div[data-name='translate'] > div.thanks"),unavailable:e("div.tab[data-name='language'] > div[data-name='translate'] > div.unavailable")},formElement:e("div.formElement"),infos:{aboutWrapper:e("div.tab[data-name='infos'] div[data-name='aboutme']"),shareInfoWrapper:e("div.tab[data-name='infos'] div.shareInformation"),permissionsWrapper:e("div.tab[data-name='infos'] div.permissions")},preview:{},checkbox:{},range:{},select:{},color:{},textarea:{},field:{},radio:{}},this.serviceAvailable=!0;const t=["behaviour","appearance","newtab","expert"];let a=!1;this.run=async()=>{s();const t={body:this.helper.template.loading().appendTo(this.elm.body)};this.elm.body.addClass(e.cl.initLoading),await this.helper.model.init(),await this.helper.i18n.init(),this.elm.body.parent("html").attr("dir",this.helper.i18n.isRtl()?"rtl":"ltr"),this.helper.stylesheet.init({defaultVal:!0}),await Promise.all([this.helper.form.init(),this.helper.stylesheet.addStylesheets(["settings"],e(document))]),this.elm.body.removeClass(e.cl.building),this.helper.i18n.parseHtml(document),this.elm.title.text(this.elm.title.text()+" - "+this.helper.i18n.get("extension_name")),["translation","support"].forEach((a=>{t[a]=this.helper.template.loading().appendTo(this.elm[a].wrapper),this.elm[a].wrapper.addClass(e.cl.loading)})),await this.helper.menu.init(),await Promise.all([this.helper.dashboard.init(),this.helper.sidebar.init(),this.helper.appearance.init(),this.helper.newtab.init(),this.helper.infos.init(),this.helper.premium.init(),this.helper.expert.init(),this.helper.importExport.init()]),this.elm.videos.forEach((t=>{const a=e(t),s=a.attr(e.attr.src);this.helper.model.call("parsedUrl",{href:s}).then((t=>{a.removeAttr(e.attr.src),e("<source/>").attr("src",t).attr("type","video/mp4").appendTo(a)}))})),n(),t.body.remove(),this.elm.body.removeClass(e.cl.initLoading);const a=await this.helper.model.call("websiteStatus");this.serviceAvailable="available"===a.status;for(const a of["translation","support"])await this.helper[a].init(),t[a].remove(),this.elm[a].wrapper.removeClass(e.cl.loading)},this.addNoPremiumText=t=>{const a=e("<p></p>").addClass(e.cl.premium).html("<span>"+this.helper.i18n.get("premium_restricted_text")+"</span>").appendTo(t);e("<a></a>").text(this.helper.i18n.get("more_link")).appendTo(a).on("click",(e=>{e.preventDefault(),location.href="#premium"}))},this.showSuccessMessage=async t=>{a=!1,this.elm.buttons.save.removeClass(e.cl.info),this.elm.body.attr(e.attr.settings.success,this.helper.i18n.get("settings_"+t)),this.elm.body.addClass(e.cl.success),await e.delay(1500),this.elm.body.removeClass(e.cl.success)},this.highlightUnsavedChanges=async()=>{!1===a&&(a=!0,this.elm.buttons.save.addClass([e.cl.settings.highlight,e.cl.info]),await e.delay(1e3),this.elm.buttons.save.removeClass(e.cl.settings.highlight))};const s=()=>{this.helper={model:new e.ModelHelper(this),checkbox:new e.CheckboxHelper(this),template:new e.TemplateHelper(this),i18n:new e.I18nHelper(this),font:new e.FontHelper(this),stylesheet:new e.StylesheetHelper(this),translation:new e.TranslationHelper(this),menu:new e.MenuHelper(this),form:new e.FormHelper(this),dashboard:new e.DashboardHelper(this),sidebar:new e.SidebarHelper(this),newtab:new e.NewtabHelper(this),appearance:new e.AppearanceHelper(this),support:new e.SupportHelper(this),premium:new e.PremiumHelper(this),utility:new e.UtilityHelper(this),importExport:new e.ImportExportHelper(this),expert:new e.ExpertHelper(this),infos:new e.InfosHelper(this)}},n=async()=>{e.api.runtime.onMessage.addListener((async t=>{t&&t.action&&"reinitialize"===t.action&&"premiumActivated"===t.type&&(a=!1,await e.delay(2e3),location.reload(!0))})),e(window).on("beforeunload",(e=>{if(a){const t="Do you really want to leave without saving your changes?";return e.returnValue=t,t}})),e("img[loading='lazy']").on("load",(t=>{e(t.currentTarget).addClass(e.cl.settings.lazyloaded)})).forEach((t=>{t.complete&&0!==t.naturalHeight&&e(t).addClass(e.cl.settings.lazyloaded)})),e("input, textarea, select").on("keyup change input",(t=>{e(t.currentTarget).parent("["+e.attr.type+"='licenseKey']").length()>0||e(t.currentTarget).parent("["+e.attr.name+"='translationInfo']").length()>0||t.currentTarget===this.elm.expert.search[0]||e(t.currentTarget).parents("div."+e.cl.settings.translation.thanks).length()>0||this.highlightUnsavedChanges()})),e(document).on("click",(()=>{e("div."+e.cl.settings.dialog).removeClass(e.cl.visible)})),this.elm.body.on("click","div."+e.cl.settings.dialog,(e=>{e.stopPropagation()})),this.elm.body.on("click","div."+e.cl.settings.dialog+" > a",(async a=>{a.preventDefault(),a.stopPropagation();const s=e(a.currentTarget).parent("div").attr(e.attr.type);if(-1!==t.indexOf(s)){let t=[s];if("appearance"===s){const t=(await e.api.storage.local.get(["utility"])).utility||{};delete t.customCss,await e.api.storage.local.set({utility:t})}else"expert"===s&&(t=["behaviour","appearance","newtab"]);await e.api.storage.sync.remove(t),this.showSuccessMessage("restored_message"),e("div."+e.cl.settings.dialog).removeClass(e.cl.visible),await this.helper.model.call("reinitialize"),await e.delay(1500),this.helper.model.call("reloadIcon"),this.helper.model.call("reloadBrowserAction"),location.reload(!0)}})),this.elm.advanced.container.css("display","none"),this.elm.advanced.toggle.on("click",(async t=>{const a=e(t.currentTarget).next("div");a.hasClass(e.cl.visible)?(a.removeClass(e.cl.visible),await e.delay(300),a.css("display","none")):(a.css("display","flex"),await e.delay(0),a.addClass(e.cl.visible))})),this.elm.buttons.save.on("click",(async t=>{t.preventDefault();const a=this.helper.menu.getPath();"translate"===a[1]?this.helper.translation.submit():"expert"===a[0]?(await this.helper.expert.save(),await this.showSuccessMessage("saved_message"),await this.helper.model.call("reinitialize"),await e.delay(1500),this.helper.model.call("reloadIcon"),this.helper.model.call("reloadBrowserAction"),await e.delay(0),location.reload(!0)):(await Promise.all([this.helper.sidebar.save(),this.helper.appearance.save(),this.helper.newtab.save()]),await this.showSuccessMessage("saved_message"),await this.helper.model.call("reinitialize"),this.helper.model.call("reloadIcon"),this.helper.model.call("reloadBrowserAction"),await this.helper.model.init(),this.helper.expert.updateRawConfigList())})),this.elm.buttons.restore.attr("title",this.helper.i18n.get("settings_restore")),this.elm.buttons.restore.on("click",(a=>{a.preventDefault();const s=this.helper.menu.getPath();let n=s[0];if("sidebar"===n&&(n="behaviour"),-1!==t.indexOf(n)){e("div."+e.cl.settings.dialog).remove();const t=a.currentTarget.getBoundingClientRect(),i=e("<div></div>").attr(e.attr.type,n).addClass(e.cl.settings.dialog).append("<p>"+this.helper.i18n.get("settings_restore_confirm")+"</p>").append("<span>"+this.helper.i18n.get("settings_menu_"+s[0])+"</span>").append("<br />").append("<a>"+this.helper.i18n.get("settings_restore")+"</a>").css("left",t.left+"px").appendTo(this.elm.body);"expert"===n&&i.children("span").remove(),e.delay().then((()=>{i.addClass(e.cl.visible)}))}}))}}).run()})(jsu);
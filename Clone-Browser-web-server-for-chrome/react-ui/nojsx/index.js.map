{"version":3,"sources":["../js/index.js"],"names":["AppOptions","AppOption","FormControlLabel","Card","CardContent","Tooltip","FormGroup","Switch","AppBar","Container","Toolbar","Typography","Button","ThemeProvider","MaterialUI","Alert","MaterialUILab","createMuiTheme","colors","withStyles","styles","card","margin","appicon","marginRight","theme","palette","primary","main","secondary","blueGrey","status","danger","functions","optVerbose","app","k","val","bg","WSC","VERBOSE","DEBUG","optAllInterfaces","webapp","interfaces","optIPV6","optPreventSleep","setTimeout","updatedSleepSetting","optBackground","console","log","updateOption","backgroundSettingChange","port","v","assert","opts","optAutoStart","chrome","permissions","request","result","success","remove","optPrivateKey","optCertificate","optUseHttps","started","stop","start","window","reload","runtime","setup_events","keydown","evt","metaKey","ctrlKey","keyCode","fgapp","document","body","addEventListener","App","React","Component","state","showAdvanced","starting","lasterr","folder","message","constructor","props","classes","init","chromise","getBackgroundPage","appOptions","settings_ready","bind","allOpts","getAll","dCpy","Object","assign","get_webapp","get","on_status_change","on_webapp_change","setState","ui_ready","get_status","fs","entry","fullPath","computeMessage","JSON","stringify","urls","slice","gen_crypto","reasonStr","warn","cn","Date","toISOString","data","createCrypto","set","privateKey","cert","render","choose_folder","onfolder","onchoosefolder","fileSystem","chooseEntry","type","startStop","checked","onChange","optDisplay","optDoPortMapping","optRenderIndex","optAdvanced","optCORS","optStatic","optUpload","optModRewriteEnable","optModRewriteRegexp","optModRewriteNegate","optModRewriteTo","optHttpsInfo","renderOpts","_this","options","keys","map","deps","enabled","indent","dep","advOptions","advancedButton","e","preventDefault","httpsOptions","disable","hasCrypto","textBoxes","paddingLeft","WebkitUserSelect","item","url","AppWithStyles","ReactDOM","getElementById"],"mappings":"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","sourcesContent":["import {AppOptions, AppOption} from './options.js'\n\nconst {\n  FormControlLabel,\n  Card,\n  CardContent,\n  Tooltip,\n  FormGroup,\n  Switch,\n  AppBar,\n  Container,\n  Toolbar,\n  Typography,\n  Button,\n  ThemeProvider\n} = MaterialUI\n\nconst {Alert} = MaterialUILab;\n\nconst {createMuiTheme, colors, withStyles} = MaterialUI;\nconst styles = {\n  card: {margin: '10px'},\n  appicon: {marginRight: '10px'}\n};\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#3f51b5',\n    },\n    secondary: colors.blueGrey,\n  },\n  status: {\n    danger: 'orange',\n  },\n});\n\n\nconst functions = {\n  optVerbose: function(app, k, val) {\n    const {bg} = app;\n    bg.WSC.VERBOSE = bg.WSC.DEBUG = val\n  },\n  optAllInterfaces: function(app, k, val) {\n    app.webapp.interfaces = []\n  },\n  optIPV6: function(app, k, val) {\n    // reset the list of interfaces\n    app.webapp.interfaces = []\n  },\n  optPreventSleep: function(app, k, val) {\n    // do it after the setting is changed\n    setTimeout(() => {\n      app.webapp.updatedSleepSetting()\n    }, 1);\n  },\n  optBackground: function(app, k, val) {\n    const {webapp, bg} = app;\n    console.log('background setting changed',val)\n\t\twebapp.updateOption('optBackground',val)\n    // appOptions.set('optBackground', val)\n    bg.backgroundSettingChange({'optBackground':val})\n  },\n  port: (app, k, v) => {\n    console.log('persist port', v)\n    console.assert(typeof v === 'number')\n    app.webapp.opts.port = v\n    app.webapp.port = v // does it still need to be set here?\n  },\n  optAutoStart: function(app, k, val) {\n    const {bg, webapp} = app;\n\t\tif (val) {\n\t\t\tchrome.permissions.request({permissions:['background']}, function(result) {\n\t\t\t\tconsole.log('request perm bg',result)\n\t\t\t\tif (result) {\n\t\t\t\t\tsuccess()\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\tchrome.permissions.remove({permissions:['background']}, function(result) {\n\t\t\t\tconsole.log('drop perm bg',result)\n\t\t\t\tsuccess()\n\t\t\t})\n\t\t}\n\t\tfunction success() {\n\t\t\tconsole.log('persist setting start in background',val)\n\t\t\twebapp.opts.optBackground = val\n\t\t\tbg.backgroundSettingChange({'optBackground':val})\n\t\t}\n  },\n  optPrivateKey: (app, k, val) => {\n    //console.log('privateKey')\n    console.assert(typeof val === 'string')\n    app.webapp.updateOption('optPrivateKey', val);\n  },\n  optCertificate: (app, k, val) => {\n    //console.log('certificate');\n    console.assert(typeof val === 'string')\n    app.webapp.updateOption('optCertificate', val);\n  },\n  optUseHttps: (app, k, val) => {\n    console.log(\"useHttps\", val);\n    app.webapp.updateOption('optUseHttps', val);\n    if (app.webapp.started) {\n      app.webapp.stop();\n      app.webapp.start();\n    }\n  }\n};\n\n\nwindow.reload = chrome.runtime.reload\nsetup_events()\nfunction setup_events() {\n  function keydown(evt) {\n    if (evt.metaKey || evt.ctrlKey) {\n      if (evt.keyCode == 82) {\n        // ctrl-r\n        console.log('received ctrl(meta)-r, reload app')\n        if (window.fgapp) {\n          fgapp.reload()\n        } else {\n          chrome.runtime.reload()\n        }\n      }\n      //evt.preventDefault() // dont prevent ctrl-w\n    }\n  }\n  document.body.addEventListener('keydown', keydown)\n}\n\n\nclass App extends React.Component {\n  state = {\n    showAdvanced: false,\n    interfaces: [],\n    port: 6669,\n    started: false,\n    starting: false,\n    lasterr: null,\n    folder: null,\n    message: ''\n  }\n  constructor(props) {\n    super(props)\n    this.classes = props.classes; // styling api\n    window.app = this\n    console.log('app created');\n    this.init()\n  }\n  async init() {\n    this.bg = await chromise.runtime.getBackgroundPage()\n    this.appOptions = new AppOptions(this.settings_ready.bind(this))\n  }\n  settings_ready() {\n    const allOpts = this.appOptions.getAll()\n    let dCpy = {};\n    Object.assign(dCpy, allOpts);\n    delete dCpy.optPrivateKey;// dont fill logs with crypto info\n    delete dCpy.optCertificate;\n\n    console.log('fetched local settings', this.appOptions, dCpy)\n    this.webapp = this.bg.get_webapp(allOpts) // retainStr in here\n    this.bg.WSC.VERBOSE = this.bg.WSC.DEBUG = this.appOptions.get('optVerbose')\n    this.webapp.on_status_change = this.on_webapp_change.bind(this)\n    this.setState(allOpts);\n    this.on_webapp_change()\n    this.ui_ready()\n  }\n  get_status() {\n    const result = {\n      starting: this.webapp && this.webapp.starting,\n      started: this.webapp && this.webapp.started,\n      lasterr: this.webapp && this.webapp.lasterr,\n      folder: this.webapp &&\n              this.webapp.fs &&\n              this.webapp.fs.entry &&\n              this.webapp.fs.entry.fullPath,\n    }\n    result.message = this.computeMessage(result)\n    return result\n  }\n  computeMessage({started, starting, lasterr}) {\n    if (lasterr) {\n      return JSON.stringify(lasterr)\n    } else if (starting) {\n      return 'STARTING'\n    } else if (started) {\n      return 'STARTED'\n    } else {\n      return 'STOPPED'\n    }\n  }\n  on_webapp_change() {\n    var status = this.get_status()\n    console.log('webapp changed',status)\n    this.setState({\n      ...status,\n      port: this.webapp.port,\n      interfaces: this.webapp.urls.slice()\n    })\n  }\n  gen_crypto() {\n  \tlet reasonStr = this.webapp.opts.optPrivateKey ? \"private key\" :\n  \t                   this.webapp.opts.optCertificate ? \"certificate\" : \"\";\n  \tif (reasonStr) {\n      console.warn(\"Would overwrite existing \" + reasonStr + \", erase it first\\nMake sure to save a copy first\");\n      return;\n    }\n    let cn = \"WebServerForChrome\" + (new Date()).toISOString();\n    let data = this.webapp.createCrypto(cn);\n    this.appOptions.set('optPrivateKey', data[cn].privateKey);\n    this.appOptions.set('optCertificate', data[cn].cert);\n    this.webapp.updateOption('optPrivateKey', data[cn].privateKey);\n    this.webapp.updateOption('optCertificate', data[cn].cert);\n    this.setState({optPrivateKey: data[cn].privateKey, optCertificate: data[cn].cert});\n    setTimeout(this.render, 50); // prevent race condition when ReactElement get set before opts have value\n  }\n  ui_ready() {\n    if (this.webapp) {\n      if (! (this.webapp.started || this.webapp.starting)) {\n        // autostart ?\n        this.webapp.start()\n      }\n    }\n  }\n  choose_folder() {\n    console.log('clicked choose folder')\n    function onfolder(folder) {\n      this.bg.onchoosefolder(folder)\n    }\n    chrome.fileSystem.chooseEntry({type:'openDirectory'}, onfolder.bind(this))\n  }\n  startStop(evt, checked) {\n    console.log('startstop', checked)\n    if (checked) this.webapp.start()\n    else this.webapp.stop()\n  }\n  onChange(k, v) {\n\t\tconsole.log('update and save',k,v)\n\t\tthis.webapp.updateOption(k,v) // also set on webapp.opts ?\n    // certain options require special manual handling (e.g. port has to set this.webapp.opts.port)\n    if (functions[k]) {\n      console.log('special handling for', k);\n      functions[k](this, k, v)\n    }\n\t\tthis.appOptions.set(k,v)\n    this.setState({[k]:v})\n  }\n  render() {\n    // option: [dependencies]\n    const optDisplay = {\n      optBackground: null,\n      optAutoStart: ['optBackground'],\n      optAllInterfaces: null,\n      optDoPortMapping: ['optAllInterfaces'],\n      optPreventSleep: null,\n      optRenderIndex: null,\n      port: null,\n    };\n    const optAdvanced = {\n      optCORS: null,\n      optIPV6: null,\n      optStatic: null,\n      optUpload: null,\n      optVerbose: null,\n      optModRewriteEnable: null,\n      optModRewriteRegexp: ['optModRewriteEnable'],\n      optModRewriteNegate: ['optModRewriteEnable'],\n      optModRewriteTo: ['optModRewriteEnable'],\n      optUseHttps: null\n    };\n    const optHttpsInfo = {\n      optPrivateKey: null,\n      optCertificate: null\n    };\n    console.assert(this);\n\n    const renderOpts = (opts) => {\n      const _this = this;\n      const options = [Object.keys(opts).map(k => {\n        const deps = opts[k] || []\n        let enabled = true\n        let indent = false\n        for (const dep of deps) {\n          indent = true\n          if (!this.state[dep]) {\n            enabled = false\n          }\n        }\n        return <AppOption indent={indent} disabled={!enabled} onChange={this.onChange.bind(this)} name={k} key={k} value={this.state[k]} appOptions={_this.appOptions} />\n      })];\n      return options;\n    }\n\n    const options = renderOpts(optDisplay)\n    const advOptions = renderOpts(optAdvanced)\n    const advancedButton = (<div><a href=\"#\" onClick={e => {\n      e.preventDefault();\n      this.setState({showAdvanced: !this.state.showAdvanced})\n    }}\n    >{this.state.showAdvanced ? 'Hide Advanced Options' : 'Show Advanced Options'}</a></div>)\n\n    const httpsOptions = (() => {\n      let disable = (!this.webapp || !this.webapp.opts.optUseHttps);\n      let hasCrypto = this.webapp && (this.webapp.opts.optPrivateKey || this.webapp.opts.optCertificate);\n      const textBoxes = renderOpts(optHttpsInfo)\n      return [(<div style={{paddingLeft: 20}}>{!disable && textBoxes}\n        {hasCrypto && !disable && <Alert severity=\"info\">To regenerate, remove key and cert. Be sure to take a copy first, for possible later use!</Alert>}\n        {!disable && <Button variant=\"contained\" key=\"crytobtn\" disabled={hasCrypto  ? true : false} onClick={e => {\n\t\t\t\t  e.preventDefault();\n\t\t\t\t  this.gen_crypto();\n\t\t\t\t}}>Generate crypto</Button>}\n\t  </div>)];\n    })();\n\n    const {state} = this;\n    return (<div>\n      <ThemeProvider theme={theme}>\n\n      <AppBar position=\"static\" color=\"primary\">\n        <Toolbar>\n          <img className={this.classes.appicon} src=\"/images/200ok-64.png\" />\n          <Typography variant=\"h6\" type=\"title\" color=\"inherit\">\n            Web Server for Chrome\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <Container>\n      <Card className={this.classes.card}>\n        <CardContent>\n          <p>Please <a\n                      target=\"_blank\"\n                      href=\"https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb/reviews\"\n            >leave a review</a> to help others find this software.\n          </p>\n        </CardContent>\n      </Card>\n\n      <Card className={this.classes.card}>\n        <CardContent>\n\n          <FormGroup>\n            <Tooltip title={'Click to start or stop the web server'}>\n              <FormControlLabel\n                label={`Web Server: ${state.message}`}\n                control={(\n                  <Switch\n                    disabled={state.starting}\n                             checked={state.started}\n                             onChange={this.startStop.bind(this)}\n                  />)}\n              />\n            </Tooltip>\n          </FormGroup>\n\n          <div>\n            <Button variant=\"contained\" onClick={this.choose_folder.bind(this)}>Choose Folder</Button>\n            <span>{state.folder ? ` Current: ${state.folder}` : 'NO FOLDER SELECTED'}</span>\n          </div>\n\n          <h3>Web Server URL(s)</h3>\n          <ul style={{WebkitUserSelect:'text'}}>\n            {state.interfaces.map((item) => {\n              return <li key={item.url}><a href={item.url} target=\"_blank\">{item.url}</a></li>\n            })}\n          </ul>\n        </CardContent>\n      </Card>\n\n      <Card className={this.classes.card}>\n        <CardContent>\n          <Tooltip title={'Some options may require a restart of the server. Restart by pressing the toggle button above'}>\n            <span>Options (may require restart)</span>\n          </Tooltip>\n          \n          {options}\n\n          {advancedButton}\n          {state.showAdvanced && <div>{advOptions}{httpsOptions}</div> }\n        </CardContent>\n      </Card>\n\n      <Card className={this.classes.card}>\n        <CardContent>\n          <p>Need to <a target=\"_blank\" href=\"https://github.com/kzahel/web-server-chrome/issues\">Report a problem</a>?\n            Open source, MIT license.</p>\n        </CardContent>\n      </Card>\n      </Container>\n\n    </ThemeProvider>\n    </div>)\n  }\n}\n\nconst AppWithStyles = withStyles(styles)(App);\n\nReactDOM.render(<AppWithStyles />, document.getElementById('app'))\n\n"],"file":"index.js"}
{"version":3,"sources":["../js/options.js"],"names":["FormControlLabel","MaterialUI","FormGroup","Switch","Checkbox","Tooltip","TextField","AppOption","disabled","indent","name","value","appOptions","onChange","parentOnChange","meta","type","label","validation","error","setError","React","useState","useEffect","evt","inval","val","undefined","target","process","console","log","newError","renderOption","Number","validationError","shrink","Boolean","help","String","get","marginLeft","options","port","parseInt","default","optAllInterfaces","optDoPortMapping","optIPV6","optCORS","optVerbose","optStatic","optTryOtherPorts","optRetryInterfaces","visible","optPreventSleep","optBackground","optAutoStart","depends","optRenderIndex","optUpload","optModRewriteEnable","optModRewriteRegexp","optModRewriteNegate","optModRewriteTo","optUseHttps","optPrivateKey","optCertificate","AppOptions","constructor","callback","chrome","storage","local","d","bind","k","getAll","Object","assign","key","set","v"],"mappings":"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","sourcesContent":["const { FormControlLabel } = MaterialUI\nconst { FormGroup } = MaterialUI\nconst {\n  Switch,\n  Checkbox,\n  Tooltip,\n  TextField,\n} = MaterialUI\n\nexport function AppOption({disabled, indent, name, value, appOptions, onChange: parentOnChange}) {\n  if (! appOptions) return 'Loading...'\n  const meta = appOptions.meta[name];\n  const {type, label, validation} = meta;\n\n  const [error, setError] = React.useState(false);\n  React.useEffect(() => {\n    // onChange(null, value) // why ?\n  }, []);\n\n  function onChange(evt, inval) {\n    let val = inval === undefined ? evt.target.value : inval;\n    if (meta.process) val = meta.process(val)\n    console.log('onChange', val);\n    if (validation) {\n      const newError = !validation(val)\n      if (error != newError) {\n        setError(newError)\n      }\n    }\n    parentOnChange(name, val)\n  }\n\n  function renderOption() {\n    switch(type) {\n      case Number: {\n        return (\n          <TextField\n            disabled={disabled}\n            error={error}\n            helperText={error ? meta.validationError : ''}\n            onChange={onChange}\n            value={value}\n            label={label}\n            type=\"number\"\n            InputLabelProps={{\n              shrink: true,\n            }}\n            margin=\"normal\"\n          />\n        )\n      }\n      case Boolean: {\n        return (<FormGroup>\n          <Tooltip title={meta.help || ''}>\n            <FormControlLabel\n              label={meta.label}\n              control={(\n                <Checkbox\n                  disabled={disabled}\n                           checked={!!value}\n                           onChange={onChange}\n                />)}\n            />\n          </Tooltip>\n        </FormGroup>)\n      }\n      case String: {\n        return (\n          <TextField\n            disabled={disabled}\n            onChange={onChange}\n            helperText={meta.label}\n            label={meta.label}\n            margin=\"normal\"\n            value={value}\n          />\n        )\n      }\n      default:\n        return <div>Option with {name} ({meta.type}) - {appOptions.get(name)}</div>\n    }\n  }\n\n  return (<div style={{marginLeft: indent ? '20px' : '0px'}}>\n    {renderOption()}\n  </div>)\n\n}\n\nconst options = {\n  port: {\n    name: \"Port\",\n    label: 'Enter Port',\n    help: 'Which port the web server will listen on',\n    process: val => parseInt(val, 10),\n    validation: (val) => {\n      return val >= 1024 && val <= 65535\n    },\n    validationError: 'Enter a number between 1024 and 65535',\n    type: Number,\n    default: 8887\n  },\n  optAllInterfaces: {\n    label: 'Accessible on local network',\n    help: 'Make the web server available to other computers on the local area network',\n    type: Boolean,\n    default: false\n  },\n  optDoPortMapping: {\n    label: 'Also on internet',\n    help: 'Attempt to open up a port on your internet router to make the server also available on the internet',\n    type: Boolean,\n    default: false\n  },\n  optIPV6: {\n    label: 'Listen on IPV6',\n    help: 'To have the server listen with IPV6',\n    type: Boolean,\n    default: false\n  },\n  optCORS: {\n    label: 'Set CORS headers',\n    help: 'To allow XMLHttpRequests from other origins',\n    type: Boolean,\n    default: false\n  },\n  optVerbose: {\n    label: 'Verbose logging',\n    help: 'To see web server logs, (navigate to \"chrome://inspect\", Extensions)',\n    type: Boolean,\n    default: false\n  },\n  optStatic: {\n    label: 'Plain (static) files view',\n    help: 'The files directory listing will not use any javascript',\n    type: Boolean,\n    default: false\n  },\n  optTryOtherPorts: {\n    type: Boolean,\n    default: false\n  },\n  optRetryInterfaces: {\n    type: Boolean,\n    visible: false,\n    default: true\n  },\n  optPreventSleep: {\n    label: 'Prevent computer from sleeping',\n    help: 'If the server is running, prevent the computer from going into sleep mode',\n    type: Boolean,\n    default: false\n  },\n  optBackground: {\n    label: 'Run in background',\n    help: 'Allow the web server to continue running, even if you close this window',\n    type: Boolean,\n    default: false\n  },\n  optAutoStart: {\n    label: 'Start on login',\n    help: 'Start the web server when you login, even if the web server window is not opened',\n    depends: [{optBackground: true}],\n    type: Boolean,\n    default: false\n  },\n  optRenderIndex: {\n    label: 'Automatically show index.html',\n    help: 'If the URL is a directory, automatically show an index.html if one is present',\n    type: Boolean,\n    default: true\n  },\n  optUpload: {\n    label: 'Allow File upload',\n    help: 'The files directory listing allows drag-and-drop to upload small files',\n    type: Boolean,\n    default: false\n  },\n  optModRewriteEnable: {\n    label: 'Enable mod-rewrite (for SPA)',\n    help: 'For SPA (single page apps) that support HTML5 history location',\n    type: Boolean,\n    default: false\n  },\n  optModRewriteRegexp: {\n    label: 'Regular Expression',\n    help: 'Any URL matching this regular expression will be rewritten',\n    type: String,\n    default: \".*\\\\.[\\\\d\\\\w]+$\" // looks like a file extension\n  },\n  optModRewriteNegate: {\n    label: 'Negate Regexp',\n    help: 'Negate the matching logic in the regexp',\n    type: Boolean,\n    default: true\n  },\n  optModRewriteTo: {\n    label: 'Rewrite To',\n    help: 'Which file to server instead of the actual path. For example, /index.html',\n    type: String,\n    default: '/index.html'\n  },\n  optUseHttps: {\n    label: 'Use https://',\n    help: 'Serve pages through https://',\n    type: Boolean,\n    default: false\n  },\n  optPrivateKey: {\n  \tlabel: 'Private key string',\n  \thelp: \"String containg private key, used in pair with certificate string.\\nEdit them in pairs\",\n  \ttype: String\n  },\n  optCertificate: {\n  \tlabel: 'Certificate string',\n  \thelp: \"String containg certificate, used in pair with private key string.\\nEdit them in pairs\",\n  \ttype: String \n  }\n}\n\nexport class AppOptions {\n  constructor(callback) {\n\t  this.meta = options\n\t  this.options = null\n\n\t  chrome.storage.local.get(null, function(d) {\n\t\t  this.options = d\n\t\t  // update options with default options\n\t\t  callback()\n\t  }.bind(this))\n  }\n  get(k) {\n\t\tif (this.options[k] !== undefined) return this.options[k]\n\t\treturn this.meta[k].default\n\t}\n\tgetAll() {\n\t\tvar d = {}\n\t\tObject.assign(d, this.options)\n\t\tfor (var key in this.meta) {\n\t\t\tif (d[key] === undefined && this.meta[key].default !== undefined) {\n\t\t\t\td[key] = this.meta[key].default\n\t\t\t}\n\t\t}\n\t\treturn d\n\t}\n\tset(k,v) {\n\t\tthis.options[k] = v\n\t\tvar d = {}\n\t\td[k] = v\n\t\tchrome.storage.local.set(d, function(){})\n\t}\n}\n"],"file":"options.js"}
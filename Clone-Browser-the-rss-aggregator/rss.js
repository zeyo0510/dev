!function(){function e(e){window.locale="default"!=Ze.locale?Ze.locale:chrome.i18n.getMessage("locale"),De.attr("title",i18n("add_url")),xe.html(i18n("send_feedback")),_e.attr("title",i18n("general_settings"));var t=$(".general");$(".add",t).val(i18n("add")),$(".edit",t).val(i18n("edit")),$(".delete",t).val(i18n("delete")),$(".import",t).val(i18n("import")+"..."),$(".export",t).val(i18n("export")+"..."),$(".change_language",t).parent(null).attr("seld",i18n("language")),$(".change_language option:first",t).html(i18n("default")+" ("+lingua.available_languages[chrome.i18n.getMessage("locale")]+")"),$(".add_translation",t).html(i18n("add_translation"));var n=$(".win");$(".ok_button",n).val(i18n("ok")),$(".cancel_button",n).val(i18n("cancel")),$(".close_button",n).val(i18n("close")),$(".p-name-td").html(i18n("name")),$(".p-address-td").html(i18n("address")),$(".p-givename-span").html(i18n("get_the_name")),$(".p-update-td").html(i18n("update")),$(".table-prop select option").each(function(){var e=$(this),t="",n=+e.val();if(0==n)t=i18n("never");else if(n<60)t=i18n("every_minutes",String(n));else if(60==n)t=i18n("every_hour");else if(10080==n)t=i18n("every_week");else{var i=n/60;t=2==i||3==i||24==i?i18n("every_hours1",String(i)):i18n("every_hours2",String(i))}e.html(t)});var i=$(".advanced-options",Ue);$("p",i).html(i18n("use_with_caution")),$(".reload-icons",i).val(i18n("reload_icons")),$(".reload-icons-aggressively",i).val(i18n("reload_icons_aggr")),$(".export-data",i).val(i18n("export_data")),$(".export-data-with-articles",i).val(i18n("export_data_art")),$(".delete-all-feeds",i).val(i18n("delete_all_feeds")),$(".reload",Ee).html(i18n("update_menu")),$(".mark-all-read",Ee).html(i18n("mark_all_as_read")),$(".delete",Ee).html(i18n("delete")),$(".properties",Ee).html(i18n("properties")+"..."),$(".select-all",qe).html(i18n("select_all")),$(".mark-as-read",qe).html(i18n("mark_as_read")),$(".mark-as-unread",qe).html(i18n("mark_as_unread")),$(".delete",qe).html(i18n("delete")),$(".undelete",qe).html(i18n("undelete")),$("#a-advanced-options").html(i18n("advanced_options")),$(".win .general").parents(".win").find(".title").html(i18n("general_settings")),e&&L(),Le.attr("placeholder",i18n("search_articles")),g();var a=$(".group-box.notifications",t);a.attr("seld",i18n("notifications")),$(".show-popup",a).next().html(i18n("show_popup")),$(".play-sound",a).next().html(i18n("play_sound")),ae(),Z(),$(".show-milestones",t).next().html(i18n("show_milestones"))}function t(){chrome.runtime.sendMessage({areYouReady:1},function(n){n?chrome.runtime.sendMessage({getOptions:1},function(t){Ze=t.options,e(!1),b()}):setTimeout(t,100)})}function n(){$(document).bind("contextmenu",function(e){var t=$(e.target);if(!t.is(":text")&&!rt[0].contains(e.target)){if(ke[0]!=e.target&&ke.has(t)){var n=t.closest("#feeds-div>div").data("id");n&&(i(e,Ee),Ee.data("id",n))}if(t.is(".item")||t.parent(null).is(".item")){var a=$(".undelete",qe);et.hasClass("deleted")?a.show():a.hide(),i(e,qe);var s=et.filter(".read").length,r=et.length-s,o=$(".mark-as-read",qe);r?o.removeAttr("disabled"):o.attr("disabled","disabled");var d=$(".mark-as-unread",qe);s?d.removeAttr("disabled"):d.attr("disabled","disabled")}return!1}}).mousedown(ye),$(".menu").mousedown(function(e){if(3==e.which||$(this).is(e.target)||$(e.target).is(".separator")||$(e.target).is("[disabled]"))return!1}),$(">div:not(.separator)",Ee).mousedown(function(){var e=$(this),t=Ee.data("id");if(e.is(".reload"))nt.click();else if(e.is(".mark-all-read")&&t&&Ve[t]){var n=Ve[t],i=[];for(var a in n.items)if(n.items.hasOwnProperty(a)){var s=n.items[a];if(s.read)continue;s.read=1,s.mdiv.addClass("read"),i.push({feed:t,guid:a})}i.length&&(L(),chrome.runtime.sendMessage({markRead:1,read:!0,items:i}))}e.is(".delete")&&t&&f(t,!1),e.is(".properties")&&t&&Fe==t&&Qe(Ve[Fe].mdiv)});var e={};e.read=1,$(">div:not(.separator)",qe).mousedown(function(){var e=$(this);if(!e.is("[disabled]"))if(e.is(".mark-as-read")||e.is(".mark-as-unread")){var t=+e.is(".mark-as-read"),n=[];et&&m(!t),et&&et.each(function(){var e=$(this),i=e.data("data"),a=i.feed,s=i.guid;e=Ve[a].items[s],t!==e.read&&n.push({feed:a,guid:s}),t?e.read=1:e.read&&delete e.read}),n.length&&(L(),chrome.runtime.sendMessage({markRead:1,read:!!t,items:n}))}else if(e.is(".delete"))dt.click();else if(e.is(".select-all"))v();else if(e.is(".undelete")){var i=h();et.removeClass("deleted"),et.each(function(){var e=$(this).data("data"),t=Ve[e.feed].items[e.guid];t.deleted&&(delete t.deleted,delete t.dateDeleted)}),chrome.runtime.sendMessage({undelete:1,items:z()}),L(),et.removeClass("selected"),S(i),Fe==Xe&&Z()}})}function i(e,t){t.css({left:e.clientX+1,top:e.clientY+1}).fadeIn(100);var n=e.clientY+1+t.outerHeight(!0)-$(window).height();n>0&&t.css("top",e.clientY-n)}function a(e){var t="feeds-list.opml",n=r();w(n.data,t,function(i){i||d(t,n.data),e(t,n.len)})}function s(e){var t=r();chrome.runtime.sendMessage({exportPlease:1,data:t.data},function(n){e(n,t.len)})}function r(){var e='<?xml version="1.0" encoding="utf-8"?>\n';e+='<opml version="1.0">\n',e+="\t<head>\n",e+="\t\t<title>"+i18n("exported")+"</title>\n",e+="\t</head>\n",e+="\t<body>\n";var t=0;for(var n in Ve)if(Ve.hasOwnProperty(n)){var i=Ve[n];e+='\t\t<outline text="'+o(i.name)+'" title="'+o(i.name)+'" ',e+='type="rss" xmlUrl="'+o(n)+'" />\n',++t}return e+="\t</body>\n",e+="</opml>",{data:e,len:t}}function o(e){return String(e).replace(/"/g,"&quot;").replace(/&/g,"&amp;")}function d(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/x-opml;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.click()}function l(e){chrome.runtime.sendMessage({importPlease:1},function(t){var n=u(t);e(n.cancelled,n.len)})}function u(e){var t=null===e,n=0;return t||(e=$.parseXML(e),e=$("opml>body>outline",e),e.each(function(){if("rss"==$(this).attr("type")){var e=$(this).attr("xmlUrl");if(e){var t=$(this).attr("title"),i=$(this).attr("text");t=t?t:i?i:e,Ve[e]||(++n,$e(e,t))}}}),n&&c()),{cancelled:t,len:n}}function c(){ke.mousedown(),Ce.mousedown()}function f(e,t){F("<p style='text-align:center'>"+i18n("are_you_sure")+"<p/>",i18n("delete"),function(){t&&t();var n=Ve[e].items;for(var i in n)n.hasOwnProperty(i)&&n[i].mdiv.remove();Ve[e].mdiv.remove(),delete Ve[e],vt[e]&&delete vt[e];for(var a in vt)vt.hasOwnProperty(a)&&(vt[a]=vt[a].filter(function(){return $(this).parent(null).length}));ee(Ye),L(),chrome.runtime.sendMessage({deleteFeed:e})})}function m(e){var t=(e?"remove":"add")+"Class";et[t]("read"),ot[t]("selected"),ot.attr("title",i18n(e?"read":"unread"))}function v(){var e=$(".item:visible",Ce);e.first().mousedown();var t=$.Event("mousedown");t.shiftKey=!0,ft=!1,e.last().trigger(t)}function p(){var e="16x16.png";K()&&Ve[Fe].favIcon&&(e=Ve[Fe].favIcon),Fe==Ye&&(e="feed.png"),Fe==Xe&&(e="delete.png"),Fe==Ge&&(e="pintab.png"),Fe==Ke&&(e="search.png"),$("#favicon").attr("href",e)}function h(){var e=et.last().nextAll(".item:visible:eq(0)");return e.length||(e=et.first().prevAll(".item:visible:eq(0)")),e}function g(){var e=Ie.data(),t={};e.feed&&e.guid&&(t=Ve[e.feed].items[e.guid]),Ie[(t.pinned?"add":"remove")+"Class"]("pinned"),Ie.attr("title",i18n(t.pinned?"unpin_message":"pin_message"))}function w(e,t,n){function i(e){n(!1,e)}window.requestFileSystem(1,1e8,function(a){a.root.getFile(t,{create:!0},function(a){var s=a.toURL();a.createWriter(function(a){var r=new Blob([e],{type:"text/plain"});a.onwriteend=function(){var e=document.createElement("a");e.setAttribute("href",s),e.setAttribute("download",t),e.click(),n(!0,s)},a.onerror=i,a.write(r)},i)},i)},i)}function b(){function e(e){var t="";return $(">div",e).each(function(){t+=$(this).data("id")}),t}function t(e,t){window.requestFileSystem(1,1e8,function(n){n.root.getDirectory("sounds",{create:!0},function(n){n.getFile(e.name,{create:!0},function(n){n.createWriter(function(i){i.onwriteend=function(){t(e.name,n.toURL())},i.write(e)})})})})}function n(e){function t(e){function t(e){var t=e.clientX-l+u;t=t>d?d:t<o?o:t,r.css("left",t),i(t)}function a(){r.removeClass("active"),$(document).unbind("mousemove",t).unbind("mouseup",a),Ze.volume=s(n()),chrome.runtime.sendMessage({changeOptions:1,options:{volume:Ze.volume}})}var l=e.clientX,u=n();$(document).bind("mousemove",t).bind("mouseup",a)}function n(){return parseFloat(r.css("left"))}function i(e){lt&&(lt.volume=s(e)/100)}function a(e){return o+e*(d-o)/100}function s(e){return Math.round(100*(e-o)/(d-o))}var r=$(".vol-hand",e),o=-5,d=95;return r.css("left",a(Ze.volume)),e.mousedown(function(e){if(!r.is(e.target)){r.addClass("active");var n=e.offsetX-5;return r.css("left",n),i(n),t(e),!1}}),r.mousedown(t),!1}function i(e,t){var n="",i=$(".settings",Ue).clone(),a=e.data("id");$("input.p-name",i).val(be(a)).prop("disabled",!Ve[a].useGivenName),$("input.p-givename",i).prop("checked",!Ve[a].useGivenName).change(function(){var e,t=!$(this).prop("checked");t&&(e=n,e||(e=Ve[a].givenName)),e||(e=Ve[a].name),e||(e=a);var s=$("input.p-name",i.win);t||(n=s.val().trim()),s.val(e).prop("disabled",!t)}),$("input.p-address",i).val(a),void 0!=Ve[a].update&&$("select option[value="+Ve[a].update+"]",i).prop("selected",!0),i=F(i.contents(),i18n("properties"),function(){var n=$("input.p-name",i.win).val().trim(),s=+$("option:selected",i.win).val(),r=!$("input.p-givename",i.win).prop("checked"),o=!1,d=!1,l={changeProperties:a};if(Ve[a].useGivenName!=r&&(o=!0,d=!0,l.useGivenName=r,Ve[a].useGivenName=r),r&&Ve[a].givenName!=n&&(o=!0,d=!0,Ve[a].givenName=n,l.givenName=n),Ve[a].update!=s&&(o=!0,Ve[a].update=s,l.update=s),d){var u=be(a);$(">div",e).text(u);for(var c in Ve[a].items)if(Ve[a].items.hasOwnProperty(c)){var f=Ve[a].items[c];f.author||$(".author",f.mdiv).text(u)}L(),t&&t(u)}o&&chrome.runtime.sendMessage(l)})}$(window).resize(he),$(".splitter").mousedown(pe),ve(),ke.add(".menu").add(Ce).disableSelection(),$(document).on("dblclick","div#feeds-div>div",function(){return i(Ve[Fe].mdiv),!1}),$(document).on("mousedown","div#feeds-div>div",function(){ee($(this).data("id"))}),Ie.click(function(){var e=$(this).data(),t=Ve[e.feed].items[e.guid];t.pinned?delete t.pinned:t.pinned=1;var n=h();if(g(),t.mdiv[(t.pinned?"add":"remove")+"Class"]("pinned"),chrome.runtime.sendMessage({setPin:1,pin:t.pinned,items:z()}),Fe==Ge&&t.mdiv.removeClass("selected"),vt[Ge]){S(n);var i=$();vt[Ge].each(function(){var e=$(this).data("data"),t=Ve[e.feed].items[e.guid];t.pinned&&(i=i.add(t.mdiv))}),vt[Ge]=i}L(),Fe==Ge&&Z()}),Ce.mousedown(function(e){$(e.target).is(this)&&($(".item.selected:visible",this).removeClass("selected"),j(0),rt.parent().hide(),$(">div",ke).removeClass("hlight"),vt[Fe]=et=$(),ot.add(dt).addClass("disabled").removeAttr("title").removeClass("selected")),e.preventDefault()}),$(document).keydown(function(e){if(!$(e.target).is("select")){if(e.ctrlKey&&(65==e.keyCode||97==e.keyCode))return v(),!1;var t=Ce.parent();if(38==e.keyCode||40==e.keyCode){var n=$(">.item.selected:visible",Ce);return n=n.length?38==e.keyCode?n.first().prevAll(".item:visible:first"):n.last().nextAll(".item:visible:first"):$(">.item:visible",Ce).first(),n.length&&(n.mousedown(),1==n.length&&n.is($(".item:visible:first",Ce))?t.scrollTop(0):t.scrollTo(n)),!1}return 35==e.keyCode?(n=$(".item:visible:last",Ce),n.mousedown(),n.length&&t.scrollTo(n),!1):36==e.keyCode?($(".item:visible:first",Ce).mousedown(),t.scrollTop(0),!1):34==e.keyCode?(t.scrollTop(t.scrollTop()+t.height()),!1):33==e.keyCode?(t.scrollTop(t.scrollTop()-t.height()),!1):void 0}}),$(document).keyup(function(e){46==e.keyCode&&dt.click()}),Ce.on("mousedown",".item",function(e){if(3!=e.which||!$(this).hasClass("selected")){var t=$(".item:visible",Ce);if(e.ctrlKey)$(this).toggleClass("selected");else if(t.removeClass("selected"),$(this).addClass("selected"),e.shiftKey&&ct[Fe]){var n=$(this).index(".item"),i=ct[Fe].index(".item");n>i&&(n+=i,i=n-i,n-=i),$(".item",Ce).each(function(e){var t=$(this);n<=e&&e<=i&&"none"!=window.getComputedStyle(t[0],null).getPropertyValue("display")&&t.addClass("selected")})}vt[Fe]=et=t.filter(".selected");var a=et.length;if(e.shiftKey&&1!=a||(ct[Fe]=$(this).hasClass("selected")?$(this):0),ft)return!1;if(1!=a&&rt.parent().hide(),a<=1&&j(0),1==a){var s=et.data("data");rt.parent().show(),G(s.feed,s.guid),$(this).hasClass("seen")||chrome.runtime.sendMessage({markSeen:1,feed:s.feed,guid:s.guid}),$(this).addClass("seen")}else a>1&&j(a);W(),V()}}),ke.mousedown(function(e){$(e.target).is(this)&&Fe!=Ye&&ee(Ye),e.preventDefault(),Le.blur()}),chrome.runtime.sendMessage({getFeeds:1},function(e){Ve=e.feeds,B()}),tt=$("td:eq(0) .reload-button",Re),tt.click(function(){tt.hasClass("disabled")||$(">div",ke).each(function(){var e=$(this).data("id");$(this).hasClass("loading")||Ve[e].disabled||chrome.runtime.sendMessage({updateFeed:e})})}),nt=$("td:eq(1) .reload-button",Re),nt.click(function(){nt.hasClass("disabled")||Ve[Fe].mdiv.hasClass("loading")||chrome.runtime.sendMessage({updateFeed:Fe})}),$(document).on("mousedown",".flist div",function(t){function n(e){var t=e.clientY-d;t=t<c?c:t>f?f:t,a.css("top",t),s.css("top",0);var n=t<0,i=n?a.prevAll():a.nextAll();t=Math.abs(t),i.each(function(){if(t<=0)return!0;var e=t<l?t:l;t-=e,$(this).css("top",n?e:-e)})}function i(){$(document).unbind("mousemove",n).unbind("mouseup",i);var t=u+Math.round(parseInt(a.css("top"),10)/l);if(s.length==t?r.append(a):s.eq(t).before(a),a.add(s).css("top",0).css("z-index",""),e(r)!=o){var d=1,c={};$(">div",r).each(function(){var e=$(this).data("id");c[e]=Ve[e].position=d++}),te(),chrome.runtime.sendMessage({savePositions:c})}}var a=$(this),s=a.siblings(),r=a.parent(null);if(a.addClass("selected"),s.removeClass("selected"),a.closest("table").find(".edit,.delete").prop("disabled",!1),!$(t.target).is(":checkbox")){a.css("z-index",3);var o=e(r),d=t.clientY,l=a.outerHeight(),u=a.index(),c=-u*l,f=a.nextAll().length*l;return $(document).mousemove(n).mouseup(i),!1}}),De.click(function(){O()}),_e.click(function(){function e(e,t){e||I("<p style='text-align:center'>"+i18n("feeds_imported",String(t))+"</p>",i18n("import")),b.prop("disabled",!1)}function r(e,t){D.append("<option value='"+e+"'>"+t+"</option>")}if(!_e.hasClass("disabled")){var o,d=$(".general",Ue).clone(),c=$(".flist",d).empty(),m=[];for(o in Ve)Ve.hasOwnProperty(o)&&m.push(o);m.sort(function(e,t){return Ve[e].position-Ve[t].position});for(var v=0;v<m.length;v++){o=m[v];var p=Ve[o],h=$("<div/>").append("<span>"+be(o)+"</span>"),g=$('<input type="checkbox" checked/>');g.prop("checked",!p.disabled),h.prepend(g),h.data("id",o);var w="16x16.png";p.favIcon&&(w=p.favIcon),h.css("background-image","url("+w+")"),c.append(h)}$(".edit,.delete",d).prop("disabled",!0),$(".delete",d).click(function(){var e=$(".flist div.selected",d.win),t=e.data("id");f(t,function(){e.remove(),$(".edit,.delete",d.win).prop("disabled",!0)})}),$(".edit",d).click(function(){var e=$(".flist div.selected",d.win);i(Ve[e.data("id")].mdiv,function(t){e.find("span").text(t)})}),$(".add",d).click(function(){O()});var b=$(".import,.export",d).prop("disabled",!1),y=He?s:a;$(".export",d).click(function(){b.prop("disabled",!0),y(function(e,t){e&&I("<p style='text-align:center'>"+i18n("feeds_exported",String(t))+"<br/>"+e+"</p>",i18n("export")),b.prop("disabled",!1)})});var M=He?0:$(".fileinput",d).change(function(t){if(t.target.files.length){var n=t.target.files[0],i=new FileReader;i.onloadend=function(t){var n=u(t.target.result);e(n.cancelled,n.len),M.val("")},i.readAsText(n)}else e(!0,0)});$(".import",d).click(function(){M&&M.click(),He&&(b.prop("disabled",!0),l(e))});var D=$(".change_language",d),S=lingua.available_languages;for(var N in S)S.hasOwnProperty(N)&&r(N,S[N]);$("option[value="+Ze.locale+"]",D).prop("selected",!0),D.change(function(){Ze.locale=$(this).val(),chrome.runtime.sendMessage({changeOptions:1,options:{locale:Ze.locale}})}),$(".add_translation",d).click(T),$(".show-popup",d).change(function(){Ze.showPopup=+this.checked,chrome.runtime.sendMessage({changeOptions:1,options:{showPopup:Ze.showPopup}})}).prop("checked",!!Ze.showPopup),$(".play-sound",d).change(function(){Ze.playSound=+this.checked,chrome.runtime.sendMessage({changeOptions:1,options:{playSound:Ze.playSound}})}).prop("checked",!!Ze.playSound),$(".show-milestones",d).change(function(){Ze.showMilestones=+this.checked,chrome.runtime.sendMessage({changeOptions:1,options:{showMilestones:Ze.showMilestones}}),Ze.showMilestones?(ae(),Z()):$(".day-panel",Ce).remove()}).prop("checked",!!Ze.showMilestones);var P=$(".select-sound",d);k(P),P.change(function(){_($("option:selected",this).data("audio")),Ze.sound=$(this).val(),chrome.runtime.sendMessage({changeOptions:1,options:{sound:Ze.sound}})}),$(".play_sound",d).click(function(){_($("option:selected",$(this).prev()).data("audio"))}).disableSelection(),$(".add-sound",d).click(function(){$('<input type="file" accept="audio/*"/>').click().change(function(e){e.target.files.length&&t(e.target.files[0],function(e,t){x(e,t,function(e,t,n){Ze.sound=t,$("option",P).each(function(){this.value==t&&$(this).remove()});var i=$("<option value='"+t+"'>"+e+"</option>");i.addClass("users"),i.data("audio",n),P.append(i),i.prop("selected",!0),C(P),P.change()})})})}),n($(".change-volume",d)),d=R(d,i18n("general_settings"));var F=$('<a id="a-advanced-options">'+i18n("advanced_options")+"</a>").click(function(e){e.preventDefault(),A()}).disableSelection();d.win.find(".buttons").append(F)}}),$(document).on("change",".content>.general .flist :checkbox",function(){var e=$(this).closest("div").data("id");Ve[e].disabled=!$(this).prop("checked"),Ve[e].mdiv[Ve[e].disabled?"hide":"show"](),K()&&e==Fe&&c();var t=Ve[e].disabled;for(var n in Ve[e].items)Ve[e].items.hasOwnProperty(n)&&Ve[e].items[n].mdiv[(t?"add":"remove")+"Class"]("disabled");L(),chrome.runtime.sendMessage({enableDisable:e,disabled:Ve[e].disabled})}),Qe=i,Me.click(function(){Me.hasClass("disabled")||i(Ve[Fe].mdiv)}),it=$("div#article-header h1"),at=$("span#author"),st=$("span#date"),rt=$("div#article"),ot=$("td:eq(2) .read-button",Re),dt=$("td:eq(2) .delete-button",Re),ot.click(function(){if(!$(this).hasClass("disabled")&&et){var e=ot.hasClass("selected");m(e);for(var t=z(),n=0;n<t.length;n++){var i=t[n];Ve[i.feed]&&Ve[i.feed].items[i.guid]&&(i=Ve[i.feed].items[i.guid],e?i.read&&delete i.read:i.read=1)}L(),chrome.runtime.sendMessage({markRead:1,read:!e,items:t})}}),dt.click(function(){function e(){var e=h();chrome.runtime.sendMessage({removeItems:1,items:t}),et.each(function(){var e=$(this),t=e.data("data");e=Ve[t.feed].items[t.guid],e.deleted?(delete Ve[t.feed].items[t.guid],e.mdiv.remove()):(e.deleted=1,e.dateDeleted=Date.now(),e.mdiv.addClass("deleted"))}),et.removeClass("selected"),M(),S(e),L(),Z()}if(!$(this).hasClass("disabled")&&et){for(var t=z(),n=!1,i=0;i<t.length;i++){var a=Ve[t[i].feed].items[t[i].guid];if(a.deleted){n=!0;break}}n?F('<p style="text-align:center">'+i18n("delete_selected",String(et.length))+"</p>",i18n("confirm"),e):e()}}),$(".toolbar-button").mousedown(function(e){e.preventDefault()});var r;Le.bind("change keydown keypress keyup cut paste",function(){setTimeout(function(){var e=Le.val().trim();if(r!=e){if(r=e,e){Je[e]||(Je[e]=y(e)),Be||(Be=Fe),ee(Ke),$(".item.found",Ce).removeClass("found"),Je[e].forEach(function(e){$(e).addClass("found")}),et.removeClass("selected"),et=$();var t=$(".item:visible:first",Ce);t.length?t.mousedown():Ce.mousedown(),me(i18n("search"),Je[e].length)}else Be&&Fe==Ke&&ee(Be),Be=null;e?je.show():je.hide(),Z()}},1)}),je.click(function(){r=null,Le.val("").change(),Je={}}),je.mousedown(function(e){e.preventDefault()})}function y(e){e=new RegExp(e,"i");var t=[];for(var n in Ve)if(Ve.hasOwnProperty(n)){var i=Ve[n].name||"",a=Ve[n].givenName||"";for(var s in Ve[n].items)if(Ve[n].items.hasOwnProperty(s)){if(s=Ve[n].items[s],!s.author)if(i){if(i.search(e)>=0){t.push(s.mdiv);continue}}else if(a&&a.search(e)>=0){t.push(s.mdiv);continue}if(String(s.author).search(e)>=0){t.push(s.mdiv);continue}if(String(s.title).search(e)>=0){t.push(s.mdiv);continue}String(s.descr).search(e)>=0&&t.push(s.mdiv)}}return t}function k(e){function t(t){!Ze.sound&&"ceres"==t.name&&t.def&&(Ze.sound=t.path,chrome.runtime.sendMessage({changeOptions:1,options:{sound:t.path}})),x(t.name,t.path,function(n,i,a){var s=$("<option value='"+i+"'>"+n+"</option>");t.def||s.addClass("users"),s.data("audio",a),e.append(s),Ze.sound==i&&s.prop("selected",!0),C(e)})}e.empty();var n=["beep","iphone2","iphone","ariel","carme","ceres","elara","europa","iapetus","io","rhea","salacia","tethys","titan"];n.forEach(function(e,t){n[t]={name:e,path:chrome.extension.getURL(e+".mp3"),def:!0}}),n.forEach(t),window.requestFileSystem(1,1e8,function(e){e.root.getDirectory("sounds",{create:!0},function(e){var n=e.createReader();n.readEntries(function(e){e.forEach(function(e){e.isFile&&t({name:e.name,path:e.toURL(),def:!1})})})})})}function C(e){var t=$("option",e);t.sort(function(e,t){return e.innerHTML.localeCompare(t.innerHTML)}),e.append(t)}function x(e,t,n){var i=new Audio;$(i).bind("canplaythrough",function(){$(this).unbind("canplaythrough"),n(e,t,i)}),i.src=t}function _(e){lt&&lt.pause(),e&&(lt=e,e.pause(),e.currentTime=0,e.volume=Ze.volume/100,e.play())}function M(){var e=100,t=$(".deleted:not(.pinned)",Ce);if(t.length>e&&t.length){var n=[];t.each(function(){var e=$(this).data("data");n.push({feed:e.feed,guid:e.guid,dateDeleted:Ve[e.feed].items[e.guid].dateDeleted})}),n.sort(function(e,t){return t.dateDeleted-e.dateDeleted}),n=n.slice(e),n.forEach(function(e){var t=Ve[e.feed].items[e.guid];t.mdiv.remove(),delete Ve[e.feed].items[e.guid]}),chrome.runtime.sendMessage({removeItems:1,items:n})}}function D(e,t){var n=$();return e.each(function(){var e=$(this);e.parent(null).length&&(t!=Fe||e.is(":visible")&&t==Fe)&&(n=n.add(e))}),n}function S(e){et=D(et,Fe),vt[Fe]=et,et.length?(et.addClass("selected"),1==et.length?et.mousedown():j(et.length)):e.length?e.mousedown():Ce.mousedown()}function O(e){var t=E(i18n("enter_feeds_name"),i18n("new_feed"),U);e&&t.win.find("input:eq(0)").val(e).select()}function T(){var e,t=$(".select-add-lang",Ue).clone(),n=$.extend({},mt);for(e in lingua.available_languages)lingua.available_languages.hasOwnProperty(e)&&n[e]&&delete n[e];n.zzz=i18n("another_language");var i,a=Object.keys(n).length,s=Math.ceil(Math.sqrt(5*a/2)),r=0;for(e in n)if(n.hasOwnProperty(e)){r%s||(i=$("<ul/>").appendTo(t));var o=$("<li/>").appendTo(i).data({l:e,n:n[e]});$("<div/>").html(n[e]).appendTo(o),++r}$("li",t).click(function(){var e=$(this).data(),t=chrome.i18n.getMessage("@@extension_id"),n="lingua.js";$.ajax("chrome-extension://"+t+"/"+n,{dataType:"text"}).done(function(t){var n=new RegExp('"(\r\n|\n)\t}',"g");"zzz"==e.l&&(e.l=""),t=t.replace(n,'",\r\n\t\t"'+e.l+'": ""\r\n\t}'),w(t,"lingua.txt",function(e){e||d("lingua.txt",t)}),I("<p style='text-align:center'>"+i18n("fill_gaps")+"<br/>"+i18n("then_send","holdenru@gmail.com")+"<br/>"+i18n("thank_you")+"</p>",e.n,function(){setTimeout(l.win.destroy,100)})})});var l=R(t,i18n("add_translation"))}function A(){var e=$(".advanced-options",Ue).clone();$(".reload-icons,.reload-icons-aggressively",e).click(function(){$(">div>div",ke).add(".flist>div").css("background-image",""),chrome.runtime.sendMessage({reloadIcons:!0,aggressively:!$(this).is(".reload-icons")})}),$(".export-data,.export-data-with-articles",e).click(function(){var e=!$(this).is(".export-data"),t=JSON.stringify(P(e,Ve),null,"\t"),n="data"+(e?"-with-articles":"")+".json";w(t,n,function(e){e||d(n,t)})}),$(".delete-all-feeds",e).click(function(){F('<p style="text-align:center">'+i18n("are_you_sure")+"</p>",i18n("delete_all_feeds"),function(){ke.add(".flist").empty(),$(".butlist .edit,.butlist .delete").prop("disabled",!0),$(".item",Ce).remove(),chrome.runtime.sendMessage({removeAllFeeds:!0}),Ve={},c(),L()})}),R(e,i18n("advanced_options")),window.requestFileSystem(1,1e8,function(t){$(".open-file-storage",e).prop("disabled",!1).click(function(){var e=document.createElement("a");e.href=t.root.toURL(),e.setAttribute("target","_blank"),e.click()}),$(".clear-file-storage",e).prop("disabled",!1).click(function(){N(t)})})}function N(e){var t=(e.isDirectory?e:e.root).createReader();t.readEntries(function(e){e.forEach(function(e){e.isDirectory?e.removeRecursively(function(){}):e.remove(function(){})})})}function P(e,t,n){n||(n=Array.isArray(t)?[]:{});for(var i in t)if(t.hasOwnProperty(i)){if("mdiv"==i||"date"==i)continue;if(!e&&"descr"==i)continue;var a=typeof t[i];"object"==a?n[i]=P(e,t[i]):n[i]=t[i]}return n}function I(e,t,n){return q(1,e,t,n)}function F(e,t,n,i){return q(2,e,t,n,i)}function R(e,t,n){return q(0,e,t,null,null,n)}function E(e,t,n,i){var a=q(2,'<p><input style="width:300px;" placeholder="'+e+'"/></p>',t,function(){n($("p>input",a.win).val().trim())},i);return a}function q(e,t,n,i,a,s){function r(){e>0&&$(document).unbind("keyup",o),u.remove(),v.stop(),$({a:1}).animate({a:0},{easing:"easeInBack",duration:200,step:function(e){l.css("-webkit-transform","scale("+e+","+e+")")},complete:function(){l.remove()}})}function o(t){$(".win").last().is(l)&&((13==t.keyCode&&2==e||1==e&&27==t.keyCode)&&c.click(),27==t.keyCode&&2==e&&f.click(),27!=t.keyCode||0!=e||s||m.click())}n=n||"The RSS Aggregator",t=t||"&nbsp;";var d=$("#winfak"),l=$(".win",d).clone(),u=$(".hider",d).clone();$("body").append(u).append(l),0==e&&$(".buttons input:not(.close_button)",l).remove(),0==e&&s&&$(".buttons",l).remove(),1==e&&$(".buttons .cancel_button",l).remove(),0!=e&&$(".buttons .close_button",l).remove(),$(".content",l).html(t),$("a",l).disableSelection(),$(".title",l).text(n),l.css("top",$(window).height()/2-l.height()/2),l.css("left",$(window).width()/2-l.width()/2),$("input:text:eq(0)",l).focus();var c=$(".buttons .ok_button",l).click(function(){i&&i(),r()}),f=$(".buttons .cancel_button",l).click(function(){a&&a(),r()}),m=$(".buttons .close_button",l).click(function(){r()});l.destroy=r,$(document).keyup(o);var v=$({a:0}).animate({a:1},{easing:"easeOutBack",duration:200,step:function(e){l.css("-webkit-transform","scale("+e+","+e+")")},complete:function(){l.css("-webkit-transform","")}});return{win:l,hider:u}}function U(e){if(e){var t=R("<p>Please wait...</p>","Checking",!0);chrome.runtime.sendMessage({checkUrl:e},function(n){t.win.destroy(),n?$e(e,n):I("<p>No such feed!</p>",0,function(){O(e)})})}}function z(){var e=[];return et.each(function(){var t=$(this).data("data");e.push({feed:t.feed,guid:t.guid})}),e}function L(){var e={},t=0,n=0;ut=0,$(".item",Ce).each(function(){var i=$(this),a=i.data("data"),s=a.feed,r=Ve[s].items[a.guid];r.read||r.deleted||Ve[s].disabled||(e[s]||(e[s]=0),e[s]+=1,ut+=1),r.deleted&&(t+=1),r.pinned&&(n+=1)});var i=$(">div",ke).each(function(){var t=$(this).data("id"),n=e[t]?e[t]:"";$("span",this).text(n),$(this)[(n?"add":"remove")+"Class"]("has-unread")});K()?me(be(Fe),+$("span",Ve[Fe].mdiv).text()):(Fe==Ye&&me(i18n("feeds"),ut),Fe==Xe&&me(i18n("trash"),t),Fe==Ge&&me(i18n("pinned"),n)),tt[(i.length?"remove":"add")+"Class"]("disabled"),tt.attr("title",i.length?i18n("update_all"):"")}function j(e){ze.attr("seld",e?i18n("selected_items",String(e)):"")[(e?"add":"remove")+"Class"]("hasCount")}function B(){var e=oe();ae(e),ne(),ee(Ye),chrome.runtime.sendMessage({iAmHere:!0},function(e){}),chrome.runtime.sendMessage({ioExists:1},function(e){He=e}),H()}function H(){$(".view-button").mousedown(function(){$(this).is(".pressed")||(Ae.is(this)&&ee(Ye),Ne.is(this)&&ee(Xe),Pe.is(this)&&ee(Ge))})}function Y(e){return ue(e,!1)+" "+le(e,!0)}function X(e){if(e.match(/\D/))return e;e=+e;for(var t=[" B"," KB"," MB"," GB"," TB"," PB"],n=0;e>999;)e/=1024,n+=1;return Math.round(e)+t[n]}function G(e,t){var n=Ve[e].items[t];Ie.data({feed:e,guid:t}),Ie[(n.pinned?"add":"remove")+"Class"]("pinned"),it.text($("<div/>").html(n.title).text()),at.text(n.author?n.author:be(e)),st.text(Y(new Date(n.date)));var i="";Ve[e].baseURI&&(i=Ve[e].baseURI),i||n.link&&!n.link.match(/^.*:/)&&(i=$("<a href='"+n.link+"'/>")[0],i=i.protocol+"//"+i.host),i||(i=$("<a href='"+e+"'/>")[0],i=i.protocol+"//"+i.host);var a=$('<p><a class="external-link" href="'+(n.link||i)+'" target="_blank">'+i18n("full_article")+"</a></p>");if(rt.html($.parseHTML(n.descr)).append(a),n.comments&&a.append($("<a class='external-link' target='blank'/>").html(i18n("comments")).attr("href",n.comments)),n.enclosure){a=$('<p><a class="external-link donwload-link" href="'+n.enclosure+'" target="_blank"></a></p>');var s=n.enclosure.replace(/^.*\//,"").trim();if($("a",a).html(i18n("download")),s){var r=s;if(n.enclosureSize){var o=X(n.enclosureSize);o&&(r+=" ("+o+")")}$("a",a).attr("download",s),s.match(/^.*:/)||$("a",a).html(r),n.enclosure.match(/^(?:f|ht)tps?:\/\//)||$("a",a).removeAttr("download")}rt.prepend(a)}$("a,img",rt).each(function(){var e=$(this),t="src",n=e.is("a");n&&(e.attr("target","_blank"),t="href");var a=e.attr(t);void 0!==a&&(a.match(/^.*:/)||("/"!=a[0]&&(a="/"+a),a=i+a,e.attr(t,a)),!n||a.match(/^(?:f|ht)tps?:\/\//)&&!e.attr("download")||e.removeAttr("target"))}),rt.scrollTop(0),rt.css("top",it.parent().outerHeight())}function K(){return Fe!=Ye&&Fe!=Xe&&Fe!=Ge&&Fe!=Ke}function W(){$(">div",ke).length&&tt.removeClass("disabled").attr("title",i18n("update_all"));var e=nt.add(Me);if(K()){e.removeClass("disabled");var t=be(Fe);me(t,+$("span",Ve[Fe].mdiv).text()),nt.attr("title",i18n("update_feed",t)),Me.attr("title",i18n("properties_for",t))}else e.addClass("disabled").removeAttr("title");ot.removeClass("selected").add(dt).addClass("disabled").removeAttr("title"),et.length>=1&&(ot.add(dt).removeClass("disabled"),ot.attr("title",i18n("read")),dt.attr("title",i18n("delete")),2*et.filter(".read").length>et.length&&ot.addClass("selected").attr("title",i18n("unread")))}function J(){var e=$(".item.selected",Ce);return Fe&&(We[Fe]=Ce.parent().scrollTop(),vt[Fe]=e),e}function Q(){var e=$();Ce.parent().scrollTop(We[Fe]||0),Fe&&vt[Fe]&&(e=vt[Fe].addClass("selected")),et=e,et=D(et,Fe)}function V(){if($(">div",ke).removeClass("hlight"),1==et.length){var e=et.data("data");Fe!=e.feed&&Ve[e.feed].mdiv.addClass("hlight")}}function Z(){if(Ze.showMilestones){var e=$(".day-panel",Ce).show(),t=$(":visible:last",Ce);e.each(function(){($(this).nextAll(":visible:first").is(".day-panel")||$(this).is(t))&&$(this).hide()})}}function ee(e){if(Fe!=e){var t=Fe==Ke;t&&$(".item.selected",Ce).removeClass("selected");var n=$();t||(n=J()),Fe=e,t&&(Le.val(""),je.hide()),Ce.removeClass().addClass(e==Ye?"showAll":e==Xe?"showDeleted":e==Ge?"showPinned":e==Ke?"showSearch":Ve[e].feedN),n.removeClass("selected"),Q(),K()?Ve[Fe].mdiv.addClass("selected").siblings().removeClass("selected"):($(">div",ke).removeClass("selected"),Fe==Ye&&me(i18n("feeds"),ut),Fe==Xe&&me(i18n("trash"),$(".item.deleted",Ce).length),Fe==Ge&&me(i18n("pinned"),$(".item.pinned",Ce).length));var i=et.length;if(0==i){var a=$(".item:visible:first",Ce);a.length&&(i=(et=et.add(a.addClass("selected"))).length,ct[Fe]=a)}var s=rt.parent();if(1==i){s.show();var r=et.data("data");G(r.feed,r.guid)}else s.hide(),j(i);W(),V(),p(),Te.removeClass("pressed");var o=$();Fe==Ye&&(o=Ae),Fe==Xe&&(o=Ne),Fe==Ge&&(o=Pe),o.addClass("pressed"),Z()}}function te(){var e=[];for(var t in Ve)Ve.hasOwnProperty(t)&&e.push(t);e.sort(function(e,t){return Ve[e].position-Ve[t].position});for(var n=0;n<e.length;n++)ke.append(Ve[e[n]].mdiv)}function ne(){$("#myStyle").remove();var e=[];for(var t in Ve)if(Ve.hasOwnProperty(t)){var n=Ve[t].feedN;e.push("."+n+" ."+n)}var i=$("<style id='myStyle'>"+e.join()+"{display:block}.item.deleted{display:none;}</style>");$("head").append(i)}function ie(){var e=[];for(var t in Ve)if(Ve.hasOwnProperty(t)){var n=Ve[t];for(var i in n.items)if(n.items.hasOwnProperty(i)){var a=n.items[i];e.push({feed:t,guid:i,feedN:n.feedN,rawDate:a.rawDate,mdiv:a.mdiv})}}return e.sort(de),e}function ae(e){if(Ze.showMilestones){e=e||ie();var t=864e5,n=Date.now(),i=new Date(n),a=n-n%t+60*i.getTimezoneOffset()*1e3,s=["future","today","yesterday"],r=[1/0,n,a],o=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],d=i.getDay()-1;
if(d=d<0?6:d,d>=2){var l=a,u=d-1;do u-=1,l-=t,s.push(o[u]),r.push(l);while(u>0)}var c,f=a-d*t;c=f==a?f-t:f,s.push("lastweek"),r.push(c);var m=i.getDate(),v=f-7*t,p=f-t*(m-d-1);v>p&&(s.push("emonth"),r.push(v));var h=["mJanuary","mFebruary","mMarch","mApril","mMay","mJune","mJuly","mAugust","mSeptember","mOctober","mNovember","mDecember"],g=i.getMonth();if(g)for(x=g;x>0;x--){var w=new Date(i.getFullYear(),x,1,0,0,0);s.push(h[x-1]),r.push(w.valueOf())}var b=i.getFullYear()-1,y=i.getFullYear()-2,k=i.getFullYear()-3;s.push(String(b)),r.push(new Date(b+1,0,1,0,0,0).valueOf()),s.push(String(y)),r.push(new Date(y+1,0,1,0,0,0).valueOf()),s.push(String(k)),r.push(new Date(k+1,0,1,0,0,0).valueOf()),s.push("older"),r.push(new Date(k,0,1,0,0,0).valueOf()),r.push(-(1/0)),$(".day-panel",Ce).remove();for(var C={},x=1,_=0;_<e.length;_++)se(e[_].rawDate,r[x],r[x-1])?C.hasOwnProperty(s[x-1])||(e[_].mdiv.before(re(s[x-1])),C[s[x-1]]=1):(x+=1,_-=1)}}function se(e,t,n){return t<=e&&e<=n}function re(e){return $('<div class="day-panel">'+i18n(e)+"</div>")}function oe(){var e=[],t=0;for(var n in Ve)if(Ve.hasOwnProperty(n)){var i=Ve[n],a=$("<div><div></div><span></span></div>");$("div",a).text(be(n));var s=0,r=!1;i.feedN="feedN"+t,t+=1;for(var o in i.items)i.items.hasOwnProperty(o)&&(i.items[o].read||i.items[o].deleted||(r=!0,++s),i.items[o].rawDate=new Date(i.items[o].date).valueOf(),e.push({feed:n,guid:o,feedN:i.feedN,rawDate:i.items[o].rawDate}));s&&$("span",a).text(s),i.disabled||(ut+=s),r&&a.addClass("has-unread"),a.data("id",n),i.favIcon&&$("div",a).css("background-image","url("+i.favIcon+")"),i.mdiv=a,ke.append(a),i.disabled&&a.hide()}te(),e.sort(de);for(var d=Date.now(),l=0;l<e.length;l++){var u=e[l];a=fe(u,d),Ce.append(a),e[l].mdiv=a}return e}function de(e,t){return t.rawDate-e.rawDate}function le(e,t){return ce(e.getHours())+":"+ce(e.getMinutes())+(t?":"+ce(e.getSeconds()):"")}function ue(e,t){var n=ce(e.getDate()),i=e.getMonth();if(t)n+="."+ce(i+1)+".";else{var a=["january","february","march","april","may","june","july","august","september","october","november","december"][i];a=i18n(a),n+=" "+a+" "}return n+=ce(e.getFullYear())}function ce(e){return String(e<10?"0"+e:e)}function fe(e,t){var n=t-864e5,i=Ve[e.feed],a=i.items[e.guid],s="item "+e.feedN;i.disabled&&(s+=" disabled"),a.seen&&(s+=" seen"),a.read&&(s+=" read"),a.deleted&&(s+=" deleted"),a.pinned&&(s+=" pinned");var r=document.createElement("div");r.className=s;var o=document.createElement("div");o.innerHTML=a.title,o.className="title",r.appendChild(o),o=document.createElement("div"),o.innerHTML=a.author||be(e.feed),o.className="author",r.appendChild(o);var d=new Date(a.rawDate);return d=d.valueOf()<n?ue(d,!0):le(d,!1),o=document.createElement("div"),o.innerHTML=d,o.className="date",r.appendChild(o),r=$(r),r.data("data",e),a.mdiv=r,r}function me(e,t){$("title").text(e+(t?" ("+t+")":""))}function ve(){window.chrome?chrome.storage.local.get("widthsAreas",function(e){e=e.widthsAreas?e.widthsAreas:{},e.left&&$(">div",Se).width(e.left),e.center&&$(">div",Oe).width(e.center),$("body").css("visibility","visible"),he()}):$("body").css("visibility","visible")}function pe(e){function t(e){var t=s+e.clientX-o;t=t>100?t:100,a.width(t),he()}function n(){r.releaseCapture?r.releaseCapture():$("*").css("cursor",""),$(document).unbind("mousemove",t).unbind("mouseup",n),window.chrome&&chrome.storage.local.get("widthsAreas",function(e){e=e.widthsAreas?e.widthsAreas:{},i?e.left=$(">div",Se).width():e.center=$(">div",Oe).width(),chrome.storage.local.set({widthsAreas:e})})}var i=$("#splitter1").is(this),a=i?$(">div",Se):$(">div",Oe),s=a.width(),r=this,o=e.clientX;return r.setCapture?r.setCapture():$("*").css("cursor","col-resize"),$(document).bind("mousemove",t),$(document).bind("mouseup",n),!1}function he(){var e=$(">div",Se).width(),t=$(">div",Oe).width();$("#splitter1").css("left",e-4),$("#splitter2").css("left",e+t-4),rt&&rt.css("top",it.parent().outerHeight()),Oe.next().width()<xe.outerWidth()+90?xe.hide():xe.show()}function ge(t,n,i){var a,s;if("tryToSubscribeToThisUrl"==t&&n.url){var r=String(n.url).trim();return void(Ve[r]?Ve[r].mdiv.mousedown():U(r))}if("loading"==t&&n.url&&Ve[n.url])return void $(Ve[n.url].mdiv).addClass("loading");{if("loadingComplete"!=t||!n.url){if("favIconChanged"==t&&n.url&&n.favIcon&&Ve[n.url]){Ve[n.url].favIcon=n.favIcon,Ve[n.url].mdiv&&$("div",Ve[n.url].mdiv).css("background-image","url("+n.favIcon+")");var o=$(".content>.general .flist");return void(o.length&&$(">div",o).each(function(){$(this).data("id")==n.url&&$(this).css("background-image","url("+n.favIcon+")")}))}if("subscribe"==t&&n.url)return void $e(n.url,n.name);if("readIt"==t&&n.url)return void(Ve[n.url]&&Ve[n.url].mdiv&&Ve[n.url].mdiv.mousedown());if("needAuth"==t&&n.url){var d=n.url;return Ve[d]&&(d=be(d)),s="<p>"+d+"</p>",s+="<div style='text-align:center'>",s+="<input id='login' placeholder='"+i18n("login")+"'/><br/>",s+="<input id='pass' placeholder='"+i18n("password")+"' type='password'/>",s+="</div>",s=F(s,i18n("authorization"),function(){var e=$("#login",s.win).val().trim(),t=$("#pass",s.win).val().trim();i({login:e,pass:t})},function(){i(!1)}),!0}return"manageFeeds"==t?void($(".content>.general").length||_e.click()):void("languageChanged"==t&&e(!0))}if(!Ve[n.url])return;if($(Ve[n.url].mdiv).removeClass("loading"),n.name&&(Ve[n.url].name=n.name,$("div",Ve[n.url].mdiv).text(be(n.url))),n.baseURI&&(Ve[n.url].baseURI=n.baseURI),n.newItems){var l=[];for(var u in n.newItems)if(n.newItems.hasOwnProperty(u)){var c=Ve[n.url];a=n.newItems[u],c.items[u]||(c.items[u]=a,a.rawDate=new Date(a.date).valueOf(),l.push({feed:n.url,guid:u,feedN:c.feedN,rawDate:a.rawDate}))}if(l.length){$(".day-panel",Ce).remove(),l.sort(de);var f=$(".item:eq(0)",Ce);if(f.length)for(;l.length;){a=l.shift();var m=Ve[a.feed].items[a.guid];do{if(!f.length)break;var v=f.data("data");v=Ve[v.feed].items[v.guid]}while(v.rawDate>m.rawDate&&(f=f.next()).length);f.length?(s=fe(a,Date.now()),f.before(s),f=s):Ce.append(fe(a,Date.now()))}else for(var p=0;p<l.length;p++)Ce.append(fe(l[p],Date.now()));L(),ae(null),Z()}var h;K()&&n.url==Fe&&!et.length&&(h=$(".item:visible:first",Ce)).length&&h.mousedown()}}}function $e(e,t){if(!Ve[e]){var n=$("<div><div></div><span></span></div>");$("div",n).html(t),Ve[e]={name:t,position:we()+1,deleted:[],items:{}},chrome.runtime.sendMessage({saveOneFeed:1,feedId:e,feed:Ve[e]}),n.data("id",e),Ve[e].mdiv=n,ke.append(n);var i=$(".content>.general .flist");if(i.length){var a=$('<div><input type="checkbox" checked/><span>'+t+"</span></div>");a.data("id",e),a.css("background-image","url(16x16.png)"),i.append(a)}var s=0;for(var r in Ve)if(Ve.hasOwnProperty(r)){var o=Ve[r];if(o.feedN){var d=+String(o.feedN).replace(/\D/g,"");d>s&&(s=d)}}Ve[e].feedN="feedN"+(s+1),ne()}Ve[e].mdiv.mousedown(),nt.click()}function we(){var e=1;for(var t in Ve)Ve.hasOwnProperty(t)&&Ve[t].position>e&&(e=Ve[t].position);return e}function be(e){var t="";if(Ve[e]){var n=Ve[e];t=n.useGivenName&&n.givenName?n.givenName:n.name?n.name:e}return t}function ye(){$(".menu").hide()}window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;var ke,Ce,xe,_e,Me,De,Se,Oe,Te,Ae,Ne,Pe,Ie,Fe,Re,Ee,qe,Ue,ze,Le,je,Be,He=!1,Ye="all",Xe="trash",Ge="pinned",Ke="search",We={},Je={};$(function(){ze=$("#item-window"),Ie=$("#article-header #pin",ze),ke=$("#feeds-div"),Ce=$("#feed-div"),xe=$("#feedback"),Re=$("#top-panel"),_e=$("td:eq(0) .config-button",Re),Me=$("td:eq(1) .config-button",Re),De=$(".add-url-button",Re),Ae=$("#view-all"),Ne=$("#view-deleted"),Pe=$("#view-pinned"),Te=Ae.add(Ne).add(Pe),Se=$("#feeds-td"),Oe=$("#feed-td"),Ue=$("#windows"),Ee=$("#feedMenu"),qe=$("#itemMenu"),Le=$("#search"),je=$("#search-closer"),xe.attr("href","https://chrome.google.com/webstore/support/"+chrome.runtime.id),n(),t(),$.ajaxSetup({crossDomain:!0,dataType:"xml"})});var Qe,Ve={url:{items:{guid:"string",read:1,pinned:1}}};Ve={};var Ze,et,tt,nt,it,at,st,rt,ot,dt,lt,ut=0,ct={},ft=!1,mt={ar:"‫‫العربية‬",bg:"‪български‬",ca:"‪català‬",cs:"‪čeština‬",da:"‪dansk‬",de:"‪Deutsch‬",en:"‪English‬","en-GB":"‪English (UK)‬","en-US":"‪English (United States)‬",es:"‪español‬","es-419":"‪español (Latinoamérica)‬",et:"‪eesti‬",el:"‪Ελληνικά‬",fil:"‪Filipino‬",fi:"‪suomi‬",fr:"‪Français‬",he:"‫עברית‬",hi:"‪हिन्दी‬",hr:"‪hrvatski‬",hu:"‪magyar‬",id:"‪Bahasa Indonesia‬",it:"‪italiano‬",ja:"‪日本語‬",ko:"‪한국어‬",lt:"‪lietuvių‬",lv:"‪latviešu‬",ms:"‪بهاس ملايو‬",nl:"‪Nederlands‬",no:"‪Norsk‬",pl:"‪polski‬","pt-BR":"‪português (Brasil)‬","pt-PT":"‪português (Portugal)‬",ro:"‪română‬",ru:"‪русский‬",sk:"‪slovenský‬",sl:"‪slovenščina‬",sr:"‪Српски‬",sv:"‪svenska‬",th:"‪ไทย‬",tr:"‪Türkçe‬",uk:"‪українська‬",vi:"‪Tiếng Việt‬","zh-CN":"‪中文 (简体)‬","zh-TW":"‪中文 (繁體)‬"};$(document).on("mousedown",".win",function(e){function t(e){var t=r+e.clientX-a,n=o+e.clientY-s;t=t<0?0:t>l?l:t,n=n<0?0:n>d?d:n,i.css({left:t,top:n})}function n(){$(document).unbind("mousemove",t).unbind("mouseup",n)}if(!$(e.target).is("input,option,select,a,.play_sound,label span,.vol-hand")){var i=$(this),a=e.clientX,s=e.clientY,r=i.position().left,o=i.position().top,d=$(window).height()-i.outerHeight(!0),l=$(window).width()-i.outerWidth(!0);return $(document).bind("mousemove",t).bind("mouseup",n),!1}});var vt={};window.chrome&&chrome.runtime.onMessage.addListener(function(e,t,n){if(e.command)return ge(e.command,e,n)}),function(e){e.fn.scrollTo=function(t){return this.each(function(){var n=e(this),i=t.offset().top-n.offset().top;i<0?n.scrollTop(n.scrollTop()+i):(i=n.height()-(i+t.outerHeight()),i<0&&n.scrollTop(n.scrollTop()-i))})}}(jQuery),function(e){e.fn.disableSelection=function(){return this.attr("unselectable","on").css("user-select","none").on("selectstart",!1)}}(jQuery),chrome.tabs.onActivated.addListener(ye),chrome.windows.onFocusChanged.addListener(ye),jQuery.extend(jQuery.easing,{easeInBack:function(e,t,n,i,a,s){return void 0==s&&(s=1.70158),i*(t/=a)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,i,a,s){return void 0==s&&(s=1.70158),i*((t=t/a-1)*t*((s+1)*t+s)+1)+n}})}();